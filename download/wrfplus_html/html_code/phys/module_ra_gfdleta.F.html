<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!WRF:MODEL_RA:RADIATION<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<A NAME='MODULE_RA_GFDLETA'><A href='../../html_code/phys/module_ra_gfdleta.F.html#MODULE_RA_GFDLETA' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='4'>
<font color=#993300>MODULE </font><font color=#cc0000>MODULE_RA_GFDLETA</font> <A href='../../call_to/MODULE_RA_GFDLETA.html' TARGET='index'>2</A><a name='5'>
      USE <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>MODULE_MODEL_CONSTANTS</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#module_ra_gfdleta.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_39"><a name='6'>
      USE <A href='../../html_code/phys/module_mp_etanew.F.html#MODULE_MP_ETANEW'>MODULE_MP_ETANEW</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#module_ra_gfdleta.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_ETANEW_3">, ONLY : RHGRD,FPVS<a name='7'>
      INTEGER,PARAMETER :: NL=81<a name='8'>
      INTEGER,PARAMETER :: NBLY=15<a name='9'>
      REAL,PARAMETER :: RTHRESH=1.E-15<a name='10'>
<a name='11'>
      INTEGER, SAVE, DIMENSION(3)     :: LTOP<a name='12'>
      REAL   , SAVE, DIMENSION(37,NL) :: XDUO3N,XDO3N2,XDO3N3,XDO3N4<a name='13'>
      REAL   , SAVE, DIMENSION(NL)    :: PRGFDL<a name='14'>
      REAL   , SAVE                   :: AB15WD,SKO2D,SKC1R,SKO3R<a name='15'>
<a name='16'>
      REAL   , SAVE :: EM1(28,180),EM1WDE(28,180),TABLE1(28,180),     &amp;<a name='17'>
                           TABLE2(28,180),TABLE3(28,180),EM3(28,180), &amp;<a name='18'>
                           SOURCE(28,NBLY), DSRCE(28,NBLY)<a name='19'>
<a name='20'>
      REAL   ,SAVE, DIMENSION(5040):: T1,T2,T4,EM1V,EM1VW,EM3V<a name='21'>
      REAL   ,SAVE                 :: R1<a name='22'>
<font color=#447700>! Created by CO2 initialization<a name='23'></font>
      REAL,   SAVE, ALLOCATABLE, DIMENSION(:,:) :: CO251,CDT51,CDT58,C2D51,&amp;<a name='24'>
                                           C2D58,CO258<a name='25'>
      REAL,   SAVE, ALLOCATABLE, DIMENSION(:)   :: STEMP,GTEMP,CO231,CO238, &amp;<a name='26'>
                                           C2D31,C2D38,CDT31,CDT38, &amp;<a name='27'>
                                           CO271,CO278,C2D71,C2D78, &amp;<a name='28'>
                                           CDT71,CDT78<a name='29'>
      REAL,   SAVE, ALLOCATABLE, DIMENSION(:)   :: CO2M51,CO2M58,CDTM51,CDTM58, &amp;<a name='30'>
                                           C2DM51,C2DM58<a name='31'>
      CHARACTER(256) :: ERRMESS<a name='32'>
<a name='33'>
<font color=#447700>! Used by CO2 initialization<a name='34'></font>
<font color=#447700>!     COMMON/PRESS/PA(109)<a name='35'></font>
<font color=#447700>!     COMMON/TRAN/ TRANSA(109,109)<a name='36'></font>
<font color=#447700>!     COMMON/COEFS/XA(109),CA(109),ETA(109),SEXPV(109),CORE,UEXP,SEXP<a name='37'></font>
      REAL   ,SAVE, DIMENSION(109) :: PA, XA, CA, ETA, SEXPV<a name='38'>
      REAL   ,SAVE, DIMENSION(109,109) :: TRANSA<a name='39'>
      REAL   ,SAVE  :: CORE,UEXP,SEXP<a name='40'>
<a name='41'>
      EQUIVALENCE (EM1V(1),EM1(1,1)),(EM1VW(1),EM1WDE(1,1)) <a name='42'>
      EQUIVALENCE (EM3V(1),EM3(1,1))<a name='43'>
      EQUIVALENCE (T1(1),TABLE1(1,1)),(T2(1),TABLE2(1,1)), &amp;<a name='44'>
                  (T4(1),TABLE3(1,1))<a name='45'>
CONTAINS<a name='46'>
<a name='47'>
<font color=#447700>!-----------------------------------------------------------------------<a name='48'></font>
<A NAME='GFDLETAINIT'><A href='../../html_code/phys/module_ra_gfdleta.F.html#GFDLETAINIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='49'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>GFDLETAINIT</font>(SFULL,SHALF,PPTOP,JULYR,MONTH,IDAY,GMT,    &amp; <A href='../../call_to/GFDLETAINIT.html' TARGET='index'>2</A>,<A href='../../call_from/GFDLETAINIT.html' TARGET='index'>5</A><a name='50'>
     &amp;                       ALLOWED_TO_READ,                           &amp;<a name='51'>
     &amp;                       KDS,KDE,KMS,KME,KTS,KTE)<a name='52'>
<font color=#447700>!-----------------------------------------------------------------------<a name='53'></font>
      IMPLICIT NONE<a name='54'>
<font color=#447700>!-----------------------------------------------------------------------<a name='55'></font>
      INTEGER,INTENT(IN) :: KDS,KDE,KMS,KME,KTS,KTE<a name='56'>
      REAL,DIMENSION(KMS:KME),INTENT(IN) :: SFULL, SHALF<a name='57'>
      INTEGER,INTENT(IN) :: JULYR,MONTH,IDAY<a name='58'>
      REAL,INTENT(IN) :: GMT,PPTOP<a name='59'>
      LOGICAL,INTENT(IN) :: ALLOWED_TO_READ<a name='60'>
      INTEGER :: IHRST,N<a name='61'>
      REAL :: PCLD<a name='62'>
      REAL :: SSLP=1013.25<a name='63'>
      REAL :: PTOP_HI=150.,PTOP_MID=350.,PTOP_LO=642.<a name='64'>
<font color=#447700>!-----------------------------------------------------------------------<a name='65'></font>
<font color=#447700>!***********************************************************************<a name='66'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='67'></font>
<font color=#447700>!<a name='68'></font>
<font color=#447700>!***  INITIALIZE DIAGNOSTIC LOW,MIDDLE,HIGH CLOUD LAYER PRESSURE LIMITS.<a name='69'></font>
<font color=#447700>!<a name='70'></font>
      LTOP(1)=0<a name='71'>
      LTOP(2)=0<a name='72'>
      LTOP(3)=0<a name='73'>
<font color=#447700>!<a name='74'></font>
      DO N=1,KTE<a name='75'>
        PCLD=(SSLP-PPTOP*10.)*SHALF(N)+PPTOP*10.<a name='76'>
        IF(PCLD&gt;=PTOP_LO)LTOP(1)=N<a name='77'>
        IF(PCLD&gt;=PTOP_MID)LTOP(2)=N<a name='78'>
        IF(PCLD&gt;=PTOP_HI)LTOP(3)=N<a name='79'>
<font color=#447700>!       PRINT *,N,PCLD,SHALF(N),PSTAR,PPTOP<a name='80'></font>
      ENDDO<a name='81'>
<font color=#447700>!<a name='82'></font>
<font color=#447700>!***  USE CALL TO CONRAD FOR DIRECT READ OF CO2 FUNCTIONS<a name='83'></font>
<font color=#447700>!***  OTHERWISE CALL CO2O3.<a name='84'></font>
<font color=#447700>!<a name='85'></font>
      IF(ALLOWED_TO_READ)THEN<a name='86'>
#if (EM_CORE==1)<a name='87'>
        CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3'>CO2O3</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#GFDLETAINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2O3_1">(SFULL,SHALF,PPTOP,KME-KMS,KME-KMS+1,KME-KMS+2)<a name='88'>
#endif<a name='89'>
#if (NMM_CORE==1)<a name='90'>
        CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CONRAD'>CONRAD</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#GFDLETAINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CONRAD_1">(KDS,KDE,KMS,KME,KTS,KTE)<a name='91'>
#endif<a name='92'>
<font color=#447700>!<a name='93'></font>
        CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#O3CLIM'>O3CLIM</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#GFDLETAINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="O3CLIM_1"><a name='94'>
        CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#TABLE'>TABLE</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#GFDLETAINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TABLE_1"><a name='95'>
        IHRST=NINT(GMT)<a name='96'>
        CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#SOLARD'>SOLARD</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#GFDLETAINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SOLARD_1">(IHRST,IDAY,MONTH,JULYR)<a name='97'>
      ENDIF<a name='98'>
<font color=#447700>!<a name='99'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='100'></font>
      END SUBROUTINE GFDLETAINIT<a name='101'>
<font color=#447700>!-----------------------------------------------------------------------<a name='102'></font>
<font color=#447700>!<a name='103'></font>
<font color=#447700>!<a name='104'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='105'></font>
<A NAME='ETARA'><A href='../../html_code/phys/module_ra_gfdleta.F.html#ETARA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='106'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>ETARA</font>(DT,THRATEN,THRATENLW,THRATENSW,PI3D              &amp;  <A href='../../call_to/ETARA.html' TARGET='index'>2</A>,<A href='../../call_from/ETARA.html' TARGET='index'>2</A><a name='107'>
     &amp;                ,XLAND,P8W,DZ8W,RHO_PHY,P_PHY,T                   &amp;<a name='108'>
     &amp;                ,QV,QW,QI                                         &amp; <a name='109'>
     &amp;                ,TSK2D,GLW,GSW                                    &amp;<a name='110'>
     &amp;                ,TOTSWDN,TOTLWDN,RSWTOA,RLWTOA,CZMEAN             &amp; <a name='111'>
     &amp;                ,GLAT,GLON,HTOP,HBOT,ALBEDO,CUPPT                 &amp;<a name='112'>
     &amp;                ,VEGFRA,SNOW,G,GMT                                &amp;<a name='113'>
     &amp;                ,NSTEPRA,NPHS,ITIMESTEP                           &amp;<a name='114'>
     &amp;                ,JULYR,JULDAY,GFDL_LW,GFDL_SW                     &amp;<a name='115'>
     &amp;                ,CFRACL,CFRACM,CFRACH                             &amp;<a name='116'>
     &amp;                ,ACFRST,NCFRST,ACFRCV,NCFRCV                      &amp;<a name='117'>
     &amp;                ,IDS,IDE,JDS,JDE,KDS,KDE                          &amp;<a name='118'>
     &amp;                ,IMS,IME,JMS,JME,KMS,KME                          &amp;<a name='119'>
     &amp;                ,ITS,ITE,JTS,JTE,KTS,KTE)<a name='120'>
<font color=#447700>!-----------------------------------------------------------------------<a name='121'></font>
      IMPLICIT NONE<a name='122'>
<font color=#447700>!-----------------------------------------------------------------------<a name='123'></font>
      INTEGER,INTENT(IN) :: IDS,IDE,JDS,JDE,KDS,KDE                     &amp;<a name='124'>
     &amp;                     ,IMS,IME,JMS,JME,KMS,KME                     &amp;<a name='125'>
     &amp;                     ,ITS,ITE,JTS,JTE,KTS,KTE,ITIMESTEP           &amp;<a name='126'>
     &amp;                     ,NPHS,NSTEPRA<a name='127'>
 <a name='128'>
      INTEGER,INTENT(IN) :: julyr,julday   <a name='129'>
      INTEGER,INTENT(INOUT),DIMENSION(ims:ime,jms:jme) :: NCFRST        &amp; <font color=#447700>!Added<a name='130'></font>
                                                         ,NCFRCV          <font color=#447700>!Added<a name='131'></font>
      REAL,INTENT(IN) :: DT,GMT,G<a name='132'>
<a name='133'>
      REAL,INTENT(INOUT),DIMENSION(ims:ime, kms:kme, jms:jme)::         &amp;<a name='134'>
                                         THRATEN,THRATENLW,THRATENSW<a name='135'>
      REAL,INTENT(IN),DIMENSION(ims:ime, kms:kme, jms:jme)::p8w,dz8w,   &amp;<a name='136'>
     &amp;                                                      rho_phy,    &amp;<a name='137'>
     &amp;                                                      p_phy,      &amp;<a name='138'>
     &amp;                                                      PI3D<a name='139'>
      REAL, INTENT(IN), DIMENSION(ims:ime, jms:jme):: ALBEDO,SNOW,      &amp;<a name='140'>
     &amp;                                                TSK2D,VEGFRA,     &amp;<a name='141'>
     &amp;                                                XLAND<a name='142'>
      REAL, INTENT(IN), DIMENSION(ims:ime, jms:jme):: GLAT,GLON<a name='143'>
      REAL, INTENT(INOUT), DIMENSION(ims:ime, jms:jme):: HTOP,HBOT,CUPPT<a name='144'>
      REAL, INTENT(INOUT), DIMENSION(ims:ime, jms:jme):: RSWTOA,        &amp; <font color=#447700>!Added<a name='145'></font>
     &amp;                                                   RLWTOA,        &amp; <font color=#447700>!Added<a name='146'></font>
     &amp;                                                   ACFRST,        &amp; <font color=#447700>!Added<a name='147'></font>
     &amp;                                                   ACFRCV<a name='148'>
      REAL,INTENT(INOUT),DIMENSION(ims:ime, jms:jme):: GLW,GSW<a name='149'>
      REAL,INTENT(OUT),DIMENSION(ims:ime, jms:jme):: CZMEAN,            &amp;<a name='150'>
     &amp;                                               TOTLWDN,TOTSWDN<a name='151'>
      REAL,INTENT(OUT),DIMENSION(ims:ime, jms:jme):: CFRACL,CFRACM,     &amp; <font color=#447700>!Added<a name='152'></font>
     &amp;                                               CFRACH               <font color=#447700>!Added<a name='153'></font>
      REAL, INTENT(IN), DIMENSION(ims:ime, kms:kme, jms:jme):: QI,QV,   &amp;<a name='154'>
     &amp;                                                         QW,T<a name='155'>
<font color=#447700>!     REAL, INTENT(IN), DIMENSION(37*kte) :: RAD1,RAD2,RAD3,RAD4<a name='156'></font>
      LOGICAL, INTENT(IN) :: gfdl_lw,gfdl_sw<a name='157'>
<a name='158'>
      REAL, DIMENSION(its:ite, kms:kme, jts:jte):: PFLIP,QIFLIP,QFLIP,  &amp;<a name='159'>
     &amp;                                             QWFLIP,TFLIP<a name='160'>
      REAL, DIMENSION(its:ite, kms:kme, jts:jte)::P8WFLIP,PHYD<a name='161'>
      REAL, DIMENSION(its:ite, kts:kte, jts:jte)::TENDS,TENDL<a name='162'>
<a name='163'>
      INTEGER :: IDAT(3),Jmonth,Jday<a name='164'>
      INTEGER :: I,J,K,KFLIP,IHRST<a name='165'>
<font color=#447700>!-----------------------------------------------------------------------<a name='166'></font>
<font color=#447700>!***********************************************************************<a name='167'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='168'></font>
      IF(GFDL_LW.AND.GFDL_SW )GO TO 100<a name='169'>
<font color=#447700>!<a name='170'></font>
<font color=#447700>! NEED HYDROSTATIC PRESSURE HERE (MONOTONIC CHANGE WITH HEIGHT)<a name='171'></font>
      DO J=JTS,JTE<a name='172'>
      DO I=ITS,ITE<a name='173'>
        PHYD(I,KTS,J)=P8W(I,KTS,J) <a name='174'>
      ENDDO<a name='175'>
      ENDDO<a name='176'>
<font color=#447700>!<a name='177'></font>
      DO J=JTS,JTE<a name='178'>
        DO K=KTS,KTE<a name='179'>
        DO I=ITS,ITE<a name='180'>
          PHYD(I,K+1,J)=PHYD(I,K,J)-G*RHO_PHY(I,K,J)*DZ8W(I,K,J)<a name='181'>
        ENDDO<a name='182'>
        ENDDO<a name='183'>
      ENDDO<a name='184'>
<font color=#447700>!<a name='185'></font>
      DO K=KMS,KME<a name='186'>
         KFLIP=KME+1-K<a name='187'>
         DO J=JTS,JTE<a name='188'>
         DO I=ITS,ITE<a name='189'>
           P8WFLIP(I,K,J)=PHYD(I,KFLIP,J)<a name='190'>
         ENDDO<a name='191'>
         ENDDO<a name='192'>
      ENDDO<a name='193'>
<font color=#447700>!<a name='194'></font>
<font color=#447700>!- Note that the effects of rain are ignored in this radiation package (BSF 2005-01-25)<a name='195'></font>
<font color=#447700>!<a name='196'></font>
      DO K=KTS,KTE<a name='197'>
        KFLIP=KTE+1-K<a name='198'>
        DO J=JTS,JTE<a name='199'>
        DO I=ITS,ITE<a name='200'>
          TFLIP (I,K,J)=T(I,KFLIP,J)<a name='201'>
          QFLIP (I,K,J)=MAX(0.,QV(I,KFLIP,J)/(1.+QV(I,KFLIP,J)))<a name='202'>
          QWFLIP(I,K,J)=QW(I,KFLIP,J)      <font color=#447700>!Modified<a name='203'></font>
          QIFLIP(I,K,J)=QI(I,KFLIP,J)      <font color=#447700>!Added QI<a name='204'></font>
<font color=#447700>!         PFLIP (I,K,J)=P_PHY(I,KFLIP,J)<a name='205'></font>
<font color=#447700>!<a name='206'></font>
<font color=#447700>!***  USE MONOTONIC HYDROSTATIC PRESSURE INTERPOLATED TO MID-LEVEL<a name='207'></font>
<font color=#447700>!<a name='208'></font>
          PFLIP(I,K,J)=0.5*(P8WFLIP(I,K,J)+P8WFLIP(I,K+1,J))<a name='209'>
        ENDDO<a name='210'>
        ENDDO<a name='211'>
      ENDDO<a name='212'>
<font color=#447700>!<a name='213'></font>
      DO J=JTS,JTE<a name='214'>
      DO I=ITS,ITE<a name='215'>
        HBOT(I,J)=KTE+1-HBOT(I,J)<a name='216'>
        HTOP(I,J)=KTE+1-HTOP(I,J)<a name='217'>
      ENDDO<a name='218'>
      ENDDO<a name='219'>
<font color=#447700>!<a name='220'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CAL_MON_DAY'>CAL_MON_DAY</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#ETARA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CAL_MON_DAY_1">(JULDAY,JULYR,JMONTH,JDAY)     <a name='221'>
<font color=#447700>!<a name='222'></font>
      IDAT(1)=JMONTH<a name='223'>
      IDAT(2)=JDAY<a name='224'>
      IDAT(3)=JULYR<a name='225'>
      IHRST  =NINT(GMT)<a name='226'>
<a name='227'>
<font color=#447700>!     CALL SOLARD(R1,IHRST,IDAT)<a name='228'></font>
<font color=#447700>!     CALL SOLARD(R1,IHRST,JULDAY)<a name='229'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='230'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#RADTN'>RADTN</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#ETARA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RADTN_1"> (DT,TFLIP,QFLIP,QWFLIP,QIFLIP,                         &amp;<a name='231'>
     &amp;            PFLIP,P8WFLIP,XLAND,TSK2D,                            &amp;<a name='232'>
     &amp;            GLAT,GLON,HTOP,HBOT,ALBEDO,CUPPT,                     &amp;<a name='233'>
     &amp;            ACFRCV,NCFRCV,ACFRST,NCFRST,                          &amp;<a name='234'>
     &amp;            VEGFRA,SNOW,GLW,GSW,                                  &amp;<a name='235'>
     &amp;            TOTSWDN,TOTLWDN,                                      &amp;<a name='236'>
     &amp;            IDAT,IHRST,                                           &amp;<a name='237'>
     &amp;            NSTEPRA,NSTEPRA,NPHS,ITIMESTEP,                       &amp;<a name='238'>
     &amp;            TENDS,TENDL,RSWTOA,RLWTOA,CZMEAN,                     &amp;<a name='239'>
     &amp;            CFRACL,CFRACM,CFRACH,                                 &amp;<a name='240'>
     &amp;            IDS,IDE,JDS,JDE,KDS,KDE,                              &amp;<a name='241'>
     &amp;            IMS,IME,JMS,JME,KMS,KME,                              &amp;<a name='242'>
     &amp;            ITS,ITE,JTS,JTE,KTS,KTE                              )<a name='243'>
<font color=#447700>!-----------------------------------------------------------------------<a name='244'></font>
<font color=#447700>!<a name='245'></font>
      IF(GFDL_LW)THEN<a name='246'>
        DO J=JTS,JTE<a name='247'>
        DO K = KTS,KTE<a name='248'>
          KFLIP=KTE+1-K<a name='249'>
          DO I=ITS,ITE<a name='250'>
            THRATENLW(I,K,J)=TENDL(I,KFLIP,J)/PI3D(I,K,J)<a name='251'>
            THRATENSW(I,K,J)=TENDS(I,KFLIP,J)/PI3D(I,K,J) <font color=#447700>!Put in SW section<a name='252'></font>
            THRATEN(I,K,J)  =THRATEN(I,K,J) + THRATENLW(I,K,J)<a name='253'>
          ENDDO<a name='254'>
        ENDDO<a name='255'>
        ENDDO<a name='256'>
      ENDIF<a name='257'>
<font color=#447700>!<a name='258'></font>
<font color=#447700>!*** THIS ASSUMES THAT LONGWAVE IS CALLED FIRST IN THE RADIATION_DRIVER.<a name='259'></font>
<font color=#447700>!<a name='260'></font>
      IF(GFDL_SW)THEN<a name='261'>
        DO J=JTS,JTE<a name='262'>
        DO K=KTS,KTE<a name='263'>
          KFLIP=KTE+1-K<a name='264'>
          DO I=ITS,ITE<a name='265'>
            THRATENSW(I,K,J)=TENDS(I,KFLIP,J)/PI3D(I,K,J)<a name='266'>
<font color=#447700>!!!         THRATEN(I,K,J)=THRATEN(I,K,J)+THRATENSW(I,K,J)  !Added<a name='267'></font>
          ENDDO<a name='268'>
        ENDDO<a name='269'>
        ENDDO<a name='270'>
      ENDIF<a name='271'>
<a name='272'>
<font color=#447700>!<a name='273'></font>
<font color=#447700>!***  RESET ACCUMULATED CONVECTIVE CLOUD TOP/BOT AND CONVECTIVE PRECIP<a name='274'></font>
<font color=#447700>!***  FOR NEXT INTERVAL BETWEEN RADIATION CALLS<a name='275'></font>
<font color=#447700>!<a name='276'></font>
      DO J=JTS,JTE<a name='277'>
      DO I=ITS,ITE<a name='278'>
<font color=#447700>!!!!    HBOT(I,J)=KTE+1-HBOT(I,J)<a name='279'></font>
<font color=#447700>!!!!    HTOP(I,J)=KTE+1-HTOP(I,J)<a name='280'></font>
        HBOT(I,J)=REAL(KTE+1)<a name='281'>
        HTOP(I,J)=0.<a name='282'>
        CUPPT(I,J)=0.<a name='283'>
      ENDDO<a name='284'>
      ENDDO<a name='285'>
<font color=#447700>!<a name='286'></font>
  100 IF(GFDL_SW)THEN<a name='287'>
        DO J=JTS,JTE<a name='288'>
        DO K=KTS,KTE<a name='289'>
          KFLIP=KTE+1-K<a name='290'>
          DO I=ITS,ITE<a name='291'>
            THRATEN(I,K,J)=THRATEN(I,K,J)+THRATENSW(I,K,J)<a name='292'>
          ENDDO<a name='293'>
        ENDDO<a name='294'>
        ENDDO<a name='295'>
      ENDIF<a name='296'>
<font color=#447700>!<a name='297'></font>
  END SUBROUTINE ETARA<a name='298'>
<font color=#447700>!<a name='299'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='300'></font>
<A NAME='RADTN'><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADTN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='301'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>RADTN</font>(DT,T,Q,QCW,QICE,                                 &amp; <A href='../../call_to/RADTN.html' TARGET='index'>1</A>,<A href='../../call_from/RADTN.html' TARGET='index'>4</A><a name='302'>
     &amp;                 PFLIP,P8WFLIP,XLAND,TSK2D,                       &amp;<a name='303'>
     &amp;                 GLAT,GLON,HTOP,HBOT,ALB,CUPPT,                   &amp;<a name='304'>
<font color=#447700>!    &amp;                 RAD1,RAD2,RAD3,RAD4,                             &amp;<a name='305'></font>
<font color=#447700>!    &amp;                 TABLE1,TABLE2,TABLE3,EM1,EM1WDE,EM3,             &amp;<a name='306'></font>
     &amp;                 ACFRCV,NCFRCV,ACFRST,NCFRST,                     &amp;<a name='307'>
     &amp;                 VEGFRC,SNO,GLW,GSW,                              &amp; <a name='308'>
     &amp;                 RSWIN,RLWIN,                                     &amp; <font color=#447700>!Added<a name='309'></font>
<font color=#447700>!    &amp;                 IDAT,LTOP,IHRST,PRGFDL,                          &amp;<a name='310'></font>
     &amp;                 IDAT,IHRST,                                      &amp;<a name='311'>
     &amp;                 NRADS,NRADL,NPHS,NTSD,                           &amp;<a name='312'>
<font color=#447700>!    &amp;                 SKO3R,AB15WD,SKC1R,SKO2D,                        &amp;<a name='313'></font>
<font color=#447700>!#$  &amp;                 TENDS,TENDL,                                     &amp;<a name='314'></font>
     &amp;                 TENDS,TENDL,RSWTOA,RLWTOA,CZMEAN,                &amp;<a name='315'>
     &amp;                 CFRACL,CFRACM,CFRACH,                            &amp; <font color=#447700>!Added<a name='316'></font>
     &amp;                 ids,ide, jds,jde, kds,kde,                       &amp;<a name='317'>
     &amp;                 ims,ime, jms,jme, kms,kme,                       &amp;<a name='318'>
     &amp;                 its,ite, jts,jte, kts,kte                       )<a name='319'>
<font color=#447700>!-----------------------------------------------------------------------<a name='320'></font>
      IMPLICIT NONE<a name='321'>
<font color=#447700>!-----------------------------------------------------------------------<a name='322'></font>
<font color=#447700>! GLAT : geodetic latitude in radians of the mass points on the computational grid.<a name='323'></font>
<a name='324'>
<font color=#447700>! CZEN : instantaneous cosine of the solar zenith angle.<a name='325'></font>
<a name='326'>
<font color=#447700>! HTOP : (REAL) model layer number that is highest in the atmosphere<a name='327'></font>
<font color=#447700>!        in which convective cloud occurred since the previous call to the<a name='328'></font>
<font color=#447700>!        radiation driver.<a name='329'></font>
<a name='330'>
<font color=#447700>! HBOT : (REAL) model layer number that is lowest in the atmosphere<a name='331'></font>
<font color=#447700>!        in which convective cloud occurred since the previous call to the<a name='332'></font>
<font color=#447700>!        radiation driver.<a name='333'></font>
<a name='334'>
<font color=#447700>! ALB  : is no longer used in the operational radiation.  Prior to 24 July 2001<a name='335'></font>
<font color=#447700>!        ALB was the climatological albedo that was modified within RADTN to<a name='336'></font>
<font color=#447700>!        account for vegetation fraction and snow.<a name='337'></font>
<font color=#447700>!<a name='338'></font>
<font color=#447700>! ALB  : reintroduced as the dynamic albedo from LSM<a name='339'></font>
<a name='340'>
<font color=#447700>! CUPPT: accumulated convective precipitation (meters) since the<a name='341'></font>
<font color=#447700>!        last call to the radiation.<a name='342'></font>
<a name='343'>
<font color=#447700>! THS : potential temperature of the ground surface.<a name='344'></font>
<a name='345'>
<font color=#447700>! IHE and IHW are relative location indices needed to locate neighboring<a name='346'></font>
<font color=#447700>!       points on the Eta's Arakawa E grid since arrays are indexed locally on<a name='347'></font>
<font color=#447700>!       each MPI task rather than globally.  IHE refers to the adjacent grid<a name='348'></font>
<font color=#447700>!       point (a V point) to the east of the mass point being considered.  IHW<a name='349'></font>
<font color=#447700>!       is the adjacent grid point to the west of the given mass point.<a name='350'></font>
<a name='351'>
<font color=#447700>! IRAD is a relic from older code that is no longer needed.<a name='352'></font>
<a name='353'>
<font color=#447700>! ACFRCV : sum of the convective cloud fractions that were computed<a name='354'></font>
<font color=#447700>!          during each call to the radiation between calls to the subroutines that<a name='355'></font>
<font color=#447700>!          do the forecast output.<a name='356'></font>
<a name='357'>
<font color=#447700>! NCFRCV : the total number of times in which the convective cloud<a name='358'></font>
<font color=#447700>!          fraction was computed to be greater than zero in the radiation between<a name='359'></font>
<font color=#447700>!          calls to the output routines.  In the post-processor, ACFRCV is divided<a name='360'></font>
<font color=#447700>!          by NCFRCV to yield an average convective cloud fraction.<a name='361'></font>
<a name='362'>
<font color=#447700>!          ACFRST and NCFRST are the analogs for stratiform cloud cover.<a name='363'></font>
<a name='364'>
<font color=#447700>!          VEGFRC is the fraction of the gridbox with vegetation.<a name='365'></font>
<a name='366'>
<font color=#447700>!          LVL holds the number of model layers that lie below the ground surface<a name='367'></font>
<font color=#447700>!          at each point.  Clearly for sigma coordinates LVL is zero everywhere.<a name='368'></font>
<a name='369'>
<font color=#447700>! CTHK  :  an assumed maximum thickness of stratiform clouds currently set<a name='370'></font>
<font color=#447700>!          to 20000 Pascals.  I think this is relevant for computing "low",<a name='371'></font>
<font color=#447700>!          "middle", and "high" cloud fractions which are post-processed but which<a name='372'></font>
<font color=#447700>!          do not feed back into the integration.<a name='373'></font>
<a name='374'>
<font color=#447700>! IDAT  : a 3-element integer array holding the month, day, and year,<a name='375'></font>
<font color=#447700>!        respectively, of the date for the start time of the free forecast.<a name='376'></font>
<a name='377'>
<font color=#447700>! ABCFF : holds coefficients for various absorption bands.  You can see<a name='378'></font>
<font color=#447700>!         where they are set in GFDLRD.F.<a name='379'></font>
<a name='380'>
<font color=#447700>! LTOP  : a 3-element integer array holding the model layer that is at or<a name='381'></font>
<font color=#447700>!         immediately below the specified pressure levels for the tops <a name='382'></font>
<font color=#447700>!         of "high" (15000 Pa), "middle" (35000 Pa), and "low" (64200 Pa) <a name='383'></font>
<font color=#447700>!         stratiform clouds.  These are for the diagnostic cloud layers <a name='384'></font>
<font color=#447700>!         needed in the output but not in the integration.<a name='385'></font>
<a name='386'>
<font color=#447700>! R1     : earth-sun distance in astronomical units.<a name='387'></font>
<a name='388'>
<font color=#447700>! NRADS : integer number of fundamental timesteps (our smallest<a name='389'></font>
<font color=#447700>!         timestep, i.e., the one for inertial gravity wave adjustment) <a name='390'></font>
<font color=#447700>!         between updates of the shortwave tendencies.  Currently we <a name='391'></font>
<font color=#447700>!         update the shortwave every hour.<a name='392'></font>
<a name='393'>
<font color=#447700>! NRADL : integer number of fundamental timesteps between updates of<a name='394'></font>
<font color=#447700>!         the longwave tendencies.  Currently we update the longwave <a name='395'></font>
<font color=#447700>!         every two hours.<a name='396'></font>
<a name='397'>
<font color=#447700>! NTSD   : integer counter of the fundamental timesteps that have<a name='398'></font>
<font color=#447700>!         elapsed since the start of the forecast.<a name='399'></font>
<font color=#447700>!<a name='400'></font>
<font color=#447700>!**********************************************************************<a name='401'></font>
<font color=#447700>!****************************** NOTE **********************************<a name='402'></font>
<font color=#447700>!**********************************************************************<a name='403'></font>
<font color=#447700>!*** DUE TO THE RESETTING OF CONVECTIVE PRECIP AND CONVECTIVE CLOUD<a name='404'></font>
<font color=#447700>!*** TOPS AND BOTTOMS, SHORTWAVE MUST NOT BE CALLED LESS FREQUENTLY<a name='405'></font>
<font color=#447700>!*** THAN LONGWAVE.<a name='406'></font>
<font color=#447700>!**********************************************************************<a name='407'></font>
<font color=#447700>!****************************** NOTE **********************************<a name='408'></font>
<font color=#447700>!**********************************************************************<a name='409'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='410'></font>
<font color=#447700>!     INTEGER, PARAMETER         :: NL=81<a name='411'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,         &amp;<a name='412'>
     &amp;                              ims,ime, jms,jme, kms,kme ,         &amp;<a name='413'>
     &amp;                              its,ite, jts,jte, kts,kte<a name='414'>
      INTEGER, INTENT(IN)        :: NRADS,NRADL,NTSD,NPHS <a name='415'>
<font color=#447700>!     LOGICAL, INTENT(IN)        :: RESTRT<a name='416'></font>
      REAL   , INTENT(IN)        :: DT<a name='417'>
<font color=#447700>!     REAL   , INTENT(IN), DIMENSION(37,NL) :: XDUO3N,XDO3N2,XDO3N3,XDO3N4<a name='418'></font>
      INTEGER, INTENT(IN), DIMENSION(3) :: IDAT<a name='419'>
<font color=#447700>!-----------------------------------------------------------------------<a name='420'></font>
      REAL,    PARAMETER :: CAPA=R_D/CP,DTR=3.1415926/180.<a name='421'>
      INTEGER            :: LM1,LP1,LM<a name='422'>
      INTEGER, INTENT(IN)               :: IHRST<a name='423'>
<font color=#447700>!     REAL,    INTENT(IN), DIMENSION(NL)    :: PRGFDL<a name='424'></font>
<font color=#447700>!<a name='425'></font>
      REAL,    PARAMETER :: ALPHA0=100.,CLFRMIN=0.1,CUPRATE=24.*1000.,  &amp;<a name='426'>
     &amp;                      EPS=R_D/R_V,EPSO3=1.E-10,                   &amp;<a name='427'>
     &amp;                      EPSQ=1.E-12,EPSQ1=1.E-5,                    &amp;<a name='428'>
     &amp;                      GAMMA=0.49,H0=0.,H1=1.,H69=-6.9,HPINC=1.E1, &amp;<a name='429'>
     &amp;                      PBOT=10000.0,PEXP=0.25,                     &amp;<a name='430'>
     &amp;                      QCLDMIN=EPSQ,RLAG=14.8125,                  &amp;<a name='431'>
     &amp;                      STBOL=STBOLT,T_ICE=-10.<a name='432'>
<font color=#447700>!<a name='433'></font>
      INTEGER, PARAMETER :: NB=12,KSMUD=0<a name='434'>
      INTEGER,PARAMETER :: K15=SELECTED_REAL_KIND(15)<a name='435'>
      REAL (KIND=K15) :: DDX,EEX,PROD<a name='436'>
<font color=#447700>!     REAL, INTENT(IN) :: SKO3R,AB15WD,SKC1R,SKO2D<a name='437'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='438'></font>
      LOGICAL :: SHORT,LONG<a name='439'>
      LOGICAL :: BITX,BITY,BITZ,BITW,BIT1,BIT2,BITC,BITS,BITCP1,BITSP1<a name='440'>
      LOGICAL :: CNCLD,NEW_CLOUD<a name='441'>
<font color=#447700>!-----------------------------------------------------------------------<a name='442'></font>
      REAL, INTENT(IN), DIMENSION(ims:ime,jms:jme) :: XLAND,TSK2D<a name='443'>
      REAL, INTENT(IN), DIMENSION(its:ite, kms:kme, jts:jte):: Q,QCW,   &amp;<a name='444'>
     &amp;                                                         QICE,T<a name='445'>
      REAL, INTENT(IN), DIMENSION(its:ite, kms:kme, jts:jte):: PFLIP,   &amp;<a name='446'>
     &amp;                                                         P8WFLIP<a name='447'>
<a name='448'>
<font color=#447700>!     REAL, INTENT(IN), DIMENSION(28,180) :: TABLE1,TABLE2,TABLE3,EM3,EM1,EM1WDE<a name='449'></font>
      REAL, INTENT(OUT), DIMENSION(ims:ime, jms:jme):: GLW,GSW,CZMEAN   &amp;<a name='450'>
     &amp;                                                ,RSWIN,RLWIN      &amp; <font color=#447700>!Added<a name='451'></font>
     &amp;                                                ,CFRACL,CFRACM    &amp;<a name='452'>
     &amp;                                                ,CFRACH<a name='453'>
<a name='454'>
<font color=#447700>!     REAL,   INTENT(IN), DIMENSION(kms:kme)   :: ETAD<a name='455'></font>
<font color=#447700>!     REAL,   INTENT(IN), DIMENSION(kms:kme)   :: AETA<a name='456'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='457'></font>
      REAL,   INTENT(INOUT), DIMENSION(ims:ime,jms:jme)  :: HTOP,HBOT<a name='458'>
      REAL,   INTENT(IN   ), DIMENSION(ims:ime,jms:jme)  :: ALB,SNO<a name='459'>
      REAL,   INTENT(IN   ), DIMENSION(ims:ime,jms:jme)  :: GLAT,GLON<a name='460'>
<font color=#447700>!-----------------------------------------------------------------------<a name='461'></font>
      REAL,   DIMENSION(ims:ime,jms:jme)  :: CZEN<a name='462'>
<font color=#447700>!#$   REAL,   DIMENSION(its:ite,jts:jte)  :: CZMEAN,SIGT4<a name='463'></font>
      REAL,   DIMENSION(its:ite,jts:jte)  :: SIGT4<a name='464'>
       INTEGER, DIMENSION(its:ite, jts:jte):: LMH<a name='465'>
<font color=#447700>!-----------------------------------------------------------------------<a name='466'></font>
      REAL,   INTENT(INOUT), DIMENSION(ims:ime,jms:jme) :: CUPPT<a name='467'>
<font color=#447700>!     REAL,   DIMENSION(37*kte)          :: RAD1,RAD2,RAD3,RAD4<a name='468'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='469'></font>
<font color=#447700>!     INTEGER,INTENT(IN), DIMENSION(jms:jme) :: IHE,IHW<a name='470'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='471'></font>
      REAL,   INTENT(INOUT), DIMENSION(ims:ime,jms:jme) :: ACFRCV,ACFRST &amp;<a name='472'>
                                                          ,RSWTOA,RLWTOA<a name='473'>
      INTEGER,INTENT(INOUT), DIMENSION(ims:ime,jms:jme) :: NCFRCV,NCFRST<a name='474'>
<font color=#447700>!-----------------------------------------------------------------------<a name='475'></font>
<font color=#447700>!#$   REAL,   DIMENSION(its:ite,jts:jte) :: RLWIN,RLWOUT<a name='476'></font>
      REAL,   DIMENSION(its:ite,jts:jte) :: RLWOUT<a name='477'>
<font color=#447700>!-----------------------------------------------------------------------<a name='478'></font>
      REAL,   INTENT(IN),   DIMENSION(ims:ime,jms:jme) :: VEGFRC<a name='479'>
      REAL,   INTENT(INOUT),DIMENSION(its:ite,kts:kte,jts:jte) :: TENDL,&amp;<a name='480'>
     &amp;                                                            TENDS <a name='481'>
<font color=#447700>!#$   REAL,   DIMENSION(its:ite,jts:jte) :: RSWIN,RSWOUT,RSWTOA<a name='482'></font>
<font color=#447700>!#$   REAL,   DIMENSION(its:ite,jts:jte) :: RSWIN,RSWOUT<a name='483'></font>
      REAL,   DIMENSION(its:ite,jts:jte) :: RSWOUT<a name='484'>
      REAL,   DIMENSION(its:ite,kts:kte,jts:jte):: RSWTT,RLWTT<a name='485'>
<font color=#447700>!-----------------------------------------------------------------------<a name='486'></font>
      REAL :: CTHK(3)<a name='487'>
      DATA CTHK/20000.0,20000.0,20000.0/<a name='488'>
<a name='489'>
      REAL    :: PTOPC(4)<a name='490'>
      REAL,DIMENSION(10),SAVE :: CC,PPT<a name='491'>
<font color=#447700>!-----------------------------------------------------------------------<a name='492'></font>
      REAL,SAVE :: ABCFF(NB)<a name='493'>
      INTEGER,DIMENSION(its:ite,jts:jte) :: LVL<a name='494'>
      REAL,   DIMENSION(its:ite, jts:jte):: PDSL,FNE,FSE,TL<a name='495'>
      REAL,   DIMENSION(  0:kte)  :: CLDAMT<a name='496'>
      REAL,   DIMENSION(its:ite,3):: CLDCFR<a name='497'>
      INTEGER,   DIMENSION(its:ite,3):: MBOT,MTOP<a name='498'>
      REAL,   DIMENSION(its:ite)  :: PSFC,TSKN,ALBEDO,XLAT,COSZ,        &amp;<a name='499'>
     &amp;                               SLMSK,FLWUP,                       &amp;<a name='500'>
     &amp;                               FSWDN,FSWUP,FSWDNS,FSWUPS,FLWDNS,  &amp;<a name='501'>
     &amp;                               FLWUPS<a name='502'>
<a name='503'>
      REAL,   DIMENSION(its:ite,kts:kte) :: PMID,TMID<a name='504'>
      REAL,   DIMENSION(its:ite,kts:kte) :: QMID,THMID,OZN,POZN<a name='505'>
      REAL,   DIMENSION(its:ite,jts:jte) :: TOT <a name='506'>
<a name='507'>
      REAL,   DIMENSION(its:ite,kts:kte+1) :: PINT,EMIS,CAMT<a name='508'>
      INTEGER,DIMENSION(its:ite,kts:kte+1) :: KBTM,KTOP<a name='509'>
      INTEGER,DIMENSION(its:ite)   :: NCLDS,KCLD <a name='510'>
      REAL,   DIMENSION(its:ite)   :: TAUDAR<a name='511'>
      REAL,   DIMENSION(its:ite,NB,kts:kte+1) ::RRCL,TTCL<a name='512'>
<a name='513'>
      REAL,   DIMENSION(its:ite,kts:kte):: CSMID,CCMID,QWMID,QIMID<a name='514'>
      REAL,SAVE :: PLOMD,PMDHI,PHITP,P400,PLBTM<a name='515'>
      INTEGER,SAVE :: NFILE<a name='516'>
<a name='517'>
<font color=#447700>!-----------------------------------------------------------------------<a name='518'></font>
      REAL    :: CLSTP,TIME,DAYI,HOUR,ADDL,RANG,RSIN1,RCOS1,RCOS2<a name='519'>
      REAL    :: TIMES,EXNER,APES,SNOFAC,CCLIMIT,CLIMIT,P1,P2,CC1,CC2<a name='520'>
      REAL    :: PMOD,CLFR1,CTAU,WV,ARG,CLDMAX<a name='521'>
      REAL    :: CL1,CL2,CR1,DPCL,QSUM,PRS1,PRS2,DELP,TCLD,DD,EE,AA,FF<a name='522'>
      REAL    :: BB,GG,DENOM,FCTRA,FCTRB,PDSLIJ,CFRAVG,SNOMM<a name='523'>
      REAL    :: TAUC,THICK,CONVPRATE,CLFR,ESAT,QSAT,RHUM,QCLD,RHGRID<a name='524'>
      INTEGER :: I,J,MYJS,MYJE,MYIS,MYIE,NTSPH,NRADPP,ITIMSW,ITIMLW,    &amp;<a name='525'>
     &amp;           JD,II<a name='526'>
      INTEGER :: L,N,LML,LVLIJ,IR,KNTLYR,LL,NC,L400,NMOD,LTROP,IWKL<a name='527'>
      INTEGER :: LCNVB,LCNVT<a name='528'>
      INTEGER :: NLVL,MALVL,LLTOP,LLBOT,KBT2,KTH1,KBT1,KTH2,KTOP1,KFLIP<a name='529'>
      INTEGER :: NBAND,NCLD,LBASE,NKTP,NBTM,KS,MYJS1,MYJS2,MYJE2,MYJE1<a name='530'>
<a name='531'>
<font color=#447700>!     REAL,DIMENSION(5040):: T1,T2,T4,EM1V,EM1VW,EM3V<a name='532'></font>
<a name='533'>
<font color=#447700>!     EQUIVALENCE (EM1V(1),EM1(1,1)),(EM1VW(1),EM1WDE(1,1)) <a name='534'></font>
<font color=#447700>!     EQUIVALENCE (EM3V(1),EM3(1,1))<a name='535'></font>
<font color=#447700>!     EQUIVALENCE (T1(1),TABLE1(1,1)),(T2(1),TABLE2(1,1)), &amp;<a name='536'></font>
<font color=#447700>!                 (T4(1),TABLE3(1,1))<a name='537'></font>
<a name='538'>
      DATA    PLOMD/64200./,PMDHI/35000./,PHITP/15000./,P400/40000./,   &amp;<a name='539'>
              PLBTM/105000./<a name='540'>
      DATA    NFILE/14/<a name='541'>
      DATA    CC/0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0/<a name='542'>
      DATA    PPT/0.,.14,.31,.70,1.6,3.4,7.7,17.,38.,85./<a name='543'>
      DATA ABCFF/2*4.0E-5,.002,.035,.377,1.95,9.40,44.6,190.,989.,      &amp;<a name='544'>
     &amp;           2706.,39011./<a name='545'>
<a name='546'>
<font color=#447700>!-----------------------------------------------------------------------<a name='547'></font>
<font color=#447700>!***********************************************************************<a name='548'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='549'></font>
      MYJS=jts<a name='550'>
      MYJE=jte<a name='551'>
      MYIS=its<a name='552'>
      MYIE=ite<a name='553'>
      MYJS1=jts <font color=#447700>!????<a name='554'></font>
      MYJE1=jte<a name='555'>
      MYJS2=jts<a name='556'>
      MYJE2=jte<a name='557'>
      LM=kte<a name='558'>
      LM1=LM-1<a name='559'>
      LP1=LM+1<a name='560'>
      CNCLD=.TRUE.<a name='561'>
<font color=#447700>!<a name='562'></font>
      DO J=JTS,JTE<a name='563'>
      DO I=ITS,ITE<a name='564'>
        LMH(I,J)=KME-1<a name='565'>
        LVL(I,J)=0<a name='566'>
      ENDDO<a name='567'>
      ENDDO<a name='568'>
<font color=#447700>!***  <a name='569'></font>
<font color=#447700>!***  ASSIGN THE PRESSURES FOR CLOUD DOMAIN BOUNDARIES<a name='570'></font>
<font color=#447700>!***<a name='571'></font>
      PTOPC(1)=PLBTM<a name='572'>
      PTOPC(2)=PLOMD<a name='573'>
      PTOPC(3)=PMDHI<a name='574'>
      PTOPC(4)=PHITP<a name='575'>
<font color=#447700>!**********************************************************************<a name='576'></font>
<font color=#447700>!***  THE FOLLOWING CODE IS EXECUTED EACH TIME THE RADIATION IS CALLED.<a name='577'></font>
<font color=#447700>!**********************************************************************<a name='578'></font>
<font color=#447700>!----------------------CONVECTION--------------------------------------<a name='579'></font>
<font color=#447700>!  NRADPP IS THE NUMBER OF TIME STEPS TO ACCUMULATE CONVECTIVE PRECIP<a name='580'></font>
<font color=#447700>!     FOR RADIATION<a name='581'></font>
<font color=#447700>!   NOTE: THIS WILL NOT WORK IF NRADS AND NRADL ARE DIFFERENT UNLESS<a name='582'></font>
<font color=#447700>!         THEY ARE INTEGER MULTIPLES OF EACH OTHER<a name='583'></font>
<font color=#447700>!  CLSTP IS THE NUMBER OF HOURS OF THE ACCUMULATION PERIOD<a name='584'></font>
<font color=#447700>!<a name='585'></font>
      NTSPH=NINT(3600./DT)<a name='586'>
      NRADPP=MIN(NRADS,NRADL)<a name='587'>
      CLSTP=1.0*NRADPP/NTSPH<a name='588'>
      CONVPRATE=CUPRATE/CLSTP<a name='589'>
      RHGRID=RHGRD<a name='590'>
<font color=#447700>!----------------------CONVECTION--------------------------------------<a name='591'></font>
<font color=#447700>!***<a name='592'></font>
<font color=#447700>!***  STATE WHETHER THE SHORT OR LONGWAVE COMPUTATIONS ARE TO BE DONE.<a name='593'></font>
<font color=#447700>!***<a name='594'></font>
      SHORT=.TRUE. <a name='595'>
      LONG=.TRUE. <a name='596'>
      ITIMSW=0<a name='597'>
      ITIMLW=0<a name='598'>
      IF(SHORT)ITIMSW=1<a name='599'>
      IF(LONG) ITIMLW=1<a name='600'>
<font color=#447700>!***<a name='601'></font>
<font color=#447700>!***  FIND THE MEAN COSINE OF THE SOLAR ZENITH ANGLE <a name='602'></font>
<font color=#447700>!***  BETWEEN THE CURRENT TIME AND THE NEXT TIME RADIATION IS<a name='603'></font>
<font color=#447700>!***  CALLED.  ONLY AVERAGE IF THE SUN IS ABOVE THE HORIZON.<a name='604'></font>
<font color=#447700>!***<a name='605'></font>
      TIME=NTSD*DT<a name='606'>
<font color=#447700>!     CALL ZENITH(TIME,DAYI,HOUR)<a name='607'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='608'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#ZENITH'>ZENITH</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADTN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ZENITH_1">(TIME,DAYI,HOUR,IDAT,IHRST,GLON,GLAT,CZEN,             &amp;<a name='609'>
     &amp;            MYIS,MYIE,MYJS,MYJE,                                  &amp;<a name='610'>
     &amp;            ids,ide, jds,jde, kds,kde,                            &amp;<a name='611'>
     &amp;            ims,ime, jms,jme, kms,kme,                            &amp;<a name='612'>
     &amp;            its,ite, jts,jte, kts,kte                         )<a name='613'>
<font color=#447700>!-----------------------------------------------------------------------<a name='614'></font>
<a name='615'>
      JD=INT(DAYI+0.50)<a name='616'>
      ADDL=0.<a name='617'>
      IF(MOD(IDAT(3),4).EQ.0)ADDL=1.<a name='618'>
      RANG=PI2*(DAYI-RLAG)/(365.25+ADDL)<a name='619'>
      RSIN1=SIN(RANG)<a name='620'>
      RCOS1=COS(RANG)<a name='621'>
      RCOS2=COS(2.*RANG)<a name='622'>
<font color=#447700>!<a name='623'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='624'></font>
      IF(SHORT)THEN<a name='625'>
        DO J=MYJS,MYJE<a name='626'>
        DO I=MYIS,MYIE<a name='627'>
          CZMEAN(I,J)=0.<a name='628'>
          TOT(I,J)=0.<a name='629'>
        ENDDO<a name='630'>
        ENDDO<a name='631'>
<font color=#447700>!<a name='632'></font>
        DO II=0,NRADS,NPHS<a name='633'>
          TIMES=NTSD*DT+II*DT<a name='634'>
          CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#ZENITH'>ZENITH</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADTN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ZENITH_2">(TIMES,DAYI,HOUR,IDAT,IHRST,GLON,GLAT,CZEN,        &amp;<a name='635'>
     &amp;                MYIS,MYIE,MYJS,MYJE,                              &amp;<a name='636'>
     &amp;                ids,ide, jds,jde, kds,kde,                        &amp;<a name='637'>
     &amp;                ims,ime, jms,jme, kms,kme,                        &amp;<a name='638'>
     &amp;                its,ite, jts,jte, kts,kte                       )<a name='639'>
          DO J=MYJS,MYJE<a name='640'>
          DO I=MYIS,MYIE<a name='641'>
            IF(CZEN(I,J).GT.0.)THEN<a name='642'>
              CZMEAN(I,J)=CZMEAN(I,J)+CZEN(I,J)<a name='643'>
              TOT(I,J)=TOT(I,J)+1.<a name='644'>
            ENDIF<a name='645'>
          ENDDO<a name='646'>
          ENDDO<a name='647'>
        ENDDO<a name='648'>
        DO J=MYJS,MYJE<a name='649'>
        DO I=MYIS,MYIE<a name='650'>
          IF(TOT(I,J).GT.0.)CZMEAN(I,J)=CZMEAN(I,J)/TOT(I,J)<a name='651'>
        ENDDO<a name='652'>
        ENDDO<a name='653'>
<font color=#447700>!<a name='654'></font>
<font color=#447700>!***  MODIFY CZEN TO BE AT THE TOP OF THE HOUR.<a name='655'></font>
<font color=#447700>!<a name='656'></font>
<font color=#447700>!       TIMES=NTSD*DT<a name='657'></font>
<font color=#447700>!       CALL ZENITH(TIMES,DAYI,HOUR,IDAT,IHRST,GLON,GLAT,CZEN,          &amp;<a name='658'></font>
<font color=#447700>!    &amp;              MYIS,MYIE,MYJS,MYJE,                                &amp;<a name='659'></font>
<font color=#447700>!    &amp;              ids,ide, jds,jde, kds,kde,                          &amp;<a name='660'></font>
<font color=#447700>!    &amp;              ims,ime, jms,jme, kms,kme,                          &amp;<a name='661'></font>
<font color=#447700>!    &amp;              its,ite, jts,jte, kts,kte                         )<a name='662'></font>
      ENDIF<a name='663'>
<font color=#447700>!-----------------------------------------------------------------------<a name='664'></font>
<font color=#447700>!<a name='665'></font>
<font color=#447700>!***********************************************************************<a name='666'></font>
<font color=#447700>!***  THIS IS THE BEGINNING OF THE PRIMARY LOOP THROUGH THE DOMAIN<a name='667'></font>
<font color=#447700>!***********************************************************************<a name='668'></font>
<font color=#447700>!                        *********************<a name='669'></font>
                         DO 700 J = MYJS, MYJE<a name='670'>
<font color=#447700>!                        *********************<a name='671'></font>
<font color=#447700>!<a name='672'></font>
      DO 125 L=1,LM<a name='673'>
      DO I=MYIS,MYIE<a name='674'>
<font color=#447700>!       IR=IRAD(I)<a name='675'></font>
        TMID(I,L)=T(I,1,J)<a name='676'>
        QMID(I,L)=EPSQ<a name='677'>
        QWMID(I,L)=0.<a name='678'>
        QIMID(I,L)=0.<a name='679'>
        CSMID(I,L)=0.<a name='680'>
        CCMID(I,L)=0.<a name='681'>
        OZN(I,L)=EPSO3<a name='682'>
        TENDS(I,L,J)=0.<a name='683'>
        TENDL(I,L,J)=0.<a name='684'>
      ENDDO<a name='685'>
  125 CONTINUE<a name='686'>
<font color=#447700>!<a name='687'></font>
      DO 140 N=1,3<a name='688'>
      DO I=MYIS,MYIE<a name='689'>
        CLDCFR(I,N)=0.<a name='690'>
        MTOP(I,N)=0<a name='691'>
        MBOT(I,N)=0<a name='692'>
      ENDDO<a name='693'>
  140 CONTINUE<a name='694'>
<font color=#447700>!***<a name='695'></font>
<font color=#447700>!***  FILL IN WORKING ARRAYS WHERE VALUES AT L=LM ARE THOSE THAT<a name='696'></font>
<font color=#447700>!***  ARE ACTUALLY AT ETA LEVEL L=LMH.<a name='697'></font>
<font color=#447700>!***<a name='698'></font>
      DO 200 I=MYIS,MYIE<a name='699'>
<font color=#447700>!     IR=IRAD(I)<a name='700'></font>
      LML=LMH(I,J)<a name='701'>
      LVLIJ=LVL(I,J)<a name='702'>
<font color=#447700>!<a name='703'></font>
      DO L=1,LML<a name='704'>
        PMID(I,L+LVLIJ)=PFLIP(I,L,J)<a name='705'>
        PINT(I,L+LVLIJ+1)=P8WFLIP(I,L+1,J)<a name='706'>
        EXNER=(1.E5/PMID(I,L+LVLIJ))**CAPA<a name='707'>
        TMID(I,L+LVLIJ)=T(I,L,J)<a name='708'>
        THMID(I,L+LVLIJ)=T(I,L,J)*EXNER<a name='709'>
        QMID(I,L+LVLIJ)=Q(I,L,J)<a name='710'>
<font color=#447700>!--- Note that rain is ignored, only effects from cloud water and ice are considered<a name='711'></font>
        QWMID(I,L+LVLIJ)=QCW(I,L,J)<a name='712'>
        QIMID(I,L+LVLIJ)=QICE(I,L,J)<a name='713'>
      ENDDO<a name='714'>
<font color=#447700>!***<a name='715'></font>
<font color=#447700>!***  FILL IN ARTIFICIAL VALUES ABOVE THE TOP OF THE DOMAIN.<a name='716'></font>
<font color=#447700>!***  PRESSURE DEPTHS OF THESE LAYERS IS 1 HPA.<a name='717'></font>
<font color=#447700>!***  TEMPERATURES ABOVE ARE ALREADY ISOTHERMAL WITH (TRUE) LAYER 1.<a name='718'></font>
<font color=#447700>!***<a name='719'></font>
      IF(LVLIJ.GT.0)THEN<a name='720'>
        KNTLYR=0<a name='721'>
<font color=#447700>!<a name='722'></font>
        DO L=LVLIJ,1,-1<a name='723'>
          KNTLYR=KNTLYR+1<a name='724'>
          PMID(I,L)=P8WFLIP(I,1,J)-REAL(2*KNTLYR-1)*0.5*HPINC<a name='725'>
          PINT(I,L+1)=PMID(I,L)+0.5*HPINC<a name='726'>
          EXNER=(1.E5/PMID(I,L))**CAPA<a name='727'>
          THMID(I,L)=TMID(I,L)*EXNER<a name='728'>
        ENDDO<a name='729'>
      ENDIF<a name='730'>
<font color=#447700>!<a name='731'></font>
      IF(LVLIJ.EQ.0) THEN<a name='732'>
         PINT(I,1)=P8WFLIP(I,1,J)<a name='733'>
      ELSE<a name='734'>
         PINT(I,1)=PMID(I,1)-0.5*HPINC<a name='735'>
      ENDIF<a name='736'>
  200 CONTINUE<a name='737'>
<font color=#447700>!***<a name='738'></font>
<font color=#447700>!***  FILL IN THE SURFACE PRESSURE, SKIN TEMPERATURE, GEODETIC LATITUDE,<a name='739'></font>
<font color=#447700>!***  ZENITH ANGLE, SEA MASK, AND ALBEDO.  THE SKIN TEMPERATURE IS<a name='740'></font>
<font color=#447700>!***  NEGATIVE OVER WATER.<a name='741'></font>
<font color=#447700>!***<a name='742'></font>
      DO 250 I=MYIS,MYIE<a name='743'>
      PSFC(I)=P8WFLIP(I,KME,J)<a name='744'>
      APES=(PSFC(I)*1.E-5)**CAPA<a name='745'>
<font color=#447700>!     TSKN(I)=THS(I,J)*APES*(1.-2.*SM(I,J))<a name='746'></font>
      IF((XLAND(I,J)-1.5).GT.0.)THEN<a name='747'>
        TSKN(I)=-TSK2D(I,J)<a name='748'>
      ELSE<a name='749'>
        TSKN(I)=TSK2D(I,J)<a name='750'>
      ENDIF<a name='751'>
<a name='752'>
<font color=#447700>!     TSKN(I)=THS(I,J)*APES*(1.-2.*(XLAND(I,J)-1.))<a name='753'></font>
<font color=#447700>!     SLMSK(I)=SM(I,J)<a name='754'></font>
      SLMSK(I)=XLAND(I,J)-1.<a name='755'>
<font color=#447700>!<a name='756'></font>
<font color=#447700>!     SNO(I,J)=AMAX1(SNO(I,J),0.)<a name='757'></font>
      SNOMM=AMAX1(SNO(I,J),0.)<a name='758'>
      SNOFAC=AMIN1(SNOMM/0.02, 1.0)<a name='759'>
<font color=#447700>!!!!  ALBEDO(I)=ALB(I,J)+(1.0-0.01*VEGFRC(I,J))*SNOFAC*(SNOALB-ALB(I,J))<a name='760'></font>
      ALBEDO(I)=ALB(I,J)<a name='761'>
<font color=#447700>!<a name='762'></font>
      XLAT(I)=GLAT(I,J)/DTR<a name='763'>
      COSZ(I)=CZMEAN(I,J)<a name='764'>
  250 CONTINUE<a name='765'>
<font color=#447700>!-----------------------------------------------------------------------<a name='766'></font>
<font color=#447700>!---  COMPUTE GRID-SCALE CLOUD COVER FOR RADIATION<a name='767'></font>
<font color=#447700>!     (modified by Ferrier, Feb '02)<a name='768'></font>
<font color=#447700>!<a name='769'></font>
<font color=#447700>!---  Cloud fraction parameterization follows Randall, 1994<a name='770'></font>
<font color=#447700>!     (see Hong et al., 1998)<a name='771'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='772'></font>
<font color=#447700>!<a name='773'></font>
      DO I=MYIS,MYIE<a name='774'>
        LML=LMH(I,J)<a name='775'>
        LVLIJ=LVL(I,J)<a name='776'>
        DO L=1,LML<a name='777'>
          LL=L+LVLIJ<a name='778'>
<font color=#447700>!<a name='779'></font>
<font color=#447700>!--- Water vapor mixing ratio<a name='780'></font>
<font color=#447700>!<a name='781'></font>
          WV=QMID(I,LL)/(1.-QMID(I,LL))<a name='782'>
<font color=#447700>!<a name='783'></font>
<font color=#447700>!--- Saturation vapor pressure w/r/t water ( &gt;=0C ) or ice ( &lt;0C )<a name='784'></font>
<font color=#447700>!<a name='785'></font>
          ESAT=1000.*FPVS(TMID(I,LL))         <font color=#447700>!--- Saturation vapor pressure (Pa)<a name='786'></font>
          QSAT=EPS*ESAT/(PMID(I,LL)-ESAT)     <font color=#447700>!--- Saturation mixing ratio<a name='787'></font>
          RHUM=WV/QSAT                        <font color=#447700>!--- Relative humidity<a name='788'></font>
<font color=#447700>!<a name='789'></font>
<font color=#447700>!--- Total "cloud" mixing ratio, QCLD.  Rain is not part of cloud,<a name='790'></font>
<font color=#447700>!    only cloud water + cloud ice + snow<a name='791'></font>
<font color=#447700>!<a name='792'></font>
          QCLD=QWMID(I,LL)+QIMID(I,LL)<a name='793'>
<font color=#447700>!<a name='794'></font>
<font color=#447700>!--- Determine cloud fraction (modified from original algorithm)<a name='795'></font>
<font color=#447700>!<a name='796'></font>
          IF (QCLD .LT. QCLDMIN) THEN<a name='797'>
<font color=#447700>!<a name='798'></font>
<font color=#447700>!--- Assume zero cloud fraction if there is no cloud mixing ratio<a name='799'></font>
<font color=#447700>!<a name='800'></font>
            CLFR=H0<a name='801'>
          ELSEIF(RHUM.GE.RHGRID)THEN<a name='802'>
<font color=#447700>!<a name='803'></font>
<font color=#447700>!--- Assume cloud fraction of unity if near saturation and the cloud<a name='804'></font>
<font color=#447700>!    mixing ratio is at or above the minimum threshold<a name='805'></font>
<font color=#447700>!<a name='806'></font>
            CLFR=H1<a name='807'>
          ELSE<a name='808'>
<font color=#447700>!<a name='809'></font>
<font color=#447700>!--- Adaptation of original algorithm (Randall, 1994; Zhao, 1995)<a name='810'></font>
<font color=#447700>!    modified based on assumed grid-scale saturation at RH=RHgrid.<a name='811'></font>
<font color=#447700>!<a name='812'></font>
            DENOM=(RHGRID*QSAT-WV)**GAMMA<a name='813'>
            ARG=MAX(H69, -ALPHA0*QCLD/DENOM)    <font color=#447700>! &lt;-- EXP(-6.9)=.001<a name='814'></font>
            CLFR=(RHUM/RHGRID)**PEXP*(1.-EXP(ARG))<a name='815'>
<font color=#447700>!!              ARG=-1000*QCLD/(RHUM-RHGRID)<a name='816'></font>
<font color=#447700>!!              ARG=MAX(ARG, ARGMIN)<a name='817'></font>
<font color=#447700>!!              CLFR=(RHUM/RHGRID)*(1.-EXP(ARG))<a name='818'></font>
            IF (CLFR .LT. .01) CLFR=0.<a name='819'>
          ENDIF          <font color=#447700>!--- End IF (QCLD .LT. QCLDmin) ...<a name='820'></font>
          CSMID(I,LL)=MIN(H1,CLFR)<a name='821'>
        ENDDO            <font color=#447700>!--- End DO L ...<a name='822'></font>
      ENDDO                <font color=#447700>!--- End DO I ...<a name='823'></font>
<font color=#447700>!***********************************************************************<a name='824'></font>
<font color=#447700>!********************END OF STRATIFORM CLOUD SECTION********************<a name='825'></font>
<font color=#447700>!***********************************************************************<a name='826'></font>
<font color=#447700>!<a name='827'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='828'></font>
<font color=#447700>!---  COMPUTE CONVECTIVE CLOUD COVER FOR RADIATION<a name='829'></font>
<font color=#447700>!<a name='830'></font>
<font color=#447700>!--- The parameterization of Slingo (1987, QJRMS, Table 1, p. 904) is<a name='831'></font>
<font color=#447700>!    used for convective cloud fraction as a function of precipitation<a name='832'></font>
<font color=#447700>!    rate.  Cloud fractions have been increased by 20% for each rainrate<a name='833'></font>
<font color=#447700>!    interval so that shallow, nonprecipitating convection is ascribed a<a name='834'></font>
<font color=#447700>!    constant cloud fraction of 0.1  (Ferrier, Feb '02).<a name='835'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='836'></font>
<font color=#447700>!<a name='837'></font>
      IF (CNCLD) THEN<a name='838'>
        DO I=MYIS,MYIE<a name='839'>
<font color=#447700>!<a name='840'></font>
<font color=#447700>!***  CLOUD TOPS AND BOTTOMS COME FROM CUCNVC.<a name='841'></font>
<font color=#447700>!***  CONVECTIVE CLOUDS NEED TO BE AT LEAST 2 MODEL LAYERS THICK.<a name='842'></font>
<font color=#447700>!<a name='843'></font>
          IF (HBOT(I,J)-HTOP(I,J) .GT. 1.0) THEN<a name='844'>
<font color=#447700>!--- Compute convective cloud fractions if appropriate  (Ferrier, Feb '02)<a name='845'></font>
            CLFR=CC(1)<a name='846'>
            PMOD=CUPPT(I,J)*CONVPRATE<a name='847'>
            IF (PMOD .GT. PPT(1)) THEN<a name='848'>
              DO NC=1,10<a name='849'>
                IF(PMOD.GT.PPT(NC)) NMOD=NC<a name='850'>
              ENDDO<a name='851'>
              IF (NMOD .GE. 10) THEN<a name='852'>
                CLFR=CC(10)<a name='853'>
              ELSE<a name='854'>
                CC1=CC(NMOD)<a name='855'>
                CC2=CC(NMOD+1)<a name='856'>
                P1=PPT(NMOD)<a name='857'>
                P2=PPT(NMOD+1)<a name='858'>
                CLFR=CC1+(CC2-CC1)*(PMOD-P1)/(P2-P1)<a name='859'>
              ENDIF      <font color=#447700>!--- End IF (NMOD .GE. 10) ...<a name='860'></font>
              CLFR=MIN(H1, CLFR)<a name='861'>
            ENDIF        <font color=#447700>!--- End IF (PMOD .GT. PPT(1)) ...<a name='862'></font>
<font color=#447700>!<a name='863'></font>
<font color=#447700>!***  ADD LVL TO BE CONSISTENT WITH OTHER WORKING ARRAYS<a name='864'></font>
<font color=#447700>!<a name='865'></font>
            LVLIJ=LVL(I,J)<a name='866'>
            LCNVT=NINT(HTOP(I,J))+LVLIJ<a name='867'>
            LCNVT=MIN(LM,LCNVT)<a name='868'>
            LCNVB=NINT(HBOT(I,J))+LVLIJ<a name='869'>
            LCNVB=MIN(LM,LCNVB)<a name='870'>
<font color=#447700>!<a name='871'></font>
            DO LL=LCNVT,LCNVB<a name='872'>
              CCMID(I,LL)=CLFR<a name='873'>
            ENDDO<a name='874'>
          ENDIF    <font color=#447700>!--- IF (HBOT(I,J)-HTOP(I,J) .GT. 1.0) ...<a name='875'></font>
        ENDDO      <font color=#447700>!--- End DO I loop<a name='876'></font>
      ENDIF        <font color=#447700>!--- End IF (CNCLD) ...<a name='877'></font>
<font color=#447700>!*********************************************************************<a name='878'></font>
<font color=#447700>!*****************END OF CONVECTIVE CLOUD SECTION*****************<a name='879'></font>
<font color=#447700>!*********************************************************************<a name='880'></font>
<font color=#447700>!***<a name='881'></font>
<font color=#447700>!***  DETERMINE THE FRACTIONAL CLOUD COVERAGE FOR HIGH, MID<a name='882'></font>
<font color=#447700>!***  AND LOW OF CLOUDS FROM THE CLOUD COVERAGE AT EACH LEVEL<a name='883'></font>
<font color=#447700>!***<a name='884'></font>
<font color=#447700>!***  NOTE: THIS IS FOR DIAGNOSTICS ONLY!!!<a name='885'></font>
<font color=#447700>!***<a name='886'></font>
<font color=#447700>!***<a name='887'></font>
       DO 500 I=MYIS,MYIE<a name='888'>
<font color=#447700>!!<a name='889'></font>
       DO L=0,LM<a name='890'>
         CLDAMT(L)=0.<a name='891'>
       ENDDO<a name='892'>
<font color=#447700>!!  <a name='893'></font>
<font color=#447700>!!***  NOW GOES LOW, MIDDLE, HIGH<a name='894'></font>
<font color=#447700>!!<a name='895'></font>
       DO 480 NLVL=1,3<a name='896'>
       CLDMAX=0.<a name='897'>
       MALVL=LM<a name='898'>
       LLTOP=LM+1-LTOP(NLVL)+LVL(I,J)<a name='899'>
<font color=#447700>!!***<a name='900'></font>
<font color=#447700>!!***  GO TO THE NEXT CLOUD LAYER IF THE TOP OF THE CLOUD-TYPE IN<a name='901'></font>
<font color=#447700>!!***  QUESTION IS BELOW GROUND OR IS IN THE LOWEST LAYER ABOVE GROUND.<a name='902'></font>
<font color=#447700>!!***<a name='903'></font>
       IF(LLTOP.GE.LM)GO TO 480<a name='904'>
<font color=#447700>!!<a name='905'></font>
       IF(NLVL.GT.1)THEN<a name='906'>
         LLBOT=LM+1-LTOP(NLVL-1)-1+LVL(I,J)<a name='907'>
         LLBOT=MIN(LLBOT,LM1)<a name='908'>
       ELSE<a name='909'>
         LLBOT=LM1<a name='910'>
       ENDIF<a name='911'>
<font color=#447700>!!<a name='912'></font>
       DO 435 L=LLTOP,LLBOT<a name='913'>
       CLDAMT(L)=AMAX1(CSMID(I,L),CCMID(I,L))<a name='914'>
       IF(CLDAMT(L).GT.CLDMAX)THEN<a name='915'>
         MALVL=L<a name='916'>
         CLDMAX=CLDAMT(L)<a name='917'>
       ENDIF<a name='918'>
   435 CONTINUE<a name='919'>
<font color=#447700>!!*********************************************************************<a name='920'></font>
<font color=#447700>!! NOW, CALCULATE THE TOTAL CLOUD FRACTION IN THIS PRESSURE DOMAIN<a name='921'></font>
<font color=#447700>!! USING THE METHOD DEVELOPED BY Y.H., K.A.C. AND A.K. (NOV., 1992).<a name='922'></font>
<font color=#447700>!! IN THIS METHOD, IT IS ASSUMED THAT SEPERATED CLOUD LAYERS ARE<a name='923'></font>
<font color=#447700>!! RADOMLY OVERLAPPED AND ADJACENT CLOUD LAYERS ARE MAXIMUM OVERLAPPED.<a name='924'></font>
<font color=#447700>!! VERTICAL LOCATION OF EACH TYPE OF CLOUD IS DETERMINED BY THE THICKEST<a name='925'></font>
<font color=#447700>!! CONTINUING CLOUD LAYERS IN THE DOMAIN.<a name='926'></font>
<font color=#447700>!!*********************************************************************<a name='927'></font>
       CL1=0.0<a name='928'>
       CL2=0.0<a name='929'>
       KBT1=LLBOT<a name='930'>
       KBT2=LLBOT<a name='931'>
       KTH1=0<a name='932'>
       KTH2=0<a name='933'>
<font color=#447700>!!<a name='934'></font>
       DO 450 LL=LLTOP,LLBOT<a name='935'>
       L=LLBOT-LL+LLTOP<a name='936'>
       BIT1=.FALSE.<a name='937'>
       CR1=CLDAMT(L)<a name='938'>
       BITX=(PINT(I,L).GE.PTOPC(NLVL+1)).AND.                           &amp;<a name='939'>
      &amp;     (PINT(I,L).LT.PTOPC(NLVL)).AND.                             &amp;<a name='940'>
      &amp;     (CLDAMT(L).GT.0.0)<a name='941'>
       BIT1=BIT1.OR.BITX<a name='942'>
       IF(.NOT.BIT1)GO TO 450<a name='943'>
<font color=#447700>!!***<a name='944'></font>
<font color=#447700>!!***  BITY=T: FIRST CLOUD LAYER; BITZ=T:CONSECUTIVE CLOUD LAYER<a name='945'></font>
<font color=#447700>!!***  NOTE:  WE ASSUME THAT THE THICKNESS OF EACH CLOUD LAYER IN THE<a name='946'></font>
<font color=#447700>!!***         DOMAIN IS LESS THAN 200 MB TO AVOID TOO MUCH COOLING OR<a name='947'></font>
<font color=#447700>!!***         HEATING. SO WE SET CTHK(NLVL)=200*E2. BUT THIS LIMIT MAY<a name='948'></font>
<font color=#447700>!!***         WORK WELL FOR CONVECTIVE CLOUDS. MODIFICATION MAY BE<a name='949'></font>
<font color=#447700>!!***         NEEDED IN THE FUTURE.<a name='950'></font>
<font color=#447700>!!***<a name='951'></font>
       BITY=BITX.AND.(KTH2.LE.0)<a name='952'>
       BITZ=BITX.AND.(KTH2.GT.0)<a name='953'>
<font color=#447700>!!<a name='954'></font>
       IF(BITY)THEN<a name='955'>
         KBT2=L<a name='956'>
         KTH2=1<a name='957'>
       ENDIF<a name='958'>
<font color=#447700>!!<a name='959'></font>
       IF(BITZ)THEN<a name='960'>
         KTOP1=KBT2-KTH2+1<a name='961'>
         DPCL=PMID(I,KBT2)-PMID(I,KTOP1)<a name='962'>
         IF(DPCL.LT.CTHK(NLVL))THEN<a name='963'>
           KTH2=KTH2+1<a name='964'>
         ELSE<a name='965'>
           KBT2=KBT2-1<a name='966'>
         ENDIF<a name='967'>
       ENDIF<a name='968'>
       IF(BITX)CL2=AMAX1(CL2,CR1)<a name='969'>
<font color=#447700>!!***<a name='970'></font>
<font color=#447700>!!*** AT THE DOMAIN BOUNDARY OR SEPARATED CLD LAYERS, RANDOM OVERLAP.<a name='971'></font>
<font color=#447700>!!*** CHOOSE THE THICKEST OR THE LARGEST FRACTION AMT AS THE CLD<a name='972'></font>
<font color=#447700>!!*** LAYER IN THAT DOMAIN.<a name='973'></font>
<font color=#447700>!!***<a name='974'></font>
       BIT2=.FALSE.<a name='975'>
       BITY=BITX.AND.(CLDAMT(L-1).LE.0.0.OR. &amp;<a name='976'>
            PINT(I,L-1).LT.PTOPC(NLVL+1))<a name='977'>
       BITZ=BITY.AND.CL1.GT.0.0<a name='978'>
       BITW=BITY.AND.CL1.LE.0.0<a name='979'>
       BIT2=BIT2.OR.BITY<a name='980'>
       IF(.NOT.BIT2)GO TO 450<a name='981'>
<font color=#447700>!!<a name='982'></font>
       IF(BITZ)THEN<a name='983'>
         KBT1=INT((CL1*KBT1+CL2*KBT2)/(CL1+CL2))<a name='984'>
         KTH1=INT((CL1*KTH1+CL2*KTH2)/(CL1+CL2))+1<a name='985'>
         CL1=CL1+CL2-CL1*CL2<a name='986'>
       ENDIF<a name='987'>
<font color=#447700>!!<a name='988'></font>
       IF(BITW)THEN<a name='989'>
         KBT1=KBT2<a name='990'>
         KTH1=KTH2<a name='991'>
         CL1=CL2<a name='992'>
       ENDIF<a name='993'>
<font color=#447700>!!<a name='994'></font>
       IF(BITY)THEN<a name='995'>
         KBT2=LLBOT<a name='996'>
         KTH2=0<a name='997'>
         CL2=0.0<a name='998'>
       ENDIF<a name='999'>
   450 CONTINUE<a name='1000'>
<font color=#447700>!<a name='1001'></font>
       CLDCFR(I,NLVL)=AMIN1(1.0,CL1)<a name='1002'>
       MTOP(I,NLVL)=MIN(KBT1,KBT1-KTH1+1)<a name='1003'>
       MBOT(I,NLVL)=KBT1<a name='1004'>
   480 CONTINUE<a name='1005'>
   500 CONTINUE<a name='1006'>
<a name='1007'>
<font color=#447700>!***<a name='1008'></font>
<font color=#447700>!***  SET THE UN-NEEDED TAUDAR TO ONE<a name='1009'></font>
<font color=#447700>!***<a name='1010'></font>
      DO I=MYIS,MYIE<a name='1011'>
        TAUDAR(I)=1.0<a name='1012'>
      ENDDO<a name='1013'>
<font color=#447700>!----------------------------------------------------------------------<a name='1014'></font>
<font color=#447700>! NOW, CALCULATE THE CLOUD RADIATIVE PROPERTIES AFTER DAVIS (1982),<a name='1015'></font>
<font color=#447700>! HARSHVARDHAN ET AL (1987) AND Y.H., K.A.C. AND A.K. (1993).<a name='1016'></font>
<font color=#447700>! <a name='1017'></font>
<font color=#447700>! UPDATE: THE FOLLOWING PARTS ARE MODIFIED, AFTER Y.T.H. (1994), TO <a name='1018'></font>
<font color=#447700>!         CALCULATE THE RADIATIVE PROPERTIES OF CLOUDS ON EACH MODEL<a name='1019'></font>
<font color=#447700>!         LAYER. BOTH CONVECTIVE AND STRATIFORM CLOUDS ARE USED<a name='1020'></font>
<font color=#447700>!         IN THIS CALCULATIONS.<a name='1021'></font>
<font color=#447700>!<a name='1022'></font>
<font color=#447700>!                                     QINGYUN ZHAO   95-3-22<a name='1023'></font>
<font color=#447700>!<a name='1024'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1025'></font>
<font color=#447700>!<a name='1026'></font>
<font color=#447700>!***<a name='1027'></font>
<font color=#447700>!*** INITIALIZE ARRAYS FOR USES LATER<a name='1028'></font>
<font color=#447700>!***<a name='1029'></font>
<a name='1030'>
      DO 600 I=MYIS,MYIE<a name='1031'>
      LML=LMH(I,J)<a name='1032'>
      LVLIJ=LVL(I,J)<a name='1033'>
<font color=#447700>!<a name='1034'></font>
<font color=#447700>!***<a name='1035'></font>
<font color=#447700>!*** NOTE: LAYER=1 IS THE SURFACE, AND LAYER=2 IS THE FIRST CLOUD<a name='1036'></font>
<font color=#447700>!***       LAYER ABOVE THE SURFACE AND SO ON.<a name='1037'></font>
<font color=#447700>!***<a name='1038'></font>
      EMIS(I,1)=1.0<a name='1039'>
      KTOP(I,1)=LP1<a name='1040'>
      KBTM(I,1)=LP1<a name='1041'>
      CAMT(I,1)=1.0<a name='1042'>
      KCLD(I)=2<a name='1043'>
<font color=#447700>!<a name='1044'></font>
      DO NBAND=1,NB<a name='1045'>
        RRCL(I,NBAND,1)=0.0<a name='1046'>
        TTCL(I,NBAND,1)=1.0<a name='1047'>
      ENDDO<a name='1048'>
<font color=#447700>!<a name='1049'></font>
      DO 510 L=2,LP1<a name='1050'>
      CAMT(I,L)=0.0<a name='1051'>
      KTOP(I,L)=1<a name='1052'>
      KBTM(I,L)=1<a name='1053'>
      EMIS(I,L)=0.0<a name='1054'>
<font color=#447700>!<a name='1055'></font>
      DO NBAND=1,NB<a name='1056'>
        RRCL(I,NBAND,L)=0.0<a name='1057'>
        TTCL(I,NBAND,L)=1.0<a name='1058'>
      ENDDO<a name='1059'>
  510 CONTINUE<a name='1060'>
<font color=#447700>!***<a name='1061'></font>
<font color=#447700>!*** NOW CALCULATE THE AMOUNT, TOP, BOTTOM AND TYPE OF EACH CLOUD LAYER<a name='1062'></font>
<font color=#447700>!*** CLOUD TYPE=1: STRATIFORM CLOUD<a name='1063'></font>
<font color=#447700>!***       TYPE=2: CONVECTIVE CLOUD<a name='1064'></font>
<font color=#447700>!*** WHEN BOTH CONVECTIVE AND STRATIFORM CLOUDS EXIST AT THE SAME POINT,<a name='1065'></font>
<font color=#447700>!*** SELECT CONVECTIVE CLOUD WITH THE HIGHER CLOUD FRACTION.<a name='1066'></font>
<font color=#447700>!*** CLOUD LAYERS ARE SEPARATED BY TOTAL ABSENCE OF CLOUDINESS.<a name='1067'></font>
<font color=#447700>!*** NOTE: THERE IS ONLY ONE CONVECTIVE CLOUD LAYER IN ONE COLUMN.<a name='1068'></font>
<font color=#447700>!*** KTOP AND KBTM ARE THE TOP AND BOTTOM OF EACH CLOUD LAYER IN TERMS<a name='1069'></font>
<font color=#447700>!*** OF MODEL LEVEL.<a name='1070'></font>
<font color=#447700>!***<a name='1071'></font>
      NEW_CLOUD=.TRUE.<a name='1072'>
<font color=#447700>!<a name='1073'></font>
      DO L=2,LML<a name='1074'>
        LL=LML-L+1+LVLIJ                        <font color=#447700>!-- Model layer<a name='1075'></font>
        CLFR=MAX(CCMID(I,LL),CSMID(I,LL))       <font color=#447700>!-- Cloud fraction in layer<a name='1076'></font>
        CLFR1=MAX(CCMID(I,LL+1),CSMID(I,LL+1))  <font color=#447700>!-- Cloud fraction in lower layer<a name='1077'></font>
<font color=#447700>!-------------------<a name='1078'></font>
        IF (CLFR .GE. CLFRMIN) THEN<a name='1079'>
<font color=#447700>!--- Cloud present at level<a name='1080'></font>
          IF (NEW_CLOUD) THEN<a name='1081'>
<font color=#447700>!--- New cloud layer<a name='1082'></font>
            IF(L==2.AND.CLFR1&gt;=CLFRmin)THEN<a name='1083'>
              KBTM(I,KCLD(I))=LL+1<a name='1084'>
              CAMT(I,KCLD(I))=CLFR1<a name='1085'>
            ELSE<a name='1086'>
              KBTM(I,KCLD(I))=LL<a name='1087'>
              CAMT(I,KCLD(I))=CLFR<a name='1088'>
            ENDIF<a name='1089'>
            NEW_CLOUD=.FALSE.<a name='1090'>
          ELSE<a name='1091'>
<font color=#447700>!--- Existing cloud layer<a name='1092'></font>
            CAMT(I,KCLD(I))=AMAX1(CAMT(I,KCLD(I)), CLFR)<a name='1093'>
          ENDIF        <font color=#447700>! End IF (NEW_CLOUD .EQ. 0) ...<a name='1094'></font>
        ELSE IF (CLFR1 .GE. CLFRMIN) THEN<a name='1095'>
<font color=#447700>!--- Cloud is not present at level but did exist at lower level, then ...<a name='1096'></font>
          IF (L .EQ. 2) THEN<a name='1097'>
<font color=#447700>!--- For the case of ground fog<a name='1098'></font>
            KBTM(I,KCLD(I))=LL+1<a name='1099'>
            CAMT(I,KCLD(I))=CLFR1<a name='1100'>
          ENDIF<a name='1101'>
          KTOP(I,KCLD(I))=LL+1<a name='1102'>
          NEW_CLOUD=.TRUE.<a name='1103'>
          KCLD(I)=KCLD(I)+1<a name='1104'>
          CAMT(I,KCLD(I))=0.0<a name='1105'>
        ENDIF<a name='1106'>
<font color=#447700>!-------------------<a name='1107'></font>
      ENDDO      <font color=#447700>!--- End DO L loop<a name='1108'></font>
<font color=#447700>!***<a name='1109'></font>
<font color=#447700>!*** THE REAL NUMBER OF CLOUD LAYERS IS (THE FIRST IS THE GROUND;<a name='1110'></font>
<font color=#447700>!*** THE LAST IS THE SKY):<a name='1111'></font>
<font color=#447700>!***<a name='1112'></font>
      NCLDS(I)=KCLD(I)-2<a name='1113'>
      NCLD=NCLDS(I)<a name='1114'>
<font color=#447700>!***<a name='1115'></font>
<font color=#447700>!***  NOW CALCULATE CLOUD RADIATIVE PROPERTIES<a name='1116'></font>
<font color=#447700>!***<a name='1117'></font>
      IF(NCLD.GE.1)THEN<a name='1118'>
<font color=#447700>!***<a name='1119'></font>
<font color=#447700>!*** NOTE: THE FOLLOWING CALCULATIONS, THE UNIT FOR PRESSURE IS MB!!!<a name='1120'></font>
<font color=#447700>!***<a name='1121'></font>
        DO 580 NC=2,NCLD+1<a name='1122'>
<font color=#447700>!<a name='1123'></font>
        TAUC=0.0   <font color=#447700>! Total optical depth for each cloud layer<a name='1124'></font>
        QSUM=0.0<a name='1125'>
        NKTP=LP1<a name='1126'>
        NBTM=0<a name='1127'>
        BITX=CAMT(I,NC).GE.CLFRMIN<a name='1128'>
        NKTP=MIN(NKTP,KTOP(I,NC))<a name='1129'>
        NBTM=MAX(NBTM,KBTM(I,NC))<a name='1130'>
<font color=#447700>!<a name='1131'></font>
        DO LL=NKTP,NBTM<a name='1132'>
          IF(LL.GE.KTOP(I,NC).AND.LL.LE.KBTM(I,NC).AND.BITX)THEN<a name='1133'>
            PRS1=PINT(I,LL)*0.01<a name='1134'>
            PRS2=PINT(I,LL+1)*0.01<a name='1135'>
            DELP=PRS2-PRS1<a name='1136'>
            TCLD=TMID(I,LL)-273.16<a name='1137'>
            QSUM=QSUM+QMID(I,LL)*DELP*(PRS1+PRS2)                       &amp;     <a name='1138'>
     &amp;           /(120.1612*SQRT(TMID(I,LL)))<a name='1139'>
<font color=#447700>!<a name='1140'></font>
<font color=#447700>!--- The simple optical depth parameterization from eq. (1) of Harshvardhan<a name='1141'></font>
<font color=#447700>!    et al. (1989, JAS, p. 1924; hereafter referred to as HRCD by authorship)<a name='1142'></font>
<font color=#447700>!    is used for convective cloud properties with some simple changes.<a name='1143'></font>
<font color=#447700>!<a name='1144'></font>
<font color=#447700>!--- The optical depth Tau is Tau=CTau*DELP, where values of CTau are<a name='1145'></font>
<font color=#447700>!    described below.<a name='1146'></font>
<font color=#447700>!<a name='1147'></font>
<font color=#447700>!--- For convection, assume simple optical depth coefficients of<a name='1148'></font>
<font color=#447700>!      1) CTau=0.16 for ice, assumed to be for T&lt;=T_ICE (=-10C in GSMCOLUMN)<a name='1149'></font>
<font color=#447700>!         This was referenced as "optically thick anvil associated with<a name='1150'></font>
<font color=#447700>!         convection in<a name='1151'></font>
<font color=#447700>!      2) CTau=0.08 for water, assumed to be present for T&gt;T_ICE<a name='1152'></font>
<font color=#447700>!<a name='1153'></font>
<font color=#447700>!--- For grid-scale processes in the absence of convection:<a name='1154'></font>
<font color=#447700>!      1) CTau=0.08*min(1., Qc/Q0) for cloud water, where<a name='1155'></font>
<font color=#447700>!         Q0 is assumed to be the threshold mixing ratio for "thick anvils",<a name='1156'></font>
<font color=#447700>!         as noted in the 2nd paragraph after eq. (1) in Harshvardhan et al.<a name='1157'></font>
<font color=#447700>!         (1989).  A value of Q0=0.1 g/kg is assumed based on experience w/<a name='1158'></font>
<font color=#447700>!         cloud observations, and it is intended only to be a crude scaling<a name='1159'></font>
<font color=#447700>!         factor for "order of magnitude" effects.  The functional dependence<a name='1160'></font>
<font color=#447700>!         on mixing ratio is based on Stephens (1978, JAS, p. 2124, eq. 7).<a name='1161'></font>
<font color=#447700>!      2) CTau=500*Qi for ice particles.  This is based on the optical depth<a name='1162'></font>
<font color=#447700>!         of snow.  Prof. Q. Fu (U. Washington) provided the following eq.:<a name='1163'></font>
<font color=#447700>!           Tau-1.5*SWP/(Res*RHOs)<a name='1164'></font>
<font color=#447700>!         SWP is snow water path, Res is the snow effective radius, RHOs is<a name='1165'></font>
<font color=#447700>!         the snow density.  Based on derivations using Petch (1998, JAS, 1846-<a name='1166'></font>
<font color=#447700>!         1858) as a starting point, Res=1.5*Ds with Ds being the mean diameter<a name='1167'></font>
<font color=#447700>!         of an exponential distribution of ice particles ("snow").  After some<a name='1168'></font>
<font color=#447700>!         manipulation,<a name='1169'></font>
<font color=#447700>!           Tau=CTau*DELP =&gt; CTau=CSTau*Qice, where<a name='1170'></font>
<font color=#447700>!         CSTau=100./(G*Ds*RHOs) ~ 500 based on values of Ds and RHOs in the<a name='1171'></font>
<font color=#447700>!         ice lookup tables (actually varies from 920 for Ds=.1 mm to ~520 for<a name='1172'></font>
<font color=#447700>!         Ds&gt;0.5 mm), and units of DELP in mb (must convert from Pascals).<a name='1173'></font>
<font color=#447700>!         "Snow" (precipitating ice) is assumed because of it dominates over<a name='1174'></font>
<font color=#447700>!         cloud ice in the scheme.<a name='1175'></font>
<font color=#447700>!<a name='1176'></font>
            CTAU=0.<a name='1177'>
            IF (CCMID(I,LL) .GE. CLFRMIN) THEN<a name='1178'>
<font color=#447700>!-- Crude convective cloud properties<a name='1179'></font>
              IF (TCLD .GT. T_ICE) THEN<a name='1180'>
                CTAU=0.08      <font color=#447700>!--- Cloud water<a name='1181'></font>
              ELSE<a name='1182'>
                CTAU=0.16      <font color=#447700>!--- Ice<a name='1183'></font>
              ENDIF<a name='1184'>
            ENDIF<a name='1185'>
<font color=#447700>!-- Crude grid-scale cloud properties<a name='1186'></font>
            IF (CSMID(I,LL) .GE. CLFRMIN)                               &amp;<a name='1187'>
     &amp;        CTAU=CTAU+800.*QWMID(I,LL)+500.*QIMID(I,LL)<a name='1188'>
            TAUC=TAUC+DELP*CTAU<a name='1189'>
          ENDIF      <font color=#447700>!--- End IF(LL.GE.KTOP(I,NC) ....<a name='1190'></font>
        ENDDO        <font color=#447700>!--- End DO LL<a name='1191'></font>
<font color=#447700>!<a name='1192'></font>
        IF(BITX)EMIS(I,NC)=1.0-EXP(-0.75*TAUC)<a name='1193'>
        IF(QSUM.GE.EPSQ1)THEN<a name='1194'>
<font color=#447700>!<a name='1195'></font>
          DO 570 NBAND=1,NB<a name='1196'>
          IF(BITX)THEN<a name='1197'>
            PROD=ABCFF(NBAND)*QSUM<a name='1198'>
            DDX=TAUC/(TAUC+PROD)<a name='1199'>
            EEX=1.0-DDX<a name='1200'>
            IF(ABS(EEX).GE.1.E-8)THEN<a name='1201'>
              DD=DDX<a name='1202'>
              EE=EEX<a name='1203'>
              FF=1.0-DD*0.85<a name='1204'>
              AA=MIN(50.0,SQRT(3.0*EE*FF)*TAUC)<a name='1205'>
              AA=EXP(-AA)<a name='1206'>
              BB=FF/EE<a name='1207'>
              GG=SQRT(BB)<a name='1208'>
              DD=(GG+1.0)*(GG+1.0)-(GG-1.0)*(GG-1.0)*AA*AA<a name='1209'>
              RRCL(I,NBAND,NC)=MAX(0.1E-5,(BB-1.0)*(1.0-AA*AA)/DD)<a name='1210'>
              TTCL(I,NBAND,NC)=AMAX1(0.1E-5,4.0*GG*AA/DD)<a name='1211'>
            ENDIF<a name='1212'>
          ENDIF<a name='1213'>
  570     CONTINUE<a name='1214'>
        ENDIF<a name='1215'>
  580   CONTINUE<a name='1216'>
<font color=#447700>!<a name='1217'></font>
      ENDIF<a name='1218'>
<font color=#447700>!<a name='1219'></font>
  600 CONTINUE<a name='1220'>
<font color=#447700>!*********************************************************************<a name='1221'></font>
<font color=#447700>!******************  COMPUTE OZONE AT MIDLAYERS  *********************<a name='1222'></font>
<font color=#447700>!*********************************************************************<a name='1223'></font>
<font color=#447700>!<a name='1224'></font>
<font color=#447700>!***  MODIFY PRESSURES SO THAT THE ENTIRE COLUMN OF OZONE (TO 0 MB)<a name='1225'></font>
<font color=#447700>!***  IS INCLUDED IN THE MODEL COLUMN EVEN WHEN PT &gt; 0 MB<a name='1226'></font>
<font color=#447700>!***<a name='1227'></font>
      DO L=1,LM<a name='1228'>
      DO I=MYIS,MYIE<a name='1229'>
        DENOM=1./(PINT(I,LP1)-PINT(I,1))<a name='1230'>
        FCTRA=PINT(I,LP1)*DENOM<a name='1231'>
        FCTRB=-PINT(I,1)*PINT(I,LP1)*DENOM<a name='1232'>
        POZN(I,L)=PMID(I,L)*FCTRA+FCTRB<a name='1233'>
      ENDDO<a name='1234'>
      ENDDO<a name='1235'>
<font color=#447700>!<a name='1236'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#OZON2D'>OZON2D</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADTN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="OZON2D_1">(LM,POZN,XLAT,RSIN1,RCOS1,RCOS2,OZN,              &amp;<a name='1237'>
<font color=#447700>!                 XDUO3N,XDO3N4,XDO3N2,XDO3N3,                     &amp;<a name='1238'></font>
<font color=#447700>!                 PRGFDL,MYIS,MYIE,                                &amp;<a name='1239'></font>
                  MYIS,MYIE,                                       &amp;<a name='1240'>
                  ids,ide, jds,jde, kds,kde,                       &amp;<a name='1241'>
                  ims,ime, jms,jme, kms,kme,                       &amp;<a name='1242'>
                  its,ite, jts,jte, kts,kte                        )<a name='1243'>
<font color=#447700>!<a name='1244'></font>
<font color=#447700>!***  <a name='1245'></font>
<font color=#447700>!***  NOW THE VARIABLES REQUIRED BY RADFS HAVE BEEN CALCULATED.<a name='1246'></font>
<font color=#447700>!***<a name='1247'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1248'></font>
<font color=#447700>!***<a name='1249'></font>
<font color=#447700>!***  CALL THE GFDL RADIATION DRIVER<a name='1250'></font>
<font color=#447700>!***<a name='1251'></font>
<font color=#447700>!***<a name='1252'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#RADFS'>RADFS</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADTN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RADFS_1"> &amp;<a name='1253'>
     &amp;     (PSFC,PMID,PINT,QMID,TMID,OZN,TSKN,SLMSK,ALBEDO,XLAT         &amp;<a name='1254'>
     &amp;,     CAMT,KTOP,KBTM,NCLDS,EMIS,RRCL,TTCL                         &amp;<a name='1255'>
     &amp;,     COSZ,TAUDAR,1                                               &amp;<a name='1256'>
     &amp;,     1,0                                                         &amp;<a name='1257'>
     &amp;,     ITIMSW,ITIMLW,JD,HOUR                                       &amp;<a name='1258'>
     &amp;,     TENDS(ITS,KTS,J),TENDL(ITS,KTS,J)                           &amp;<a name='1259'>
     &amp;,     FLWUP,FSWUP,FSWDN,FSWDNS,FSWUPS,FLWDNS,FLWUPS               &amp;<a name='1260'>
     &amp;,     ids,ide, jds,jde, kds,kde                                   &amp;<a name='1261'>
     &amp;,     ims,ime, jms,jme, kms,kme                                   &amp;<a name='1262'>
     &amp;,     its,ite, jts,jte, kts,kte                           )<a name='1263'>
<font color=#447700>!----------------------------------------------------------------------<a name='1264'></font>
      IF(LONG)THEN<a name='1265'>
        DO I=MYIS,MYIE<a name='1266'>
          GLW(I,J)=FLWDNS(I)<a name='1267'>
        ENDDO<a name='1268'>
      ENDIF<a name='1269'>
<font color=#447700>!<a name='1270'></font>
      IF(SHORT)THEN<a name='1271'>
        DO I=MYIS,MYIE<a name='1272'>
          GSW(I,J)=FSWDNS(I)-FSWUPS(I)<a name='1273'>
        ENDDO<a name='1274'>
      ENDIF<a name='1275'>
<font color=#447700>!<a name='1276'></font>
      DO 650 I=MYIS,MYIE<a name='1277'>
      CFRACL(I,J)=CLDCFR(I,1)<a name='1278'>
      CFRACM(I,J)=CLDCFR(I,2)<a name='1279'>
      CFRACH(I,J)=CLDCFR(I,3)<a name='1280'>
<font color=#447700>!     <a name='1281'></font>
<font color=#447700>!***  ARRAYS ACFRST AND ACFRCV ACCUMULATE AVERAGE STRATIFORM AND<a name='1282'></font>
<font color=#447700>!***  CONVECTIVE CLOUD FRACTIONS, RESPECTIVELY. <a name='1283'></font>
<font color=#447700>!***  ACCUMLATE THESE VARIABLES ONLY ONCE PER RADIATION CALL.<a name='1284'></font>
<font color=#447700>!<a name='1285'></font>
<font color=#447700>!***  ASSUME RANDOM OVERLAP BETWEEN LOW, MIDDLE, &amp; HIGH LAYERS.<a name='1286'></font>
<font color=#447700>!<a name='1287'></font>
      CFRAVG=1.-(1.-CFRACL(I,J))*(1.-CFRACM(I,J))*(1.-CFRACH(I,J))<a name='1288'>
<font color=#447700>!<a name='1289'></font>
      IF(CNCLD)THEN<a name='1290'>
        IF(HBOT(I,J)-HTOP(I,J).GT.1.)THEN<a name='1291'>
<font color=#447700>!--- Count locations with convective cloudiness<a name='1292'></font>
          ACFRST(I,J)=ACFRST(I,J)+CFRAVG<a name='1293'>
          NCFRST(I,J)=NCFRST(I,J)+1<a name='1294'>
        ENDIF<a name='1295'>
        BITS=.FALSE.<a name='1296'>
        DO LL=1,LM<a name='1297'>
          BITS=CSMID(I,LL).GE.CLFRMIN  <font color=#447700>!--- Existence of grid-scale cloud in layer<a name='1298'></font>
          IF(BITS)EXIT<a name='1299'>
        ENDDO<a name='1300'>
        IF(BITS)THEN<a name='1301'>
<font color=#447700>!--- Count locations with grid-scale cloudiness<a name='1302'></font>
          ACFRST(I,J)=ACFRST(I,J)+CFRAVG<a name='1303'>
          NCFRST(I,J)=NCFRST(I,J)+1<a name='1304'>
        ENDIF<a name='1305'>
      ELSE<a name='1306'>
<font color=#447700>!--- Count only locations with grid-scale cloudiness<a name='1307'></font>
        ACFRCV(I,J)=ACFRCV(I,J)+CFRAVG<a name='1308'>
        NCFRCV(I,J)=NCFRCV(I,J)+1<a name='1309'>
      ENDIF<a name='1310'>
  650 CONTINUE<a name='1311'>
<font color=#447700>!***<a name='1312'></font>
<font color=#447700>!***  COLLECT ATMOSPHERIC TEMPERATURE TENDENCIES DUE TO RADIATION.<a name='1313'></font>
<font color=#447700>!***  ALSO COLLECT THE TOTAL SW AND INCOMING LW RADIATION (W/M**2)<a name='1314'></font>
<font color=#447700>!***  AND CONVERT TO FORM NEEDED FOR PREDICTION OF THS IN SURFCE.<a name='1315'></font>
<font color=#447700>!***<a name='1316'></font>
      DO 660 I=MYIS,MYIE<a name='1317'>
      DO L=1,LM<a name='1318'>
        LL=LVL(I,J)+L<a name='1319'>
        IF(SHORT)RSWTT(I,L,J)=TENDS(I,LL,J)<a name='1320'>
        IF(LONG) RLWTT(I,L,J)=TENDL(I,LL,J)<a name='1321'>
        IF(LL.EQ.LM)GO TO 660<a name='1322'>
      ENDDO<a name='1323'>
  660 CONTINUE<a name='1324'>
<font color=#447700>!***<a name='1325'></font>
<font color=#447700>!***  SUM THE LW INCOMING AND SW RADIATION (W/M**2) FOR RADIN.<a name='1326'></font>
<font color=#447700>!***<a name='1327'></font>
      DO 675 I=MYIS,MYIE<a name='1328'>
      IF(LONG)THEN<a name='1329'>
        SIGT4(I,J)=STBOL*TMID(I,LM)*TMID(I,LM)* &amp;<a name='1330'>
                   TMID(I,LM)*TMID(I,LM)<a name='1331'>
      ENDIF<a name='1332'>
<font color=#447700>!     <a name='1333'></font>
<font color=#447700>!***  ACCUMULATE VARIOUS LW AND SW RADIATIVE FLUXES FOR POST<a name='1334'></font>
<font color=#447700>!***  PROCESSOR.  PASSED VIA COMMON ACMRDL AND ACMRDS.<a name='1335'></font>
<font color=#447700>!<a name='1336'></font>
      IF(LONG)THEN<a name='1337'>
        RLWIN(I,J) =FLWDNS(I)<a name='1338'>
        RLWOUT(I,J)=FLWUPS(I)<a name='1339'>
        RLWTOA(I,J)=FLWUP(I)<a name='1340'>
      ENDIF<a name='1341'>
      IF(SHORT)THEN<a name='1342'>
        RSWIN(I,J) =FSWDNS(I)<a name='1343'>
        RSWOUT(I,J)=FSWUPS(I)<a name='1344'>
        RSWTOA(I,J)=FSWUP(I)<a name='1345'>
      ENDIF<a name='1346'>
  675 CONTINUE<a name='1347'>
<font color=#447700>!***<a name='1348'></font>
<font color=#447700>!***  THIS ROW IS FINISHED. GO TO NEXT<a name='1349'></font>
<font color=#447700>!***<a name='1350'></font>
<font color=#447700>!                        *********************<a name='1351'></font>
  700                          CONTINUE<a name='1352'>
<font color=#447700>!                        *********************<a name='1353'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1354'></font>
<font color=#447700>!***<a name='1355'></font>
<font color=#447700>!***  CALLS TO RADIATION THIS TIME STEP ARE COMPLETE.<a name='1356'></font>
<font color=#447700>!***<a name='1357'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1358'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1359'></font>
<font color=#447700>!***<a name='1360'></font>
<font color=#447700>!***  HORIZONTAL SMOOTHING OF TEMPERATURE TENDENCIES<a name='1361'></font>
<font color=#447700>!***<a name='1362'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1363'></font>
      IF(SHORT) THEN<a name='1364'>
        DO 800 L=1,LM<a name='1365'>
<font color=#447700>!       CALL ZERO2(TL,  &amp;                  <a name='1366'></font>
<font color=#447700>!                  ids,ide, jds,jde, kds,kde,                         &amp;<a name='1367'></font>
<font color=#447700>!                  ims,ime, jms,jme, kms,kme,                         &amp;<a name='1368'></font>
<font color=#447700>!                  its,ite, jts,jte, kts,kte                          )<a name='1369'></font>
<font color=#447700>!       CALL ZERO2(FNE, &amp;<a name='1370'></font>
<font color=#447700>!                  ids,ide, jds,jde, kds,kde,                         &amp;<a name='1371'></font>
<font color=#447700>!                  ims,ime, jms,jme, kms,kme,                         &amp;<a name='1372'></font>
<font color=#447700>!                  its,ite, jts,jte, kts,kte                          )<a name='1373'></font>
<font color=#447700>!       CALL ZERO2(FSE, &amp;<a name='1374'></font>
<font color=#447700>!                  ids,ide, jds,jde, kds,kde,                         &amp;<a name='1375'></font>
<font color=#447700>!                  ims,ime, jms,jme, kms,kme,                         &amp;<a name='1376'></font>
<font color=#447700>!                  its,ite, jts,jte, kts,kte                          )<a name='1377'></font>
<font color=#447700>!<a name='1378'></font>
<font color=#447700>!        IF(KSMUD.GE.1)THEN<a name='1379'></font>
<font color=#447700>!          DO 750 KS=1,KSMUD<a name='1380'></font>
<font color=#447700>!!<a name='1381'></font>
<font color=#447700>!          DO J=MYJS,MYJE<a name='1382'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1383'></font>
<font color=#447700>!            TL(I,J)=RSWTT(I,L,J)<a name='1384'></font>
<font color=#447700>!!           TL(I,J)=RSWTT(I,L,J)*HTM(I,L,J)<a name='1385'></font>
<font color=#447700>!          ENDDO<a name='1386'></font>
<font color=#447700>!          ENDDO<a name='1387'></font>
<font color=#447700>!!<a name='1388'></font>
<font color=#447700>!          DO J=MYJS,MYJE<a name='1389'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1390'></font>
<font color=#447700>!            FNE(I,J)=(TL(I+IHE(J),J+1)-TL(I,J)) <a name='1391'></font>
<font color=#447700>!!                    *HTM(I,L,J)*HTM(I+IHE(J),J+1,L)<a name='1392'></font>
<font color=#447700>!          ENDDO<a name='1393'></font>
<font color=#447700>!          ENDDO<a name='1394'></font>
<font color=#447700>!!<a name='1395'></font>
<font color=#447700>!          DO J=MYJS1,MYJE<a name='1396'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1397'></font>
<font color=#447700>!            FSE(I,J)=(TL(I+IHE(J),J-1)-TL(I,J)) <a name='1398'></font>
<font color=#447700>!!                    *HTM(I+IHE(J),J-1,L)*HTM(I,L,J)<a name='1399'></font>
<font color=#447700>!          ENDDO<a name='1400'></font>
<font color=#447700>!          ENDDO<a name='1401'></font>
<font color=#447700>!!<a name='1402'></font>
<font color=#447700>!          DO J=MYJS2,MYJE2<a name='1403'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1404'></font>
<font color=#447700>!            TL(I,J)=(FNE(I,J)-FNE(I+IHW(J),J-1)  &amp;<a name='1405'></font>
<font color=#447700>!                    +FSE(I,J)-FSE(I+IHW(J),J+1)) &amp;<a name='1406'></font>
<font color=#447700>!                    *0.125+TL(I,J)<a name='1407'></font>
<font color=#447700>!!                   *HBM2(I,J)*0.125+TL(I,J)<a name='1408'></font>
<font color=#447700>!          ENDDO<a name='1409'></font>
<font color=#447700>!          ENDDO<a name='1410'></font>
<font color=#447700>!!<a name='1411'></font>
<font color=#447700>!          DO J=MYJS,MYJE<a name='1412'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1413'></font>
<font color=#447700>!            RSWTT(I,L,J)=TL(I,J)<a name='1414'></font>
<font color=#447700>!          ENDDO<a name='1415'></font>
<font color=#447700>!          ENDDO<a name='1416'></font>
<font color=#447700>!!<a name='1417'></font>
<font color=#447700>!  750     CONTINUE<a name='1418'></font>
<font color=#447700>!        ENDIF<a name='1419'></font>
<font color=#447700>!<a name='1420'></font>
  800   CONTINUE<a name='1421'>
      ENDIF<a name='1422'>
<font color=#447700>!----------------------------------------------------------------------<a name='1423'></font>
<font color=#447700>!<a name='1424'></font>
      IF(LONG)THEN<a name='1425'>
<font color=#447700>!<a name='1426'></font>
        DO 900 L=1,LM<a name='1427'>
<font color=#447700>!       CALL ZERO2(TL, &amp;<a name='1428'></font>
<font color=#447700>!                  ids,ide, jds,jde, kds,kde,                         &amp;<a name='1429'></font>
<font color=#447700>!                  ims,ime, jms,jme, kms,kme,                         &amp;<a name='1430'></font>
<font color=#447700>!                  its,ite, jts,jte, kts,kte                          )<a name='1431'></font>
<font color=#447700>!       CALL ZERO2(FNE, &amp;<a name='1432'></font>
<font color=#447700>!                  ids,ide, jds,jde, kds,kde,                         &amp;<a name='1433'></font>
<font color=#447700>!                  ims,ime, jms,jme, kms,kme,                         &amp;<a name='1434'></font>
<font color=#447700>!                  its,ite, jts,jte, kts,kte                          )<a name='1435'></font>
<font color=#447700>!       CALL ZERO2(FSE, &amp;<a name='1436'></font>
<font color=#447700>!                  ids,ide, jds,jde, kds,kde,                         &amp;<a name='1437'></font>
<font color=#447700>!                  ims,ime, jms,jme, kms,kme,                         &amp;<a name='1438'></font>
<font color=#447700>!                  its,ite, jts,jte, kts,kte                          )<a name='1439'></font>
<font color=#447700>!<a name='1440'></font>
<font color=#447700>!        IF(KSMUD.GE.1)THEN<a name='1441'></font>
<font color=#447700>!          DO 850 KS=1,KSMUD<a name='1442'></font>
<font color=#447700>!!<a name='1443'></font>
<font color=#447700>!          DO J=MYJS,MYJE<a name='1444'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1445'></font>
<font color=#447700>!            TL(I,J)=RLWTT(I,L,J)<a name='1446'></font>
<font color=#447700>!!           TL(I,J)=RLWTT(I,L,J)*HTM(I,L,J)<a name='1447'></font>
<font color=#447700>!          ENDDO<a name='1448'></font>
<font color=#447700>!          ENDDO<a name='1449'></font>
<font color=#447700>!!<a name='1450'></font>
<font color=#447700>!          DO J=MYJS,MYJE1<a name='1451'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1452'></font>
<font color=#447700>!            FNE(I,J)=(TL(I+IHE(J),J+1)-TL(I,J))  <a name='1453'></font>
<font color=#447700>!!                    *HTM(I,L,J)*HTM(I+IHE(J),J+1,L)<a name='1454'></font>
<font color=#447700>!          ENDDO<a name='1455'></font>
<font color=#447700>!          ENDDO<a name='1456'></font>
<font color=#447700>!!<a name='1457'></font>
<font color=#447700>!          DO J=MYJS1,MYJE<a name='1458'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1459'></font>
<font color=#447700>!            FSE(I,J)=(TL(I+IHE(J),J-1)-TL(I,J))  <a name='1460'></font>
<font color=#447700>!!                    *HTM(I+IHE(J),J-1,L)*HTM(I,L,J)<a name='1461'></font>
<font color=#447700>!          ENDDO<a name='1462'></font>
<font color=#447700>!          ENDDO<a name='1463'></font>
<font color=#447700>!!<a name='1464'></font>
<font color=#447700>!          DO J=MYJS2,MYJE2<a name='1465'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1466'></font>
<font color=#447700>!            TL(I,J)=(FNE(I,J)-FNE(I+IHW(J),J-1) &amp;<a name='1467'></font>
<font color=#447700>!                    +FSE(I,J)-FSE(I+IHW(J),J+1)) &amp;<a name='1468'></font>
<font color=#447700>!                    *0.125+TL(I,J)<a name='1469'></font>
<font color=#447700>!!                   *HBM2(I,J)*0.125+TL(I,J)<a name='1470'></font>
<font color=#447700>!          ENDDO<a name='1471'></font>
<font color=#447700>!          ENDDO<a name='1472'></font>
<font color=#447700>!!<a name='1473'></font>
<font color=#447700>!          DO J=MYJS,MYJE<a name='1474'></font>
<font color=#447700>!          DO I=MYIS,MYIE<a name='1475'></font>
<font color=#447700>!            RLWTT(I,L,J)=TL(I,J)<a name='1476'></font>
<font color=#447700>!          ENDDO<a name='1477'></font>
<font color=#447700>!          ENDDO<a name='1478'></font>
<font color=#447700>!!<a name='1479'></font>
<font color=#447700>!  850     CONTINUE<a name='1480'></font>
<font color=#447700>!        ENDIF<a name='1481'></font>
  900   CONTINUE<a name='1482'>
      ENDIF<a name='1483'>
<font color=#447700>!----------------------------------------------------------------------<a name='1484'></font>
<a name='1485'>
      END SUBROUTINE RADTN<a name='1486'>
<a name='1487'>
<font color=#447700>!----------------------------------------------------------------------<a name='1488'></font>
<a name='1489'>
<A NAME='ZENITH'><A href='../../html_code/phys/module_ra_gfdleta.F.html#ZENITH' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1490'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>ZENITH</font>(TIMES,DAYI,HOUR,IDAT,IHRST,GLON,GLAT,CZEN,     &amp; <A href='../../call_to/ZENITH.html' TARGET='index'>2</A><a name='1491'>
                        MYIS,MYIE,MYJS,MYJE,                           &amp;<a name='1492'>
                        IDS,IDE, JDS,JDE, KDS,KDE,                     &amp;<a name='1493'>
                        IMS,IME, JMS,JME, KMS,KME,                     &amp;<a name='1494'>
                        ITS,ITE, JTS,JTE, KTS,KTE)<a name='1495'>
<font color=#447700>!----------------------------------------------------------------------<a name='1496'></font>
      IMPLICIT NONE<a name='1497'>
<font color=#447700>!----------------------------------------------------------------------<a name='1498'></font>
      INTEGER, INTENT(IN)        :: IDS,IDE, JDS,JDE, KDS,KDE ,        &amp;<a name='1499'>
                                    IMS,IME, JMS,JME, KMS,KME ,        &amp;<a name='1500'>
                                    ITS,ITE, JTS,JTE, KTS,KTE<a name='1501'>
      INTEGER, INTENT(IN)        :: MYJS,MYJE,MYIS,MYIE<a name='1502'>
<a name='1503'>
      REAL,    INTENT(IN)        :: TIMES<a name='1504'>
      REAL,    INTENT(OUT)       :: HOUR,DAYI<a name='1505'>
      INTEGER, INTENT(IN)        :: IHRST<a name='1506'>
<a name='1507'>
      INTEGER, INTENT(IN), DIMENSION(3) :: IDAT <a name='1508'>
      REAL,    INTENT(IN), DIMENSION(IMS:IME,JMS:JME) :: GLAT,GLON<a name='1509'>
      REAL,    INTENT(OUT), DIMENSION(IMS:IME,JMS:JME) :: CZEN<a name='1510'>
<a name='1511'>
      REAL,    PARAMETER :: GSTC1=24110.54841,GSTC2=8640184.812866,    &amp;<a name='1512'>
                            GSTC3=9.3104E-2,GSTC4=-6.2E-6,             &amp;<a name='1513'>
                            PI=3.1415926,PI2=2.*PI,PIH=0.5*PI,         &amp;<a name='1514'>
<font color=#447700>!#$                         DEG2RD=1.745329E-2,OBLIQ=23.440*DEG2RD,    &amp;<a name='1515'></font>
                            DEG2RD=3.1415926/180.,OBLIQ=23.440*DEG2RD, &amp;<a name='1516'>
                            ZEROJD=2451545.0<a name='1517'>
<a name='1518'>
      REAL    :: DAY,YFCTR,ADDDAY,STARTYR,DATJUL,DIFJD,SLONM,   &amp;<a name='1519'>
                 ANOM,SLON,DEC,RA,DATJ0,TU,STIM0,SIDTIM,HRANG<a name='1520'>
      REAL    :: HRLCL,SINALT<a name='1521'>
      INTEGER :: KMNTH,KNT,IDIFYR,J,I<a name='1522'>
      LOGICAL :: LEAP<a name='1523'>
<font color=#447700>!-----------------------------------------------------------------------<a name='1524'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='1525'></font>
      INTEGER :: MONTH (12)<a name='1526'>
<font color=#447700>!-----------------------------------------------------------------------<a name='1527'></font>
      DATA MONTH/31,28,31,30,31,30,31,31,30,31,30,31/<a name='1528'>
<font color=#447700>!***********************************************************************<a name='1529'></font>
<font color=#447700>!     SAVE MONTH<a name='1530'></font>
      DAY=0.<a name='1531'>
      LEAP=.FALSE.<a name='1532'>
      IF(MOD(IDAT(3),4).EQ.0)THEN<a name='1533'>
        MONTH(2)=29<a name='1534'>
        LEAP=.TRUE.<a name='1535'>
      ENDIF<a name='1536'>
      IF(IDAT(1).GT.1)THEN<a name='1537'>
        KMNTH=IDAT(1)-1<a name='1538'>
        DO 10 KNT=1,KMNTH<a name='1539'>
        DAY=DAY+REAL(MONTH(KNT))<a name='1540'>
   10   CONTINUE<a name='1541'>
      ENDIF<a name='1542'>
<font color=#447700>!***<a name='1543'></font>
<font color=#447700>!***  CALCULATE EXACT NUMBER OF DAYS FROM BEGINNING OF YEAR TO<a name='1544'></font>
<font color=#447700>!***  FORECAST TIME OF INTEREST <a name='1545'></font>
<font color=#447700>!***<a name='1546'></font>
      DAY=DAY+REAL(IDAT(2)-1)+(REAL(IHRST)+TIMES/3600.)/24.<a name='1547'>
      DAYI=REAL(INT(DAY)+1)<a name='1548'>
      HOUR=(DAY-DAYI+1.)*24.<a name='1549'>
      YFCTR=2000.-IDAT(3)<a name='1550'>
<font color=#447700>!-----------------------------------------------------------------------<a name='1551'></font>
<font color=#447700>!***<a name='1552'></font>
<font color=#447700>!***  FIND CELESTIAL LONGITUDE OF THE SUN THEN THE SOLAR DECLINATION AND<a name='1553'></font>
<font color=#447700>!***  RIGHT ASCENSION.<a name='1554'></font>
<font color=#447700>!***<a name='1555'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='1556'></font>
      IDIFYR=IDAT(3)-2000<a name='1557'>
<font color=#447700>!***<a name='1558'></font>
<font color=#447700>!***  FIND JULIAN DATE OF START OF THE RELEVANT YEAR<a name='1559'></font>
<font color=#447700>!***  ADDING IN LEAP DAYS AS NEEDED<a name='1560'></font>
<font color=#447700>!***<a name='1561'></font>
      IF(IDIFYR.LT.0)THEN<a name='1562'>
        ADDDAY=REAL(IDIFYR/4)<a name='1563'>
      ELSE<a name='1564'>
        ADDDAY=REAL((IDIFYR+3)/4)<a name='1565'>
      ENDIF<a name='1566'>
      STARTYR=ZEROJD+IDIFYR*365.+ADDDAY-0.5<a name='1567'>
<font color=#447700>!***<a name='1568'></font>
<font color=#447700>!***  THE JULIAN DATE OF THE TIME IN QUESTION<a name='1569'></font>
<font color=#447700>!***<a name='1570'></font>
      DATJUL=STARTYR+DAY<a name='1571'>
<font color=#447700>!<a name='1572'></font>
<font color=#447700>!***  DIFFERENCE OF ACTUAL JULIAN DATE FROM JULIAN DATE<a name='1573'></font>
<font color=#447700>!***  AT 00H 1 January 2000<a name='1574'></font>
<font color=#447700>!<a name='1575'></font>
      DIFJD=DATJUL-ZEROJD<a name='1576'>
<font color=#447700>!<a name='1577'></font>
<font color=#447700>!***  MEAN GEOMETRIC LONGITUDE OF THE SUN<a name='1578'></font>
<font color=#447700>!<a name='1579'></font>
      SLONM=(280.460+0.9856474*DIFJD)*DEG2RD+YFCTR*PI2<a name='1580'>
<font color=#447700>!<a name='1581'></font>
<font color=#447700>!***  THE MEAN ANOMOLY<a name='1582'></font>
<font color=#447700>!<a name='1583'></font>
      ANOM=(357.528+0.9856003*DIFJD)*DEG2RD<a name='1584'>
<font color=#447700>!<a name='1585'></font>
<font color=#447700>!***  APPARENT GEOMETRIC LONGITUDE OF THE SUN<a name='1586'></font>
<font color=#447700>!<a name='1587'></font>
      SLON=SLONM+(1.915*SIN(ANOM)+0.020*SIN(2.*ANOM))*DEG2RD<a name='1588'>
      IF(SLON.GT.PI2)SLON=SLON-PI2<a name='1589'>
<font color=#447700>!<a name='1590'></font>
<font color=#447700>!***  DECLINATION AND RIGHT ASCENSION<a name='1591'></font>
<font color=#447700>! <a name='1592'></font>
      DEC=ASIN(SIN(SLON)*SIN(OBLIQ))<a name='1593'>
      RA=ACOS(COS(SLON)/COS(DEC))<a name='1594'>
      IF(SLON.GT.PI)RA=PI2-RA<a name='1595'>
<font color=#447700>!***<a name='1596'></font>
<font color=#447700>!***  FIND THE GREENWICH SIDEREAL TIME THEN THE LOCAL SOLAR<a name='1597'></font>
<font color=#447700>!***  HOUR ANGLE.<a name='1598'></font>
<font color=#447700>!***<a name='1599'></font>
      DATJ0=STARTYR+DAYI-1.<a name='1600'>
      TU=(DATJ0-2451545.)/36525.<a name='1601'>
      STIM0=GSTC1+GSTC2*TU+GSTC3*TU**2+GSTC4*TU**3<a name='1602'>
      SIDTIM=STIM0/3600.+YFCTR*24.+1.00273791*HOUR<a name='1603'>
      SIDTIM=SIDTIM*15.*DEG2RD<a name='1604'>
      IF(SIDTIM.LT.0.)SIDTIM=SIDTIM+PI2<a name='1605'>
      IF(SIDTIM.GT.PI2)SIDTIM=SIDTIM-PI2<a name='1606'>
      HRANG=SIDTIM-RA<a name='1607'>
<font color=#447700>!<a name='1608'></font>
      DO 100 J=MYJS,MYJE<a name='1609'>
      DO 100 I=MYIS,MYIE<a name='1610'>
<font color=#447700>!     HRLCL=HRANG-GLON(I,J)<a name='1611'></font>
      HRLCL=HRANG+GLON(I,J)+PI2<a name='1612'>
<font color=#447700>!***<a name='1613'></font>
<font color=#447700>!***  THE ZENITH ANGLE IS THE COMPLEMENT OF THE ALTITUDE THUS THE<a name='1614'></font>
<font color=#447700>!***  COSINE OF THE ZENITH ANGLE EQUALS THE SINE OF THE ALTITUDE.<a name='1615'></font>
<font color=#447700>!***<a name='1616'></font>
      SINALT=SIN(DEC)*SIN(GLAT(I,J))+COS(DEC)*COS(HRLCL)* &amp;<a name='1617'>
       COS(GLAT(I,J))<a name='1618'>
      IF(SINALT.LT.0.)SINALT=0.<a name='1619'>
      CZEN(I,J)=SINALT<a name='1620'>
  100 CONTINUE<a name='1621'>
<font color=#447700>!***<a name='1622'></font>
<font color=#447700>!***  IF THE FORECAST IS IN A DIFFERENT YEAR THAN THE START TIME,<a name='1623'></font>
<font color=#447700>!***  RESET DAYI TO THE PROPER DAY OF THE NEW YEAR (IT MUST NOT BE<a name='1624'></font>
<font color=#447700>!***  RESET BEFORE THE SOLAR ZENITH ANGLE IS COMPUTED).<a name='1625'></font>
<font color=#447700>!***<a name='1626'></font>
      IF(DAYI.GT.365.)THEN<a name='1627'>
        IF(.NOT.LEAP)THEN<a name='1628'>
          DAYI=DAYI-365.<a name='1629'>
        ELSEIF(LEAP.AND.DAYI.GT.366.)THEN<a name='1630'>
          DAYI=DAYI-366.<a name='1631'>
        ENDIF<a name='1632'>
      ENDIF<a name='1633'>
<font color=#447700>!<a name='1634'></font>
      END SUBROUTINE ZENITH<a name='1635'>
<font color=#447700>!-----------------------------------------------------------------------<a name='1636'></font>
<a name='1637'>
<A NAME='OZON2D'><A href='../../html_code/phys/module_ra_gfdleta.F.html#OZON2D' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1638'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>OZON2D</font> (LK,POZN,XLAT,RSIN1,RCOS1,RCOS2,QO3,              &amp; <A href='../../call_to/OZON2D.html' TARGET='index'>1</A><a name='1639'>
<font color=#447700>!                    XDUO3N,XDO3N4,XDO3N2,XDO3N3,                     &amp;<a name='1640'></font>
<font color=#447700>!                    PRGFDL,MYIS,MYIE,                                &amp;<a name='1641'></font>
                     MYIS,MYIE,                                       &amp;<a name='1642'>
                     ids,ide, jds,jde, kds,kde,                       &amp;<a name='1643'>
                     ims,ime, jms,jme, kms,kme,                       &amp;<a name='1644'>
                     its,ite, jts,jte, kts,kte                        )<a name='1645'>
<font color=#447700>!----------------------------------------------------------------------<a name='1646'></font>
 IMPLICIT NONE<a name='1647'>
<font color=#447700>!----------------------------------------------------------------------<a name='1648'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='1649'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='1650'>
                                    its,ite, jts,jte, kts,kte  <a name='1651'>
      INTEGER, INTENT(IN)        :: LK,MYIS,MYIE<a name='1652'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte) :: POZN<a name='1653'>
      REAL,    INTENT(IN), DIMENSION(its:ite)  :: XLAT<a name='1654'>
      REAL,    INTENT(INOUT), DIMENSION(its:ite,kts:kte) :: QO3<a name='1655'>
      REAL,    INTENT(IN)  :: RSIN1,RCOS1,RCOS2<a name='1656'>
<font color=#447700>!----------------------------------------------------------------------<a name='1657'></font>
      INTEGER, PARAMETER ::  NL=81,NLP1=NL+1,LNGTH=37*NL<a name='1658'>
      REAL, PARAMETER :: RTD=57.2957795<a name='1659'>
<a name='1660'>
<font color=#447700>!     REAL,    INTENT(IN),  DIMENSION(37,NL) :: XDUO3N,XDO3N4,XDO3N2,XDO3N3<a name='1661'></font>
<font color=#447700>!     REAL,    INTENT(IN), DIMENSION(NL)    :: PRGFDL<a name='1662'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1663'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1664'></font>
      INTEGER,DIMENSION(its:ite)    :: JJROW<a name='1665'>
      REAL,   DIMENSION(its:ite)    :: TTHAN<a name='1666'>
      REAL,   DIMENSION(its:ite,NL) :: QO3O3<a name='1667'>
<a name='1668'>
      INTEGER :: I,K,NUMITR,ILOG,IT,NHALF<a name='1669'>
      REAL    :: TH2,DO3V,DO3VP,APHI,APLO<a name='1670'>
<font color=#447700>!----------------------------------------------------------------------<a name='1671'></font>
      DO I=MYIS,MYIE<a name='1672'>
        TH2=0.2*XLAT(I)<a name='1673'>
        JJROW(I)=19.001-TH2<a name='1674'>
        TTHAN(I)=(19-JJROW(I))-TH2<a name='1675'>
      ENDDO<a name='1676'>
<font color=#447700>!<a name='1677'></font>
<font color=#447700>!***  SEASONAL AND SPATIAL INTERPOLATION DONE BELOW.<a name='1678'></font>
<font color=#447700>!<a name='1679'></font>
      DO K=1,NL<a name='1680'>
      DO I=MYIS,MYIE<a name='1681'>
        DO3V=XDUO3N(JJROW(I),K)+RSIN1*XDO3N2(JJROW(I),K)  &amp;<a name='1682'>
                   +RCOS1*XDO3N3(JJROW(I),K)  &amp;<a name='1683'>
                   +RCOS2*XDO3N4(JJROW(I),K)<a name='1684'>
        DO3VP=XDUO3N(JJROW(I)+1,K)+RSIN1*XDO3N2(JJROW(I)+1,K) &amp;<a name='1685'>
                    +RCOS1*XDO3N3(JJROW(I)+1,K) &amp;<a name='1686'>
                    +RCOS2*XDO3N4(JJROW(I)+1,K)<a name='1687'>
<font color=#447700>!<a name='1688'></font>
<font color=#447700>!***  NOW LATITUDINAL INTERPOLATION<a name='1689'></font>
<font color=#447700>!***  AND CONVERT O3 INTO MASS MIXING RATIO (ORIG DATA MPY BY 1.E4)<a name='1690'></font>
<font color=#447700>! <a name='1691'></font>
        QO3O3(I,K)=1.E-4*(DO3V+TTHAN(I)*(DO3VP-DO3V))<a name='1692'>
      ENDDO<a name='1693'>
      ENDDO<a name='1694'>
<font color=#447700>!***<a name='1695'></font>
<font color=#447700>!***  VERTICAL INTERPOLATION FOR EACH GRIDPOINT (LINEAR IN LN P)<a name='1696'></font>
<font color=#447700>!***<a name='1697'></font>
      NUMITR=0<a name='1698'>
      ILOG=NL<a name='1699'>
   20 CONTINUE<a name='1700'>
      ILOG=(ILOG+1)/2<a name='1701'>
        IF(ILOG.EQ.1)GO TO 25<a name='1702'>
        NUMITR=NUMITR+1<a name='1703'>
        GO TO 20<a name='1704'>
   25 CONTINUE<a name='1705'>
<font color=#447700>!<a name='1706'></font>
      DO 60 K=1,LK<a name='1707'>
<font color=#447700>!<a name='1708'></font>
      NHALF=(NL+1)/2<a name='1709'>
      DO I=MYIS,MYIE<a name='1710'>
        JJROW(I)=NHALF<a name='1711'>
      ENDDO<a name='1712'>
<font color=#447700>!<a name='1713'></font>
      DO 40 IT=1,NUMITR<a name='1714'>
      NHALF=(NHALF+1)/2<a name='1715'>
      DO I=MYIS,MYIE<a name='1716'>
        IF(POZN(I,K).LT.PRGFDL(JJROW(I)-1))THEN<a name='1717'>
          JJROW(I)=JJROW(I)-NHALF<a name='1718'>
        ELSEIF(POZN(I,K).GE.PRGFDL(JJROW(I)))THEN<a name='1719'>
          JJROW(I)=JJROW(I)+NHALF<a name='1720'>
        ENDIF<a name='1721'>
        JJROW(I)=MIN(JJROW(I),NL)<a name='1722'>
        JJROW(I)=MAX(JJROW(I),2)<a name='1723'>
      ENDDO<a name='1724'>
   40 CONTINUE<a name='1725'>
<font color=#447700>!<a name='1726'></font>
      DO 50 I=MYIS,MYIE<a name='1727'>
      IF(POZN(I,K).LT.PRGFDL(1))THEN<a name='1728'>
        QO3(I,K)=QO3O3(I,1)<a name='1729'>
      ELSE IF(POZN(I,K).GT.PRGFDL(NL))THEN<a name='1730'>
        QO3(I,K)=QO3O3(I,NL)<a name='1731'>
      ELSE<a name='1732'>
        APLO=ALOG(PRGFDL(JJROW(I)-1))<a name='1733'>
        APHI=ALOG(PRGFDL(JJROW(I)))<a name='1734'>
        QO3(I,K)=QO3O3(I,JJROW(I))+(ALOG(POZN(I,K))-APHI)/ &amp;<a name='1735'>
                   (APLO-APHI)* &amp;<a name='1736'>
                   (QO3O3(I,JJROW(I)-1)-QO3O3(I,JJROW(I)))<a name='1737'>
      ENDIF<a name='1738'>
   50 CONTINUE<a name='1739'>
<font color=#447700>!<a name='1740'></font>
   60 CONTINUE<a name='1741'>
<a name='1742'>
  END SUBROUTINE OZON2D<a name='1743'>
<font color=#447700>!-----------------------------------------------------------------------<a name='1744'></font>
<a name='1745'>
<font color=#447700>! SUBROUTINE ZERO2(ARRAY, &amp;<a name='1746'></font>
<font color=#447700>!                  ids,ide, jds,jde, kds,kde,                         &amp;<a name='1747'></font>
<font color=#447700>!                  ims,ime, jms,jme, kms,kme,                         &amp;<a name='1748'></font>
<font color=#447700>!                  its,ite, jts,jte, kts,kte                          )<a name='1749'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1750'></font>
<font color=#447700>!IMPLICIT NONE<a name='1751'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1752'></font>
<font color=#447700>!     INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='1753'></font>
<font color=#447700>!                                   ims,ime, jms,jme, kms,kme ,      &amp;<a name='1754'></font>
<font color=#447700>!                                   its,ite, jts,jte, kts,kte<a name='1755'></font>
<font color=#447700>!     REAL, INTENT(INOUT), DIMENSION(its:ite,jts:jte) :: ARRAY<a name='1756'></font>
<font color=#447700>!     INTEGER :: I,J<a name='1757'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='1758'></font>
<font color=#447700>!     DO J=jts,jte<a name='1759'></font>
<font color=#447700>!     DO I=its,ite<a name='1760'></font>
<font color=#447700>!       ARRAY(I,J)=0.<a name='1761'></font>
<font color=#447700>!     ENDDO<a name='1762'></font>
<font color=#447700>!     ENDDO<a name='1763'></font>
<a name='1764'>
<font color=#447700>! END SUBROUTINE ZERO2<a name='1765'></font>
<a name='1766'>
<font color=#447700>!----------------------------------------------------------------<a name='1767'></font>
<a name='1768'>
<A NAME='O3INT'><A href='../../html_code/phys/module_ra_gfdleta.F.html#O3INT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1769'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>O3INT</font>(PHALF,DDUO3N,DDO3N2,DDO3N3,DDO3N4, &amp; <A href='../../call_to/O3INT.html' TARGET='index'>1</A><a name='1770'>
                 ids,ide, jds,jde, kds,kde,            &amp;<a name='1771'>
                 ims,ime, jms,jme, kms,kme,            &amp;<a name='1772'>
                 its,ite, jts,jte, kts,kte             )<a name='1773'>
<font color=#447700>!----------------------------------------------------------------------<a name='1774'></font>
 IMPLICIT NONE<a name='1775'>
<font color=#447700>!----------------------------------------------------------------------<a name='1776'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='1777'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='1778'>
                                    its,ite, jts,jte, kts,kte<a name='1779'>
<a name='1780'>
<font color=#447700>!$$$  SUBPROGRAM DOCUMENTATION BLOCK<a name='1781'></font>
<font color=#447700>!                .      .    .                                       .<a name='1782'></font>
<font color=#447700>! SUBPROGRAM:    O3INT       COMPUTE ZONAL MEAN OZONE FOR ETA LYRS<a name='1783'></font>
<font color=#447700>!   PRGMMR: KENNETH CAMPANA  ORG: W/NMC23    DATE: 89-07-07<a name='1784'></font>
<font color=#447700>!           MICHAEL BALDWIN  ORG: W/NMC22    DATE: 92-06-08<a name='1785'></font>
<font color=#447700>!<a name='1786'></font>
<font color=#447700>! ABSTRACT: THIS CODE WRITTEN AT GFDL...<a name='1787'></font>
<font color=#447700>!   CALCULATES SEASONAL ZONAL MEAN OZONE,EVERY 5 DEG OF LATITUDE,<a name='1788'></font>
<font color=#447700>!   FOR CURRENT MODEL VERTICAL COORDINATE. OUTPUT DATA IN G/G * 1.E4<a name='1789'></font>
<font color=#447700>!   CODE IS CALLED ONLY ONCE.<a name='1790'></font>
<font color=#447700>!<a name='1791'></font>
<font color=#447700>! PROGRAM HISTORY LOG:<a name='1792'></font>
<font color=#447700>!   84-01-01  FELS AND SCHWARZKOPF,GFDL.<a name='1793'></font>
<font color=#447700>!   89-07-07  K. CAMPANA - ADAPTED STAND-ALONE CODE FOR IN-LINE USE.<a name='1794'></font>
<font color=#447700>!   92-06-08  M. BALDWIN - UPDATE TO RUN IN ETA MODEL<a name='1795'></font>
<font color=#447700>!<a name='1796'></font>
<font color=#447700>! USAGE:    CALL O3INT(O3,SIGL) OLD<a name='1797'></font>
<font color=#447700>!   INPUT ARGUMENT LIST:<a name='1798'></font>
<font color=#447700>!     PHALF    - MID LAYER PRESSURE (K=LM+1 IS MODEL SURFACE)<a name='1799'></font>
<font color=#447700>!   OUTPUT ARGUMENT LIST:<a name='1800'></font>
<font color=#447700>!     DDUO3N   - ZONAL MEAN OZONE DATA IN ALL MODEL LAYERS (G/G*1.E4)<a name='1801'></font>
<font color=#447700>!     DDO3N2     DIMENSIONED(L,N),WHERE L(=37) IS LATITUDE BETWEEN<a name='1802'></font>
<font color=#447700>!     DDO3N3     N AND S POLES,N=NUM OF VERTICAL LYRS(K=1 IS TOP LYR)<a name='1803'></font>
<font color=#447700>!     DDO3N4     AND SEASON-WIN,SPR,SUM,FALL.<a name='1804'></font>
<font color=#447700>!        IN COMMON<a name='1805'></font>
<font color=#447700>!<a name='1806'></font>
<font color=#447700>!   OUTPUT FILES:<a name='1807'></font>
<font color=#447700>!     OUTPUT   - PRINT FILE.<a name='1808'></font>
<font color=#447700>!<a name='1809'></font>
<font color=#447700>! ATTRIBUTES:<a name='1810'></font>
<font color=#447700>!   LANGUAGE: FORTRAN 200.<a name='1811'></font>
<font color=#447700>!<a name='1812'></font>
<font color=#447700>!$$$<a name='1813'></font>
<font color=#447700>!....     PROGRAM O3INT FROM DAN SCHWARZKOPF-GETS ZONAL MEAN O3<a name='1814'></font>
<font color=#447700>!..    OUTPUT O3 IS WINTER,SPRING,SUMMER,FALL (NORTHERN HEMISPHERE)<a name='1815'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='1816'></font>
<font color=#447700>!      INCLUDE "parmeta"<a name='1817'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='1818'></font>
<font color=#447700>!     *********************************************************<a name='1819'></font>
<a name='1820'>
      INTEGER :: N,NP,NP2,NM1<a name='1821'>
<a name='1822'>
<font color=#447700>!     PARAMETER (N=LM,NP=N+1,NP2=N+2,NM1=N-1)<a name='1823'></font>
<font color=#447700>!     *********************************************************<a name='1824'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='1825'></font>
<font color=#447700>!***<a name='1826'></font>
<font color=#447700>!***  SEASONAL CLIMATOLOGIES OF O3 (OBTAINED FROM A PREVIOUSLY RUN<a name='1827'></font>
<font color=#447700>!***  CODE WHICH INTERPOLATES O3 TO USER VERTICAL COORDINATE).<a name='1828'></font>
<font color=#447700>!***  DEFINED AS 5 DEG LAT MEANS N.P.-&gt;S.P.<a name='1829'></font>
<font color=#447700>!***<a name='1830'></font>
      REAL, INTENT(OUT), DIMENSION(37,kte):: DDUO3N,DDO3N2,DDO3N3,DDO3N4<a name='1831'>
<a name='1832'>
<font color=#447700>!                        C O M M O N /SAVMEM/<a name='1833'></font>
<font color=#447700>!       ...WINTER....  ...SPRING....  ...SUMMER....  ....FALL.....<a name='1834'></font>
<font color=#447700>!    1  DDUO3N(37,LM), DDO3N2(37,LM), DDO3N3(37,LM), DDO3N4(37,LM)<a name='1835'></font>
<font color=#447700>!          ..... K.CAMPANA   OCTOBER 1988<a name='1836'></font>
<font color=#447700>!CCC  DIMENSION T41(NP2,2),O3O3(37,N,4)<a name='1837'></font>
<font color=#447700>!     DIMENSION SIGL(N)<a name='1838'></font>
<font color=#447700>!     *********************************************************<a name='1839'></font>
      REAL ::   QI(82)<a name='1840'>
      REAL ::   DDUO3(19,kts:kte),RO31(10,41),RO32(10,41),DUO3N(19,41)<a name='1841'>
      REAL ::   TEMPN(19)<a name='1842'>
      REAL ::   O3HI(10,25),O3LO1(10,16),O3LO2(10,16),O3LO3(10,16), &amp;<a name='1843'>
                O3LO4(10,16)<a name='1844'>
      REAL ::   O3HI1(10,16),O3HI2(10,9),PH1(45),PH2(37),P1(48),P2(33)<a name='1845'>
      REAL ::   O35DEG(37,kts:kte)<a name='1846'>
      REAL ::   RSTD(81),RO3(10,41),RO3M(10,40),RBAR(kts:kte),RDATA(81), &amp;<a name='1847'>
                PHALF(kts:kte+1),P(81),PH(82)<a name='1848'>
<a name='1849'>
      INTEGER :: NKK,NK,NKP,K,L,NCASE,ITAPE,IPLACE,NKMM,NKM,KI,KK,KQ,JJ,KEN<a name='1850'>
      REAL :: O3RD,O3TOT,O3DU<a name='1851'>
<a name='1852'>
      EQUIVALENCE (O3HI1(1,1),O3HI(1,1)),(O3HI2(1,1),O3HI(1,17))<a name='1853'>
      EQUIVALENCE (PH1(1),PH(1)),(PH2(1),PH(46))<a name='1854'>
      EQUIVALENCE (P1(1),P(1)),(P2(1),P(49))<a name='1855'>
      DATA PH1/      0., &amp;<a name='1856'>
           0.1027246E-04, 0.1239831E-04, 0.1491845E-04, 0.1788053E-04, &amp;<a name='1857'>
           0.2135032E-04, 0.2540162E-04, 0.3011718E-04, 0.3558949E-04, &amp;<a name='1858'>
           0.4192172E-04, 0.4922875E-04, 0.5763817E-04, 0.6729146E-04, &amp;<a name='1859'>
           0.7834518E-04, 0.9097232E-04, 0.1053635E-03, 0.1217288E-03, &amp;<a name='1860'>
           0.1402989E-03, 0.1613270E-03, 0.1850904E-03, 0.2119495E-03, &amp;<a name='1861'>
           0.2423836E-03, 0.2768980E-03, 0.3160017E-03, 0.3602623E-03, &amp;<a name='1862'>
           0.4103126E-03, 0.4668569E-03, 0.5306792E-03, 0.6026516E-03, &amp;<a name='1863'>
           0.6839018E-03, 0.7759249E-03, 0.8803303E-03, 0.9987843E-03, &amp;<a name='1864'>
           0.1133178E-02, 0.1285955E-02, 0.1460360E-02, 0.1660001E-02, &amp;<a name='1865'>
           0.1888764E-02, 0.2151165E-02, 0.2452466E-02, 0.2798806E-02, &amp;<a name='1866'>
           0.3197345E-02, 0.3656456E-02, 0.4185934E-02, 0.4797257E-02/<a name='1867'>
      DATA PH2/ &amp;<a name='1868'>
           0.5503893E-02, 0.6321654E-02, 0.7269144E-02, 0.8368272E-02, &amp;<a name='1869'>
           0.9644873E-02, 0.1112946E-01, 0.1285810E-01, 0.1487354E-01, &amp;<a name='1870'>
           0.1722643E-01, 0.1997696E-01, 0.2319670E-01, 0.2697093E-01, &amp;<a name='1871'>
           0.3140135E-01, 0.3660952E-01, 0.4274090E-01, 0.4996992E-01, &amp;<a name='1872'>
           0.5848471E-01, 0.6847525E-01, 0.8017242E-01, 0.9386772E-01, &amp;<a name='1873'>
           0.1099026E+00, 0.1286765E+00, 0.1506574E+00, 0.1763932E+00, &amp;<a name='1874'>
           0.2065253E+00, 0.2415209E+00, 0.2814823E+00, 0.3266369E+00, &amp;<a name='1875'>
           0.3774861E+00, 0.4345638E+00, 0.4984375E+00, 0.5697097E+00, &amp;<a name='1876'>
           0.6490189E+00, 0.7370409E+00, 0.8344896E+00, 0.9421190E+00, &amp;<a name='1877'>
           0.1000000E+01/<a name='1878'>
      DATA P1/ &amp;<a name='1879'>
           0.9300000E-05, 0.1129521E-04, 0.1360915E-04, 0.1635370E-04, &amp;<a name='1880'>
           0.1954990E-04, 0.2331653E-04, 0.2767314E-04, 0.3277707E-04, &amp;<a name='1881'>
           0.3864321E-04, 0.4547839E-04, 0.5328839E-04, 0.6234301E-04, &amp;<a name='1882'>
           0.7263268E-04, 0.8450696E-04, 0.9793231E-04, 0.1133587E-03, &amp;<a name='1883'>
           0.1307170E-03, 0.1505832E-03, 0.1728373E-03, 0.1982122E-03, &amp;<a name='1884'>
           0.2266389E-03, 0.2592220E-03, 0.2957792E-03, 0.3376068E-03, &amp;<a name='1885'>
           0.3844381E-03, 0.4379281E-03, 0.4976965E-03, 0.5658476E-03, &amp;<a name='1886'>
           0.6418494E-03, 0.7287094E-03, 0.8261995E-03, 0.9380076E-03, &amp;<a name='1887'>
           0.1063498E-02, 0.1207423E-02, 0.1369594E-02, 0.1557141E-02, &amp;<a name='1888'>
           0.1769657E-02, 0.2015887E-02, 0.2295520E-02, 0.2620143E-02, &amp;<a name='1889'>
           0.2989651E-02, 0.3419469E-02, 0.3909867E-02, 0.4481491E-02, &amp;<a name='1890'>
           0.5135272E-02, 0.5898971E-02, 0.6774619E-02, 0.7799763E-02/<a name='1891'>
      DATA P2/ &amp;<a name='1892'>
           0.8978218E-02, 0.1036103E-01, 0.1195488E-01, 0.1382957E-01, &amp;<a name='1893'>
           0.1599631E-01, 0.1855114E-01, 0.2151235E-01, 0.2501293E-01, &amp;<a name='1894'>
           0.2908220E-01, 0.3390544E-01, 0.3952926E-01, 0.4621349E-01, &amp;<a name='1895'>
           0.5403168E-01, 0.6330472E-01, 0.7406807E-01, 0.8677983E-01, &amp;<a name='1896'>
           0.1015345E+00, 0.1189603E+00, 0.1391863E+00, 0.1630739E+00, &amp;<a name='1897'>
           0.1908004E+00, 0.2235461E+00, 0.2609410E+00, 0.3036404E+00, &amp;<a name='1898'>
           0.3513750E+00, 0.4055375E+00, 0.4656677E+00, 0.5335132E+00, &amp;<a name='1899'>
           0.6083618E+00, 0.6923932E+00, 0.7845676E+00, 0.8875882E+00, &amp;<a name='1900'>
           0.1000000E+01/<a name='1901'>
      DATA O3HI1/ &amp;<a name='1902'>
       .55,.50,.45,.45,.40,.35,.35,.30,.30,.30, &amp;<a name='1903'>
       .55,.51,.46,.47,.42,.38,.37,.36,.35,.35, &amp;<a name='1904'>
       .55,.53,.48,.49,.44,.42,.41,.40,.38,.38, &amp;<a name='1905'>
       .60,.55,.52,.52,.50,.47,.46,.44,.42,.41, &amp;<a name='1906'>
       .65,.60,.55,.56,.53,.52,.50,.48,.45,.45, &amp;<a name='1907'>
       .75,.65,.60,.60,.55,.55,.55,.50,.48,.47, &amp;<a name='1908'>
       .80,.75,.75,.75,.70,.70,.65,.63,.60,.60, &amp;<a name='1909'>
       .90,.85,.85,.80,.80,.75,.75,.74,.72,.71, &amp;<a name='1910'>
       1.10,1.05,1.00,.90,.90,.90,.85,.83,.80,.80, &amp;<a name='1911'>
       1.40,1.30,1.25,1.25,1.25,1.20,1.15,1.10,1.05,1.00, &amp;<a name='1912'>
       1.7,1.7,1.6,1.6,1.6,1.6,1.6,1.6,1.5,1.5, &amp;<a name='1913'>
       2.1,2.0,1.9,1.9,1.9,1.8,1.8,1.8,1.7,1.7, &amp;<a name='1914'>
       2.4,2.3,2.2,2.2,2.2,2.1,2.1,2.1,2.0,2.0, &amp;<a name='1915'>
       2.7,2.5,2.5,2.5,2.5,2.5,2.4,2.4,2.3,2.3, &amp;<a name='1916'>
       2.9,2.8,2.7,2.7,2.7,2.7,2.7,2.7,2.6,2.6, &amp;<a name='1917'>
       3.1,3.1,3.0,3.0,3.0,3.0,3.0,3.0,2.9,2.8/<a name='1918'>
      DATA O3HI2/ &amp;<a name='1919'>
       3.3,3.4,3.4,3.6,3.7,3.9,4.0,4.1,4.0,3.8, &amp;<a name='1920'>
       3.6,3.8,3.9,4.2,4.7,5.3,5.6,5.7,5.5,5.2, &amp;<a name='1921'>
       4.1,4.3,4.7,5.2,6.0,6.7,7.0,6.8,6.4,6.2, &amp;<a name='1922'>
       5.4,5.7,6.0,6.6,7.3,8.0,8.4,7.7,7.1,6.7, &amp;<a name='1923'>
       6.7,6.8,7.0,7.6,8.3,10.0,9.6,8.2,7.5,7.2, &amp;<a name='1924'>
       9.2,9.3,9.4,9.6,10.3,10.6,10.0,8.5,7.7,7.3, &amp;<a name='1925'>
       12.6,12.1,12.0,12.1,11.7,11.0,10.0,8.6,7.8,7.4, &amp;<a name='1926'>
       14.2,13.5,13.1,12.8,11.9,10.9,9.8,8.5,7.8,7.5, &amp;<a name='1927'>
       14.3,14.0,13.4,12.7,11.6,10.6,9.3,8.4,7.6,7.3/<a name='1928'>
      DATA O3LO1/ &amp;<a name='1929'>
       14.9,14.2,13.3,12.5,11.2,10.3,9.5,8.6,7.5,7.4, &amp;<a name='1930'>
       14.5,14.1,13.0,11.8,10.5,9.8,9.2,7.9,7.4,7.4, &amp;<a name='1931'>
       11.8,11.5,10.9,10.5,9.9,9.6,8.9,7.5,7.2,7.2, &amp;<a name='1932'>
       7.3,7.7,7.8,8.4,8.4,8.5,7.9,7.4,7.1,7.1, &amp;<a name='1933'>
       4.1,4.4,5.3,6.6,6.9,7.5,7.4,7.2,7.0,6.9, &amp;<a name='1934'>
       1.8,1.9,2.5,3.3,4.5,5.8,6.3,6.3,6.4,6.1, &amp;<a name='1935'>
       0.4,0.5,0.8,1.2,2.7,3.6,4.6,4.7,5.0,5.2, &amp;<a name='1936'>
       .10,.15,.20,.50,1.4,2.1,3.0,3.2,3.5,3.9, &amp;<a name='1937'>
       .07,.10,.12,.30,1.0,1.4,1.8,1.9,2.3,2.5, &amp;<a name='1938'>
       .06,.08,.10,.15,.60,.80,1.4,1.5,1.5,1.6, &amp;<a name='1939'>
       .05,.05,.06,.09,.20,.40,.70,.80,.90,.90, &amp;<a name='1940'>
       .05,.05,.06,.08,.10,.13,.20,.25,.30,.40, &amp;<a name='1941'>
       .05,.05,.05,.06,.07,.07,.08,.09,.10,.13, &amp;<a name='1942'>
       .05,.05,.05,.05,.06,.06,.06,.06,.07,.07, &amp;<a name='1943'>
       .05,.05,.05,.05,.05,.05,.05,.06,.06,.06, &amp;<a name='1944'>
       .04,.04,.04,.04,.04,.04,.04,.05,.05,.05/<a name='1945'>
      DATA O3LO2/ &amp;<a name='1946'>
       14.8,14.2,13.8,12.2,11.0,9.8,8.5,7.8,7.4,6.9, &amp;<a name='1947'>
       13.2,13.0,12.5,11.3,10.4,9.0,7.8,7.5,7.0,6.6, &amp;<a name='1948'>
       10.6,10.6,10.7,10.1,9.4,8.6,7.5,7.0,6.5,6.1, &amp;<a name='1949'>
       7.0,7.3,7.5,7.5,7.5,7.3,6.7,6.4,6.0,5.8, &amp;<a name='1950'>
       3.8,4.0,4.7,5.0,5.2,5.9,5.8,5.6,5.5,5.5, &amp;<a name='1951'>
       1.4,1.6,2.4,3.0,3.7,4.1,4.6,4.8,5.1,5.0, &amp;<a name='1952'>
       .40,.50,.90,1.2,2.0,2.7,3.2,3.6,4.3,4.1, &amp;<a name='1953'>
       .07,.10,.20,.30,.80,1.4,2.1,2.4,2.7,3.0, &amp;<a name='1954'>
       .06,.07,.09,.15,.30,.70,1.2,1.4,1.6,2.0, &amp;<a name='1955'>
       .05,.05,.06,.12,.15,.30,.60,.70,.80,.80, &amp;<a name='1956'>
       .04,.05,.06,.08,.09,.15,.30,.40,.40,.40, &amp;<a name='1957'>
       .04,.04,.05,.055,.06,.09,.12,.13,.15,.15, &amp;<a name='1958'>
       .03,.03,.045,.052,.055,.06,.07,.07,.06,.07, &amp;<a name='1959'>
       .03,.03,.04,.051,.052,.052,.06,.06,.05,.05, &amp;<a name='1960'>
       .02,.02,.03,.05,.05,.05,.04,.04,.04,.04, &amp;<a name='1961'>
       .02,.02,.02,.04,.04,.04,.03,.03,.03,.03/<a name='1962'>
      DATA O3LO3/ &amp;<a name='1963'>
       14.5,14.0,13.5,11.3,11.0,10.0,9.0,8.3,7.5,7.3, &amp;<a name='1964'>
       13.5,13.2,12.5,11.1,10.4,9.7,8.2,7.8,7.4,6.8, &amp;<a name='1965'>
       10.8,10.9,11.0,10.4,10.0,9.6,7.9,7.5,7.0,6.7, &amp;<a name='1966'>
       7.3,7.5,7.8,8.5,9.0,8.5,7.7,7.4,6.9,6.5, &amp;<a name='1967'>
       4.1,4.5,5.3,6.2,7.3,7.7,7.3,7.0,6.6,6.4, &amp;<a name='1968'>
       1.8,2.0,2.2,3.8,4.3,5.6,6.2,6.2,6.4,6.2, &amp;<a name='1969'>
       .30,.50,.60,1.5,2.8,3.7,4.5,4.7,5.5,5.6, &amp;<a name='1970'>
       .09,.10,.15,.60,1.2,2.1,3.0,3.5,4.0,4.3, &amp;<a name='1971'>
       .06,.08,.10,.30,.60,1.1,1.9,2.2,2.9,3.0, &amp;<a name='1972'>
       .04,.05,.06,.15,.45,.60,1.1,1.3,1.6,1.8, &amp;<a name='1973'>
       .04,.04,.04,.08,.20,.30,.55,.60,.75,.90, &amp;<a name='1974'>
       .04,.04,.04,.05,.06,.10,.12,.15,.20,.25, &amp;<a name='1975'>
       .04,.04,.03,.04,.05,.06,.07,.07,.07,.08, &amp;<a name='1976'>
       .03,.03,.04,.05,.05,.05,.05,.05,.05,.05, &amp;<a name='1977'>
       .03,.03,.03,.04,.04,.04,.05,.05,.04,.04, &amp;<a name='1978'>
       .02,.02,.02,.04,.04,.04,.04,.04,.03,.03/<a name='1979'>
      DATA O3LO4/ &amp;<a name='1980'>
       14.2,13.8,13.2,12.5,11.7,10.5,8.6,7.8,7.5,6.6, &amp;<a name='1981'>
       12.5,12.4,12.2,11.7,10.8,9.8,7.8,7.2,6.5,6.1, &amp;<a name='1982'>
       10.6,10.5,10.4,10.1,9.6,9.0,7.1,6.8,6.1,5.9, &amp;<a name='1983'>
       7.0,7.4,7.9,7.8,7.6,7.3,6.2,6.1,5.8,5.6, &amp;<a name='1984'>
       4.2,4.6,5.1,5.6,5.9,5.9,5.9,5.8,5.6,5.3, &amp;<a name='1985'>
       2.1,2.3,2.6,2.9,3.5,4.3,4.8,4.9,5.1,5.1, &amp;<a name='1986'>
       0.7,0.8,1.0,1.5,2.0,2.8,3.5,3.6,3.7,4.0, &amp;<a name='1987'>
       .15,.20,.40,.50,.60,1.4,2.1,2.2,2.3,2.5, &amp;<a name='1988'>
       .08,.10,.15,.25,.30,.90,1.2,1.3,1.4,1.6, &amp;<a name='1989'>
       .07,.08,.10,.14,.20,.50,.70,.90,.90,.80, &amp;<a name='1990'>
       .05,.06,.08,.12,.14,.20,.35,.40,.60,.50, &amp;<a name='1991'>
       .05,.05,.08,.09,.09,.09,.11,.12,.15,.18, &amp;<a name='1992'>
       .04,.05,.06,.07,.07,.08,.08,.08,.08,.08, &amp;<a name='1993'>
       .04,.04,.05,.07,.07,.07,.07,.07,.06,.05, &amp;<a name='1994'>
       .02,.02,.04,.05,.05,.05,.05,.05,.04,.04, &amp;<a name='1995'>
       .02,.02,.03,.04,.04,.04,.04,.04,.03,.03/<a name='1996'>
<a name='1997'>
<font color=#447700>!!!!!<a name='1998'></font>
<font color=#447700>!     PSS=101325.<a name='1999'></font>
<font color=#447700>!     PDIF=PSS-PT<a name='2000'></font>
<font color=#447700>!<a name='2001'></font>
<font color=#447700>!     DO L=1,LM1<a name='2002'></font>
<font color=#447700>!       PHALF(L+1)=AETA(L)*PDIF+PT<a name='2003'></font>
<font color=#447700>!     ENDDO<a name='2004'></font>
<font color=#447700>!<a name='2005'></font>
<font color=#447700>!     PHALF(1)=0.<a name='2006'></font>
<font color=#447700>!     PHALF(LP1)=PSS<a name='2007'></font>
<font color=#447700>!!!!<a name='2008'></font>
      N=kte;NP=N+1;NP2=N+2;NM1=N-1<a name='2009'>
<a name='2010'>
      NKK=41<a name='2011'>
      NK=81<a name='2012'>
      NKP=NK+1<a name='2013'>
      DO 24 K=1,NP<a name='2014'>
<font color=#447700>!  24 PHALF(K)=PHALF(K)*1.0E 03<a name='2015'></font>
   24 PHALF(K)=PHALF(K)*0.01*1.0E+03<a name='2016'>
<font color=#447700>!  24 PSTD(K)=PSTD(K+1)*1.0E 03<a name='2017'></font>
      DO 25 K=1,NK<a name='2018'>
      PH(K)=PH(K)*1013250.<a name='2019'>
   25 P(K)=P(K)*1013250.<a name='2020'>
      PH(NKP)=PH(NKP)*1013250.<a name='2021'>
<font color=#447700>!KAC  WRITE (6,3) PH<a name='2022'></font>
<font color=#447700>!KAC  WRITE (6,3) P<a name='2023'></font>
<font color=#447700>!     WRITE (6,3) (PHALF(K),K=1,NP)<a name='2024'></font>
<font color=#447700>!     WRITE (6,3) (PSTD(K),K=1,NP)<a name='2025'></font>
<font color=#447700>!***LOAD ARRAYS RO31,RO32,AS IN DICKS PGM.<a name='2026'></font>
      DO 1010 K=1,25<a name='2027'>
      DO 1010 L=1,10<a name='2028'>
        RO31(L,K)=O3HI(L,K)<a name='2029'>
        RO32(L,K)=O3HI(L,K)<a name='2030'>
1010  CONTINUE<a name='2031'>
<font color=#447700>!<a name='2032'></font>
      DO 3000 NCASE=1,4<a name='2033'>
      ITAPE=NCASE+50<a name='2034'>
      IPLACE=2<a name='2035'>
      IF (NCASE.EQ.2) IPLACE=4<a name='2036'>
      IF (NCASE.EQ.3) IPLACE=1<a name='2037'>
      IF (NCASE.EQ.4) IPLACE=3<a name='2038'>
<font color=#447700>!***NCASE=1: SPRING (IN N.H.)<a name='2039'></font>
<font color=#447700>!***NCASE=2: FALL   (IN N.H.)<a name='2040'></font>
<font color=#447700>!***NCASE=3: WINTER (IN N.H.)<a name='2041'></font>
<font color=#447700>!***NCASE=4: SUMMER (IN N.H.)<a name='2042'></font>
      IF (NCASE.EQ.1.OR.NCASE.EQ.2) THEN<a name='2043'>
         DO 1011 K=26,41<a name='2044'>
         DO 1011 L=1,10<a name='2045'>
           RO31(L,K)=O3LO1(L,K-25)<a name='2046'>
           RO32(L,K)=O3LO2(L,K-25)<a name='2047'>
1011     CONTINUE<a name='2048'>
      ENDIF<a name='2049'>
      IF (NCASE.EQ.3.OR.NCASE.EQ.4) THEN<a name='2050'>
         DO 1031 K=26,41<a name='2051'>
         DO 1031 L=1,10<a name='2052'>
           RO31(L,K)=O3LO3(L,K-25)<a name='2053'>
           RO32(L,K)=O3LO4(L,K-25)<a name='2054'>
1031     CONTINUE<a name='2055'>
      ENDIF<a name='2056'>
      DO 30 KK=1,NKK<a name='2057'>
      DO 31 L=1,10<a name='2058'>
      DUO3N(L,KK)=RO31(11-L,KK)<a name='2059'>
   31 DUO3N(L+9,KK)=RO32(L,KK)<a name='2060'>
      DUO3N(10,KK)=.5*(RO31(1,KK)+RO32(1,KK))<a name='2061'>
   30 CONTINUE<a name='2062'>
<font color=#447700>!***FOR NCASE=2 OR NCASE=4,REVERSE LATITUDE ARRANGEMENT OF CORR. SEASON<a name='2063'></font>
      IF (NCASE.EQ.2.OR.NCASE.EQ.4) THEN<a name='2064'>
         DO 1024 KK=1,NKK<a name='2065'>
         DO 1025 L=1,19<a name='2066'>
           TEMPN(L)=DUO3N(20-L,KK)<a name='2067'>
1025     CONTINUE<a name='2068'>
         DO 1026 L=1,19<a name='2069'>
           DUO3N(L,KK)=TEMPN(L)<a name='2070'>
1026     CONTINUE<a name='2071'>
1024     CONTINUE<a name='2072'>
      ENDIF<a name='2073'>
<font color=#447700>!***DUO3N NOW IS O3 PROFILE FOR APPROPRIATE SEASON,AT STD. PRESSURE<a name='2074'></font>
<font color=#447700>!      LEVELS<a name='2075'></font>
<font color=#447700>!KAC  WRITE (6,800) DUO3N<a name='2076'></font>
<font color=#447700>!***BEGIN LATITUDE (10 DEG) LOOP<a name='2077'></font>
      DO 33 L=1,19<a name='2078'>
      DO 22 KK=1,NKK<a name='2079'>
   22 RSTD(KK)=DUO3N(L,KK)<a name='2080'>
      NKM=NK-1<a name='2081'>
      NKMM=NK-3<a name='2082'>
<font color=#447700>!     BESSELS HALF-POINT INTERPOLATION FORMULA<a name='2083'></font>
      DO 60 K=4,NKMM,2<a name='2084'>
      KI=K/2<a name='2085'>
   60 RDATA(K)=.5*(RSTD(KI)+RSTD(KI+1))-(RSTD(KI+2)-RSTD(KI+1)-RSTD(KI)+ &amp;<a name='2086'>
      RSTD(KI-1))/16.<a name='2087'>
      RDATA(2)=.5*(RSTD(2)+RSTD(1))<a name='2088'>
      RDATA(NKM)=.5*(RSTD(NKK)+RSTD(NKK-1))<a name='2089'>
<font color=#447700>!     PUT UNCHANGED DATA INTO NEW ARRAY<a name='2090'></font>
      DO 61 K=1,NK,2<a name='2091'>
      KQ=(K+1)/2<a name='2092'>
   61 RDATA(K)=RSTD(KQ)<a name='2093'>
<font color=#447700>!---NOTE TO NMC: THIS WRITE IS COMMENTED OUT TO REDUCE PRINTOUT<a name='2094'></font>
<font color=#447700>!     WRITE (6,798) RDATA<a name='2095'></font>
<font color=#447700>!     CALCULATE LAYER-MEAN OZONE MIXING RATIO FOR EACH MODEL LEVEL<a name='2096'></font>
      DO 99 KK=1,N<a name='2097'>
      RBAR(KK)=0.<a name='2098'>
<font color=#447700>!     LOOP TO CALCULATE SUMS TO GET LAYER OZONE MEAN<a name='2099'></font>
      DO 98 K=1,NK<a name='2100'>
      IF(PH(K+1).LT.PHALF(KK)) GO TO 98<a name='2101'>
      IF(PH(K).GT.PHALF(KK+1)) GO TO 98<a name='2102'>
      IF(PH(K+1).LT.PHALF(KK+1).AND.PH(K).LT.PHALF(KK)) RBAR(KK)=RBAR(KK &amp;<a name='2103'>
      )+RDATA(K)*(PH(K+1)-PHALF(KK))<a name='2104'>
      IF(PH(K+1).LT.PHALF(KK+1).AND.PH(K).GE.PHALF(KK)) RBAR(KK)=RBAR(KK &amp;<a name='2105'>
      )+RDATA(K)*(PH(K+1)-PH(K))<a name='2106'>
      IF(PH(K+1).GT.PHALF(KK+1).AND.PH(K).GT.PHALF(KK)) RBAR(KK)=RBAR(KK &amp;<a name='2107'>
      )+RDATA(K)*(PHALF(KK+1)-PH(K))<a name='2108'>
   98 CONTINUE<a name='2109'>
      RBAR(KK)=RBAR(KK)/(PHALF(KK+1)-PHALF(KK))<a name='2110'>
      IF(RBAR(KK).GT..0000) GO TO 99<a name='2111'>
<font color=#447700>!     CODE TO COVER CASE WHEN MODEL RESOLUTION IS SO FINE THAT NO VALUE<a name='2112'></font>
<font color=#447700>!     OF P(K) IN THE OZONE DATA ARRAY FALLS BETWEEN PHALF(KK+1) AND<a name='2113'></font>
<font color=#447700>!     PHALF(KK).   PROCEDURE IS TO SIMPLY GRAB THE NEAREST VALUE FROM<a name='2114'></font>
<font color=#447700>!     RDATA<a name='2115'></font>
      DO 29 K=1,NK<a name='2116'>
      IF(PH(K).LT.PHALF(KK).AND.PH(K+1).GE.PHALF(KK+1)) RBAR(KK)=RDATA(K)<a name='2117'>
   29 CONTINUE<a name='2118'>
   99 CONTINUE<a name='2119'>
<font color=#447700>!     CALCULATE TOTAL OZONE<a name='2120'></font>
      O3RD=0.<a name='2121'>
      DO 89 KK=1,80<a name='2122'>
   89 O3RD=O3RD+RDATA(KK)*(PH(KK+1)-PH(KK))<a name='2123'>
      O3RD=O3RD+RDATA(81)*(P(81)-PH(81))<a name='2124'>
      O3RD=O3RD/980.<a name='2125'>
      O3TOT=0.<a name='2126'>
      DO 88 KK=1,N<a name='2127'>
   88 O3TOT=O3TOT+RBAR(KK)*(PHALF(KK+1)-PHALF(KK))<a name='2128'>
      O3TOT=O3TOT/980.<a name='2129'>
<font color=#447700>!     UNITS ARE MICROGRAMS/CM**2<a name='2130'></font>
      O3DU=O3TOT/2.144<a name='2131'>
<font color=#447700>!     O3DU UNITS ARE DOBSON UNITS (10**-3 ATM-CM)<a name='2132'></font>
<font color=#447700>!--NOTE TO NMC: THIS IS COMMENTED OUT TO SAVE PRINTOUT<a name='2133'></font>
<font color=#447700>!     WRITE (6,796) O3RD,O3TOT,O3DU<a name='2134'></font>
      DO 23 KK=1,N<a name='2135'>
   23 DDUO3(L,KK)=RBAR(KK)*.01<a name='2136'>
   33 CONTINUE<a name='2137'>
<font color=#447700>!***END OF LATITUDE LOOP<a name='2138'></font>
<font color=#447700>!<a name='2139'></font>
<font color=#447700>!***CREATE 5 DEG OZONE QUANTITIES BY LINEAR INTERPOLATION OF<a name='2140'></font>
<font color=#447700>!      10 DEG VALUES<a name='2141'></font>
      DO 1060 KK=1,N<a name='2142'>
        DO 1061 L=1,19<a name='2143'>
          O35DEG(2*L-1,KK)=DDUO3(L,KK)<a name='2144'>
1061    CONTINUE<a name='2145'>
        DO 1062 L=1,18<a name='2146'>
          O35DEG(2*L,KK)=0.5*(DDUO3(L,KK)+DDUO3(L+1,KK))<a name='2147'>
1062    CONTINUE<a name='2148'>
1060  CONTINUE<a name='2149'>
<font color=#447700>!***OUTPUT TO UNIT (ITAPE) THE OZONE VALUES FOR LATER USE<a name='2150'></font>
<font color=#447700>!O222  ***************************************************<a name='2151'></font>
<font color=#447700>!C          WRITE (66) O35DEG<a name='2152'></font>
      IF (IPLACE.EQ.1) THEN<a name='2153'>
      DO 302 JJ=1,37<a name='2154'>
       DO 302 KEN=1,N<a name='2155'>
        DDUO3N(JJ,KEN) = O35DEG(JJ,KEN)<a name='2156'>
  302 CONTINUE<a name='2157'>
      ELSE IF (IPLACE.EQ.2) THEN<a name='2158'>
      DO 312 JJ=1,37<a name='2159'>
       DO 312 KEN=1,N<a name='2160'>
        DDO3N2(JJ,KEN) = O35DEG(JJ,KEN)<a name='2161'>
  312 CONTINUE<a name='2162'>
      ELSE IF (IPLACE.EQ.3) THEN<a name='2163'>
      DO 322 JJ=1,37<a name='2164'>
       DO 322 KEN=1,N<a name='2165'>
        DDO3N3(JJ,KEN) = O35DEG(JJ,KEN)<a name='2166'>
  322 CONTINUE<a name='2167'>
      ELSE IF (IPLACE.EQ.4) THEN<a name='2168'>
      DO 332 JJ=1,37<a name='2169'>
       DO 332 KEN=1,N<a name='2170'>
        DDO3N4(JJ,KEN) = O35DEG(JJ,KEN)<a name='2171'>
  332 CONTINUE<a name='2172'>
      END IF<a name='2173'>
<font color=#447700>!O222  ***************************************************<a name='2174'></font>
3000  CONTINUE<a name='2175'>
<font color=#447700>!***END OF LOOP OVER CASES<a name='2176'></font>
      RETURN<a name='2177'>
   1  FORMAT(10F4.2)<a name='2178'>
    2 FORMAT(10X,E14.7,1X,E14.7,1X,E14.7,1X,E14.7,1X)<a name='2179'>
   3  FORMAT(10E12.5)<a name='2180'>
  797 FORMAT(10F7.2)<a name='2181'>
  799 FORMAT(19F6.4)<a name='2182'>
  800 FORMAT(19F6.2)<a name='2183'>
  102 FORMAT(' O3 IPLACE=',I4)<a name='2184'>
 1033 FORMAT(19F6.5)<a name='2185'>
  101 FORMAT(5X,1H*,F6.5,1H,,F6.5,1H,,F6.5,1H,,F6.5,1H,,F6.5,1H,,F6.5, &amp;<a name='2186'>
      1H,,F6.5,1H,,F6.5,1H,,F6.5,1H,)<a name='2187'>
      <a name='2188'>
      END SUBROUTINE O3INT<a name='2189'>
<font color=#447700>!----------------------------------------------------------------<a name='2190'></font>
<a name='2191'>
<A NAME='CLO89'><A href='../../html_code/phys/module_ra_gfdleta.F.html#CLO89' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2192'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>CLO89</font>(CLDFAC,CAMT,NCLDS,KBTM,KTOP                  &amp; <A href='../../call_to/CLO89.html' TARGET='index'>1</A><a name='2193'>
      ,          ids,ide, jds,jde, kds,kde                      &amp;<a name='2194'>
      ,          ims,ime, jms,jme, kms,kme                      &amp;<a name='2195'>
      ,          its,ite, jts,jte, kts,kte                      )<a name='2196'>
<font color=#447700>!----------------------------------------------------------------------<a name='2197'></font>
 IMPLICIT NONE<a name='2198'>
<font color=#447700>!----------------------------------------------------------------------<a name='2199'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='2200'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='2201'>
                                    its,ite, jts,jte, kts,kte<a name='2202'>
<font color=#447700>!----------------------------------------------------------------------<a name='2203'></font>
<a name='2204'>
<font color=#447700>!     ************************************************************<a name='2205'></font>
<font color=#447700>!     *                                                          *<a name='2206'></font>
<font color=#447700>!     * THIS SUBROUTINE WAS MODIFIED TO BE USED IN THE ETA MODEL *<a name='2207'></font>
<font color=#447700>!     *                                                          *<a name='2208'></font>
<font color=#447700>!     *                            Q. ZHAO    95-3-22            *<a name='2209'></font>
<font color=#447700>!     *                                                          *<a name='2210'></font>
<font color=#447700>!     ************************************************************<a name='2211'></font>
<a name='2212'>
      REAL,    INTENT(OUT),DIMENSION(its:ite,kts:kte+1,kts:kte+1) :: CLDFAC<a name='2213'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: CAMT<a name='2214'>
      INTEGER, INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: KBTM,KTOP<a name='2215'>
      INTEGER, INTENT(IN), DIMENSION(its:ite)           :: NCLDS<a name='2216'>
<a name='2217'>
      REAL,    DIMENSION(kts:kte+1,kts:kte+1,64) :: CLDIPT<a name='2218'>
      REAL,    DIMENSION(kts:kte+1) :: CLDROW<a name='2219'>
      INTEGER:: IQ,ITOP,I,J,JTOP,IR,IP,K1,K2,KB,K,KP,KT,NC<a name='2220'>
      REAL   :: XCLD<a name='2221'>
<a name='2222'>
      INTEGER :: L,LP1,LP2,LP3,LM1,LM2,LM3,MYIS,MYIE<a name='2223'>
<a name='2224'>
    <font color=#447700>!  DIMENSION CLDIPT(LP1,LP1, 64 )<a name='2225'></font>
    <font color=#447700>!  DIMENSION NCLDS(IDIM1:IDIM2),KTOP(IDIM1:IDIM2,LP1), &amp;<a name='2226'></font>
    <font color=#447700>!            KBTM(IDIM1:IDIM2,LP1)<a name='2227'></font>
    <font color=#447700>!  DIMENSION CLDROW(LP1)<a name='2228'></font>
    <font color=#447700>!  DIMENSION CAMT(IDIM1:IDIM2,LP1),CLDFAC(IDIM1:IDIM2,LP1,LP1)<a name='2229'></font>
<a name='2230'>
      L=kte<a name='2231'>
      LP1=L+1;  LP2=L+2;  LP3=L+3<a name='2232'>
      LM1=L-1;  LM2=L-2;  LM3=L-3<a name='2233'>
      MYIS=its; MYIE=ite<a name='2234'>
<a name='2235'>
<font color=#447700>!<a name='2236'></font>
      DO 1 IQ=MYIS,MYIE,64<a name='2237'>
      ITOP=IQ+63<a name='2238'>
      IF(ITOP.GT.MYIE) ITOP=MYIE<a name='2239'>
      JTOP=ITOP-IQ+1<a name='2240'>
      DO 11 IP=1,JTOP<a name='2241'>
      IR=IQ+IP-1<a name='2242'>
      IF (NCLDS(IR).EQ.0) THEN<a name='2243'>
        DO 25 J=1,LP1<a name='2244'>
        DO 25 I=1,LP1<a name='2245'>
        CLDIPT(I,J,IP)=1.<a name='2246'>
25      CONTINUE<a name='2247'>
      ENDIF<a name='2248'>
      IF (NCLDS(IR).GE.1) THEN<a name='2249'>
          XCLD=1.-CAMT(IR,2)<a name='2250'>
           K1=KTOP(IR,2)+1<a name='2251'>
           K2=KBTM(IR,2)<a name='2252'>
          DO 27 J=1,LP1<a name='2253'>
              CLDROW(J)=1.<a name='2254'>
27        CONTINUE<a name='2255'>
          DO 29 J=1,K2<a name='2256'>
              CLDROW(J)=XCLD<a name='2257'>
29        CONTINUE<a name='2258'>
          KB=MAX(K1,K2+1)<a name='2259'>
          DO 33 K=KB,LP1<a name='2260'>
          DO 33 KP=1,LP1<a name='2261'>
               CLDIPT(KP,K,IP)=CLDROW(KP)<a name='2262'>
33        CONTINUE<a name='2263'>
          DO 37 J=1,LP1<a name='2264'>
              CLDROW(J)=1.<a name='2265'>
37        CONTINUE<a name='2266'>
          DO 39 J=K1,LP1<a name='2267'>
              CLDROW(J)=XCLD<a name='2268'>
39        CONTINUE<a name='2269'>
          KT=MIN(K1-1,K2)<a name='2270'>
          DO 43 K=1,KT<a name='2271'>
          DO 43 KP=1,LP1<a name='2272'>
              CLDIPT(KP,K,IP)=CLDROW(KP)<a name='2273'>
43        CONTINUE<a name='2274'>
          IF(K2+1.LE.K1-1) THEN<a name='2275'>
            DO 31 J=K2+1,K1-1<a name='2276'>
            DO 31 I=1,LP1<a name='2277'>
                CLDIPT(I,J,IP)=1.<a name='2278'>
31          CONTINUE<a name='2279'>
          ELSE IF(K1.LE.K2) THEN<a name='2280'>
            DO 32 J=K1,K2<a name='2281'>
            DO 32 I=1,LP1<a name='2282'>
                CLDIPT(I,J,IP)=XCLD<a name='2283'>
32          CONTINUE<a name='2284'>
          ENDIF<a name='2285'>
      ENDIF<a name='2286'>
<a name='2287'>
      IF (NCLDS(IR).GE.2) THEN<a name='2288'>
        DO 21 NC=2,NCLDS(IR)<a name='2289'>
          XCLD=1.-CAMT(IR,NC+1)<a name='2290'>
           K1=KTOP(IR,NC+1)+1<a name='2291'>
           K2=KBTM(IR,NC+1)<a name='2292'>
          DO 47 J=1,LP1<a name='2293'>
              CLDROW(J)=1.<a name='2294'>
47        CONTINUE<a name='2295'>
          DO 49 J=1,K2<a name='2296'>
              CLDROW(J)=XCLD<a name='2297'>
49        CONTINUE<a name='2298'>
          KB=MAX(K1,K2+1)<a name='2299'>
          DO 53 K=KB,LP1<a name='2300'>
          DO 53 KP=1,LP1<a name='2301'>
               CLDIPT(KP,K,IP)=CLDIPT(KP,K,IP)*CLDROW(KP)<a name='2302'>
53        CONTINUE<a name='2303'>
          DO 57 J=1,LP1<a name='2304'>
              CLDROW(J)=1.<a name='2305'>
57        CONTINUE<a name='2306'>
          DO 59 J=K1,LP1<a name='2307'>
              CLDROW(J)=XCLD<a name='2308'>
59        CONTINUE<a name='2309'>
          KT=MIN(K1-1,K2)<a name='2310'>
          DO 63 K=1,KT<a name='2311'>
          DO 63 KP=1,LP1<a name='2312'>
              CLDIPT(KP,K,IP)=CLDIPT(KP,K,IP)*CLDROW(KP)<a name='2313'>
63        CONTINUE<a name='2314'>
          IF(K1.LE.K2) THEN<a name='2315'>
            DO 52 J=K1,K2<a name='2316'>
            DO 52 I=1,LP1<a name='2317'>
                CLDIPT(I,J,IP)=CLDIPT(I,J,IP)*XCLD<a name='2318'>
52          CONTINUE<a name='2319'>
          ENDIF<a name='2320'>
21        CONTINUE<a name='2321'>
      ENDIF<a name='2322'>
11    CONTINUE<a name='2323'>
      DO 71 J=1,LP1<a name='2324'>
      DO 71 I=1,LP1<a name='2325'>
      DO 71 IP=1,JTOP<a name='2326'>
      IR=IQ+IP-1<a name='2327'>
      CLDFAC(IR,I,J)=CLDIPT(I,J,IP)<a name='2328'>
71    CONTINUE<a name='2329'>
1     CONTINUE<a name='2330'>
<a name='2331'>
  END SUBROUTINE CLO89<a name='2332'>
<font color=#447700>!----------------------------------------------------------------<a name='2333'></font>
<font color=#447700>!     SUBROUTINE LWR88(HEATRA,GRNFLX,TOPFLX,                         &amp;<a name='2334'></font>
<font color=#447700>!                      PRESS,TEMP,RH2O,QO3,CLDFAC,                   &amp;<a name='2335'></font>
<font color=#447700>!                      CAMT,NCLDS,KTOP,KBTM,                         &amp;<a name='2336'></font>
<font color=#447700>!!                     BO3RND,AO3RND,T1,T2,T4,EM1V,EM1VW,EM3V,       &amp;<a name='2337'></font>
<font color=#447700>!                      BO3RND,AO3RND, &amp;<a name='2338'></font>
<font color=#447700>!                      APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='2339'></font>
<font color=#447700>!                      ZERO,ONE,H18E3,P0INV,H6P08108,DIFFCTR,        &amp;<a name='2340'></font>
<font color=#447700>!                      GINV,H3M4,BETINW,RATH2OMW,GP0INV,P0,P0XZP8,   &amp;<a name='2341'></font>
<font color=#447700>!                      P0XZP2,H3M3,H1M3,H1M2,H25E2,B0,B2,B1,B3,HAF,  &amp;<a name='2342'></font>
<font color=#447700>!                      TEN,HP1,FOUR,HM1EZ,SKO3R,                     &amp;<a name='2343'></font>
<font color=#447700>!                      AB15WD,SKC1R,RADCON,QUARTR,TWO,               &amp;<a name='2344'></font>
<font color=#447700>!                      HM6666M2,HMP66667,HMP5, HP166666,H41666M2,    &amp;<a name='2345'></font>
<font color=#447700>!                      RADCON1,H16E1, H28E1,H44194M2,H1P41819,SKO2D, &amp;<a name='2346'></font>
<font color=#447700>!                      ids,ide, jds,jde, kds,kde,                    &amp;<a name='2347'></font>
<font color=#447700>!                      ims,ime, jms,jme, kms,kme,                    &amp;<a name='2348'></font>
<font color=#447700>!                      its,ite, jts,jte, kts,kte                     )<a name='2349'></font>
<a name='2350'>
<A NAME='LWR88'><A href='../../html_code/phys/module_ra_gfdleta.F.html#LWR88' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2351'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>LWR88</font>(HEATRA,GRNFLX,TOPFLX,                         &amp; <A href='../../call_to/LWR88.html' TARGET='index'>1</A>,<A href='../../call_from/LWR88.html' TARGET='index'>1</A><a name='2352'>
                       PRESS,TEMP,RH2O,QO3,CLDFAC,                   &amp;<a name='2353'>
                       CAMT,NCLDS,KTOP,KBTM,                         &amp;<a name='2354'>
<font color=#447700>!                      BO3RND,AO3RND,T1,T2,T4,EM1V,EM1VW,EM3V,       &amp;<a name='2355'></font>
                       BO3RND,AO3RND, &amp;<a name='2356'>
                       APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='2357'>
                       ZERO,ONE,H18E3,P0INV,H6P08108,DIFFCTR,        &amp;<a name='2358'>
                       GINV,H3M4,BETINW,RATH2OMW,GP0INV,P0,P0XZP8,   &amp;<a name='2359'>
                       P0XZP2,H3M3,H1M3,H1M2,H25E2,B0,B2,B1,B3,HAF,  &amp;<a name='2360'>
                       TEN,HP1,FOUR,HM1EZ,                           &amp;<a name='2361'>
                       RADCON,QUARTR,TWO,                            &amp;<a name='2362'>
                       HM6666M2,HMP66667,HMP5, HP166666,H41666M2,    &amp;<a name='2363'>
                       RADCON1,H16E1, H28E1,H44194M2,H1P41819,       &amp;<a name='2364'>
                       ids,ide, jds,jde, kds,kde,                    &amp;<a name='2365'>
                       ims,ime, jms,jme, kms,kme,                    &amp;<a name='2366'>
                       its,ite, jts,jte, kts,kte                     )<a name='2367'>
<font color=#447700>!---------------------------------------------------------------------<a name='2368'></font>
 IMPLICIT NONE<a name='2369'>
<font color=#447700>!----------------------------------------------------------------------<a name='2370'></font>
<font color=#447700>!     INTEGER, PARAMETER :: NBLY=15<a name='2371'></font>
<a name='2372'>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='2373'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='2374'>
                                    its,ite, jts,jte, kts,kte  <a name='2375'>
      REAL,    INTENT(IN)        :: ZERO,ONE,H18E3,P0INV,H6P08108,DIFFCTR<a name='2376'>
      REAL,    INTENT(IN)        :: GINV,H3M4,BETINW,RATH2OMW,GP0INV<a name='2377'>
      REAL,    INTENT(IN)        :: P0XZP8,P0XZP2,H3M3,P0,H1M3<a name='2378'>
      REAL,    INTENT(IN)        :: H1M2,H25E2,B0,B1,B2,B3,HAF<a name='2379'>
<font color=#447700>!     REAL,    INTENT(IN)        :: TEN,HP1,FOUR,HM1EZ,SKO3R<a name='2380'></font>
      REAL,    INTENT(IN)        :: TEN,HP1,FOUR,HM1EZ         <a name='2381'>
<font color=#447700>!     REAL,    INTENT(IN)        :: AB15WD,SKC1R,RADCON,QUARTR,TWO<a name='2382'></font>
      REAL,    INTENT(IN)        :: RADCON,QUARTR,TWO<a name='2383'>
      REAL,    INTENT(IN)        :: HM6666M2,HMP66667,HMP5, HP166666,H41666M2<a name='2384'>
<font color=#447700>!     REAL,    INTENT(IN) :: RADCON1,H16E1, H28E1,H44194M2,H1P41819,SKO2D<a name='2385'></font>
      REAL,    INTENT(IN) :: RADCON1,H16E1, H28E1,H44194M2,H1P41819<a name='2386'>
<font color=#447700>!----------------------------------------------------------------------<a name='2387'></font>
      REAL, INTENT(IN), DIMENSION(3) :: BO3RND,AO3RND<a name='2388'>
<font color=#447700>!     REAL,INTENT(IN),DIMENSION(5040):: T1,T2,T4,EM1V,EM1VW<a name='2389'></font>
<font color=#447700>!     REAL, INTENT(IN), DIMENSION(5040) :: EM3V<a name='2390'></font>
      REAL,INTENT(IN),DIMENSION(NBLY) :: APCM,BPCM,ATPCM,BTPCM,ACOMB, &amp;<a name='2391'>
                                         BCOMB,BETACM<a name='2392'>
<a name='2393'>
      REAL,    INTENT(IN),DIMENSION(its:ite,kts:kte+1,kts:kte+1) :: CLDFAC<a name='2394'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: CAMT<a name='2395'>
      INTEGER, INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: KBTM,KTOP<a name='2396'>
      INTEGER, INTENT(IN), DIMENSION(its:ite)           :: NCLDS<a name='2397'>
     <a name='2398'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: PRESS,TEMP<a name='2399'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte)   :: RH2O,QO3<a name='2400'>
      REAL,    INTENT(OUT), DIMENSION(its:ite,kts:kte)   :: HEATRA<a name='2401'>
      REAL,    INTENT(OUT), DIMENSION(its:ite)           :: GRNFLX,TOPFLX<a name='2402'>
<a name='2403'>
<font color=#447700>!     REAL,    DIMENSION(kts:kte+1,kts:kte+1,64) :: CLDIPT<a name='2404'></font>
<a name='2405'>
<font color=#447700>!     Include co2 data from a file, which needs to have exactly vertical<a name='2406'></font>
<font color=#447700>!     dimension of the model.<a name='2407'></font>
      <a name='2408'>
<a name='2409'>
<font color=#447700>!!! ??? co2 table<a name='2410'></font>
<font color=#447700>!     REAL,    DIMENSION(kts:kte+1,kts:kte+1) :: CO251,CDT51,CDT58,C2D51,&amp;<a name='2411'></font>
<font color=#447700>!                                                C2D58,CO258<a name='2412'></font>
<font color=#447700>!     REAL,    DIMENSION(kts:kte+1)           :: STEMP,GTEMP,CO231,CO238, &amp;<a name='2413'></font>
<font color=#447700>!                                                C2D31,C2D38,CDT31,CDT38, &amp;<a name='2414'></font>
<font color=#447700>!                                                CO271,CO278,C2D71,C2D78, &amp;<a name='2415'></font>
<font color=#447700>!                                                CDT71,CDT78<a name='2416'></font>
<font color=#447700>!     REAL,    DIMENSION(kts:kte)             :: CO2M51,CO2M58,CDTM51,CDTM58, &amp;<a name='2417'></font>
<font color=#447700>!                                                C2DM51,C2DM58<a name='2418'></font>
<font color=#447700>!!! end co2 table<a name='2419'></font>
<a name='2420'>
<font color=#447700>!     REAL,    DIMENSION(kts:kte+1) :: CLDROW<a name='2421'></font>
<a name='2422'>
      REAL,    DIMENSION(its:ite,kts:kte+1) :: TEXPSL,TOTPHI,TOTO3,CNTVAL,&amp;<a name='2423'>
                                               TPHIO3,TOTVO2,TSTDAV,TDAV, &amp; <a name='2424'>
                                               VSUM3,CO2R1,D2CD21,DCO2D1, &amp;<a name='2425'>
                                               CO2R2,D2CD22,DCO2D2,CO2SP1,&amp;<a name='2426'>
                                               CO2SP2,CO2R,DCO2DT,D2CDT2, &amp;<a name='2427'>
                                               TLSQU,DIFT<a name='2428'>
      REAL,    DIMENSION(its:ite,kts:kte)   :: DELP2,DELP,CO2NBL,&amp;<a name='2429'>
                                               QH2O,VV,VAR1,VAR2,VAR3,VAR4<a name='2430'>
      REAL,    DIMENSION(its:ite,kts:kte+1) :: P,T<a name='2431'>
      REAL,    DIMENSION(its:ite,kts:kte)   :: CO2MR,CO2MD,CO2M2D<a name='2432'>
      REAL,    DIMENSION(its:ite,kts:kte*2+1):: EMPL<a name='2433'>
<a name='2434'>
      REAL,    DIMENSION(its:ite)           :: EMX1,EMX2,VSUM1,VSUM2,A1,A2 <a name='2435'>
      REAL,    DIMENSION(its:ite,kts:kte+1,kts:kte+1) :: CO21<a name='2436'>
<a name='2437'>
   <font color=#447700>!  COMMON/CO2BD3/CO251(LP1,LP1),CO258(LP1,LP1),CDT51(LP1,LP1),<a name='2438'></font>
   <font color=#447700>!  DIMENSION CO21(IDIM1:IDIM2,LP1,LP1),CO2NBL(IDIM1:IDIM2,L)<a name='2439'></font>
   <font color=#447700>!  DIMENSION CO2R(IDIM1:IDIM2,LP1),DIFT(IDIM1:IDIM2,LP1)<a name='2440'></font>
   <font color=#447700>! 1   CO2M2D(IDIM1:IDIM2,L)<a name='2441'></font>
   <font color=#447700>!  DIMENSION CO2MR(IDIM1:IDIM2,L),CO2MD(IDIM1:IDIM2,L),<a name='2442'></font>
   <font color=#447700>! 2 CO2M58(L),CDTM51(L),CDTM58(L),C2DM51(L),C2DM58(L),<a name='2443'></font>
   <font color=#447700>! 1 CDT58(LP1,LP1),C2D51(LP1,LP1),C2D58(LP1,LP1),CO2M51(L),<a name='2444'></font>
   <font color=#447700>!  COMMON / CO2BD2 / CO231(LP1),CO238(LP1),CDT31(LP1),<a name='2445'></font>
   <font color=#447700>! 1 CDT38(LP1),C2D31(LP1),C2D38(LP1)<a name='2446'></font>
   <font color=#447700>!  DIMENSION CO2R1(IDIM1:IDIM2,LP1),DCO2D1(IDIM1:IDIM2,LP1)<a name='2447'></font>
   <font color=#447700>!  DIMENSION D2CD21(IDIM1:IDIM2,LP1),D2CD22(IDIM1:IDIM2,LP1)<a name='2448'></font>
   <font color=#447700>! 3 STEMP(LP1),GTEMP(LP1),B0,B1,B2,B3<a name='2449'></font>
   <font color=#447700>! 1 VV(IDIM1:IDIM2,L),VSUM3(IDIM1:IDIM2,LP1),VSUM1(IDIM1:IDIM2),<a name='2450'></font>
   <font color=#447700>! 2 VSUM2(IDIM1:IDIM2)<a name='2451'></font>
   <font color=#447700>!  DIMENSION TDAV(IDIM1:IDIM2,LP1),TSTDAV(IDIM1:IDIM2,LP1),<a name='2452'></font>
   <font color=#447700>!  LLP1=LL+1, LL = 2L<a name='2453'></font>
   <font color=#447700>!  EMX2(IDIM1:IDIM2),EMPL(IDIM1:IDIM2,LLP1)<a name='2454'></font>
   <font color=#447700>!  DIMENSION TPHIO3(IDIM1:IDIM2,LP1),<a name='2455'></font>
   <font color=#447700>!  DIMENSION TEXPSL(IDIM1:IDIM2,LP1)<a name='2456'></font>
   <font color=#447700>!  DIMENSION QH2O(IDIM1:IDIM2,L)<a name='2457'></font>
   <font color=#447700>!  DIMENSION DELP2(IDIM1:IDIM2,L)<a name='2458'></font>
   <font color=#447700>!  DIMENSION VAR1(IDIM1:IDIM2,L),VAR2(IDIM1:IDIM2,L),<a name='2459'></font>
   <font color=#447700>! 1   VAR3(IDIM1:IDIM2,L),VAR4(IDIM1:IDIM2,L)<a name='2460'></font>
   <font color=#447700>! 1 VV(IDIM1:IDIM2,L)<a name='2461'></font>
   <font color=#447700>!  DIMENSION CNTVAL(IDIM1:IDIM2,LP1)<a name='2462'></font>
   <font color=#447700>!  DIMENSION TOTO3(IDIM1:IDIM2,LP1)<a name='2463'></font>
   <font color=#447700>!  DIMENSION EMX1(IDIM1:IDIM2),<a name='2464'></font>
<a name='2465'>
   <font color=#447700>!  DIMENSION PRESS(IDIM1:IDIM2,LP1),TEMP(IDIM1:IDIM2,LP1), &amp;<a name='2466'></font>
   <font color=#447700>!     RH2O(IDIM1:IDIM2,L),QO3(IDIM1:IDIM2,L)<a name='2467'></font>
   <font color=#447700>!  DIMENSION HEATRA(IDIM1:IDIM2,L),GRNFLX(IDIM1:IDIM2),    &amp;<a name='2468'></font>
   <font color=#447700>!     TOPFLX(IDIM1:IDIM2)<a name='2469'></font>
<a name='2470'>
<font color=#447700>!<a name='2471'></font>
<font color=#447700>!<a name='2472'></font>
<font color=#447700>!****COMPUTE FLUX PRESSURES (P) AND DIFFERENCES (DELP2,DELP)<a name='2473'></font>
<font color=#447700>!****COMPUTE FLUX LEVEL TEMPERATURES (T) AND CONTINUUM TEMPERATURE<a name='2474'></font>
<font color=#447700>!    CORRECTIONS (TEXPSL)<a name='2475'></font>
    <a name='2476'>
      INTEGER :: K, I,KP<a name='2477'>
      INTEGER :: L,LP1,LP2,LP3,LM1,LM2,LM3,MYIS,MYIE,LLP1,LL<a name='2478'>
<a name='2479'>
      L=kte<a name='2480'>
      LP1=L+1;  LP2=L+2;  LP3=L+3; LLP1 = 2*L + 1<a name='2481'>
      LM1=L-1;  LM2=L-2;  LM3=L-3; LL = 2*L<a name='2482'>
      MYIS=its; MYIE=ite<a name='2483'>
<a name='2484'>
<a name='2485'>
      DO 103 K=2,L<a name='2486'>
      DO 103 I=MYIS,MYIE<a name='2487'>
      P(I,K)=HAF*(PRESS(I,K-1)+PRESS(I,K))<a name='2488'>
      T(I,K)=HAF*(TEMP(I,K-1)+TEMP(I,K))<a name='2489'>
103   CONTINUE<a name='2490'>
      DO 105 I=MYIS,MYIE<a name='2491'>
      P(I,1)=ZERO<a name='2492'>
      P(I,LP1)=PRESS(I,LP1)<a name='2493'>
      T(I,1)=TEMP(I,1)<a name='2494'>
      T(I,LP1)=TEMP(I,LP1)<a name='2495'>
105   CONTINUE<a name='2496'>
      DO 107 K=1,L<a name='2497'>
      DO 107 I=MYIS,MYIE<a name='2498'>
      DELP2(I,K)=P(I,K+1)-P(I,K)<a name='2499'>
      DELP(I,K)=ONE/DELP2(I,K)<a name='2500'>
107   CONTINUE<a name='2501'>
<font color=#447700>!****COMPUTE ARGUMENT FOR CONT.TEMP.COEFF.<a name='2502'></font>
<font color=#447700>!    (THIS IS 1800.(1./TEMP-1./296.))<a name='2503'></font>
      DO 125 K=1,LP1<a name='2504'>
      DO 125 I=MYIS,MYIE<a name='2505'>
      TEXPSL(I,K)=H18E3/TEMP(I,K)-H6P08108<a name='2506'>
<font color=#447700>!...THEN TAKE EXPONENTIAL<a name='2507'></font>
      TEXPSL(I,K)=EXP(TEXPSL(I,K))<a name='2508'>
125   CONTINUE<a name='2509'>
<font color=#447700>!***COMPUTE OPTICAL PATHS FOR H2O AND O3, USING THE DIFFUSIVITY<a name='2510'></font>
<font color=#447700>!   APPROXIMATION FOR THE ANGULAR INTEGRATION (1.66). OBTAIN THE<a name='2511'></font>
<font color=#447700>!   UNWEIGHTED VALUES(VAR1,VAR3) AND THE WEIGHTED VALUES(VAR2,VAR4).<a name='2512'></font>
<font color=#447700>!   THE QUANTITIES H3M4(.0003) AND H3M3(.003) APPEARING IN THE VAR2 AND<a name='2513'></font>
<font color=#447700>!   VAR4 EXPRESSIONS ARE THE APPROXIMATE VOIGT CORRECTIONS FOR H2O AND<a name='2514'></font>
<font color=#447700>!   O3,RESPECTIVELY.<a name='2515'></font>
<font color=#447700>!<a name='2516'></font>
      DO 131 K=1,L<a name='2517'>
      DO 131 I=MYIS,MYIE<a name='2518'>
      QH2O(I,K)=RH2O(I,K)*DIFFCTR<a name='2519'>
<font color=#447700>!---VV IS THE LAYER-MEAN PRESSURE (IN ATM),WHICH IS NOT THE SAME AS<a name='2520'></font>
<font color=#447700>!   THE LEVEL PRESSURE (PRESS)<a name='2521'></font>
      VV(I,K)=HAF*(P(I,K+1)+P(I,K))*P0INV<a name='2522'>
      VAR1(I,K)=DELP2(I,K)*QH2O(I,K)*GINV<a name='2523'>
      VAR3(I,K)=DELP2(I,K)*QO3(I,K)*DIFFCTR*GINV<a name='2524'>
      VAR2(I,K)=VAR1(I,K)*(VV(I,K)+H3M4)<a name='2525'>
      VAR4(I,K)=VAR3(I,K)*(VV(I,K)+H3M3)<a name='2526'>
<font color=#447700>!  COMPUTE OPTICAL PATH FOR THE H2O CONTINUUM, USING ROBERTS COEFFS.<a name='2527'></font>
<font color=#447700>!  (BETINW),AND TEMP. CORRECTION (TEXPSL). THE DIFFUSIVITY FACTOR<a name='2528'></font>
<font color=#447700>!  (WHICH CANCELS OUT IN THIS EXPRESSION) IS ASSUMED TO BE 1.66. THE<a name='2529'></font>
<font color=#447700>!  USE OF THE DIFFUSIVITY FACTOR HAS BEEN SHOWN TO BE A SIGNIFICANT<a name='2530'></font>
<font color=#447700>!  SOURCE OF ERROR IN THE CONTINUUM CALCS.,BUT THE TIME PENALTY OF<a name='2531'></font>
<font color=#447700>!  AN ANGULAR INTEGRATION IS SEVERE.<a name='2532'></font>
<font color=#447700>!<a name='2533'></font>
      CNTVAL(I,K)=TEXPSL(I,K)*RH2O(I,K)*VAR2(I,K)*BETINW/ &amp;<a name='2534'>
                   (RH2O(I,K)+RATH2OMW)<a name='2535'>
131   CONTINUE<a name='2536'>
<font color=#447700>!   COMPUTE SUMMED OPTICAL PATHS FOR H2O,O3 AND CONTINUUM<a name='2537'></font>
      DO 201 I=MYIS,MYIE<a name='2538'>
      TOTPHI(I,1)=ZERO<a name='2539'>
      TOTO3(I,1)=ZERO<a name='2540'>
      TPHIO3(I,1)=ZERO<a name='2541'>
      TOTVO2(I,1)=ZERO<a name='2542'>
201   CONTINUE<a name='2543'>
      DO 203 K=2,LP1<a name='2544'>
      DO 203 I=MYIS,MYIE<a name='2545'>
      TOTPHI(I,K)=TOTPHI(I,K-1)+VAR2(I,K-1)<a name='2546'>
      TOTO3(I,K)=TOTO3(I,K-1)+VAR3(I,K-1)<a name='2547'>
      TPHIO3(I,K)=TPHIO3(I,K-1)+VAR4(I,K-1)<a name='2548'>
      TOTVO2(I,K)=TOTVO2(I,K-1)+CNTVAL(I,K-1)<a name='2549'>
203   CONTINUE<a name='2550'>
<font color=#447700>!---EMX1 IS THE ADDITIONAL PRESSURE-SCALED MASS FROM PRESS(L) TO<a name='2551'></font>
<font color=#447700>!   P(L). IT IS USED IN NEARBY LAYER AND EMISS CALCULATIONS.<a name='2552'></font>
<font color=#447700>!---EMX2 IS THE ADDITIONAL PRESSURE-SCALED MASS FROM PRESS(L) TO<a name='2553'></font>
<font color=#447700>!   P(LP1). IT IS USED IN CALCULATIONS BETWEEN FLUX LEVELS L AND LP1.<a name='2554'></font>
<font color=#447700>!<a name='2555'></font>
      DO 801 I=MYIS,MYIE<a name='2556'>
      EMX1(I)=QH2O(I,L)*PRESS(I,L)*(PRESS(I,L)-P(I,L))*GP0INV<a name='2557'>
      EMX2(I)=QH2O(I,L)*PRESS(I,L)*(P(I,LP1)-PRESS(I,L))*GP0INV<a name='2558'>
801   CONTINUE<a name='2559'>
<font color=#447700>!---EMPL IS THE PRESSURE SCALED MASS FROM P(K) TO PRESS(K) (INDEX 2-LP1)<a name='2560'></font>
<font color=#447700>!   OR TO PRESS(K+1) (INDEX LP2-LL)<a name='2561'></font>
      DO 811 K=1,L<a name='2562'>
      DO 811 I=MYIS,MYIE<a name='2563'>
      EMPL(I,K+1)=QH2O(I,K)*P(I,K+1)*(P(I,K+1)-PRESS(I,K))*GP0INV<a name='2564'>
811   CONTINUE<a name='2565'>
      DO 812 K=1,LM1<a name='2566'>
      DO 812 I=MYIS,MYIE<a name='2567'>
      EMPL(I,LP2+K-1)=QH2O(I,K+1)*P(I,K+1)*(PRESS(I,K+1)-P(I,K+1)) &amp;<a name='2568'>
                     *GP0INV<a name='2569'>
812   CONTINUE<a name='2570'>
      DO 821 I=MYIS,MYIE<a name='2571'>
      EMPL(I,1)=VAR2(I,L)<a name='2572'>
      EMPL(I,LLP1)=EMPL(I,LL)<a name='2573'>
821   CONTINUE<a name='2574'>
<font color=#447700>!***COMPUTE WEIGHTED TEMPERATURE (TDAV) AND PRESSURE (TSTDAV) INTEGRALS<a name='2575'></font>
<font color=#447700>!   FOR USE IN OBTAINING TEMP. DIFFERENCE BET. SOUNDING AND STD.<a name='2576'></font>
<font color=#447700>!   TEMP. SOUNDING (DIFT)<a name='2577'></font>
      DO 161 I=MYIS,MYIE<a name='2578'>
      TSTDAV(I,1)=ZERO<a name='2579'>
      TDAV(I,1)=ZERO<a name='2580'>
161   CONTINUE<a name='2581'>
      DO 162 K=1,LP1<a name='2582'>
      DO 162 I=MYIS,MYIE<a name='2583'>
      VSUM3(I,K)=TEMP(I,K)-STEMP(K)<a name='2584'>
162   CONTINUE<a name='2585'>
      DO 163 K=1,L<a name='2586'>
      DO 165 I=MYIS,MYIE<a name='2587'>
      VSUM2(I)=GTEMP(K)*DELP2(I,K)<a name='2588'>
      VSUM1(I)=VSUM2(I)*VSUM3(I,K)<a name='2589'>
      TSTDAV(I,K+1)=TSTDAV(I,K)+VSUM2(I)<a name='2590'>
      TDAV(I,K+1)=TDAV(I,K)+VSUM1(I)<a name='2591'>
165   CONTINUE<a name='2592'>
163   CONTINUE<a name='2593'>
<font color=#447700>!<a name='2594'></font>
<font color=#447700>!****EVALUATE COEFFICIENTS FOR CO2 PRESSURE INTERPOLATION (A1,A2)<a name='2595'></font>
      DO 171 I=MYIS,MYIE<a name='2596'>
      A1(I)=(PRESS(I,LP1)-P0XZP8)/P0XZP2<a name='2597'>
      A2(I)=(P0-PRESS(I,LP1))/P0XZP2<a name='2598'>
171   CONTINUE<a name='2599'>
<font color=#447700>!***PERFORM CO2 PRESSURE INTERPOLATION ON ALL INPUTTED TRANSMISSION<a name='2600'></font>
<font color=#447700>!   FUNCTIONS AND TEMP. DERIVATIVES<a name='2601'></font>
<font color=#447700>!---SUCCESSIVELY COMPUTING CO2R,DCO2DT AND D2CDT2 IS DONE TO SAVE<a name='2602'></font>
<font color=#447700>!   STORAGE (AT A SLIGHT LOSS IN COMPUTATION TIME)<a name='2603'></font>
      DO 184 K=1,LP1<a name='2604'>
      DO 184 I=MYIS,MYIE<a name='2605'>
        CO2R1(I,K)=A1(I)*CO231(K)+A2(I)*CO238(K)<a name='2606'>
        D2CD21(I,K)=H1M3*(A1(I)*C2D31(K)+A2(I)*C2D38(K))<a name='2607'>
        DCO2D1(I,K)=H1M2*(A1(I)*CDT31(K)+A2(I)*CDT38(K))<a name='2608'>
        CO2R2(I,K)=A1(I)*CO271(K)+A2(I)*CO278(K)<a name='2609'>
        D2CD22(I,K)=H1M3*(A1(I)*C2D71(K)+A2(I)*C2D78(K))<a name='2610'>
        DCO2D2(I,K)=H1M2*(A1(I)*CDT71(K)+A2(I)*CDT78(K))<a name='2611'>
184   CONTINUE<a name='2612'>
      DO 190 K=1,L<a name='2613'>
      DO 190 I=MYIS,MYIE<a name='2614'>
        CO2MR(I,K)=A1(I)*CO2M51(K)+A2(I)*CO2M58(K)<a name='2615'>
        CO2MD(I,K)=H1M2*(A1(I)*CDTM51(K)+A2(I)*CDTM58(K))<a name='2616'>
        CO2M2D(I,K)=H1M3*(A1(I)*C2DM51(K)+A2(I)*C2DM58(K))<a name='2617'>
190   CONTINUE<a name='2618'>
<font color=#447700>!***COMPUTE CO2 TEMPERATURE INTERPOLATIONS FOR ALL BANDS,USING DIFT<a name='2619'></font>
<font color=#447700>!<a name='2620'></font>
<font color=#447700>!   THE CASE WHERE K=1 IS HANDLED FIRST. WE ARE NOW REPLACING<a name='2621'></font>
<font color=#447700>!   3-DIMENSIONAL ARRAYS BY 2-D ARRAYS, TO SAVE SPACE. THUS THIS<a name='2622'></font>
<font color=#447700>!   CALCULATION IS FOR (I,KP,1)<a name='2623'></font>
      DO 211 KP=2,LP1<a name='2624'>
      DO 211 I=MYIS,MYIE<a name='2625'>
      DIFT(I,KP)=TDAV(I,KP)/TSTDAV(I,KP)<a name='2626'>
211   CONTINUE<a name='2627'>
      DO 212 I=MYIS,MYIE<a name='2628'>
      CO21(I,1,1)=1.0<a name='2629'>
      CO2SP1(I,1)=1.0<a name='2630'>
      CO2SP2(I,1)=1.0<a name='2631'>
212   CONTINUE<a name='2632'>
      DO 215 KP=2,LP1<a name='2633'>
      DO 215 I=MYIS,MYIE<a name='2634'>
<font color=#447700>!---CALCULATIONS FOR KP&gt;1 FOR K=1<a name='2635'></font>
      CO2R(I,KP)=A1(I)*CO251(KP,1)+A2(I)*CO258(KP,1)<a name='2636'>
      DCO2DT(I,KP)=H1M2*(A1(I)*CDT51(KP,1)+A2(I)*CDT58(KP,1))<a name='2637'>
      D2CDT2(I,KP)=H1M3*(A1(I)*C2D51(KP,1)+A2(I)*C2D58(KP,1))<a name='2638'>
      CO21(I,KP,1)=CO2R(I,KP)+DIFT(I,KP)*(DCO2DT(I,KP)+ &amp;<a name='2639'>
                   HAF*DIFT(I,KP)*D2CDT2(I,KP))<a name='2640'>
<font color=#447700>!---CALCULATIONS FOR (EFFECTIVELY) KP=1,K&gt;KP. THESE USE THE<a name='2641'></font>
<font color=#447700>!   SAME VALUE OF DIFT DUE TO SYMMETRY<a name='2642'></font>
      CO2R(I,KP)=A1(I)*CO251(1,KP)+A2(I)*CO258(1,KP)<a name='2643'>
      DCO2DT(I,KP)=H1M2*(A1(I)*CDT51(1,KP)+A2(I)*CDT58(1,KP))<a name='2644'>
      D2CDT2(I,KP)=H1M3*(A1(I)*C2D51(1,KP)+A2(I)*C2D58(1,KP))<a name='2645'>
      CO21(I,1,KP)=CO2R(I,KP)+DIFT(I,KP)*(DCO2DT(I,KP)+ &amp;<a name='2646'>
                   HAF*DIFT(I,KP)*D2CDT2(I,KP))<a name='2647'>
215   CONTINUE<a name='2648'>
<font color=#447700>!   THE TRANSMISSION FUNCTIONS USED IN SPA88 MAY BE COMPUTED NOW.<a name='2649'></font>
<font color=#447700>!---(IN THE 250 LOOP,DIFT REALLY SHOULD BE (I,1,K), BUT DIFT IS<a name='2650'></font>
<font color=#447700>!    INVARIANT WITH RESPECT TO K,KP,AND SO (I,1,K)=(I,K,1))<a name='2651'></font>
      DO 250 K=2,LP1<a name='2652'>
      DO 250 I=MYIS,MYIE<a name='2653'>
      CO2SP1(I,K)=CO2R1(I,K)+DIFT(I,K)*(DCO2D1(I,K)+HAF*DIFT(I,K)* &amp;<a name='2654'>
       D2CD21(I,K))<a name='2655'>
      CO2SP2(I,K)=CO2R2(I,K)+DIFT(I,K)*(DCO2D2(I,K)+HAF*DIFT(I,K)* &amp;<a name='2656'>
       D2CD22(I,K))<a name='2657'>
250   CONTINUE<a name='2658'>
<font color=#447700>!<a name='2659'></font>
<font color=#447700>!   NEXT THE CASE WHEN K=2...L<a name='2660'></font>
      DO 220 K=2,L<a name='2661'>
      DO 222 KP=K+1,LP1<a name='2662'>
      DO 222 I=MYIS,MYIE<a name='2663'>
      DIFT(I,KP)=(TDAV(I,KP)-TDAV(I,K))/ &amp;<a name='2664'>
                    (TSTDAV(I,KP)-TSTDAV(I,K))<a name='2665'>
      CO2R(I,KP)=A1(I)*CO251(KP,K)+A2(I)*CO258(KP,K)<a name='2666'>
      DCO2DT(I,KP)=H1M2*(A1(I)*CDT51(KP,K)+A2(I)*CDT58(KP,K))<a name='2667'>
      D2CDT2(I,KP)=H1M3*(A1(I)*C2D51(KP,K)+A2(I)*C2D58(KP,K))<a name='2668'>
      CO21(I,KP,K)=CO2R(I,KP)+DIFT(I,KP)*(DCO2DT(I,KP)+ &amp;<a name='2669'>
                   HAF*DIFT(I,KP)*D2CDT2(I,KP))<a name='2670'>
      CO2R(I,KP)=A1(I)*CO251(K,KP)+A2(I)*CO258(K,KP)<a name='2671'>
      DCO2DT(I,KP)=H1M2*(A1(I)*CDT51(K,KP)+A2(I)*CDT58(K,KP))<a name='2672'>
      D2CDT2(I,KP)=H1M3*(A1(I)*C2D51(K,KP)+A2(I)*C2D58(K,KP))<a name='2673'>
      CO21(I,K,KP)=CO2R(I,KP)+DIFT(I,KP)*(DCO2DT(I,KP)+ &amp;<a name='2674'>
                   HAF*DIFT(I,KP)*D2CDT2(I,KP))<a name='2675'>
222   CONTINUE<a name='2676'>
220   CONTINUE<a name='2677'>
<font color=#447700>!   FINALLY THE CASE WHEN K=KP,K=2..LP1<a name='2678'></font>
      DO 206 K=2,LP1<a name='2679'>
      DO 206 I=MYIS,MYIE<a name='2680'>
      DIFT(I,K)=HAF*(VSUM3(I,K)+VSUM3(I,K-1))<a name='2681'>
      CO2R(I,K)=A1(I)*CO251(K,K)+A2(I)*CO258(K,K)<a name='2682'>
      DCO2DT(I,K)=H1M2*(A1(I)*CDT51(K,K)+A2(I)*CDT58(K,K))<a name='2683'>
      D2CDT2(I,K)=H1M3*(A1(I)*C2D51(K,K)+A2(I)*C2D58(K,K))<a name='2684'>
      CO21(I,K,K)=CO2R(I,K)+DIFT(I,K)*(DCO2DT(I,K)+ &amp;<a name='2685'>
                   HAF*DIFT(I,K)*D2CDT2(I,K))<a name='2686'>
206   CONTINUE<a name='2687'>
<font color=#447700>!--- WE AREN'T DOING NBL TFS ON THE 100 CM-1 BANDS .<a name='2688'></font>
      DO 260 K=1,L<a name='2689'>
      DO 260 I=MYIS,MYIE<a name='2690'>
      CO2NBL(I,K)=CO2MR(I,K)+VSUM3(I,K)*(CO2MD(I,K)+HAF* &amp;<a name='2691'>
       VSUM3(I,K)*CO2M2D(I,K))<a name='2692'>
260   CONTINUE<a name='2693'>
<font color=#447700>!***COMPUTE TEMP. COEFFICIENT BASED ON T(K) (SEE REF.2)<a name='2694'></font>
      DO 264 K=1,LP1<a name='2695'>
      DO 264 I=MYIS,MYIE<a name='2696'>
      IF (T(I,K).LE.H25E2) THEN<a name='2697'>
         TLSQU(I,K)=B0+(T(I,K)-H25E2)* &amp;<a name='2698'>
                            (B1+(T(I,K)-H25E2)* &amp;<a name='2699'>
                         (B2+B3*(T(I,K)-H25E2)))<a name='2700'>
      ELSE<a name='2701'>
         TLSQU(I,K)=B0<a name='2702'>
      ENDIF<a name='2703'>
264   CONTINUE<a name='2704'>
<font color=#447700>!***APPLY TO ALL CO2 TFS<a name='2705'></font>
      DO 280 K=1,LP1<a name='2706'>
      DO 282 KP=1,LP1<a name='2707'>
      DO 282 I=MYIS,MYIE<a name='2708'>
      CO21(I,KP,K)=CO21(I,KP,K)*(ONE-TLSQU(I,KP))+TLSQU(I,KP)<a name='2709'>
282   CONTINUE<a name='2710'>
280   CONTINUE<a name='2711'>
      DO 284 K=1,LP1<a name='2712'>
      DO 286 I=MYIS,MYIE<a name='2713'>
      CO2SP1(I,K)=CO2SP1(I,K)*(ONE-TLSQU(I,1))+TLSQU(I,1)<a name='2714'>
      CO2SP2(I,K)=CO2SP2(I,K)*(ONE-TLSQU(I,1))+TLSQU(I,1)<a name='2715'>
286   CONTINUE<a name='2716'>
284   CONTINUE<a name='2717'>
      DO 288 K=1,L<a name='2718'>
      DO 290 I=MYIS,MYIE<a name='2719'>
      CO2NBL(I,K)=CO2NBL(I,K)*(ONE-TLSQU(I,K))+TLSQU(I,K)<a name='2720'>
290   CONTINUE<a name='2721'>
288   CONTINUE<a name='2722'>
<font color=#447700>!     CALL FST88(HEATRA,GRNFLX,TOPFLX, &amp;<a name='2723'></font>
<font color=#447700>!                QH2O,PRESS,P,DELP,DELP2,TEMP,T, &amp;<a name='2724'></font>
<font color=#447700>!                CLDFAC,NCLDS,KTOP,KBTM,CAMT, &amp;<a name='2725'></font>
<font color=#447700>!                CO21,CO2NBL,CO2SP1,CO2SP2, &amp;<a name='2726'></font>
<font color=#447700>!                VAR1,VAR2,VAR3,VAR4,CNTVAL, &amp;<a name='2727'></font>
<font color=#447700>!                TOTO3,TPHIO3,TOTPHI,TOTVO2, &amp;<a name='2728'></font>
<font color=#447700>!                EMX1,EMX2,EMPL, &amp;<a name='2729'></font>
<font color=#447700>!<a name='2730'></font>
<font color=#447700>!                BO3RND,AO3RND, &amp;<a name='2731'></font>
<font color=#447700>!!               T1,T2,T4 , EM1V,EM1VW, EM3V, &amp;<a name='2732'></font>
<font color=#447700>!                APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='2733'></font>
<font color=#447700>!                TEN,HP1,HAF,ONE,FOUR,HM1EZ,SKO3R, &amp;<a name='2734'></font>
<font color=#447700>!                AB15WD,SKC1R,RADCON,QUARTR,TWO, &amp;<a name='2735'></font>
<font color=#447700>!                HM6666M2,HMP66667,HMP5, &amp;<a name='2736'></font>
<font color=#447700>!                HP166666,H41666M2,RADCON1, &amp;<a name='2737'></font>
<font color=#447700>!                H16E1, H28E1, H25E2, H44194M2,H1P41819, &amp;<a name='2738'></font>
<font color=#447700>!                SKO2D,                                        &amp;<a name='2739'></font>
<font color=#447700>!                ids,ide, jds,jde, kds,kde,                    &amp;<a name='2740'></font>
<font color=#447700>!                ims,ime, jms,jme, kms,kme,                    &amp;<a name='2741'></font>
<font color=#447700>!                its,ite, jts,jte, kts,kte                     )<a name='2742'></font>
<a name='2743'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#FST88'>FST88</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#LWR88' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FST88_1">(HEATRA,GRNFLX,TOPFLX, &amp;<a name='2744'>
                 QH2O,PRESS,P,DELP,DELP2,TEMP,T, &amp;<a name='2745'>
                 CLDFAC,NCLDS,KTOP,KBTM,CAMT, &amp;<a name='2746'>
                 CO21,CO2NBL,CO2SP1,CO2SP2, &amp;<a name='2747'>
                 VAR1,VAR2,VAR3,VAR4,CNTVAL, &amp;<a name='2748'>
                 TOTO3,TPHIO3,TOTPHI,TOTVO2, &amp;<a name='2749'>
                 EMX1,EMX2,EMPL, &amp;<a name='2750'>
<font color=#447700>!<a name='2751'></font>
                 BO3RND,AO3RND, &amp;<a name='2752'>
<font color=#447700>!                T1,T2,T4 , EM1V,EM1VW, EM3V, &amp;<a name='2753'></font>
                 APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='2754'>
                 TEN,HP1,HAF,ONE,FOUR,HM1EZ,       &amp;<a name='2755'>
                 RADCON,QUARTR,TWO,  &amp;<a name='2756'>
                 HM6666M2,HMP66667,HMP5, &amp;<a name='2757'>
                 HP166666,H41666M2,RADCON1, &amp;<a name='2758'>
                 H16E1, H28E1, H25E2, H44194M2,H1P41819, &amp;<a name='2759'>
                 ids,ide, jds,jde, kds,kde,                    &amp;<a name='2760'>
                 ims,ime, jms,jme, kms,kme,                    &amp;<a name='2761'>
                 its,ite, jts,jte, kts,kte                     )<a name='2762'>
<a name='2763'>
  END SUBROUTINE LWR88<a name='2764'>
<font color=#447700>!---------------------------------------------------------------------<a name='2765'></font>
<font color=#447700>! SUBROUTINE FST88(HEATRA,GRNFLX,TOPFLX, &amp;<a name='2766'></font>
<font color=#447700>!                      QH2O,PRESS,P,DELP,DELP2,TEMP,T, &amp;<a name='2767'></font>
<font color=#447700>!                      CLDFAC,NCLDS,KTOP,KBTM,CAMT, &amp;<a name='2768'></font>
<font color=#447700>!                      CO21,CO2NBL,CO2SP1,CO2SP2, &amp;<a name='2769'></font>
<font color=#447700>!                      VAR1,VAR2,VAR3,VAR4,CNTVAL, &amp;<a name='2770'></font>
<font color=#447700>!                      TOTO3,TPHIO3,TOTPHI,TOTVO2, &amp;<a name='2771'></font>
<font color=#447700>!                      EMX1,EMX2,EMPL, &amp;<a name='2772'></font>
<font color=#447700>!                      BO3RND,AO3RND, &amp;<a name='2773'></font>
<font color=#447700>!!                     T1,T2,T4 , EM1V,EM1VW, EM3V, &amp;<a name='2774'></font>
<font color=#447700>!                      APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='2775'></font>
<font color=#447700>!                      TEN,HP1,HAF,ONE,FOUR,HM1EZ,SKO3R, &amp;<a name='2776'></font>
<font color=#447700>!                      AB15WD,SKC1R,RADCON,QUARTR,TWO, &amp;<a name='2777'></font>
<font color=#447700>!                      HM6666M2,HMP66667,HMP5, &amp;<a name='2778'></font>
<font color=#447700>!                      HP166666,H41666M2,RADCON1, &amp;<a name='2779'></font>
<font color=#447700>!                      H16E1, H28E1, H25E2, H44194M2,H1P41819, &amp;<a name='2780'></font>
<font color=#447700>!                      SKO2D,                                        &amp;<a name='2781'></font>
<font color=#447700>!                      ids,ide, jds,jde, kds,kde,                    &amp;<a name='2782'></font>
<font color=#447700>!                      ims,ime, jms,jme, kms,kme,                    &amp;<a name='2783'></font>
<font color=#447700>!                      its,ite, jts,jte, kts,kte                     )<a name='2784'></font>
<a name='2785'>
<A NAME='FST88'><A href='../../html_code/phys/module_ra_gfdleta.F.html#FST88' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2786'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>FST88</font>(HEATRA,GRNFLX,TOPFLX, &amp; <A href='../../call_to/FST88.html' TARGET='index'>1</A>,<A href='../../call_from/FST88.html' TARGET='index'>5</A><a name='2787'>
                       QH2O,PRESS,P,DELP,DELP2,TEMP,T, &amp;<a name='2788'>
                       CLDFAC,NCLDS,KTOP,KBTM,CAMT, &amp;<a name='2789'>
                       CO21,CO2NBL,CO2SP1,CO2SP2, &amp;<a name='2790'>
                       VAR1,VAR2,VAR3,VAR4,CNTVAL, &amp;<a name='2791'>
                       TOTO3,TPHIO3,TOTPHI,TOTVO2, &amp;<a name='2792'>
                       EMX1,EMX2,EMPL, &amp;<a name='2793'>
                       BO3RND,AO3RND, &amp;<a name='2794'>
<font color=#447700>!                      T1,T2,T4 , EM1V,EM1VW, EM3V, &amp;<a name='2795'></font>
                       APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='2796'>
                       TEN,HP1,HAF,ONE,FOUR,HM1EZ,       &amp;<a name='2797'>
                       RADCON,QUARTR,TWO, &amp;<a name='2798'>
                       HM6666M2,HMP66667,HMP5, &amp;<a name='2799'>
                       HP166666,H41666M2,RADCON1, &amp;<a name='2800'>
                       H16E1, H28E1, H25E2, H44194M2,H1P41819, &amp;<a name='2801'>
                       ids,ide, jds,jde, kds,kde,                    &amp;<a name='2802'>
                       ims,ime, jms,jme, kms,kme,                    &amp;<a name='2803'>
                       its,ite, jts,jte, kts,kte                     )<a name='2804'>
<font color=#447700>!---------------------------------------------------------------------<a name='2805'></font>
 IMPLICIT NONE<a name='2806'>
<font color=#447700>!----------------------------------------------------------------------<a name='2807'></font>
<font color=#447700>!     INTEGER, PARAMETER :: NBLY=15<a name='2808'></font>
<a name='2809'>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='2810'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='2811'>
                                    its,ite, jts,jte, kts,kte<a name='2812'>
<a name='2813'>
<font color=#447700>!     REAL,    INTENT(IN)        :: TEN,HP1,HAF,ONE,FOUR,HM1EZ,SKO3R<a name='2814'></font>
      REAL,    INTENT(IN)        :: TEN,HP1,HAF,ONE,FOUR,HM1EZ<a name='2815'>
<font color=#447700>!     REAL,    INTENT(IN)        :: AB15WD,SKC1R,RADCON,QUARTR,TWO<a name='2816'></font>
      REAL,    INTENT(IN)        :: RADCON,QUARTR,TWO<a name='2817'>
      REAL,    INTENT(IN)        :: HM6666M2,HMP66667,HMP5<a name='2818'>
      REAL,    INTENT(IN)        :: HP166666,H41666M2,RADCON1,H16E1, H28E1 <a name='2819'>
<font color=#447700>!     REAL,    INTENT(IN)        :: H25E2,H44194M2,H1P41819,SKO2D<a name='2820'></font>
      REAL,    INTENT(IN)        :: H25E2,H44194M2,H1P41819<a name='2821'>
<a name='2822'>
      REAL,INTENT(IN),DIMENSION(NBLY) :: APCM,BPCM,ATPCM,BTPCM,ACOMB, &amp;<a name='2823'>
                                         BCOMB,BETACM<a name='2824'>
<a name='2825'>
<font color=#447700>!     REAL, INTENT(IN), DIMENSION(5040) :: T1,T2,T4,EM1V,EM1VW<a name='2826'></font>
<font color=#447700>!     REAL, INTENT(IN), DIMENSION(5040) :: EM3V<a name='2827'></font>
      REAL, INTENT(IN), DIMENSION(its:ite,kts:kte*2+1) :: EMPL<a name='2828'>
      REAL, INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: TOTO3,TPHIO3,TOTPHI,CNTVAL,&amp;<a name='2829'>
                                                        CO2SP1,CO2SP2   <a name='2830'>
<a name='2831'>
      REAL,    INTENT(IN),DIMENSION(its:ite,kts:kte+1,kts:kte+1) :: CLDFAC<a name='2832'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: CAMT,TOTVO2<a name='2833'>
      INTEGER, INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: KBTM,KTOP<a name='2834'>
      INTEGER, INTENT(IN), DIMENSION(its:ite)           :: NCLDS<a name='2835'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte)   :: QH2O<a name='2836'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: PRESS,TEMP<a name='2837'>
      REAL,    INTENT(OUT), DIMENSION(its:ite,kts:kte)  :: HEATRA<a name='2838'>
      REAL,    INTENT(OUT), DIMENSION(its:ite)          :: GRNFLX,TOPFLX<a name='2839'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: P,T<a name='2840'>
      REAL,    INTENT(INOUT), DIMENSION(its:ite,kts:kte+1,kts:kte+1) :: CO21<a name='2841'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte)   :: CO2NBL,DELP2, &amp;<a name='2842'>
                                                           DELP,&amp;<a name='2843'>
                                               VAR1,VAR2,VAR3,VAR4<a name='2844'>
      REAL, INTENT(IN), DIMENSION(3) :: BO3RND,AO3RND<a name='2845'>
      REAL, INTENT(IN), DIMENSION(its:ite)   :: EMX1,EMX2<a name='2846'>
      <a name='2847'>
      REAL, DIMENSION(its:ite,kts:kte*2+1) :: TPL,EMD,ALP,C,CSUB,CSUB2<a name='2848'>
      REAL, DIMENSION(its:ite,kts:kte*2+1) :: C2<a name='2849'>
      INTEGER, DIMENSION(its:ite,kts:kte+1) :: IXO<a name='2850'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: VTMP3,FXO,DT,FXOE2,DTE2, &amp;<a name='2851'>
                                            SS1,CSOUR,TC,OSS,CSS,DTC,SS2,&amp;<a name='2852'>
                                            AVEPHI,E1CTS1,E1FLX,  &amp;<a name='2853'>
                                            E1CTW1,DSORC,EMISS,FAC1,&amp;<a name='2854'>
                                            TO3SP,OVER1D,CNTTAU,TOTEVV,&amp;<a name='2855'>
                                            CO2SP,FLX,AVMO3, &amp;<a name='2856'>
                                            AVPHO3,AVVO2,CONT1D,TO31D,EMISDG,&amp;<a name='2857'>
                                            DELPR1<a name='2858'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: EMISSB,DELPR2,CONTDG,TO3DG,HEATEM,&amp;<a name='2859'>
                                            VSUM1,FLXNET,Z1<a name='2860'>
<a name='2861'>
      REAL, DIMENSION(its:ite,kts:kte+1,NBLY) :: SORC<a name='2862'>
      REAL, DIMENSION(its:ite,kts:kte)   :: E1CTS2,E1CTW2,TO3SPC,RLOG,EXCTS,&amp;<a name='2863'>
                                            CTSO3,CTS<a name='2864'>
      REAL, DIMENSION(its:ite)   :: GXCTS,FLX1E1<a name='2865'>
      REAL, DIMENSION(its:ite)   :: PTOP,PBOT,FTOP,FBOT,DELPTC<a name='2866'>
      REAL, DIMENSION(its:ite,2) :: FXOSP,DTSP,EMSPEC<a name='2867'>
<font color=#447700>!     REAL, DIMENSION(28,NBLY) :: SOURCE,DSRCE<a name='2868'></font>
      INTEGER :: K, I,KP,LLM2,J1,J3,KMAX,KMIN,KCLDS,ICNT,LLM1<a name='2869'>
      INTEGER :: L,LP1,LP2,LP3,LM1,LM2,LM3,MYIS,MYIE,LLP1,LL,KK,KLEN<a name='2870'>
<a name='2871'>
      L=kte<a name='2872'>
      LP1=L+1;  LP2=L+2;  LP3=L+3; LLP1 = 2*L + 1<a name='2873'>
      LM1=L-1;  LM2=L-2;  LM3=L-3; LL = 2*L<a name='2874'>
      LLM2 = LL-2; LLM1=LL-1<a name='2875'>
      MYIS=its; MYIE=ite<a name='2876'>
<a name='2877'>
<font color=#447700>!<a name='2878'></font>
      DO 101 K=1,LP1<a name='2879'>
      DO 101 I=MYIS,MYIE<a name='2880'>
<font color=#447700>!---TEMP. INDICES FOR E1,SOURCE<a name='2881'></font>
      VTMP3(I,K)=AINT(TEMP(I,K)*HP1)<a name='2882'>
      FXO(I,K)=VTMP3(I,K)-9.<a name='2883'>
      DT(I,K)=TEMP(I,K)-TEN*VTMP3(I,K)<a name='2884'>
<font color=#447700>!---INTEGER INDEX FOR SOURCE (USED IMMEDIATELY)<a name='2885'></font>
      IXO(I,K)=FXO(I,K)<a name='2886'>
101   CONTINUE<a name='2887'>
      DO 103 k=1,L<a name='2888'>
      DO 103 I=MYIS,MYIE<a name='2889'>
<font color=#447700>!---TEMP. INDICES FOR E2 (KP=1 LAYER NOT USED IN FLUX CALCULATIONS)<a name='2890'></font>
      VTMP3(I,K)=AINT(T(I,K+1)*HP1)<a name='2891'>
      FXOE2(I,K)=VTMP3(I,K)-9.<a name='2892'>
      DTE2(I,K)=T(I,K+1)-TEN*VTMP3(I,K)<a name='2893'>
103   CONTINUE<a name='2894'>
<font color=#447700>!---SPECIAL CASE TO HANDLE KP=LP1 LAYER AND SPECIAL E2 CALCS.<a name='2895'></font>
      DO 105 I=MYIS,MYIE<a name='2896'>
      FXOE2(I,LP1)=FXO(I,L)<a name='2897'>
      DTE2(I,LP1)=DT(I,L)<a name='2898'>
      FXOSP(I,1)=FXOE2(I,LM1)<a name='2899'>
      FXOSP(I,2)=FXO(I,LM1)<a name='2900'>
      DTSP(I,1)=DTE2(I,LM1)<a name='2901'>
      DTSP(I,2)=DT(I,LM1)<a name='2902'>
105   CONTINUE<a name='2903'>
<font color=#447700>!<a name='2904'></font>
<font color=#447700>!---SOURCE FUNCTION FOR COMBINED BAND 1<a name='2905'></font>
      DO 4114 I=MYIS,MYIE<a name='2906'>
      DO 4114 K=1,LP1<a name='2907'>
        VTMP3(I,K)=SOURCE(IXO(I,K),1)<a name='2908'>
        DSORC(I,K)=DSRCE(IXO(I,K),1)<a name='2909'>
4114   CONTINUE<a name='2910'>
      DO 4112 K=1,LP1<a name='2911'>
      DO 4112 I=MYIS,MYIE<a name='2912'>
      SORC(I,K,1)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2913'>
4112   CONTINUE<a name='2914'>
<font color=#447700>!---SOURCE FUNCTION FOR COMBINED BAND 2<a name='2915'></font>
      DO 4214 I=MYIS,MYIE<a name='2916'>
      DO 4214 K=1,LP1<a name='2917'>
        VTMP3(I,K)=SOURCE(IXO(I,K),2)<a name='2918'>
        DSORC(I,K)=DSRCE(IXO(I,K),2)<a name='2919'>
4214   CONTINUE<a name='2920'>
      DO 4212 K=1,LP1<a name='2921'>
      DO 4212 I=MYIS,MYIE<a name='2922'>
      SORC(I,K,2)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2923'>
4212   CONTINUE<a name='2924'>
<font color=#447700>!---SOURCE FUNCTION FOR COMBINED BAND 3<a name='2925'></font>
      DO 4314 I=MYIS,MYIE<a name='2926'>
      DO 4314 K=1,LP1<a name='2927'>
        VTMP3(I,K)=SOURCE(IXO(I,K),3)<a name='2928'>
        DSORC(I,K)=DSRCE(IXO(I,K),3)<a name='2929'>
4314   CONTINUE<a name='2930'>
      DO 4312 K=1,LP1<a name='2931'>
      DO 4312 I=MYIS,MYIE<a name='2932'>
      SORC(I,K,3)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2933'>
4312   CONTINUE<a name='2934'>
<font color=#447700>!---SOURCE FUNCTION FOR COMBINED BAND 4<a name='2935'></font>
      DO 4414 I=MYIS,MYIE<a name='2936'>
      DO 4414 K=1,LP1<a name='2937'>
        VTMP3(I,K)=SOURCE(IXO(I,K),4)<a name='2938'>
        DSORC(I,K)=DSRCE(IXO(I,K),4)<a name='2939'>
4414   CONTINUE<a name='2940'>
      DO 4412 K=1,LP1<a name='2941'>
      DO 4412 I=MYIS,MYIE<a name='2942'>
      SORC(I,K,4)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2943'>
4412   CONTINUE<a name='2944'>
<font color=#447700>!---SOURCE FUNCTION FOR COMBINED BAND 5<a name='2945'></font>
      DO 4514 I=MYIS,MYIE<a name='2946'>
      DO 4514 K=1,LP1<a name='2947'>
        VTMP3(I,K)=SOURCE(IXO(I,K),5)<a name='2948'>
        DSORC(I,K)=DSRCE(IXO(I,K),5)<a name='2949'>
4514   CONTINUE<a name='2950'>
      DO 4512 K=1,LP1<a name='2951'>
      DO 4512 I=MYIS,MYIE<a name='2952'>
      SORC(I,K,5)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2953'>
4512   CONTINUE<a name='2954'>
<font color=#447700>!---SOURCE FUNCTION FOR COMBINED BAND 6<a name='2955'></font>
      DO 4614 I=MYIS,MYIE<a name='2956'>
      DO 4614 K=1,LP1<a name='2957'>
        VTMP3(I,K)=SOURCE(IXO(I,K),6)<a name='2958'>
        DSORC(I,K)=DSRCE(IXO(I,K),6)<a name='2959'>
4614   CONTINUE<a name='2960'>
      DO 4612 K=1,LP1<a name='2961'>
      DO 4612 I=MYIS,MYIE<a name='2962'>
      SORC(I,K,6)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2963'>
4612   CONTINUE<a name='2964'>
<font color=#447700>!---SOURCE FUNCTION FOR COMBINED BAND 7<a name='2965'></font>
      DO 4714 I=MYIS,MYIE<a name='2966'>
      DO 4714 K=1,LP1<a name='2967'>
        VTMP3(I,K)=SOURCE(IXO(I,K),7)<a name='2968'>
        DSORC(I,K)=DSRCE(IXO(I,K),7)<a name='2969'>
4714   CONTINUE<a name='2970'>
      DO 4712 K=1,LP1<a name='2971'>
      DO 4712 I=MYIS,MYIE<a name='2972'>
      SORC(I,K,7)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2973'>
4712   CONTINUE<a name='2974'>
<font color=#447700>!---SOURCE FUNCTION FOR COMBINED BAND 8<a name='2975'></font>
      DO 4814 I=MYIS,MYIE<a name='2976'>
      DO 4814 K=1,LP1<a name='2977'>
        VTMP3(I,K)=SOURCE(IXO(I,K),8)<a name='2978'>
        DSORC(I,K)=DSRCE(IXO(I,K),8)<a name='2979'>
4814   CONTINUE<a name='2980'>
      DO 4812 K=1,LP1<a name='2981'>
      DO 4812 I=MYIS,MYIE<a name='2982'>
      SORC(I,K,8)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2983'>
4812   CONTINUE<a name='2984'>
<font color=#447700>!---SOURCE FUNCTION FOR BAND 9 (560-670 CM-1)<a name='2985'></font>
      DO 4914 I=MYIS,MYIE<a name='2986'>
      DO 4914 K=1,LP1<a name='2987'>
        VTMP3(I,K)=SOURCE(IXO(I,K),9)<a name='2988'>
        DSORC(I,K)=DSRCE(IXO(I,K),9)<a name='2989'>
4914   CONTINUE<a name='2990'>
      DO 4912 K=1,LP1<a name='2991'>
      DO 4912 I=MYIS,MYIE<a name='2992'>
      SORC(I,K,9)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='2993'>
4912   CONTINUE<a name='2994'>
<font color=#447700>!---SOURCE FUNCTION FOR BAND 10 (670-800 CM-1)<a name='2995'></font>
      DO 5014 I=MYIS,MYIE<a name='2996'>
      DO 5014 K=1,LP1<a name='2997'>
        VTMP3(I,K)=SOURCE(IXO(I,K),10)<a name='2998'>
        DSORC(I,K)=DSRCE(IXO(I,K),10)<a name='2999'>
5014  CONTINUE<a name='3000'>
      DO 5012 K=1,LP1<a name='3001'>
      DO 5012 I=MYIS,MYIE<a name='3002'>
      SORC(I,K,10)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='3003'>
5012   CONTINUE<a name='3004'>
<font color=#447700>!---SOURCE FUNCTION FOR BAND 11 (800-900 CM-1)<a name='3005'></font>
      DO 5114 I=MYIS,MYIE<a name='3006'>
      DO 5114 K=1,LP1<a name='3007'>
        VTMP3(I,K)=SOURCE(IXO(I,K),11)<a name='3008'>
        DSORC(I,K)=DSRCE(IXO(I,K),11)<a name='3009'>
5114   CONTINUE<a name='3010'>
      DO 5112 K=1,LP1<a name='3011'>
      DO 5112 I=MYIS,MYIE<a name='3012'>
      SORC(I,K,11)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='3013'>
5112   CONTINUE<a name='3014'>
<font color=#447700>!---SOURCE FUNCTION FOR BAND 12 (900-990 CM-1)<a name='3015'></font>
      DO 5214 I=MYIS,MYIE<a name='3016'>
      DO 5214 K=1,LP1<a name='3017'>
        VTMP3(I,K)=SOURCE(IXO(I,K),12)<a name='3018'>
        DSORC(I,K)=DSRCE(IXO(I,K),12)<a name='3019'>
5214   CONTINUE<a name='3020'>
      DO 5212 K=1,LP1<a name='3021'>
      DO 5212 I=MYIS,MYIE<a name='3022'>
      SORC(I,K,12)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='3023'>
5212   CONTINUE<a name='3024'>
<font color=#447700>!---SOURCE FUNCTION FOR BAND 13 (990-1070 CM-1)<a name='3025'></font>
      DO 5314 I=MYIS,MYIE<a name='3026'>
      DO 5314 K=1,LP1<a name='3027'>
        VTMP3(I,K)=SOURCE(IXO(I,K),13)<a name='3028'>
        DSORC(I,K)=DSRCE(IXO(I,K),13)<a name='3029'>
5314   CONTINUE<a name='3030'>
      DO 5312 K=1,LP1<a name='3031'>
      DO 5312 I=MYIS,MYIE<a name='3032'>
      SORC(I,K,13)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='3033'>
5312   CONTINUE<a name='3034'>
<font color=#447700>!---SOURCE FUNCTION FOR BAND 14 (1070-1200 CM-1)<a name='3035'></font>
      DO 5414 I=MYIS,MYIE<a name='3036'>
      DO 5414 K=1,LP1<a name='3037'>
        VTMP3(I,K)=SOURCE(IXO(I,K),14)<a name='3038'>
        DSORC(I,K)=DSRCE(IXO(I,K),14)<a name='3039'>
5414   CONTINUE<a name='3040'>
      DO 5412 K=1,LP1<a name='3041'>
      DO 5412 I=MYIS,MYIE<a name='3042'>
      SORC(I,K,14)=VTMP3(I,K)+DT(I,K)*DSORC(I,K)<a name='3043'>
5412   CONTINUE<a name='3044'>
<font color=#447700>!<a name='3045'></font>
<font color=#447700>!        THE FOLLOWING SUBROUTINE OBTAINS NLTE SOURCE FUNCTION FOR CO2<a name='3046'></font>
<font color=#447700>!<a name='3047'></font>
<font color=#447700>!<a name='3048'></font>
<font color=#447700>!     CALL NLTE<a name='3049'></font>
<font color=#447700>!<a name='3050'></font>
<font color=#447700>!<a name='3051'></font>
<font color=#447700>!---OBTAIN SPECIAL SOURCE FUNCTIONS FOR THE 15 UM BAND (CSOUR)<a name='3052'></font>
<font color=#447700>!   AND THE WINDOW REGION (SS1)<a name='3053'></font>
      DO 131 K=1,LP1<a name='3054'>
      DO 131 I=MYIS,MYIE<a name='3055'>
      SS1(I,K)=SORC(I,K,11)+SORC(I,K,12)+SORC(I,K,14)<a name='3056'>
131   CONTINUE<a name='3057'>
      DO 143 K=1,LP1<a name='3058'>
      DO 143 I=MYIS,MYIE<a name='3059'>
      CSOUR(I,K)=SORC(I,K,9)+SORC(I,K,10)<a name='3060'>
143   CONTINUE<a name='3061'>
<font color=#447700>!<a name='3062'></font>
<font color=#447700>!---COMPUTE TEMP**4 (TC) AND VERTICAL TEMPERATURE DIFFERENCES<a name='3063'></font>
<font color=#447700>!   (OSS,CSS,SS2,DTC). ALL THESE WILL BE USED LATER IN FLUX COMPUTA-<a name='3064'></font>
<font color=#447700>!   TIONS.<a name='3065'></font>
<font color=#447700>!<a name='3066'></font>
      DO 901 K=1,LP1<a name='3067'>
      DO 901 I=MYIS,MYIE<a name='3068'>
      TC(I,K)=(TEMP(I,K)*TEMP(I,K))**2<a name='3069'>
901   CONTINUE<a name='3070'>
      DO 903 K=1,L<a name='3071'>
      DO 903 I=MYIS,MYIE<a name='3072'>
      OSS(I,K+1)=SORC(I,K+1,13)-SORC(I,K,13)<a name='3073'>
      CSS(I,K+1)=CSOUR(I,K+1)-CSOUR(I,K)<a name='3074'>
      DTC(I,K+1)=TC(I,K+1)-TC(I,K)<a name='3075'>
      SS2(I,K+1)=SS1(I,K+1)-SS1(I,K)<a name='3076'>
903   CONTINUE<a name='3077'>
<font color=#447700>!<a name='3078'></font>
<font color=#447700>!<a name='3079'></font>
<font color=#447700>!---THE FOLLOWIMG IS A DRASTIC REWRITE OF THE RADIATION CODE TO<a name='3080'></font>
<font color=#447700>!    (LARGELY) ELIMINATE THREE-DIMENSIONAL ARRAYS. THE CODE WORKS<a name='3081'></font>
<font color=#447700>!    ON THE FOLLOWING PRINCIPLES:<a name='3082'></font>
<font color=#447700>!<a name='3083'></font>
<font color=#447700>!          LET K = FIXED FLUX LEVEL, KP = VARYING FLUX LEVEL<a name='3084'></font>
<font color=#447700>!          THEN FLUX(K)=SUM OVER KP : (DELTAB(KP)*TAU(KP,K))<a name='3085'></font>
<font color=#447700>!               OVER ALL KP'S, FROM 1 TO LP1.<a name='3086'></font>
<font color=#447700>!<a name='3087'></font>
<font color=#447700>!          WE CAN BREAK DOWN THE CALCULATIONS FOR ALL K'S AS FOLLOWS:<a name='3088'></font>
<font color=#447700>!<a name='3089'></font>
<font color=#447700>!          FOR ALL K'S K=1 TO LP1:<a name='3090'></font>
<font color=#447700>!              FLUX(K)=SUM OVER KP : (DELTAB(KP)*TAU(KP,K))  (1)<a name='3091'></font>
<font color=#447700>!                      OVER ALL KP'S, FROM K+1 TO LP1<a name='3092'></font>
<font color=#447700>!          AND<a name='3093'></font>
<font color=#447700>!              FOR KP FROM K+1 TO LP1:<a name='3094'></font>
<font color=#447700>!                 FLUX(KP) = DELTAB(K)*TAU(K,KP)              (2)<a name='3095'></font>
<font color=#447700>!<a name='3096'></font>
<font color=#447700>!          NOW IF TAU(K,KP)=TAU(KP,K) (SYMMETRICAL ARRAYS)<a name='3097'></font>
<font color=#447700>!          WE CAN COMPUTE A 1-DIMENSIONAL ARRAY TAU1D(KP) FROM<a name='3098'></font>
<font color=#447700>!          K+1 TO LP1, EACH TIME K IS INCREMENTED.<a name='3099'></font>
<font color=#447700>!          EQUATIONS (1) AND (2) THEN BECOME:<a name='3100'></font>
<font color=#447700>!<a name='3101'></font>
<font color=#447700>!             TAU1D(KP) = (VALUES FOR TAU(KP,K) AT THE PARTICULAR K)<a name='3102'></font>
<font color=#447700>!             FLUX(K) = SUM OVER KP : (DELTAB(KP)*TAU1D(KP))   (3)<a name='3103'></font>
<font color=#447700>!             FLUX(KP) = DELTAB(K)*TAU1D(KP)                   (4)<a name='3104'></font>
<font color=#447700>!<a name='3105'></font>
<font color=#447700>!         THE TERMS FOR TAU (K,K) AND OTHER SPECIAL TERMS (FOR<a name='3106'></font>
<font color=#447700>!         NEARBY LAYERS) MUST, OF COURSE, BE HANDLED SEPARATELY, AND<a name='3107'></font>
<font color=#447700>!         WITH CARE.<a name='3108'></font>
<font color=#447700>!<a name='3109'></font>
<font color=#447700>!      COMPUTE "UPPER TRIANGLE" TRANSMISSION FUNCTIONS FOR<a name='3110'></font>
<font color=#447700>!      THE 9.6 UM BAND (TO3SP) AND THE 15 UM BAND (OVER1D). ALSO,<a name='3111'></font>
<font color=#447700>!      THE<a name='3112'></font>
<font color=#447700>!      STAGE 1...COMPUTE O3 ,OVER TRANSMISSION FCTNS AND AVEPHI<a name='3113'></font>
<font color=#447700>!---DO K=1 CALCULATION (FROM FLUX LAYER KK TO THE TOP) SEPARATELY<a name='3114'></font>
<font color=#447700>!   AS VECTORIZATION IS IMPROVED,AND OZONE CTS TRANSMISSIVITY<a name='3115'></font>
<font color=#447700>!   MAY BE EXTRACTED HERE.<a name='3116'></font>
      DO 3021 K=1,L<a name='3117'>
      DO 3021 I=MYIS,MYIE<a name='3118'>
      AVEPHI(I,K)=TOTPHI(I,K+1)<a name='3119'>
3021  CONTINUE<a name='3120'>
<font color=#447700>!---IN ORDER TO PROPERLY EVALUATE EMISS INTEGRATED OVER THE (LP1)<a name='3121'></font>
<font color=#447700>!   LAYER, A SPECIAL EVALUATION OF EMISS IS DONE. THIS REQUIRES<a name='3122'></font>
<font color=#447700>!   A SPECIAL COMPUTATION OF AVEPHI, AND IT IS STORED IN THE<a name='3123'></font>
<font color=#447700>!   (OTHERWISE VACANT) LP1'TH POSITION<a name='3124'></font>
<font color=#447700>!<a name='3125'></font>
      DO 803 I=MYIS,MYIE<a name='3126'>
      AVEPHI(I,LP1)=AVEPHI(I,LM1)+EMX1(I)<a name='3127'>
803   CONTINUE<a name='3128'>
<font color=#447700>!   COMPUTE FLUXES FOR K=1<a name='3129'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#E1E290'>E1E290</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#FST88' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="E1E290_1">(E1CTS1,E1CTS2,E1FLX,E1CTW1,E1CTW2,EMISS, &amp;<a name='3130'>
                  FXO,DT,FXOE2,DTE2,AVEPHI,TEMP,T,         &amp;<a name='3131'>
<font color=#447700>!                 T1,T2,T4 ,EM1V,EM1VW,                    &amp;<a name='3132'></font>
                  H16E1,TEN,HP1,H28E1,HAF,                 &amp;<a name='3133'>
                  ids,ide, jds,jde, kds,kde,               &amp;<a name='3134'>
                  ims,ime, jms,jme, kms,kme,               &amp;<a name='3135'>
                  its,ite, jts,jte, kts,kte                )<a name='3136'>
<a name='3137'>
      DO 302 K=1,L<a name='3138'>
      DO 302 I=MYIS,MYIE<a name='3139'>
      FAC1(I,K)=BO3RND(2)*TPHIO3(I,K+1)/TOTO3(I,K+1)<a name='3140'>
      TO3SPC(I,K)=HAF*(FAC1(I,K)* &amp;<a name='3141'>
          (SQRT(ONE+(FOUR*AO3RND(2)*TOTO3(I,K+1))/FAC1(I,K))-ONE))<a name='3142'>
<font color=#447700>!   FOR K=1, TO3SP IS USED INSTEAD OF TO31D (THEY ARE EQUAL IN THIS<a name='3143'></font>
<font color=#447700>!   CASE); TO3SP IS PASSED TO SPA90, WHILE TO31D IS A WORK-ARRAY.<a name='3144'></font>
      TO3SP(I,K)=EXP(HM1EZ*(TO3SPC(I,K)+SKO3R*TOTVO2(I,K+1)))<a name='3145'>
      OVER1D(I,K)=EXP(HM1EZ*(SQRT(AB15WD*TOTPHI(I,K+1))+ &amp;<a name='3146'>
                  SKC1R*TOTVO2(I,K+1)))<a name='3147'>
<font color=#447700>!---BECAUSE ALL CONTINUUM TRANSMISSIVITIES ARE OBTAINED FROM THE<a name='3148'></font>
<font color=#447700>!  2-D QUANTITY CNTTAU (AND ITS RECIPROCAL TOTEVV) WE STORE BOTH<a name='3149'></font>
<font color=#447700>!  OF THESE HERE. FOR K=1, CONT1D EQUALS CNTTAU<a name='3150'></font>
      CNTTAU(I,K)=EXP(HM1EZ*TOTVO2(I,K+1))<a name='3151'>
      TOTEVV(I,K)=1./CNTTAU(I,K)<a name='3152'>
302   CONTINUE<a name='3153'>
      DO 3022 K=1,L<a name='3154'>
      DO 3022 I=MYIS,MYIE<a name='3155'>
      CO2SP(I,K+1)=OVER1D(I,K)*CO21(I,1,K+1)<a name='3156'>
3022  CONTINUE<a name='3157'>
      DO 3023 K=1,L<a name='3158'>
      DO 3023 I=MYIS,MYIE<a name='3159'>
      CO21(I,K+1,1)=CO21(I,K+1,1)*OVER1D(I,K)<a name='3160'>
3023  CONTINUE<a name='3161'>
<font color=#447700>!---RLOG IS THE NBL AMOUNT FOR THE 15 UM BAND CALCULATION<a name='3162'></font>
      DO 1808 I=MYIS,MYIE<a name='3163'>
      RLOG(I,1)=OVER1D(I,1)*CO2NBL(I,1)<a name='3164'>
1808  CONTINUE<a name='3165'>
<font color=#447700>!---THE TERMS WHEN KP=1 FOR ALL K ARE THE PHOTON EXCHANGE WITH<a name='3166'></font>
<font color=#447700>!   THE TOP OF THE ATMOSPHERE, AND ARE OBTAINED DIFFERENTLY THAN<a name='3167'></font>
<font color=#447700>!   THE OTHER CALCULATIONS<a name='3168'></font>
      DO 305 K=2,LP1<a name='3169'>
      DO 305 I=MYIS,MYIE<a name='3170'>
      FLX(I,K)= (TC(I,1)*E1FLX(I,K) &amp;<a name='3171'>
                +SS1(I,1)*CNTTAU(I,K-1) &amp;<a name='3172'>
                +SORC(I,1,13)*TO3SP(I,K-1) &amp;<a name='3173'>
                +CSOUR(I,1)*CO2SP(I,K)) &amp;<a name='3174'>
                *CLDFAC(I,1,K)<a name='3175'>
305   CONTINUE<a name='3176'>
      DO 307 I=MYIS,MYIE<a name='3177'>
      FLX(I,1)= TC(I,1)*E1FLX(I,1)+SS1(I,1)+SORC(I,1,13) &amp;<a name='3178'>
                +CSOUR(I,1)<a name='3179'>
307   CONTINUE<a name='3180'>
<font color=#447700>!---THE KP TERMS FOR K=1...<a name='3181'></font>
      DO 303 KP=2,LP1<a name='3182'>
      DO 303 I=MYIS,MYIE<a name='3183'>
      FLX(I,1)=FLX(I,1)+(OSS(I,KP)*TO3SP(I,KP-1) &amp;<a name='3184'>
                        +SS2(I,KP)*CNTTAU(I,KP-1) &amp;<a name='3185'>
                        +CSS(I,KP)*CO21(I,KP,1) &amp;<a name='3186'>
                        +DTC(I,KP)*EMISS(I,KP-1))*CLDFAC(I,KP,1)<a name='3187'>
303   CONTINUE<a name='3188'>
<font color=#447700>!          SUBROUTINE SPA88 IS CALLED TO OBTAIN EXACT CTS FOR WATER<a name='3189'></font>
<font color=#447700>!     CO2 AND O3, AND APPROXIMATE CTS CO2 AND O3 CALCULATIONS.<a name='3190'></font>
<font color=#447700>!<a name='3191'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#SPA88'>SPA88</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#FST88' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPA88_1">(EXCTS,CTSO3,GXCTS,SORC,CSOUR, &amp;<a name='3192'>
                 CLDFAC,TEMP,PRESS,VAR1,VAR2, &amp;<a name='3193'>
                 P,DELP,DELP2,TOTVO2,TO3SP,TO3SPC, &amp;<a name='3194'>
                 CO2SP1,CO2SP2,CO2SP,              &amp;<a name='3195'>
                 APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='3196'>
                 H25E2,ONE,H44194M2,H1P41819,HAF,HM1EZ,TWO,    &amp;<a name='3197'>
<font color=#447700>!                SKO2D,RADCON,                                 &amp;<a name='3198'></font>
                 RADCON,                                 &amp;<a name='3199'>
                 ids,ide, jds,jde, kds,kde,                    &amp;<a name='3200'>
                 ims,ime, jms,jme, kms,kme,                    &amp;<a name='3201'>
                 its,ite, jts,jte, kts,kte                     )<a name='3202'>
<a name='3203'>
<font color=#447700>!<a name='3204'></font>
<font color=#447700>!    THIS SECTION COMPUTES THE EMISSIVITY CTS HEATING RATES FOR 2<a name='3205'></font>
<font color=#447700>!    EMISSIVITY BANDS: THE 0-160,1200-2200 CM-1 BAND AND THE 800-<a name='3206'></font>
<font color=#447700>!    990,1070-1200 CM-1 BAND. THE REMAINING CTS COMTRIBUTIONS ARE<a name='3207'></font>
<font color=#447700>!    CONTAINED IN CTSO3, COMPUTED IN SPA88.<a name='3208'></font>
<font color=#447700>!<a name='3209'></font>
      DO 998 I=MYIS,MYIE<a name='3210'>
      VTMP3(I,1)=1.<a name='3211'>
998   CONTINUE<a name='3212'>
      DO 999 K=1,L<a name='3213'>
      DO 999 I=MYIS,MYIE<a name='3214'>
      VTMP3(I,K+1)=CNTTAU(I,K)*CLDFAC(I,K+1,1)<a name='3215'>
999   CONTINUE<a name='3216'>
      DO 1001 K=1,L<a name='3217'>
      DO 1001 I=MYIS,MYIE<a name='3218'>
      CTS(I,K)=RADCON*DELP(I,K)*(TC(I,K)* &amp;<a name='3219'>
           (E1CTW2(I,K)*CLDFAC(I,K+1,1)-E1CTW1(I,K)*CLDFAC(I,K,1)) + &amp;<a name='3220'>
            SS1(I,K)*(VTMP3(I,K+1)-VTMP3(I,K)))<a name='3221'>
1001  CONTINUE<a name='3222'>
<font color=#447700>!<a name='3223'></font>
      DO 1011 K=1,L<a name='3224'>
      DO 1011 I=MYIS,MYIE<a name='3225'>
      VTMP3(I,K)=TC(I,K)*(CLDFAC(I,K,1)*(E1CTS1(I,K)-E1CTW1(I,K)) - &amp;<a name='3226'>
                        CLDFAC(I,K+1,1)*(E1CTS2(I,K)-E1CTW2(I,K)))<a name='3227'>
1011  CONTINUE<a name='3228'>
      DO 1012 I=MYIS,MYIE<a name='3229'>
      FLX1E1(I)=TC(I,LP1)*CLDFAC(I,LP1,1)* &amp;<a name='3230'>
                (E1CTS1(I,LP1)-E1CTW1(I,LP1))<a name='3231'>
1012  CONTINUE<a name='3232'>
      DO 1014 K=1,L<a name='3233'>
      DO 1013 I=MYIS,MYIE<a name='3234'>
      FLX1E1(I)=FLX1E1(I)+VTMP3(I,K)<a name='3235'>
1013  CONTINUE<a name='3236'>
1014  CONTINUE<a name='3237'>
<font color=#447700>!<a name='3238'></font>
<font color=#447700>!---NOW REPEAT FLUX CALCULATIONS FOR THE K=2..LM1  CASES.<a name='3239'></font>
<font color=#447700>!   CALCULATIONS FOR FLUX LEVEL L AND LP1 ARE DONE SEPARATELY, AS ALL<a name='3240'></font>
<font color=#447700>!   EMISSIVITY AND CO2 CALCULATIONS ARE SPECIAL CASES OR NEARBY LAYERS.<a name='3241'></font>
<font color=#447700>!<a name='3242'></font>
      DO 321 K=2,LM1<a name='3243'>
      KLEN=K<a name='3244'>
<font color=#447700>!<a name='3245'></font>
      DO 3218 KK=1,LP1-K<a name='3246'>
      DO 3218 I=MYIS,MYIE<a name='3247'>
      AVEPHI(I,KK+K-1)=TOTPHI(I,KK+K)-TOTPHI(I,K)<a name='3248'>
3218  CONTINUE<a name='3249'>
      DO 1803 I=MYIS,MYIE<a name='3250'>
      AVEPHI(I,LP1)=AVEPHI(I,LM1)+EMX1(I)<a name='3251'>
1803   CONTINUE<a name='3252'>
<font color=#447700>!---COMPUTE EMISSIVITY FLUXES (E2) FOR THIS CASE. NOTE THAT<a name='3253'></font>
<font color=#447700>!   WE HAVE OMITTED THE NEARBY LATER CASE (EMISS(I,K,K)) AS WELL<a name='3254'></font>
<font color=#447700>!   AS ALL CASES WITH K=L OR LP1. BUT THESE CASES HAVE ALWAYS<a name='3255'></font>
<font color=#447700>!   BEEN HANDLED AS SPECIAL CASES, SO WE MAY AS WELL COMPUTE<a name='3256'></font>
<font color=#447700>!    THEIR FLUXES SEPARASTELY.<a name='3257'></font>
<font color=#447700>!<a name='3258'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#E290'>E290</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#FST88' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="E290_1">(EMISSB,EMISS,AVEPHI,KLEN,FXOE2,DTE2,  &amp;<a name='3259'>
<font color=#447700>!                      T1,T2,T4,                      &amp;<a name='3260'></font>
                       H16E1,HP1,H28E1,HAF,TEN,       &amp;<a name='3261'>
                       ids,ide, jds,jde, kds,kde,     &amp;<a name='3262'>
                       ims,ime, jms,jme, kms,kme,     &amp;<a name='3263'>
                       its,ite, jts,jte, kts,kte      )<a name='3264'>
<a name='3265'>
      DO 322 KK=1,LP1-K<a name='3266'>
      DO 322 I=MYIS,MYIE<a name='3267'>
      AVMO3(I,KK+K-1)=TOTO3(I,KK+K)-TOTO3(I,K)<a name='3268'>
      AVPHO3(I,KK+K-1)=TPHIO3(I,KK+K)-TPHIO3(I,K)<a name='3269'>
      AVVO2(I,KK+K-1)=TOTVO2(I,KK+K)-TOTVO2(I,K)<a name='3270'>
      CONT1D(I,KK+K-1)=CNTTAU(I,KK+K-1)*TOTEVV(I,K-1)<a name='3271'>
322   CONTINUE<a name='3272'>
<font color=#447700>!<a name='3273'></font>
      DO 3221 KK=1,LP1-K<a name='3274'>
      DO 3221 I=MYIS,MYIE<a name='3275'>
      FAC1(I,K+KK-1)=BO3RND(2)*AVPHO3(I,K+KK-1)/AVMO3(I,K+KK-1)<a name='3276'>
      VTMP3(I,K+KK-1)=HAF*(FAC1(I,K+KK-1)* &amp;<a name='3277'>
        (SQRT(ONE+(FOUR*AO3RND(2)*AVMO3(I,K+KK-1))/ &amp;<a name='3278'>
         FAC1(I,K+KK-1))-ONE))<a name='3279'>
      TO31D(I,K+KK-1)=EXP(HM1EZ*(VTMP3(I,K+KK-1) &amp;<a name='3280'>
                         +SKO3R*AVVO2(I,K+KK-1)))<a name='3281'>
      OVER1D(I,K+KK-1)=EXP(HM1EZ*(SQRT(AB15WD*AVEPHI(I,K+KK-1))+ &amp;<a name='3282'>
                  SKC1R*AVVO2(I,K+KK-1)))<a name='3283'>
      CO21(I,K+KK,K)=OVER1D(I,K+KK-1)*CO21(I,K+KK,K)<a name='3284'>
3221  CONTINUE<a name='3285'>
      DO 3223 KP=K+1,LP1<a name='3286'>
      DO 3223 I=MYIS,MYIE<a name='3287'>
      CO21(I,K,KP)=OVER1D(I,KP-1)*CO21(I,K,KP)<a name='3288'>
3223  CONTINUE<a name='3289'>
<font color=#447700>!---RLOG IS THE NBL AMOUNT FOR THE 15 UM BAND CALCULATION<a name='3290'></font>
      DO 1804 I=MYIS,MYIE<a name='3291'>
      RLOG(I,K)=OVER1D(I,K)*CO2NBL(I,K)<a name='3292'>
1804  CONTINUE<a name='3293'>
<font color=#447700>!---THE KP TERMS FOR ARBIRRARY K..<a name='3294'></font>
      DO 3423 KP=K+1,LP1<a name='3295'>
      DO 3423 I=MYIS,MYIE<a name='3296'>
      FLX(I,K)=FLX(I,K)+(OSS(I,KP)*TO31D(I,KP-1) &amp;<a name='3297'>
                        +SS2(I,KP)*CONT1D(I,KP-1) &amp;<a name='3298'>
                        +CSS(I,KP)*CO21(I,KP,K) &amp;<a name='3299'>
                        +DTC(I,KP)*EMISS(I,KP-1))*CLDFAC(I,KP,K)<a name='3300'>
3423  CONTINUE<a name='3301'>
      DO 3425 KP=K+1,LP1<a name='3302'>
      DO 3425 I=MYIS,MYIE<a name='3303'>
      FLX(I,KP)=FLX(I,KP)+(OSS(I,K)*TO31D(I,KP-1) &amp;<a name='3304'>
                         +SS2(I,K)*CONT1D(I,KP-1) &amp;<a name='3305'>
                         +CSS(I,K)*CO21(I,K,KP) &amp;<a name='3306'>
                         +DTC(I,K)*EMISSB(I,KP-1))*CLDFAC(I,K,KP)<a name='3307'>
3425  CONTINUE<a name='3308'>
321   CONTINUE<a name='3309'>
<font color=#447700>!<a name='3310'></font>
      DO 821 I=MYIS,MYIE<a name='3311'>
      TPL(I,1)=TEMP(I,L)<a name='3312'>
      TPL(I,LP1)=HAF*(T(I,LP1)+TEMP(I,L))<a name='3313'>
      TPL(I,LLP1)=HAF*(T(I,L)+TEMP(I,L))<a name='3314'>
821   CONTINUE<a name='3315'>
      DO 823 K=2,L<a name='3316'>
      DO 823 I=MYIS,MYIE<a name='3317'>
      TPL(I,K)=T(I,K)<a name='3318'>
      TPL(I,K+L)=T(I,K)<a name='3319'>
823   CONTINUE<a name='3320'>
<font color=#447700>!<a name='3321'></font>
<font color=#447700>!---E2 FUNCTIONS ARE REQUIRED IN THE NBL CALCULATIONS FOR 2 CASES,<a name='3322'></font>
<font color=#447700>!   DENOTED (IN OLD CODE) AS (L,LP1) AND (LP1,LP1)<a name='3323'></font>
      DO 833 I=MYIS,MYIE<a name='3324'>
      AVEPHI(I,1)=VAR2(I,L)<a name='3325'>
      AVEPHI(I,2)=VAR2(I,L)+EMPL(I,L)<a name='3326'>
833   CONTINUE<a name='3327'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#E2SPEC'>E2SPEC</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#FST88' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="E2SPEC_1">(EMISS,AVEPHI,FXOSP,DTSP,                          &amp;<a name='3328'>
<font color=#447700>!                     T1,T2,T4, &amp;<a name='3329'></font>
                      H16E1,TEN,H28E1,HP1,                          &amp;<a name='3330'>
                      ids,ide, jds,jde, kds,kde,                    &amp;<a name='3331'>
                      ims,ime, jms,jme, kms,kme,                    &amp;<a name='3332'>
                      its,ite, jts,jte, kts,kte                     )<a name='3333'>
<a name='3334'>
<font color=#447700>!<a name='3335'></font>
<font color=#447700>!     CALL E3V88 FOR NBL H2O TRANSMISSIVITIES<a name='3336'></font>
<font color=#447700>!          CALL E3V88(EMD,TPL,EMPL,EM3V, &amp;<a name='3337'></font>
           CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#E3V88'>E3V88</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#FST88' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="E3V88_1">(EMD,TPL,EMPL, &amp;<a name='3338'>
                      TEN,HP1,H28E1,H16E1,  &amp;<a name='3339'>
                      ids,ide, jds,jde, kds,kde,                    &amp;<a name='3340'>
                      ims,ime, jms,jme, kms,kme,                    &amp;<a name='3341'>
                      its,ite, jts,jte, kts,kte                     )<a name='3342'>
<font color=#447700>!<a name='3343'></font>
<font color=#447700>!   COMPUTE NEARBY LAYER AND SPECIAL-CASE TRANSMISSIVITIES FOR EMISS<a name='3344'></font>
<font color=#447700>!    USING METHODS FOR H2O GIVEN IN REF. (4)<a name='3345'></font>
      DO 851 K=2,L<a name='3346'>
      DO 851 I=MYIS,MYIE<a name='3347'>
      EMISDG(I,K)=EMD(I,K+L)+EMD(I,K)<a name='3348'>
851   CONTINUE<a name='3349'>
<font color=#447700>!<a name='3350'></font>
<font color=#447700>!   NOTE THAT EMX1/2 (PRESSURE SCALED PATHS) ARE NOW COMPUTED IN<a name='3351'></font>
<font color=#447700>!   LWR88<a name='3352'></font>
      DO 861 I=MYIS,MYIE<a name='3353'>
      EMSPEC(I,1)=(EMD(I,1)*EMPL(I,1)-EMD(I,LP1)*EMPL(I,LP1))/ &amp;<a name='3354'>
       EMX1(I) + QUARTR*(EMISS(I,1)+EMISS(I,2))<a name='3355'>
      EMISDG(I,LP1)=TWO*EMD(I,LP1)<a name='3356'>
      EMSPEC(I,2)=TWO*(EMD(I,1)*EMPL(I,1)-EMD(I,LLP1)*EMPL(I,LLP1))/ &amp;<a name='3357'>
       EMX2(I)<a name='3358'>
861   CONTINUE<a name='3359'>
      DO 331 I=MYIS,MYIE<a name='3360'>
      FAC1(I,L)=BO3RND(2)*VAR4(I,L)/VAR3(I,L)<a name='3361'>
      VTMP3(I,L)=HAF*(FAC1(I,L)* &amp;<a name='3362'>
          (SQRT(ONE+(FOUR*AO3RND(2)*VAR3(I,L))/FAC1(I,L))-ONE))<a name='3363'>
      TO31D(I,L)=EXP(HM1EZ*(VTMP3(I,L)+SKO3R*CNTVAL(I,L)))<a name='3364'>
      OVER1D(I,L)=EXP(HM1EZ*(SQRT(AB15WD*VAR2(I,L))+ &amp;<a name='3365'>
                  SKC1R*CNTVAL(I,L)))<a name='3366'>
      CONT1D(I,L)=CNTTAU(I,L)*TOTEVV(I,LM1)<a name='3367'>
      RLOG(I,L)=OVER1D(I,L)*CO2NBL(I,L)<a name='3368'>
331   CONTINUE<a name='3369'>
      DO 618 K=1,L<a name='3370'>
      DO 618 I=MYIS,MYIE<a name='3371'>
      RLOG(I,K)=LOG(RLOG(I,K))<a name='3372'>
618   CONTINUE<a name='3373'>
      DO 601 K=1,LM1<a name='3374'>
      DO 601 I=MYIS,MYIE<a name='3375'>
      DELPR1(I,K+1)=DELP(I,K+1)*(PRESS(I,K+1)-P(I,K+1))<a name='3376'>
      ALP(I,LP1+K-1)=-SQRT(DELPR1(I,K+1))*RLOG(I,K+1)<a name='3377'>
601   CONTINUE<a name='3378'>
      DO 603 K=1,L<a name='3379'>
      DO 603 I=MYIS,MYIE<a name='3380'>
      DELPR2(I,K+1)=DELP(I,K)*(P(I,K+1)-PRESS(I,K))<a name='3381'>
      ALP(I,K)=-SQRT(DELPR2(I,K+1))*RLOG(I,K)<a name='3382'>
603   CONTINUE<a name='3383'>
      DO 625 I=MYIS,MYIE<a name='3384'>
      ALP(I,LL)=-RLOG(I,L)<a name='3385'>
      ALP(I,LLP1)=-RLOG(I,L)*SQRT(DELP(I,L)*(P(I,LP1)-PRESS(I,LM1)))<a name='3386'>
625   CONTINUE<a name='3387'>
<font color=#447700>!        THE FIRST COMPUTATION IS FOR THE 15 UM BAND,WITH THE<a name='3388'></font>
<font color=#447700>!     FOR THE COMBINED H2O AND CO2 TRANSMISSION FUNCTION.<a name='3389'></font>
<font color=#447700>!<a name='3390'></font>
<font color=#447700>!       PERFORM NBL COMPUTATIONS FOR THE 15 UM BAND<a name='3391'></font>
<font color=#447700>!***THE STATEMENT FUNCTION SF IN PREV. VERSIONS IS NOW EXPLICITLY<a name='3392'></font>
<font color=#447700>!   EVALUATED.<a name='3393'></font>
      DO 631 K=1,LLP1<a name='3394'>
      DO 631 I=MYIS,MYIE<a name='3395'>
      C(I,K)=ALP(I,K)*(HMP66667+ALP(I,K)*(QUARTR+ALP(I,K)*HM6666M2))<a name='3396'>
631   CONTINUE<a name='3397'>
      DO 641 I=MYIS,MYIE<a name='3398'>
      CO21(I,LP1,LP1)=ONE+C(I,L)<a name='3399'>
      CO21(I,LP1,L)=ONE+(DELP2(I,L)*C(I,LL)-(PRESS(I,L)-P(I,L))* &amp;<a name='3400'>
       C(I,LLM1))/(P(I,LP1)-PRESS(I,L))<a name='3401'>
      CO21(I,L,LP1)=ONE+((P(I,LP1)-PRESS(I,LM1))*C(I,LLP1)- &amp;<a name='3402'>
       (P(I,LP1)-PRESS(I,L))*C(I,L))/(PRESS(I,L)-PRESS(I,LM1))<a name='3403'>
641   CONTINUE<a name='3404'>
      DO 643 K=2,L<a name='3405'>
      DO 643 I=MYIS,MYIE<a name='3406'>
      CO21(I,K,K)=ONE+HAF*(C(I,LM1+K)+C(I,K-1))<a name='3407'>
643   CONTINUE<a name='3408'>
<font color=#447700>!<a name='3409'></font>
<font color=#447700>!    COMPUTE NEARBY-LAYER TRANSMISSIVITIES FOR THE O3 BAND AND FOR THE<a name='3410'></font>
<font color=#447700>!    ONE-BAND CONTINUUM BAND (TO3 AND EMISS2). THE SF2 FUNCTION IS<a name='3411'></font>
<font color=#447700>!    USED. THE METHOD IS THE SAME AS DESCRIBED FOR CO2 IN REF (4).<a name='3412'></font>
      DO 651 K=1,LM1<a name='3413'>
      DO 651 I=MYIS,MYIE<a name='3414'>
      CSUB(I,K+1)=CNTVAL(I,K+1)*DELPR1(I,K+1)<a name='3415'>
      CSUB(I,LP1+K-1)=CNTVAL(I,K)*DELPR2(I,K+1)<a name='3416'>
651   CONTINUE<a name='3417'>
<font color=#447700>!---THE SF2 FUNCTION IN PREV. VERSIONS IS NOW EXPLICITLY EVALUATED<a name='3418'></font>
      DO 655 K=1,LLM2<a name='3419'>
      DO 655 I=MYIS,MYIE<a name='3420'>
      CSUB2(I,K+1)=SKO3R*CSUB(I,K+1)<a name='3421'>
      C(I,K+1)=CSUB(I,K+1)*(HMP5+CSUB(I,K+1)* &amp;<a name='3422'>
                (HP166666-CSUB(I,K+1)*H41666M2))<a name='3423'>
      C2(I,K+1)=CSUB2(I,K+1)*(HMP5+CSUB2(I,K+1)* &amp;<a name='3424'>
                 (HP166666-CSUB2(I,K+1)*H41666M2))<a name='3425'>
655   CONTINUE<a name='3426'>
      DO 661 I=MYIS,MYIE<a name='3427'>
      CONTDG(I,LP1)=1.+C(I,LLM1)<a name='3428'>
      TO3DG(I,LP1)=1.+C2(I,LLM1)<a name='3429'>
661   CONTINUE<a name='3430'>
      DO 663 K=2,L<a name='3431'>
      DO 663 I=MYIS,MYIE<a name='3432'>
      CONTDG(I,K)=ONE+HAF*(C(I,K)+C(I,LM1+K))<a name='3433'>
      TO3DG(I,K)=ONE+HAF*(C2(I,K)+C2(I,LM1+K))<a name='3434'>
663   CONTINUE<a name='3435'>
<font color=#447700>!---NOW OBTAIN FLUXES<a name='3436'></font>
<font color=#447700>!<a name='3437'></font>
<font color=#447700>!    FOR THE DIAGONAL TERMS...<a name='3438'></font>
      DO 871 K=2,LP1<a name='3439'>
      DO 871 I=MYIS,MYIE<a name='3440'>
      FLX(I,K)=FLX(I,K)+(DTC(I,K)*EMISDG(I,K) &amp;<a name='3441'>
                       +SS2(I,K)*CONTDG(I,K) &amp;<a name='3442'>
                       +OSS(I,K)*TO3DG(I,K) &amp;<a name='3443'>
                       +CSS(I,K)*CO21(I,K,K))*CLDFAC(I,K,K)<a name='3444'>
871   CONTINUE<a name='3445'>
<font color=#447700>!     FOR THE TWO OFF-DIAGONAL TERMS...<a name='3446'></font>
      DO 873 I=MYIS,MYIE<a name='3447'>
      FLX(I,L)=FLX(I,L)+(CSS(I,LP1)*CO21(I,LP1,L) &amp;<a name='3448'>
                        +DTC(I,LP1)*EMSPEC(I,2) &amp;<a name='3449'>
                        +OSS(I,LP1)*TO31D(I,L) &amp;<a name='3450'>
                        +SS2(I,LP1)*CONT1D(I,L))*CLDFAC(I,LP1,L)<a name='3451'>
      FLX(I,LP1)=FLX(I,LP1)+(CSS(I,L)*CO21(I,L,LP1) &amp;<a name='3452'>
                            +OSS(I,L)*TO31D(I,L) &amp;<a name='3453'>
                            +SS2(I,L)*CONT1D(I,L) &amp;<a name='3454'>
                            +DTC(I,L)*EMSPEC(I,1))*CLDFAC(I,L,LP1)<a name='3455'>
873   CONTINUE<a name='3456'>
<font color=#447700>!<a name='3457'></font>
<font color=#447700>!     FINAL SECTION OBTAINS EMISSIVITY HEATING RATES,<a name='3458'></font>
<font color=#447700>!     TOTAL HEATING RATES AND THE FLUX AT THE GROUND<a name='3459'></font>
<font color=#447700>!<a name='3460'></font>
<font color=#447700>!     .....CALCULATE THE EMISSIVITY HEATING RATES<a name='3461'></font>
      DO 1101 K=1,L<a name='3462'>
      DO 1101 I=MYIS,MYIE<a name='3463'>
      HEATEM(I,K)=RADCON*(FLX(I,K+1)-FLX(I,K))*DELP(I,K)<a name='3464'>
1101  CONTINUE<a name='3465'>
<font color=#447700>!     .....CALCULATE THE TOTAL HEATING RATES<a name='3466'></font>
      DO 1103 K=1,L<a name='3467'>
      DO 1103 I=MYIS,MYIE<a name='3468'>
      HEATRA(I,K)=HEATEM(I,K)-CTS(I,K)-CTSO3(I,K)+EXCTS(I,K)<a name='3469'>
1103  CONTINUE<a name='3470'>
<font color=#447700>!     .....CALCULATE THE FLUX AT EACH FLUX LEVEL USING THE FLUX AT THE<a name='3471'></font>
<font color=#447700>!    TOP (FLX1E1+GXCTS) AND THE INTEGRAL OF THE HEATING RATES (VSUM1)<a name='3472'></font>
      DO 1111 K=1,L<a name='3473'>
      DO 1111 I=MYIS,MYIE<a name='3474'>
      VSUM1(I,K)=HEATRA(I,K)*DELP2(I,K)*RADCON1<a name='3475'>
1111  CONTINUE<a name='3476'>
      DO 1115 I=MYIS,MYIE<a name='3477'>
      TOPFLX(I)=FLX1E1(I)+GXCTS(I)<a name='3478'>
      FLXNET(I,1)=TOPFLX(I)<a name='3479'>
1115  CONTINUE<a name='3480'>
<font color=#447700>!---ONLY THE SURFACE VALUE OF FLUX (GRNFLX) IS NEEDED UNLESS<a name='3481'></font>
<font color=#447700>!    THE THICK CLOUD SECTION IS INVOKED.<a name='3482'></font>
      DO 1123 K=2,LP1<a name='3483'>
      DO 1123 I=MYIS,MYIE<a name='3484'>
      FLXNET(I,K)=FLXNET(I,K-1)+VSUM1(I,K-1)<a name='3485'>
1123  CONTINUE<a name='3486'>
      DO 1125 I=MYIS,MYIE<a name='3487'>
      GRNFLX(I)=FLXNET(I,LP1)<a name='3488'>
1125  CONTINUE<a name='3489'>
<font color=#447700>!<a name='3490'></font>
<font color=#447700>!     THIS IS THE THICK CLOUD SECTION.OPTIONALLY,IF THICK CLOUD<a name='3491'></font>
<font color=#447700>!     FLUXES ARE TO BE "CONVECTIVELY ADJUSTED",IE,DF/DP IS CONSTANT,<a name='3492'></font>
<font color=#447700>!     FOR CLOUDY PART OF GRID POINT, THE FOLLOWING CODE IS EXECUTED.<a name='3493'></font>
<font color=#447700>!***FIRST,COUNT THE NUMBER OF CLOUDS ALONG THE LAT. ROW. SKIP THE<a name='3494'></font>
<font color=#447700>!   ENTIRE THICK CLOUD COMPUTATION OF THERE ARE NO CLOUDS.<a name='3495'></font>
      ICNT=0<a name='3496'>
      DO 1301 I=MYIS,MYIE<a name='3497'>
      ICNT=ICNT+NCLDS(I)<a name='3498'>
1301  CONTINUE<a name='3499'>
      IF (ICNT.EQ.0) GO TO 6999<a name='3500'>
<font color=#447700>!---FIND THE MAXIMUM NUMBER OF CLOUDS IN THE LATITUDE ROW<a name='3501'></font>
      KCLDS=NCLDS(MYIS)<a name='3502'>
      DO 2106 I=MYIS,MYIE<a name='3503'>
      KCLDS=MAX(NCLDS(I),KCLDS)<a name='3504'>
2106  CONTINUE<a name='3505'>
<font color=#447700>!<a name='3506'></font>
<font color=#447700>!<a name='3507'></font>
<font color=#447700>!***OBTAIN THE PRESSURES AND FLUXES OF THE TOP AND BOTTOM OF<a name='3508'></font>
<font color=#447700>!   THE NC'TH CLOUD (IT IS ASSUMED THAT ALL KTOP AND KBTM'S HAVE<a name='3509'></font>
<font color=#447700>!   BEEN DEFINED!).<a name='3510'></font>
      DO 1361 KK=1,KCLDS<a name='3511'>
      KMIN=LP1<a name='3512'>
      KMAX=0<a name='3513'>
      DO 1362 I=MYIS,MYIE<a name='3514'>
        J1=KTOP(I,KK+1)<a name='3515'>
<font color=#447700>!       IF (J1.EQ.1) GO TO 1362<a name='3516'></font>
        J3=KBTM(I,KK+1)<a name='3517'>
        IF (J3.GT.J1) THEN<a name='3518'>
          PTOP(I)=P(I,J1)<a name='3519'>
          PBOT(I)=P(I,J3+1)<a name='3520'>
          FTOP(I)=FLXNET(I,J1)<a name='3521'>
          FBOT(I)=FLXNET(I,J3+1)<a name='3522'>
<font color=#447700>!***OBTAIN THE "FLUX DERIVATIVE" DF/DP (DELPTC)<a name='3523'></font>
          DELPTC(I)=(FTOP(I)-FBOT(I))/(PTOP(I)-PBOT(I))<a name='3524'>
          KMIN=MIN(KMIN,J1)<a name='3525'>
          KMAX=MAX(KMAX,J3)<a name='3526'>
        ENDIF<a name='3527'>
1362  CONTINUE<a name='3528'>
      KMIN=KMIN+1<a name='3529'>
<font color=#447700>!***CALCULATE THE TOT. FLUX CHG. FROM THE TOP OF THE CLOUD, FOR<a name='3530'></font>
<font color=#447700>!   ALL LEVELS.<a name='3531'></font>
      DO 1365 K=KMIN,KMAX<a name='3532'>
      DO 1363 I=MYIS,MYIE<a name='3533'>
<font color=#447700>!       IF (KTOP(I,KK+1).EQ.1) GO TO 1363<a name='3534'></font>
        IF(KTOP(I,KK+1).LT.K .AND. K.LE.KBTM(I,KK+1)) THEN<a name='3535'>
          Z1(I,K)=(P(I,K)-PTOP(I))*DELPTC(I)+FTOP(I)<a name='3536'>
<font color=#447700>!ORIGINAL FLXNET(I,K)=FLXNET(I,K)*(ONE-CAMT(I,KK+1)) +<a name='3537'></font>
<font color=#447700>!ORIGINAL1            Z1(I,K)*CAMT(I,KK+1)<a name='3538'></font>
          FLXNET(I,K)=Z1(I,K)<a name='3539'>
        ENDIF<a name='3540'>
1363  CONTINUE<a name='3541'>
1365  CONTINUE<a name='3542'>
1361  CONTINUE<a name='3543'>
<font color=#447700>!***USING THIS FLUX CHG. IN THE CLOUDY PART OF THE GRID BOX, OBTAIN<a name='3544'></font>
<font color=#447700>!   THE NEW FLUXES, WEIGHTING THE CLEAR AND CLOUDY FLUXES:AGAIN, ONLY<a name='3545'></font>
<font color=#447700>!    THE FLUXES IN THICK-CLOUD LEVELS WILL EVENTUALLY BE USED.<a name='3546'></font>
<font color=#447700>!     DO 6051 K=1,LP1<a name='3547'></font>
<font color=#447700>!     DO 6051 I=MYIS,MYIE<a name='3548'></font>
<font color=#447700>!     FLXNET(I,K)=FLXNET(I,K)*(ONE-CAMT(I,NC)) +<a name='3549'></font>
<font color=#447700>!    1            Z1(I,K)*CAMT(I,NC)<a name='3550'></font>
<font color=#447700>!051  CONTINUE<a name='3551'></font>
<font color=#447700>!***MERGE FLXTHK INTO FLXNET FOR APPROPRIATE LEVELS.<a name='3552'></font>
<font color=#447700>!     DO 1401 K=1,LP1<a name='3553'></font>
<font color=#447700>!     DO 1401 I=MYIS,MYIE<a name='3554'></font>
<font color=#447700>!     IF (K.GT.ITOP(I) .AND. K.LE.IBOT(I)<a name='3555'></font>
<font color=#447700>!    1  .AND.  (NC-1).LE.NCLDS(I))  THEN<a name='3556'></font>
<font color=#447700>!          FLXNET(I,K)=FLXTHK(I,K)<a name='3557'></font>
<font color=#447700>!     ENDIF<a name='3558'></font>
<font color=#447700>!401  CONTINUE<a name='3559'></font>
<font color=#447700>!<a name='3560'></font>
<font color=#447700>!******END OF CLOUD LOOP*****<a name='3561'></font>
6001  CONTINUE<a name='3562'>
6999  CONTINUE<a name='3563'>
<font color=#447700>!***THE FINAL STEP IS TO RECOMPUTE THE HEATING RATES BASED ON THE<a name='3564'></font>
<font color=#447700>!   REVISED FLUXES:<a name='3565'></font>
      DO 6101 K=1,L<a name='3566'>
      DO 6101 I=MYIS,MYIE<a name='3567'>
      HEATRA(I,K)=RADCON*(FLXNET(I,K+1)-FLXNET(I,K))*DELP(I,K)<a name='3568'>
6101  CONTINUE<a name='3569'>
<font color=#447700>!     THE THICK CLOUD SECTION ENDS HERE.<a name='3570'></font>
<a name='3571'>
  END SUBROUTINE FST88<a name='3572'>
<a name='3573'>
<font color=#447700>!----------------------------------------------------------------------<a name='3574'></font>
<a name='3575'>
<A NAME='E1E290'><A href='../../html_code/phys/module_ra_gfdleta.F.html#E1E290' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3576'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>E1E290</font>(G1,G2,G3,G4,G5,EMISS,FXOE1,DTE1,FXOE2,DTE2,      &amp; <A href='../../call_to/E1E290.html' TARGET='index'>1</A><a name='3577'>
                       AVEPHI,TEMP,T,                                &amp;<a name='3578'>
<font color=#447700>!                      T1,T2,T4,EM1V,EM1VW,                          &amp;<a name='3579'></font>
                       H16E1,TEN,HP1,H28E1,HAF,                      &amp;<a name='3580'>
                       ids,ide, jds,jde, kds,kde,                    &amp;<a name='3581'>
                       ims,ime, jms,jme, kms,kme,                    &amp;<a name='3582'>
                       its,ite, jts,jte, kts,kte                     )<a name='3583'>
<font color=#447700>!---------------------------------------------------------------------<a name='3584'></font>
 IMPLICIT NONE<a name='3585'>
<font color=#447700>!----------------------------------------------------------------------<a name='3586'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='3587'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='3588'>
                                    its,ite, jts,jte, kts,kte<a name='3589'>
      REAL,INTENT(IN) :: H16E1,TEN,HP1,H28E1,HAF<a name='3590'>
<a name='3591'>
      REAL,INTENT(OUT),DIMENSION(its:ite,kts:kte+1) :: G1,G4,G3,EMISS<a name='3592'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte+1) :: FXOE1,DTE1,FXOE2,DTE2<a name='3593'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte+1) :: AVEPHI,TEMP,T<a name='3594'>
      REAL,INTENT(OUT),DIMENSION(its:ite,kts:kte)   :: G2,G5<a name='3595'>
<font color=#447700>!     REAL,INTENT(IN),DIMENSION(5040):: T1,T2,T4 ,EM1V,EM1VW<a name='3596'></font>
<a name='3597'>
      REAL,DIMENSION(its:ite,kts:kte+1) :: TMP3,DU,FYO,WW1,WW2<a name='3598'>
      INTEGER,DIMENSION(its:ite,kts:kte*3+2)   :: IT1<a name='3599'>
      INTEGER,DIMENSION(its:ite,kts:kte+1) :: IVAL<a name='3600'>
<a name='3601'>
<font color=#447700>!     REAL,DIMENSION(28,180):: EM1,EM1WDE,TABLE1,TABLE2, &amp;<a name='3602'></font>
<font color=#447700>!                              TABLE3<a name='3603'></font>
<font color=#447700>!     EQUIVALENCE (EM1V(1),EM1(1,1)),(EM1VW(1),EM1WDE(1,1))<a name='3604'></font>
<font color=#447700>!     EQUIVALENCE (T1(1),TABLE1(1,1)),(T2(1),TABLE2(1,1)), &amp;<a name='3605'></font>
<font color=#447700>!      (T4(1),TABLE3(1,1))<a name='3606'></font>
<a name='3607'>
      INTEGER :: K, I,KP,LLM2,J1,J3,KMAX,KMIN,KCLDS,ICNT,LLM1<a name='3608'>
      INTEGER :: L,LP1,LP2,LP3,LM1,LM2,LM3,MYIS,MYIE,LLP1,LL,KK,KLEN<a name='3609'>
<a name='3610'>
      L=kte<a name='3611'>
      LP1=L+1;  LP2=L+2;  LP3=L+3; LLP1 = 2*L + 1<a name='3612'>
      LM1=L-1;  LM2=L-2;  LM3=L-3; LL = 2*L<a name='3613'>
      LLM2 = LL-2; LLM1=LL-1<a name='3614'>
      MYIS=its; MYIE=ite<a name='3615'>
<a name='3616'>
<font color=#447700>!---FIRST WE OBTAIN THE EMISSIVITIES AS A FUNCTION OF TEMPERATURE<a name='3617'></font>
<font color=#447700>!   (INDEX FXO) AND WATER AMOUNT (INDEX FYO). THIS PART OF THE CODE<a name='3618'></font>
<font color=#447700>!   THUS GENERATES THE E2 FUNCTION. THE FXO INDICES HAVE BEEN<a name='3619'></font>
<font color=#447700>!   OBTAINED IN FST88, FOR CONVENIENCE.<a name='3620'></font>
<font color=#447700>!<a name='3621'></font>
<font color=#447700>!---THIS SUBROUTINE EVALUATES THE K=1 CASE ONLY--<a name='3622'></font>
<font color=#447700>!<a name='3623'></font>
<font color=#447700>!---THIS LOOP REPLACES LOOPS GOING FROMI=1,IMAX AND KP=2,LP1 PLUS<a name='3624'></font>
<font color=#447700>!   THE SPECIAL CASE FOR THE LP1TH LAYER.<a name='3625'></font>
<a name='3626'>
      DO 1322 K=1,LP1<a name='3627'>
      DO 1322 I=MYIS,MYIE<a name='3628'>
      TMP3(I,K)=LOG10(AVEPHI(I,K))+H16E1<a name='3629'>
      FYO(I,K)=AINT(TMP3(I,K)*TEN)<a name='3630'>
      DU(I,K)=TMP3(I,K)-HP1*FYO(I,K)<a name='3631'>
      FYO(I,K)=H28E1*FYO(I,K)<a name='3632'>
      IVAL(I,K)=FYO(I,K)+FXOE2(I,K)<a name='3633'>
      EMISS(I,K)=T1(IVAL(I,K))+DU(I,K)*T2(IVAL(I,K)) &amp;<a name='3634'>
                              +DTE2(I,K)*T4(IVAL(I,K))<a name='3635'>
1322  CONTINUE<a name='3636'>
<font color=#447700>!<a name='3637'></font>
<font color=#447700>!---THE SPECIAL CASE EMISS(I,L) (LAYER KP) IS OBTAINED NOW<a name='3638'></font>
<font color=#447700>!   BY AVERAGING THE VALUES FOR L AND LP1:<a name='3639'></font>
      DO 1344 I=MYIS,MYIE<a name='3640'>
      EMISS(I,L)=HAF*(EMISS(I,L)+EMISS(I,LP1))<a name='3641'>
1344  CONTINUE<a name='3642'>
<font color=#447700>!<a name='3643'></font>
<font color=#447700>!   CALCULATIONS FOR THE KP=1 LAYER ARE NOT PERFORMED, AS<a name='3644'></font>
<font color=#447700>!   THE RADIATION CODE ASSUMES THAT THE TOP FLUX LAYER (ABOVE THE<a name='3645'></font>
<font color=#447700>!   TOP DATA LEVEL) IS ISOTHERMAL, AND HENCE CONTRIBUTES NOTHING<a name='3646'></font>
<font color=#447700>!   TO THE FLUXES AT OTHER LEVELS.<a name='3647'></font>
<font color=#447700>!<a name='3648'></font>
<font color=#447700>!***THE FOLLOWING IS THE CALCULATION FOR THE E1 FUNCTION, FORMERLY<a name='3649'></font>
<font color=#447700>!    DONE IN SUBROUTINE E1V88. THE MOVE TO E1E288 IS DUE TO THE<a name='3650'></font>
<font color=#447700>!    SAVINGS IN OBTAINING INDEX VALUES (THE TEMP. INDICES HAVE<a name='3651'></font>
<font color=#447700>!    BEEN OBTAINED IN FST88, WHILE THE U-INDICES ARE OBTAINED<a name='3652'></font>
<font color=#447700>!    IN THE E2 CALCS.,WITH K=1).<a name='3653'></font>
<font color=#447700>!<a name='3654'></font>
<font color=#447700>!<a name='3655'></font>
<font color=#447700>!   FOR TERMS INVOLVING TOP LAYER, DU IS NOT KNOWN; IN FACT, WE<a name='3656'></font>
<font color=#447700>!   USE INDEX 2 TO REPERSENT INDEX 1 IN PREV. CODE. THIS MEANS THAT<a name='3657'></font>
<font color=#447700>!    THE IT1 INDEX 1 AND LLP1 HAS TO BE CALCULATED SEPARATELY. THE<a name='3658'></font>
<font color=#447700>!   INDEX LLP2 GIVES THE SAME VALUE AS 1; IT CAN BE OMITTED.<a name='3659'></font>
      DO 208 I=MYIS,MYIE<a name='3660'>
      IT1(I,1)=FXOE1(I,1)<a name='3661'>
      WW1(I,1)=TEN-DTE1(I,1)<a name='3662'>
      WW2(I,1)=HP1<a name='3663'>
208   CONTINUE<a name='3664'>
      DO 209 K=1,L<a name='3665'>
      DO 209 I=MYIS,MYIE<a name='3666'>
      IT1(I,K+1)=FYO(I,K)+FXOE1(I,K+1)<a name='3667'>
      IT1(I,LP2+K-1)=FYO(I,K)+FXOE1(I,K)<a name='3668'>
      WW1(I,K+1)=TEN-DTE1(I,K+1)<a name='3669'>
      WW2(I,K+1)=HP1-DU(I,K)<a name='3670'>
209   CONTINUE<a name='3671'>
      DO 211 KP=1,L<a name='3672'>
      DO 211 I=MYIS,MYIE<a name='3673'>
      IT1(I,KP+LLP1)=FYO(I,KP)+FXOE1(I,1)<a name='3674'>
211   CONTINUE<a name='3675'>
<font color=#447700>!<a name='3676'></font>
<font color=#447700>!<a name='3677'></font>
<font color=#447700>!  G3(I,1) HAS THE SAME VALUES AS G1 (AND DID ALL ALONG)<a name='3678'></font>
      DO 230 I=MYIS,MYIE<a name='3679'>
      G1(I,1)=WW1(I,1)*WW2(I,1)*EM1V(IT1(I,1))+ &amp;<a name='3680'>
              WW2(I,1)*DTE1(I,1)*EM1V(IT1(I,1)+1)<a name='3681'>
      G3(I,1)=G1(I,1)<a name='3682'>
230   CONTINUE<a name='3683'>
      DO 240 K=1,L<a name='3684'>
      DO 240 I=MYIS,MYIE<a name='3685'>
      G1(I,K+1)=WW1(I,K+1)*WW2(I,K+1)*EM1V(IT1(I,K+1))+ &amp;<a name='3686'>
              WW2(I,K+1)*DTE1(I,K+1)*EM1V(IT1(I,K+1)+1)+ &amp;<a name='3687'>
              WW1(I,K+1)*DU(I,K)*EM1V(IT1(I,K+1)+28)+ &amp;<a name='3688'>
              DTE1(I,K+1)*DU(I,K)*EM1V(IT1(I,K+1)+29)<a name='3689'>
      G2(I,K)=WW1(I,K)*WW2(I,K+1)*EM1V(IT1(I,K+LP2-1))+ &amp;<a name='3690'>
              WW2(I,K+1)*DTE1(I,K)*EM1V(IT1(I,K+LP2-1)+1)+ &amp;<a name='3691'>
              WW1(I,K)*DU(I,K)*EM1V(IT1(I,K+LP2-1)+28)+ &amp;<a name='3692'>
              DTE1(I,K)*DU(I,K)*EM1V(IT1(I,K+LP2-1)+29)<a name='3693'>
240   CONTINUE<a name='3694'>
      DO 241 KP=2,LP1<a name='3695'>
      DO 241 I=MYIS,MYIE<a name='3696'>
      G3(I,KP)=WW1(I,1)*WW2(I,KP)*EM1V(IT1(I,LL+KP))+ &amp;<a name='3697'>
              WW2(I,KP)*DTE1(I,1)*EM1V(IT1(I,LL+KP)+1)+ &amp;<a name='3698'>
              WW1(I,1)*DU(I,KP-1)*EM1V(IT1(I,LL+KP)+28)+ &amp;<a name='3699'>
              DTE1(I,1)*DU(I,KP-1)*EM1V(IT1(I,LL+KP)+29)<a name='3700'>
241   CONTINUE<a name='3701'>
<font color=#447700>!<a name='3702'></font>
      DO 244 I=MYIS,MYIE<a name='3703'>
      G4(I,1)=WW1(I,1)*WW2(I,1)*EM1VW(IT1(I,1))+ &amp;<a name='3704'>
              WW2(I,1)*DTE1(I,1)*EM1VW(IT1(I,1)+1)<a name='3705'>
244   CONTINUE<a name='3706'>
      DO 242 K=1,L<a name='3707'>
      DO 242 I=MYIS,MYIE<a name='3708'>
      G4(I,K+1)=WW1(I,K+1)*WW2(I,K+1)*EM1VW(IT1(I,K+1))+ &amp;<a name='3709'>
              WW2(I,K+1)*DTE1(I,K+1)*EM1VW(IT1(I,K+1)+1)+ &amp;<a name='3710'>
              WW1(I,K+1)*DU(I,K)*EM1VW(IT1(I,K+1)+28)+ &amp;<a name='3711'>
              DTE1(I,K+1)*DU(I,K)*EM1VW(IT1(I,K+1)+29)<a name='3712'>
      G5(I,K)=WW1(I,K)*WW2(I,K+1)*EM1VW(IT1(I,K+LP2-1))+ &amp;<a name='3713'>
              WW2(I,K+1)*DTE1(I,K)*EM1VW(IT1(I,K+LP2-1)+1)+ &amp;<a name='3714'>
              WW1(I,K)*DU(I,K)*EM1VW(IT1(I,K+LP2-1)+28)+ &amp;<a name='3715'>
              DTE1(I,K)*DU(I,K)*EM1VW(IT1(I,K+LP2-1)+29)<a name='3716'>
242   CONTINUE<a name='3717'>
<font color=#447700>!<a name='3718'></font>
  END SUBROUTINE E1E290<a name='3719'>
<a name='3720'>
<font color=#447700>!----------------------------------------------------------------------<a name='3721'></font>
<a name='3722'>
<A NAME='SPA88'><A href='../../html_code/phys/module_ra_gfdleta.F.html#SPA88' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3723'>
 <font color=#993300>SUBROUTINE </font><font color=#cc0000>SPA88</font>(EXCTS,CTSO3,GXCTS,SORC,CSOUR,                      &amp; <A href='../../call_to/SPA88.html' TARGET='index'>1</A><a name='3724'>
                       CLDFAC,TEMP,PRESS,VAR1,VAR2,                  &amp;<a name='3725'>
                       P,DELP,DELP2,TOTVO2,TO3SP,TO3SPC,             &amp;<a name='3726'>
                       CO2SP1,CO2SP2,CO2SP,                          &amp;<a name='3727'>
                       APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='3728'>
                       H25E2,ONE,H44194M2,H1P41819,HAF,HM1EZ,TWO,    &amp;<a name='3729'>
<font color=#447700>!                      SKO2D,RADCON,                                 &amp;<a name='3730'></font>
                       RADCON,                                 &amp;<a name='3731'>
                       ids,ide, jds,jde, kds,kde,                    &amp;<a name='3732'>
                       ims,ime, jms,jme, kms,kme,                    &amp;<a name='3733'>
                       its,ite, jts,jte, kts,kte                     )<a name='3734'>
<font color=#447700>!---------------------------------------------------------------------<a name='3735'></font>
 IMPLICIT NONE<a name='3736'>
<font color=#447700>!----------------------------------------------------------------------<a name='3737'></font>
<font color=#447700>!     INTEGER, PARAMETER :: NBLY=15<a name='3738'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='3739'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='3740'>
                                    its,ite, jts,jte, kts,kte<a name='3741'>
<a name='3742'>
      REAL,INTENT(IN) :: H25E2,ONE,H44194M2,H1P41819,HAF,HM1EZ,TWO, &amp;<a name='3743'>
                         RADCON<a name='3744'>
<font color=#447700>!                        SKO2D,RADCON<a name='3745'></font>
<a name='3746'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte+1) :: CSOUR<a name='3747'>
      REAL,INTENT(OUT),DIMENSION(its:ite,kts:kte)  :: CTSO3<a name='3748'>
      REAL,INTENT(OUT),DIMENSION(its:ite,kts:kte)  :: EXCTS<a name='3749'>
      REAL,INTENT(OUT),DIMENSION(its:ite)          :: GXCTS<a name='3750'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte+1,NBLY) :: SORC<a name='3751'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte+1,kts:kte+1) :: CLDFAC<a name='3752'>
      REAL,INTENT(IN), DIMENSION(its:ite,kts:kte+1) :: PRESS,TEMP<a name='3753'>
<a name='3754'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte) :: VAR1,VAR2 <a name='3755'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte+1) :: P<a name='3756'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte)   :: DELP,DELP2,TO3SPC<a name='3757'>
      REAL,INTENT(IN),DIMENSION(its:ite,kts:kte+1) ::TOTVO2,TO3SP,CO2SP1,&amp;<a name='3758'>
                                                     CO2SP2,CO2SP<a name='3759'>
      REAL,INTENT(IN),DIMENSION(NBLY) :: APCM,BPCM,ATPCM,BTPCM,ACOMB, &amp;<a name='3760'>
                                         BCOMB,BETACM<a name='3761'>
<a name='3762'>
      REAL,DIMENSION(its:ite,kts:kte+1) ::CTMP,CTMP2,CTMP3<a name='3763'>
      REAL,DIMENSION(its:ite,kts:kte)   ::X,Y,FAC1,FAC2,F,FF,AG,AGG, &amp;<a name='3764'>
                                          PHITMP,PSITMP,TOPM,TOPPHI,TT<a name='3765'>
<a name='3766'>
      INTEGER :: K, I,KP,LLM2,J1,J3,KMAX,KMIN,KCLDS,ICNT,LLM1<a name='3767'>
      INTEGER :: L,LP1,LP2,LP3,LM1,LM2,LM3,MYIS,MYIE,LLP1,LL,KK,KLEN<a name='3768'>
<a name='3769'>
      L=kte<a name='3770'>
      LP1=L+1;  LP2=L+2;  LP3=L+3; LLP1 = 2*L + 1<a name='3771'>
      LM1=L-1;  LM2=L-2;  LM3=L-3; LL = 2*L<a name='3772'>
      LLM2 = LL-2; LLM1=LL-1<a name='3773'>
      MYIS=its; MYIE=ite<a name='3774'>
<a name='3775'>
<font color=#447700>!--!COMPUTE TEMPERATURE QUANTITIES FOR USE IN PROGRAM<a name='3776'></font>
<a name='3777'>
      DO 101 K=1,L<a name='3778'>
      DO 101 I=MYIS,MYIE<a name='3779'>
      X(I,K)=TEMP(I,K)-H25E2<a name='3780'>
      Y(I,K)=X(I,K)*X(I,K)<a name='3781'>
101   CONTINUE<a name='3782'>
<font color=#447700>!---INITIALIZE CTMP(I,1),CTMP2(I,1),CTMP3(I,1) TO UNITY; THESE ARE<a name='3783'></font>
<font color=#447700>!   TRANSMISSION FCTNS AT THE TOP.<a name='3784'></font>
      DO 345 I=MYIS,MYIE<a name='3785'>
      CTMP(I,1)=ONE<a name='3786'>
      CTMP2(I,1)=1.<a name='3787'>
      CTMP3(I,1)=1.<a name='3788'>
345   CONTINUE<a name='3789'>
<font color=#447700>!***BEGIN LOOP ON FREQUENCY BANDS (1)***<a name='3790'></font>
<font color=#447700>!<a name='3791'></font>
<font color=#447700>!---CALCULATION FOR BAND 1 (COMBINED BAND 1)<a name='3792'></font>
<font color=#447700>!<a name='3793'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='3794'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='3795'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='3796'></font>
      DO 301 K=1,L<a name='3797'>
      DO 301 I=MYIS,MYIE<a name='3798'>
      F(I,K)=H44194M2*(APCM(1)*X(I,K)+BPCM(1)*Y(I,K))<a name='3799'>
      FF(I,K)=H44194M2*(ATPCM(1)*X(I,K)+BTPCM(1)*Y(I,K))<a name='3800'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='3801'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='3802'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='3803'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='3804'>
301   CONTINUE<a name='3805'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='3806'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='3807'></font>
      DO 315 I=MYIS,MYIE<a name='3808'>
      TOPM(I,1)=PHITMP(I,1)<a name='3809'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='3810'>
315   CONTINUE<a name='3811'>
      DO 319 K=2,L<a name='3812'>
      DO 317 I=MYIS,MYIE<a name='3813'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='3814'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='3815'>
317   CONTINUE<a name='3816'>
319   CONTINUE<a name='3817'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='3818'></font>
      DO 321 K=1,L<a name='3819'>
      DO 321 I=MYIS,MYIE<a name='3820'>
      FAC1(I,K)=ACOMB(1)*TOPM(I,K)<a name='3821'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(1)*TOPPHI(I,K))<a name='3822'>
      TT(I,K)=EXP(HM1EZ*FAC1(I,K)/SQRT(1.+FAC2(I,K)))<a name='3823'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='3824'>
321   CONTINUE<a name='3825'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='3826'></font>
      DO 353 K=1,L<a name='3827'>
      DO 353 I=MYIS,MYIE<a name='3828'>
      EXCTS(I,K)=SORC(I,K,1)*(CTMP(I,K+1)-CTMP(I,K))<a name='3829'>
353   CONTINUE<a name='3830'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='3831'></font>
      DO 361 I=MYIS,MYIE<a name='3832'>
      GXCTS(I)=CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,1)+ &amp;<a name='3833'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='3834'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='3835'>
         (SORC(I,LP1,1)-SORC(I,L,1)))<a name='3836'>
361   CONTINUE<a name='3837'>
<font color=#447700>!<a name='3838'></font>
<font color=#447700>!<a name='3839'></font>
<font color=#447700>!-----CALCULATION FOR BAND 2 (COMBINED BAND 2)<a name='3840'></font>
<font color=#447700>!<a name='3841'></font>
<font color=#447700>!<a name='3842'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='3843'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='3844'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='3845'></font>
      DO 401 K=1,L<a name='3846'>
      DO 401 I=MYIS,MYIE<a name='3847'>
      F(I,K)=H44194M2*(APCM(2)*X(I,K)+BPCM(2)*Y(I,K))<a name='3848'>
      FF(I,K)=H44194M2*(ATPCM(2)*X(I,K)+BTPCM(2)*Y(I,K))<a name='3849'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='3850'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='3851'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='3852'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='3853'>
401   CONTINUE<a name='3854'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='3855'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='3856'></font>
      DO 415 I=MYIS,MYIE<a name='3857'>
      TOPM(I,1)=PHITMP(I,1)<a name='3858'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='3859'>
415   CONTINUE<a name='3860'>
      DO 419 K=2,L<a name='3861'>
      DO 417 I=MYIS,MYIE<a name='3862'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='3863'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='3864'>
417   CONTINUE<a name='3865'>
419   CONTINUE<a name='3866'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='3867'></font>
      DO 421 K=1,L<a name='3868'>
      DO 421 I=MYIS,MYIE<a name='3869'>
      FAC1(I,K)=ACOMB(2)*TOPM(I,K)<a name='3870'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(2)*TOPPHI(I,K))<a name='3871'>
      TT(I,K)=EXP(HM1EZ*FAC1(I,K)/SQRT(1.+FAC2(I,K)))<a name='3872'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='3873'>
421   CONTINUE<a name='3874'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='3875'></font>
      DO 453 K=1,L<a name='3876'>
      DO 453 I=MYIS,MYIE<a name='3877'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,2)* &amp; <a name='3878'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='3879'>
453   CONTINUE<a name='3880'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='3881'></font>
      DO 461 I=MYIS,MYIE<a name='3882'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,2)+ &amp;<a name='3883'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='3884'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='3885'>
         (SORC(I,LP1,2)-SORC(I,L,2)))<a name='3886'>
461   CONTINUE<a name='3887'>
<font color=#447700>!<a name='3888'></font>
<font color=#447700>!-----CALCULATION FOR BAND 3 (COMBINED BAND 3)<a name='3889'></font>
<font color=#447700>!<a name='3890'></font>
<font color=#447700>!<a name='3891'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='3892'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='3893'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='3894'></font>
      DO 501 K=1,L<a name='3895'>
      DO 501 I=MYIS,MYIE<a name='3896'>
      F(I,K)=H44194M2*(APCM(3)*X(I,K)+BPCM(3)*Y(I,K))<a name='3897'>
      FF(I,K)=H44194M2*(ATPCM(3)*X(I,K)+BTPCM(3)*Y(I,K))<a name='3898'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='3899'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='3900'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='3901'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='3902'>
501   CONTINUE<a name='3903'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='3904'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='3905'></font>
      DO 515 I=MYIS,MYIE<a name='3906'>
      TOPM(I,1)=PHITMP(I,1)<a name='3907'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='3908'>
515   CONTINUE<a name='3909'>
      DO 519 K=2,L<a name='3910'>
      DO 517 I=MYIS,MYIE<a name='3911'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='3912'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='3913'>
517   CONTINUE<a name='3914'>
519   CONTINUE<a name='3915'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='3916'></font>
      DO 521 K=1,L<a name='3917'>
      DO 521 I=MYIS,MYIE<a name='3918'>
      FAC1(I,K)=ACOMB(3)*TOPM(I,K)<a name='3919'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(3)*TOPPHI(I,K))<a name='3920'>
      TT(I,K)=EXP(HM1EZ*FAC1(I,K)/SQRT(1.+FAC2(I,K)))<a name='3921'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='3922'>
521   CONTINUE<a name='3923'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='3924'></font>
      DO 553 K=1,L<a name='3925'>
      DO 553 I=MYIS,MYIE<a name='3926'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,3)* &amp;<a name='3927'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='3928'>
553   CONTINUE<a name='3929'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='3930'></font>
      DO 561 I=MYIS,MYIE<a name='3931'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,3)+ &amp;<a name='3932'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='3933'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='3934'>
         (SORC(I,LP1,3)-SORC(I,L,3)))<a name='3935'>
561   CONTINUE<a name='3936'>
<font color=#447700>!<a name='3937'></font>
<font color=#447700>!-----CALCULATION FOR BAND 4 (COMBINED BAND 4)<a name='3938'></font>
<font color=#447700>!<a name='3939'></font>
<font color=#447700>!<a name='3940'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='3941'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='3942'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='3943'></font>
      DO 601 K=1,L<a name='3944'>
      DO 601 I=MYIS,MYIE<a name='3945'>
      F(I,K)=H44194M2*(APCM(4)*X(I,K)+BPCM(4)*Y(I,K))<a name='3946'>
      FF(I,K)=H44194M2*(ATPCM(4)*X(I,K)+BTPCM(4)*Y(I,K))<a name='3947'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='3948'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='3949'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='3950'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='3951'>
601   CONTINUE<a name='3952'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='3953'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='3954'></font>
      DO 615 I=MYIS,MYIE<a name='3955'>
      TOPM(I,1)=PHITMP(I,1)<a name='3956'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='3957'>
615   CONTINUE<a name='3958'>
      DO 619 K=2,L<a name='3959'>
      DO 617 I=MYIS,MYIE<a name='3960'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='3961'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='3962'>
617   CONTINUE<a name='3963'>
619   CONTINUE<a name='3964'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='3965'></font>
      DO 621 K=1,L<a name='3966'>
      DO 621 I=MYIS,MYIE<a name='3967'>
      FAC1(I,K)=ACOMB(4)*TOPM(I,K)<a name='3968'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(4)*TOPPHI(I,K))<a name='3969'>
      TT(I,K)=EXP(HM1EZ*FAC1(I,K)/SQRT(1.+FAC2(I,K)))<a name='3970'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='3971'>
621   CONTINUE<a name='3972'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='3973'></font>
      DO 653 K=1,L<a name='3974'>
      DO 653 I=MYIS,MYIE<a name='3975'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,4)* &amp;<a name='3976'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='3977'>
653   CONTINUE<a name='3978'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='3979'></font>
      DO 661 I=MYIS,MYIE<a name='3980'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,4)+ &amp;<a name='3981'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='3982'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='3983'>
         (SORC(I,LP1,4)-SORC(I,L,4)))<a name='3984'>
661   CONTINUE<a name='3985'>
<font color=#447700>!<a name='3986'></font>
<font color=#447700>!-----CALCULATION FOR BAND 5 (COMBINED BAND 5)<a name='3987'></font>
<font color=#447700>!<a name='3988'></font>
<font color=#447700>!<a name='3989'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='3990'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='3991'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='3992'></font>
      DO 701 K=1,L<a name='3993'>
      DO 701 I=MYIS,MYIE<a name='3994'>
      F(I,K)=H44194M2*(APCM(5)*X(I,K)+BPCM(5)*Y(I,K))<a name='3995'>
      FF(I,K)=H44194M2*(ATPCM(5)*X(I,K)+BTPCM(5)*Y(I,K))<a name='3996'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='3997'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='3998'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='3999'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4000'>
701   CONTINUE<a name='4001'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4002'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4003'></font>
      DO 715 I=MYIS,MYIE<a name='4004'>
      TOPM(I,1)=PHITMP(I,1)<a name='4005'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4006'>
715   CONTINUE<a name='4007'>
      DO 719 K=2,L<a name='4008'>
      DO 717 I=MYIS,MYIE<a name='4009'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4010'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4011'>
717   CONTINUE<a name='4012'>
719   CONTINUE<a name='4013'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4014'></font>
      DO 721 K=1,L<a name='4015'>
      DO 721 I=MYIS,MYIE<a name='4016'>
      FAC1(I,K)=ACOMB(5)*TOPM(I,K)<a name='4017'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(5)*TOPPHI(I,K))<a name='4018'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4019'>
                 BETACM(5)*TOTVO2(I,K+1)*SKO2D))<a name='4020'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4021'>
721   CONTINUE<a name='4022'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4023'></font>
      DO 753 K=1,L<a name='4024'>
      DO 753 I=MYIS,MYIE<a name='4025'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,5)* &amp;<a name='4026'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4027'>
753   CONTINUE<a name='4028'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4029'></font>
      DO 761 I=MYIS,MYIE<a name='4030'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,5)+ &amp;<a name='4031'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4032'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4033'>
         (SORC(I,LP1,5)-SORC(I,L,5)))<a name='4034'>
761   CONTINUE<a name='4035'>
<font color=#447700>!<a name='4036'></font>
<font color=#447700>!-----CALCULATION FOR BAND 6 (COMBINED BAND 6)<a name='4037'></font>
<font color=#447700>!<a name='4038'></font>
<font color=#447700>!<a name='4039'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4040'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4041'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4042'></font>
      DO 801 K=1,L<a name='4043'>
      DO 801 I=MYIS,MYIE<a name='4044'>
      F(I,K)=H44194M2*(APCM(6)*X(I,K)+BPCM(6)*Y(I,K))<a name='4045'>
      FF(I,K)=H44194M2*(ATPCM(6)*X(I,K)+BTPCM(6)*Y(I,K))<a name='4046'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4047'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4048'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4049'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4050'>
801   CONTINUE<a name='4051'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4052'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4053'></font>
      DO 815 I=MYIS,MYIE<a name='4054'>
      TOPM(I,1)=PHITMP(I,1)<a name='4055'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4056'>
815   CONTINUE<a name='4057'>
      DO 819 K=2,L<a name='4058'>
      DO 817 I=MYIS,MYIE<a name='4059'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4060'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4061'>
817   CONTINUE<a name='4062'>
819   CONTINUE<a name='4063'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4064'></font>
      DO 821 K=1,L<a name='4065'>
      DO 821 I=MYIS,MYIE<a name='4066'>
      FAC1(I,K)=ACOMB(6)*TOPM(I,K)<a name='4067'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(6)*TOPPHI(I,K))<a name='4068'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4069'>
                 BETACM(6)*TOTVO2(I,K+1)*SKO2D))<a name='4070'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4071'>
821   CONTINUE<a name='4072'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4073'></font>
      DO 853 K=1,L<a name='4074'>
      DO 853 I=MYIS,MYIE<a name='4075'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,6)* &amp;<a name='4076'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4077'>
853   CONTINUE<a name='4078'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4079'></font>
      DO 861 I=MYIS,MYIE<a name='4080'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,6)+ &amp;<a name='4081'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4082'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4083'>
         (SORC(I,LP1,6)-SORC(I,L,6)))<a name='4084'>
861   CONTINUE<a name='4085'>
<font color=#447700>!<a name='4086'></font>
<font color=#447700>!-----CALCULATION FOR BAND 7 (COMBINED BAND 7)<a name='4087'></font>
<font color=#447700>!<a name='4088'></font>
<font color=#447700>!<a name='4089'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4090'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4091'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4092'></font>
      DO 901 K=1,L<a name='4093'>
      DO 901 I=MYIS,MYIE<a name='4094'>
      F(I,K)=H44194M2*(APCM(7)*X(I,K)+BPCM(7)*Y(I,K))<a name='4095'>
      FF(I,K)=H44194M2*(ATPCM(7)*X(I,K)+BTPCM(7)*Y(I,K))<a name='4096'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4097'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4098'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4099'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4100'>
901   CONTINUE<a name='4101'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4102'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4103'></font>
      DO 915 I=MYIS,MYIE<a name='4104'>
      TOPM(I,1)=PHITMP(I,1)<a name='4105'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4106'>
915   CONTINUE<a name='4107'>
      DO 919 K=2,L<a name='4108'>
      DO 917 I=MYIS,MYIE<a name='4109'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4110'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4111'>
917   CONTINUE<a name='4112'>
919   CONTINUE<a name='4113'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4114'></font>
      DO 921 K=1,L<a name='4115'>
      DO 921 I=MYIS,MYIE<a name='4116'>
      FAC1(I,K)=ACOMB(7)*TOPM(I,K)<a name='4117'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(7)*TOPPHI(I,K))<a name='4118'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4119'>
                 BETACM(7)*TOTVO2(I,K+1)*SKO2D))<a name='4120'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4121'>
921   CONTINUE<a name='4122'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4123'></font>
      DO 953 K=1,L<a name='4124'>
      DO 953 I=MYIS,MYIE<a name='4125'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,k,7)* &amp;<a name='4126'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4127'>
953   CONTINUE<a name='4128'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4129'></font>
      DO 961 I=MYIS,MYIE<a name='4130'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,7)+ &amp;<a name='4131'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4132'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4133'>
         (SORC(I,LP1,7)-SORC(I,L,7)))<a name='4134'>
961   CONTINUE<a name='4135'>
<font color=#447700>!<a name='4136'></font>
<font color=#447700>!-----CALCULATION FOR BAND 8 (COMBINED BAND 8)<a name='4137'></font>
<font color=#447700>!<a name='4138'></font>
<font color=#447700>!<a name='4139'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4140'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4141'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4142'></font>
      DO 1001 K=1,L<a name='4143'>
      DO 1001 I=MYIS,MYIE<a name='4144'>
      F(I,K)=H44194M2*(APCM(8)*X(I,K)+BPCM(8)*Y(I,K))<a name='4145'>
      FF(I,K)=H44194M2*(ATPCM(8)*X(I,K)+BTPCM(8)*Y(I,K))<a name='4146'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4147'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4148'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4149'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4150'>
1001  CONTINUE<a name='4151'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4152'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4153'></font>
      DO 1015 I=MYIS,MYIE<a name='4154'>
      TOPM(I,1)=PHITMP(I,1)<a name='4155'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4156'>
1015  CONTINUE<a name='4157'>
      DO 1019 K=2,L<a name='4158'>
      DO 1017 I=MYIS,MYIE<a name='4159'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4160'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4161'>
1017  CONTINUE<a name='4162'>
1019  CONTINUE<a name='4163'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4164'></font>
      DO 1021 K=1,L<a name='4165'>
      DO 1021 I=MYIS,MYIE<a name='4166'>
      FAC1(I,K)=ACOMB(8)*TOPM(I,K)<a name='4167'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(8)*TOPPHI(I,K))<a name='4168'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4169'>
                 BETACM(8)*TOTVO2(I,K+1)*SKO2D))<a name='4170'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4171'>
1021  CONTINUE<a name='4172'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4173'></font>
      DO 1053 K=1,L<a name='4174'>
      DO 1053 I=MYIS,MYIE<a name='4175'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,8)* &amp;<a name='4176'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4177'>
1053  CONTINUE<a name='4178'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4179'></font>
      DO 1061 I=MYIS,MYIE<a name='4180'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,8)+ &amp;<a name='4181'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4182'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4183'>
         (SORC(I,LP1,8)-SORC(I,L,8)))<a name='4184'>
1061  CONTINUE<a name='4185'>
<font color=#447700>!<a name='4186'></font>
<font color=#447700>!-----CALCULATION FOR BAND 9 ( 560-670 CM-1; INCLUDES CO2)<a name='4187'></font>
<font color=#447700>!<a name='4188'></font>
<font color=#447700>!<a name='4189'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4190'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4191'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4192'></font>
      DO 1101 K=1,L<a name='4193'>
      DO 1101 I=MYIS,MYIE<a name='4194'>
      F(I,K)=H44194M2*(APCM(9)*X(I,K)+BPCM(9)*Y(I,K))<a name='4195'>
      FF(I,K)=H44194M2*(ATPCM(9)*X(I,K)+BTPCM(9)*Y(I,K))<a name='4196'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4197'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4198'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4199'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4200'>
1101  CONTINUE<a name='4201'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4202'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4203'></font>
      DO 1115 I=MYIS,MYIE<a name='4204'>
      TOPM(I,1)=PHITMP(I,1)<a name='4205'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4206'>
1115  CONTINUE<a name='4207'>
      DO 1119 K=2,L<a name='4208'>
      DO 1117 I=MYIS,MYIE<a name='4209'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4210'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4211'>
1117  CONTINUE<a name='4212'>
1119  CONTINUE<a name='4213'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4214'></font>
      DO 1121 K=1,L<a name='4215'>
      DO 1121 I=MYIS,MYIE<a name='4216'>
      FAC1(I,K)=ACOMB(9)*TOPM(I,K)<a name='4217'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(9)*TOPPHI(I,K))<a name='4218'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4219'>
                 BETACM(9)*TOTVO2(I,K+1)*SKO2D))*CO2SP1(I,K+1)<a name='4220'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4221'>
1121  CONTINUE<a name='4222'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4223'></font>
      DO 1153 K=1,L<a name='4224'>
      DO 1153 I=MYIS,MYIE<a name='4225'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,9)* &amp;<a name='4226'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4227'>
1153  CONTINUE<a name='4228'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4229'></font>
      DO 1161 I=MYIS,MYIE<a name='4230'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,9)+ &amp;<a name='4231'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4232'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4233'>
         (SORC(I,LP1,9)-SORC(I,L,9)))<a name='4234'>
1161  CONTINUE<a name='4235'>
<font color=#447700>!<a name='4236'></font>
<font color=#447700>!-----CALCULATION FOR BAND 10 (670-800 CM-1; INCLUDES CO2)<a name='4237'></font>
<font color=#447700>!<a name='4238'></font>
<font color=#447700>!<a name='4239'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4240'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4241'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4242'></font>
      DO 1201 K=1,L<a name='4243'>
      DO 1201 I=MYIS,MYIE<a name='4244'>
      F(I,K)=H44194M2*(APCM(10)*X(I,K)+BPCM(10)*Y(I,K))<a name='4245'>
      FF(I,K)=H44194M2*(ATPCM(10)*X(I,K)+BTPCM(10)*Y(I,K))<a name='4246'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4247'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4248'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4249'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4250'>
1201  CONTINUE<a name='4251'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4252'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4253'></font>
      DO 1215 I=MYIS,MYIE<a name='4254'>
      TOPM(I,1)=PHITMP(I,1)<a name='4255'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4256'>
1215  CONTINUE<a name='4257'>
      DO 1219 K=2,L<a name='4258'>
      DO 1217 I=MYIS,MYIE<a name='4259'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4260'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4261'>
1217  CONTINUE<a name='4262'>
1219  CONTINUE<a name='4263'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4264'></font>
      DO 1221 K=1,L<a name='4265'>
      DO 1221 I=MYIS,MYIE<a name='4266'>
      FAC1(I,K)=ACOMB(10)*TOPM(I,K)<a name='4267'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(10)*TOPPHI(I,K))<a name='4268'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4269'>
                 BETACM(10)*TOTVO2(I,K+1)*SKO2D))*CO2SP2(I,K+1)<a name='4270'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4271'>
1221  CONTINUE<a name='4272'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4273'></font>
      DO 1253 K=1,L<a name='4274'>
      DO 1253 I=MYIS,MYIE<a name='4275'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,10)* &amp;<a name='4276'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4277'>
1253  CONTINUE<a name='4278'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4279'></font>
      DO 1261 I=MYIS,MYIE<a name='4280'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,10)+ &amp;<a name='4281'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4282'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4283'>
         (SORC(I,LP1,10)-SORC(I,L,10)))<a name='4284'>
1261  CONTINUE<a name='4285'>
<font color=#447700>!<a name='4286'></font>
<font color=#447700>!-----CALCULATION FOR BAND 11 (800-900 CM-1)<a name='4287'></font>
<font color=#447700>!<a name='4288'></font>
<font color=#447700>!<a name='4289'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4290'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4291'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4292'></font>
      DO 1301 K=1,L<a name='4293'>
      DO 1301 I=MYIS,MYIE<a name='4294'>
      F(I,K)=H44194M2*(APCM(11)*X(I,K)+BPCM(11)*Y(I,K))<a name='4295'>
      FF(I,K)=H44194M2*(ATPCM(11)*X(I,K)+BTPCM(11)*Y(I,K))<a name='4296'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4297'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4298'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4299'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4300'>
1301  CONTINUE<a name='4301'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4302'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4303'></font>
      DO 1315 I=MYIS,MYIE<a name='4304'>
      TOPM(I,1)=PHITMP(I,1)<a name='4305'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4306'>
1315  CONTINUE<a name='4307'>
      DO 1319 K=2,L<a name='4308'>
      DO 1317 I=MYIS,MYIE<a name='4309'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4310'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4311'>
1317  CONTINUE<a name='4312'>
1319  CONTINUE<a name='4313'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4314'></font>
      DO 1321 K=1,L<a name='4315'>
      DO 1321 I=MYIS,MYIE<a name='4316'>
      FAC1(I,K)=ACOMB(11)*TOPM(I,K)<a name='4317'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(11)*TOPPHI(I,K))<a name='4318'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4319'>
                 BETACM(11)*TOTVO2(I,K+1)*SKO2D))<a name='4320'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4321'>
1321  CONTINUE<a name='4322'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4323'></font>
      DO 1353 K=1,L<a name='4324'>
      DO 1353 I=MYIS,MYIE<a name='4325'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,11)* &amp;<a name='4326'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4327'>
1353  CONTINUE<a name='4328'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4329'></font>
      DO 1361 I=MYIS,MYIE<a name='4330'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,11)+ &amp;<a name='4331'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4332'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4333'>
         (SORC(I,LP1,11)-SORC(I,L,11)))<a name='4334'>
1361  CONTINUE<a name='4335'>
<font color=#447700>!<a name='4336'></font>
<font color=#447700>!-----CALCULATION FOR BAND 12 (900-990 CM-1)<a name='4337'></font>
<font color=#447700>!<a name='4338'></font>
<font color=#447700>!<a name='4339'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4340'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4341'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4342'></font>
      DO 1401 K=1,L<a name='4343'>
      DO 1401 I=MYIS,MYIE<a name='4344'>
      F(I,K)=H44194M2*(APCM(12)*X(I,K)+BPCM(12)*Y(I,K))<a name='4345'>
      FF(I,K)=H44194M2*(ATPCM(12)*X(I,K)+BTPCM(12)*Y(I,K))<a name='4346'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4347'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4348'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4349'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4350'>
1401  CONTINUE<a name='4351'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4352'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4353'></font>
      DO 1415 I=MYIS,MYIE<a name='4354'>
      TOPM(I,1)=PHITMP(I,1)<a name='4355'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4356'>
1415  CONTINUE<a name='4357'>
      DO 1419 K=2,L<a name='4358'>
      DO 1417 I=MYIS,MYIE<a name='4359'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4360'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4361'>
1417  CONTINUE<a name='4362'>
1419  CONTINUE<a name='4363'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4364'></font>
      DO 1421 K=1,L<a name='4365'>
      DO 1421 I=MYIS,MYIE<a name='4366'>
      FAC1(I,K)=ACOMB(12)*TOPM(I,K)<a name='4367'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(12)*TOPPHI(I,K))<a name='4368'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4369'>
                 BETACM(12)*TOTVO2(I,K+1)*SKO2D))<a name='4370'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4371'>
1421  CONTINUE<a name='4372'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4373'></font>
      DO 1453 K=1,L<a name='4374'>
      DO 1453 I=MYIS,MYIE<a name='4375'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,12)* &amp;<a name='4376'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4377'>
1453  CONTINUE<a name='4378'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4379'></font>
      DO 1461 I=MYIS,MYIE<a name='4380'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,12)+ &amp;<a name='4381'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4382'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4383'>
         (SORC(I,LP1,12)-SORC(I,L,12)))<a name='4384'>
1461  CONTINUE<a name='4385'>
<font color=#447700>!<a name='4386'></font>
<font color=#447700>!-----CALCULATION FOR BAND 13 (990-1070 CM-1; INCLUDES O3))<a name='4387'></font>
<font color=#447700>!<a name='4388'></font>
<font color=#447700>!<a name='4389'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4390'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4391'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4392'></font>
      DO 1501 K=1,L<a name='4393'>
      DO 1501 I=MYIS,MYIE<a name='4394'>
      F(I,K)=H44194M2*(APCM(13)*X(I,K)+BPCM(13)*Y(I,K))<a name='4395'>
      FF(I,K)=H44194M2*(ATPCM(13)*X(I,K)+BTPCM(13)*Y(I,K))<a name='4396'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4397'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4398'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4399'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4400'>
1501  CONTINUE<a name='4401'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4402'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4403'></font>
      DO 1515 I=MYIS,MYIE<a name='4404'>
      TOPM(I,1)=PHITMP(I,1)<a name='4405'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4406'>
1515  CONTINUE<a name='4407'>
      DO 1519 K=2,L<a name='4408'>
      DO 1517 I=MYIS,MYIE<a name='4409'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4410'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4411'>
1517  CONTINUE<a name='4412'>
1519  CONTINUE<a name='4413'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4414'></font>
      DO 1521 K=1,L<a name='4415'>
      DO 1521 I=MYIS,MYIE<a name='4416'>
      FAC1(I,K)=ACOMB(13)*TOPM(I,K)<a name='4417'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(13)*TOPPHI(I,K))<a name='4418'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4419'>
                 BETACM(13)*TOTVO2(I,K+1)*SKO2D+TO3SPC(I,K)))<a name='4420'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4421'>
1521  CONTINUE<a name='4422'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4423'></font>
      DO 1553 K=1,L<a name='4424'>
      DO 1553 I=MYIS,MYIE<a name='4425'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,13)* &amp;<a name='4426'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4427'>
1553  CONTINUE<a name='4428'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4429'></font>
      DO 1561 I=MYIS,MYIE<a name='4430'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,13)+ &amp;<a name='4431'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4432'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4433'>
         (SORC(I,LP1,13)-SORC(I,L,13)))<a name='4434'>
1561  CONTINUE<a name='4435'>
<font color=#447700>!<a name='4436'></font>
<font color=#447700>!-----CALCULATION FOR BAND 14 (1070-1200 CM-1)<a name='4437'></font>
<font color=#447700>!<a name='4438'></font>
<font color=#447700>!<a name='4439'></font>
<font color=#447700>!---OBTAIN TEMPERATURE CORRECTION (CAPPHI,CAPPSI),THEN MULTIPLY<a name='4440'></font>
<font color=#447700>!   BY OPTICAL PATH (VAR1,VAR2) TO COMPUTE TEMPERATURE-CORRECTED<a name='4441'></font>
<font color=#447700>!   OPTICAL PATH AND MEAN PRESSURE FOR A LAYER (PHITMP,PSITMP)<a name='4442'></font>
      DO 1601 K=1,L<a name='4443'>
      DO 1601 I=MYIS,MYIE<a name='4444'>
      F(I,K)=H44194M2*(APCM(14)*X(I,K)+BPCM(14)*Y(I,K))<a name='4445'>
      FF(I,K)=H44194M2*(ATPCM(14)*X(I,K)+BTPCM(14)*Y(I,K))<a name='4446'>
      AG(I,K)=(H1P41819+F(I,K))*F(I,K)+ONE<a name='4447'>
      AGG(I,K)=(H1P41819+FF(I,K))*FF(I,K)+ONE<a name='4448'>
      PHITMP(I,K)=VAR1(I,K)*(((( AG(I,K)*AG(I,K))**2)**2)**2)<a name='4449'>
      PSITMP(I,K)=VAR2(I,K)*(((( AGG(I,K)*AGG(I,K))**2)**2)**2)<a name='4450'>
1601  CONTINUE<a name='4451'>
<font color=#447700>!---OBTAIN OPTICAL PATH,MEAN PRESSURE FROM THE TOP TO THE PRESSURE<a name='4452'></font>
<font color=#447700>!   P(K) (TOPM,TOPPHI)<a name='4453'></font>
      DO 1615 I=MYIS,MYIE<a name='4454'>
      TOPM(I,1)=PHITMP(I,1)<a name='4455'>
      TOPPHI(I,1)=PSITMP(I,1)<a name='4456'>
1615  CONTINUE<a name='4457'>
      DO 1619 K=2,L<a name='4458'>
      DO 1617 I=MYIS,MYIE<a name='4459'>
      TOPM(I,K)=TOPM(I,K-1)+PHITMP(I,K)<a name='4460'>
      TOPPHI(I,K)=TOPPHI(I,K-1)+PSITMP(I,K)<a name='4461'>
1617  CONTINUE<a name='4462'>
1619  CONTINUE<a name='4463'>
<font color=#447700>!---TT IS THE CLOUD-FREE CTS TRANSMISSION FUNCTION<a name='4464'></font>
      DO 1621 K=1,L<a name='4465'>
      DO 1621 I=MYIS,MYIE<a name='4466'>
      FAC1(I,K)=ACOMB(14)*TOPM(I,K)<a name='4467'>
      FAC2(I,K)=FAC1(I,K)*TOPM(I,K)/(BCOMB(14)*TOPPHI(I,K))<a name='4468'>
      TT(I,K)=EXP(HM1EZ*(FAC1(I,K)/SQRT(ONE+FAC2(I,K))+ &amp;<a name='4469'>
                 BETACM(14)*TOTVO2(I,K+1)*SKO2D))<a name='4470'>
      CTMP(I,K+1)=TT(I,K)*CLDFAC(I,K+1,1)<a name='4471'>
1621  CONTINUE<a name='4472'>
<font color=#447700>!---EXCTS IS THE CTS COOLING RATE ACCUMULATED OVER FREQUENCY BANDS<a name='4473'></font>
      DO 1653 K=1,L<a name='4474'>
      DO 1653 I=MYIS,MYIE<a name='4475'>
      EXCTS(I,K)=EXCTS(I,K)+SORC(I,K,14)* &amp;<a name='4476'>
                   (CTMP(I,K+1)-CTMP(I,K))<a name='4477'>
1653  CONTINUE<a name='4478'>
<font color=#447700>!---GXCTS IS THE EXACT CTS TOP FLUX ACCUMULATED OVER FREQUENCY BANDS<a name='4479'></font>
      DO 1661 I=MYIS,MYIE<a name='4480'>
      GXCTS(I)=GXCTS(I)+CLDFAC(I,LP1,1)*(TT(I,L)*SORC(I,L,14)+ &amp;<a name='4481'>
         (HAF*DELP(I,L)*(TT(I,LM1)*(P(I,LP1)-PRESS(I,L)) + &amp;<a name='4482'>
         TT(I,L)*(P(I,LP1)+PRESS(I,L)-TWO*P(I,L)))) * &amp;<a name='4483'>
         (SORC(I,LP1,14)-SORC(I,L,14)))<a name='4484'>
1661  CONTINUE<a name='4485'>
<font color=#447700>!<a name='4486'></font>
<font color=#447700>!<a name='4487'></font>
<font color=#447700>!   OBTAIN CTS FLUX AT THE TOP BY INTEGRATION OF HEATING RATES AND<a name='4488'></font>
<font color=#447700>!   USING CTS FLUX AT THE BOTTOM (CURRENT VALUE OF GXCTS). NOTE<a name='4489'></font>
<font color=#447700>!   THAT THE PRESSURE QUANTITIES AND CONVERSION FACTORS HAVE NOT<a name='4490'></font>
<font color=#447700>!   BEEN INCLUDED EITHER IN EXCTS OR IN GXCTS. THESE CANCEL OUT, THUS<a name='4491'></font>
<font color=#447700>!   REDUCING COMPUTATIONS!<a name='4492'></font>
      DO 1731 K=1,L<a name='4493'>
      DO 1731 I=MYIS,MYIE<a name='4494'>
      GXCTS(I)=GXCTS(I)-EXCTS(I,K)<a name='4495'>
1731  CONTINUE<a name='4496'>
<font color=#447700>!<a name='4497'></font>
<font color=#447700>!   NOW SCALE THE COOLING RATE (EXCTS) BY INCLUDING THE PRESSURE<a name='4498'></font>
<font color=#447700>!   FACTOR (DELP) AND THE CONVERSION FACTOR (RADCON)<a name='4499'></font>
      DO 1741 K=1,L<a name='4500'>
      DO 1741 I=MYIS,MYIE<a name='4501'>
      EXCTS(I,K)=EXCTS(I,K)*RADCON*DELP(I,K)<a name='4502'>
1741  CONTINUE<a name='4503'>
<font color=#447700>!---THIS IS THE END OF THE EXACT CTS COMPUTATIONS; AT THIS POINT<a name='4504'></font>
<font color=#447700>!   EXCTS HAS ITS APPROPRIATE VALUE.<a name='4505'></font>
<font color=#447700>!<a name='4506'></font>
<font color=#447700>!*** COMPUTE APPROXIMATE CTS HEATING RATES FOR 15UM AND 9.6 UM BANDS<a name='4507'></font>
<font color=#447700>!     (CTSO3)<a name='4508'></font>
      DO 1711 K=1,L<a name='4509'>
      DO 1711 I=MYIS,MYIE<a name='4510'>
      CTMP2(I,K+1)=CO2SP(I,K+1)*CLDFAC(I,K+1,1)<a name='4511'>
      CTMP3(I,K+1)=TO3SP(I,K)*CLDFAC(I,K+1,1)<a name='4512'>
1711  CONTINUE<a name='4513'>
      DO 1701 K=1,L<a name='4514'>
      DO 1701 I=MYIS,MYIE<a name='4515'>
      CTSO3(I,K)=RADCON*DELP(I,K)* &amp;<a name='4516'>
           (CSOUR(I,K)*(CTMP2(I,K+1)-CTMP2(I,K)) + &amp;<a name='4517'>
            SORC(I,K,13)*(CTMP3(I,K+1)-CTMP3(I,K)))<a name='4518'>
1701  CONTINUE<a name='4519'>
<a name='4520'>
 END SUBROUTINE SPA88<a name='4521'>
<font color=#447700>!----------------------------------------------------------------------<a name='4522'></font>
<a name='4523'>
<A NAME='E290'><A href='../../html_code/phys/module_ra_gfdleta.F.html#E290' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4524'>
 <font color=#993300>SUBROUTINE </font><font color=#cc0000>E290</font>(EMISSB,EMISS,AVEPHI,KLEN,FXOE2,DTE2, &amp; <A href='../../call_to/E290.html' TARGET='index'>1</A><a name='4525'>
<font color=#447700>!                      T1,T2,T4,                                     &amp;<a name='4526'></font>
                       H16E1,HP1,H28E1,HAF,TEN,                      &amp;<a name='4527'>
                       ids,ide, jds,jde, kds,kde,                    &amp;<a name='4528'>
                       ims,ime, jms,jme, kms,kme,                    &amp;<a name='4529'>
                       its,ite, jts,jte, kts,kte                     )<a name='4530'>
<font color=#447700>!---------------------------------------------------------------------<a name='4531'></font>
 IMPLICIT NONE<a name='4532'>
<font color=#447700>!----------------------------------------------------------------------<a name='4533'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='4534'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='4535'>
                                    its,ite, jts,jte, kts,kte<a name='4536'>
      INTEGER, INTENT(IN)        :: KLEN<a name='4537'>
      REAL, INTENT(IN) :: H16E1,HP1,H28E1,HAF ,TEN<a name='4538'>
      REAL, INTENT(OUT),DIMENSION(its:ite,kts:kte+1) :: EMISSB<a name='4539'>
      REAL, INTENT(IN ),DIMENSION(its:ite,kts:kte+1) :: AVEPHI,FXOE2,DTE2<a name='4540'>
<a name='4541'>
<font color=#447700>!     REAL, INTENT(IN ), DIMENSION(5040) :: T1,T2,T4<a name='4542'></font>
<a name='4543'>
      REAL, INTENT(INOUT), DIMENSION(its:ite,kts:kte+1) :: EMISS<a name='4544'>
<a name='4545'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: TMP3,DT,FYO,DU<a name='4546'>
      INTEGER, DIMENSION(its:ite,kts:kte+1) :: IVAL<a name='4547'>
<a name='4548'>
<font color=#447700>!     REAL,    DIMENSION(28,180) :: TABLE1,TABLE2,TABLE3<a name='4549'></font>
<font color=#447700>!     EQUIVALENCE (T1(1),TABLE1(1,1)),(T2(1),TABLE2(1,1)), &amp;<a name='4550'></font>
<font color=#447700>!                 (T4(1),TABLE3(1,1))<a name='4551'></font>
<font color=#447700>!     EQUIVALENCE (TMP3,DT)<a name='4552'></font>
<a name='4553'>
      INTEGER :: K, I,KP,LLM2,J1,J3,KMAX,KMIN,KCLDS,ICNT,LLM1<a name='4554'>
      INTEGER :: L,LP1,LP2,LP3,LM1,LM2,LM3,MYIS,MYIE,LLP1,LL,KK<a name='4555'>
<a name='4556'>
      L=kte<a name='4557'>
      LP1=L+1;  LP2=L+2;  LP3=L+3; LLP1 = 2*L + 1<a name='4558'>
      LM1=L-1;  LM2=L-2;  LM3=L-3; LL = 2*L<a name='4559'>
      LLM2 = LL-2; LLM1=LL-1<a name='4560'>
      MYIS=its; MYIE=ite<a name='4561'>
<a name='4562'>
<a name='4563'>
<font color=#447700>!---FIRST WE OBTAIN THE EMISSIVITIES AS A FUNCTION OF TEMPERATURE<a name='4564'></font>
<font color=#447700>!   (INDEX FXO) AND WATER AMOUNT (INDEX FYO). THIS PART OF THE CODE<a name='4565'></font>
<font color=#447700>!   THUS GENERATES THE E2 FUNCTION.<a name='4566'></font>
<font color=#447700>!<a name='4567'></font>
<font color=#447700>!---CALCULATIONS FOR VARYING KP (FROM KP=K+1 TO LP1, INCLUDING SPECIAL<a name='4568'></font>
<font color=#447700>!   CASE: RESULTS ARE IN EMISS<a name='4569'></font>
<a name='4570'>
<a name='4571'>
<a name='4572'>
      DO 132 K=1,LP2-KLEN<a name='4573'>
      DO 132 I=MYIS,MYIE<a name='4574'>
      TMP3(I,K)=LOG10(AVEPHI(I,KLEN+K-1))+H16E1<a name='4575'>
      FYO(I,K)=AINT(TMP3(I,K)*TEN)<a name='4576'>
      DU(I,K)=TMP3(I,K)-HP1*FYO(I,K)<a name='4577'>
      FYO(I,K)=H28E1*FYO(I,K)<a name='4578'>
      IVAL(I,K)=FYO(I,K)+FXOE2(I,KLEN+K-1)<a name='4579'>
      EMISS(I,KLEN+K-1)=T1(IVAL(I,K))+DU(I,K)*T2(IVAL(I,K)) &amp; <a name='4580'>
                                 +DTE2(I,KLEN+K-1)*T4(IVAL(I,K))<a name='4581'>
132   CONTINUE<a name='4582'>
<font color=#447700>!---THE SPECIAL CASE EMISS(I,L) (LAYER KP) IS OBTAINED NOW<a name='4583'></font>
<font color=#447700>!   BY AVERAGING THE VALUES FOR L AND LP1:<a name='4584'></font>
      DO 1344 I=MYIS,MYIE<a name='4585'>
      EMISS(I,L)=HAF*(EMISS(I,L)+EMISS(I,LP1))<a name='4586'>
1344  CONTINUE<a name='4587'>
<font color=#447700>!---NOTE THAT EMISS(I,LP1) IS NOT USEFUL AFTER THIS POINT.<a name='4588'></font>
<font color=#447700>!<a name='4589'></font>
<font color=#447700>!---CALCULATIONS FOR KP=KLEN AND VARYING K; RESULTS ARE IN EMISSB.<a name='4590'></font>
<font color=#447700>!  IN THIS CASE, THE TEMPERATURE INDEX IS UNCHANGED, ALWAYS BEING<a name='4591'></font>
<font color=#447700>!  FXO(I,KLEN-1); THE WATER INDEX CHANGES, BUT IS SYMMETRICAL WITH<a name='4592'></font>
<font color=#447700>!  THAT FOR THE VARYING KP CASE.NOTE THAT THE SPECIAL CASE IS NOT<a name='4593'></font>
<font color=#447700>!  INVOLVED HERE.<a name='4594'></font>
<font color=#447700>!     (FIXED LEVEL) K VARIES FROM (KLEN+1) TO LP1; RESULTS ARE IN<a name='4595'></font>
<font color=#447700>!   EMISSB(I,(KLEN) TO L)<a name='4596'></font>
      DO 142 K=1,LP1-KLEN<a name='4597'>
      DO 142 I=MYIS,MYIE<a name='4598'>
      DT(I,K)=DTE2(I,KLEN-1)<a name='4599'>
      IVAL(I,K)=FYO(I,K)+FXOE2(I,KLEN-1)<a name='4600'>
142   CONTINUE<a name='4601'>
<font color=#447700>!<a name='4602'></font>
      DO 234 K=1,LP1-KLEN<a name='4603'>
      DO 234 I=MYIS,MYIE<a name='4604'>
      EMISSB(I,KLEN+K-1)=T1(IVAL(I,K))+DU(I,K)*T2(IVAL(I,K)) &amp;<a name='4605'>
                                      +DT(I,K)*T4(IVAL(I,K))<a name='4606'>
234   CONTINUE<a name='4607'>
<a name='4608'>
 END SUBROUTINE E290<a name='4609'>
<a name='4610'>
<font color=#447700>!---------------------------------------------------------------------<a name='4611'></font>
<a name='4612'>
<A NAME='E2SPEC'><A href='../../html_code/phys/module_ra_gfdleta.F.html#E2SPEC' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4613'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>E2SPEC</font>(EMISS,AVEPHI,FXOSP,DTSP,                         &amp; <A href='../../call_to/E2SPEC.html' TARGET='index'>1</A><a name='4614'>
<font color=#447700>!                      T1,T2,T4,                                     &amp;<a name='4615'></font>
                       H16E1,TEN,H28E1,HP1,                          &amp;<a name='4616'>
                       ids,ide, jds,jde, kds,kde,                    &amp;<a name='4617'>
                       ims,ime, jms,jme, kms,kme,                    &amp;<a name='4618'>
                       its,ite, jts,jte, kts,kte                     )<a name='4619'>
<font color=#447700>!---------------------------------------------------------------------<a name='4620'></font>
 IMPLICIT NONE<a name='4621'>
<font color=#447700>!----------------------------------------------------------------------<a name='4622'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='4623'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='4624'>
                                    its,ite, jts,jte, kts,kte<a name='4625'>
      REAL,INTENT(IN ) :: H16E1,TEN,H28E1,HP1  <a name='4626'>
      REAL,INTENT(INOUT),DIMENSION(its:ite,kts:kte+1) :: EMISS<a name='4627'>
      REAL,INTENT(IN ),DIMENSION(its:ite,kts:kte+1) :: AVEPHI<a name='4628'>
      REAL,INTENT(IN ),DIMENSION(its:ite,2) :: FXOSP,DTSP<a name='4629'>
<a name='4630'>
<font color=#447700>!     REAL, INTENT(IN ),DIMENSION(5040) :: T1,T2,T4<a name='4631'></font>
<a name='4632'>
<font color=#447700>!     REAL, DIMENSION(28,180) :: TABLE1,TABLE2,TABLE3<a name='4633'></font>
<font color=#447700>!     EQUIVALENCE (T1(1),TABLE1(1,1)),(T2(1),TABLE2(1,1)), &amp;<a name='4634'></font>
<font color=#447700>!                 (T4(1),TABLE3(1,1))<a name='4635'></font>
<a name='4636'>
      INTEGER :: K,I,MYIS,MYIE<a name='4637'>
<a name='4638'>
      REAL,    DIMENSION(its:ite,kts:kte+1) :: TMP3,FYO,DU<a name='4639'>
      INTEGER, DIMENSION(its:ite,kts:kte+1) :: IVAL<a name='4640'>
<a name='4641'>
      MYIS=its<a name='4642'>
      MYIE=ite<a name='4643'>
<a name='4644'>
      DO 132 K=1,2<a name='4645'>
      DO 132 I=MYIS,MYIE<a name='4646'>
      TMP3(I,K)=LOG10(AVEPHI(I,K))+H16E1<a name='4647'>
      FYO(I,K)=AINT(TMP3(I,K)*TEN)<a name='4648'>
      DU(I,K)=TMP3(I,K)-HP1*FYO(I,K)<a name='4649'>
      IVAL(I,K)=H28E1*FYO(I,K)+FXOSP(I,K)<a name='4650'>
      EMISS(I,K)=T1(IVAL(I,K))+DU(I,K)*T2(IVAL(I,K))+ &amp;<a name='4651'>
                               DTSP(I,K)*T4(IVAL(I,K))<a name='4652'>
132   CONTINUE<a name='4653'>
<a name='4654'>
  END SUBROUTINE E2SPEC<a name='4655'>
<a name='4656'>
<font color=#447700>!---------------------------------------------------------------------<a name='4657'></font>
<a name='4658'>
<font color=#447700>! SUBROUTINE E3V88(EMV,TV,AV,EM3V,            &amp;<a name='4659'></font>
<A NAME='E3V88'><A href='../../html_code/phys/module_ra_gfdleta.F.html#E3V88' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4660'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>E3V88</font>(EMV,TV,AV, &amp; <A href='../../call_to/E3V88.html' TARGET='index'>1</A><a name='4661'>
                       TEN,HP1,H28E1,H16E1,  &amp;<a name='4662'>
                       ids,ide, jds,jde, kds,kde,                    &amp;<a name='4663'>
                       ims,ime, jms,jme, kms,kme,                    &amp;<a name='4664'>
                       its,ite, jts,jte, kts,kte                     )<a name='4665'>
<font color=#447700>!---------------------------------------------------------------------<a name='4666'></font>
 IMPLICIT NONE<a name='4667'>
<font color=#447700>!----------------------------------------------------------------------<a name='4668'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='4669'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='4670'>
                                    its,ite, jts,jte, kts,kte<a name='4671'>
      REAL,    INTENT(IN)  :: TEN,HP1,H28E1,H16E1 <a name='4672'>
<font color=#447700>!-----------------------------------------------------------------------<a name='4673'></font>
      REAL, INTENT(OUT), DIMENSION(its:ite,kts:kte*2+1) :: EMV<a name='4674'>
      REAL, INTENT(IN),  DIMENSION(its:ite,kts:kte*2+1) :: TV,AV<a name='4675'>
<font color=#447700>!     REAL, INTENT(IN),  DIMENSION(5040) :: EM3V<a name='4676'></font>
<a name='4677'>
      REAL,DIMENSION(its:ite,kts:kte*2+1) ::FXO,TMP3,DT,WW1,WW2,DU,&amp;<a name='4678'>
                                            FYO<a name='4679'>
<font color=#447700>!     REAL, DIMENSION(5040) :: EM3V<a name='4680'></font>
<a name='4681'>
<font color=#447700>!     EQUIVALENCE (EM3V(1),EM3(1,1))<a name='4682'></font>
<a name='4683'>
      INTEGER,DIMENSION(its:ite,kts:kte*2+1) ::IT<a name='4684'>
<a name='4685'>
      INTEGER :: LLP1,I,K,MYIS,MYIE ,L<a name='4686'>
      L = kte<a name='4687'>
      LLP1 = 2*L + 1<a name='4688'>
      MYIS=its; MYIE=ite<a name='4689'>
<a name='4690'>
<font color=#447700>!---THE FOLLOWING LOOP REPLACES A DOUBLE LOOP OVER I (1-IMAX) AND<a name='4691'></font>
<font color=#447700>!   K (1-LLP1)<a name='4692'></font>
<a name='4693'>
      DO 203 K=1,LLP1<a name='4694'>
      DO 203 I=MYIS,MYIE<a name='4695'>
        FXO(I,K)=AINT(TV(I,K)*HP1)<a name='4696'>
        TMP3(I,K)=LOG10(AV(I,K))+H16E1<a name='4697'>
        DT(I,K)=TV(I,K)-TEN*FXO(I,K)<a name='4698'>
        FYO(I,K)=AINT(TMP3(I,K)*TEN)<a name='4699'>
        DU(I,K)=TMP3(I,K)-HP1*FYO(I,K)<a name='4700'>
<font color=#447700>!---OBTAIN INDEX FOR TABLE LOOKUP; THIS VALUE WILL HAVE TO BE<a name='4701'></font>
<font color=#447700>!   DECREMENTED BY 9 TO ACCOUNT FOR TABLE TEMPS STARTING AT 100K.<a name='4702'></font>
        IT(I,K)=FXO(I,K)+FYO(I,K)*H28E1<a name='4703'>
        WW1(I,K)=TEN-DT(I,K)<a name='4704'>
        WW2(I,K)=HP1-DU(I,K)<a name='4705'>
        EMV(I,K)=WW1(I,K)*WW2(I,K)*EM3V(IT(I,K)-9)+ &amp;<a name='4706'>
                 WW2(I,K)*DT(I,K)*EM3V(IT(I,K)-8)+ &amp; <a name='4707'>
                 WW1(I,K)*DU(I,K)*EM3V(IT(I,K)+19)+ &amp; <a name='4708'>
                 DT(I,K)*DU(I,K)*EM3V(IT(I,K)+20)<a name='4709'>
203   CONTINUE<a name='4710'>
<a name='4711'>
  END SUBROUTINE E3V88<a name='4712'>
<font color=#447700>!-----------------------------------------------------------------------<a name='4713'></font>
<a name='4714'>
<A NAME='SWR93'><A href='../../html_code/phys/module_ra_gfdleta.F.html#SWR93' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4715'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>SWR93</font>(FSWC,HSWC,UFSWC,DFSWC,FSWL,HSWL,UFSWL,             &amp; <A href='../../call_to/SWR93.html' TARGET='index'>1</A><a name='4716'>
                       DFSWL,                                         &amp;<a name='4717'>
                       PRESS,COSZRO,TAUDAR,RH2O,RRCO2,SSOLAR,QO3,     &amp;<a name='4718'>
                       NCLDS,KTOPSW,KBTMSW,CAMT,CRR,CTT,              &amp;<a name='4719'>
                       ALVB,ALNB,ALVD,ALND,GDFVB,GDFNB,GDFVD,GDFND,   &amp;<a name='4720'>
<font color=#447700>!                      UCO2,UO3,TUCO2,TUO3,TDO3,TDCO2,                &amp;<a name='4721'></font>
                       ABCFF,PWTS,                                    &amp;<a name='4722'>
                       H35E1,H1224E3,ONE,ZERO,HAF,H69766E5,HP219,     &amp;<a name='4723'>
                       HP816,RRAYAV,GINV,CFCO2,CFO3,                  &amp;<a name='4724'>
                       TWO,H235M3,HP26,H129M2,H75826M4,H1036E2,       &amp;<a name='4725'>
                       H1P082,HMP805,H1386E2,H658M2,H2118M2,H42M2,    &amp;<a name='4726'>
                       H323M4,HM1EZ,DIFFCTR,O3DIFCTR,FIFTY,RADCON,    &amp;<a name='4727'>
                       ids,ide, jds,jde, kds,kde,                     &amp;<a name='4728'>
                       ims,ime, jms,jme, kms,kme,                     &amp;<a name='4729'>
                       its,ite, jts,jte, kts,kte                      )<a name='4730'>
<font color=#447700>!----------------------------------------------------------------------<a name='4731'></font>
 IMPLICIT NONE<a name='4732'>
<font color=#447700>!----------------------------------------------------------------------<a name='4733'></font>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='4734'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='4735'>
                                    its,ite, jts,jte, kts,kte<a name='4736'>
      REAL,INTENT(IN) :: RRCO2,SSOLAR<a name='4737'>
      REAL,INTENT(IN) :: H35E1,H1224E3,ONE,ZERO,HAF,H69766E5,HP219,HP816,RRAYAV,&amp;<a name='4738'>
                         GINV,CFCO2,CFO3<a name='4739'>
      REAL,INTENT(IN) :: TWO,H235M3,HP26,H129M2,H75826M4,H1036E2  <a name='4740'>
      REAL,INTENT(IN) :: H1P082,HMP805,H1386E2,H658M2,H2118M2,H42M2,H323M4,HM1EZ<a name='4741'>
      REAL,INTENT(IN) :: DIFFCTR,O3DIFCTR,FIFTY,RADCON<a name='4742'>
<font color=#447700>!----------------------------------------------------------------------<a name='4743'></font>
      INTEGER, PARAMETER :: NB=12<a name='4744'>
      REAL,    INTENT(IN ),DIMENSION(its:ite,kts:kte+1) :: PRESS,CAMT<a name='4745'>
      REAL,    INTENT(IN ),DIMENSION(its:ite,kts:kte) :: RH2O,QO3<a name='4746'>
      REAL,    INTENT(IN ),DIMENSION(its:ite) :: COSZRO,TAUDAR,ALVB,ALVD,ALNB,ALND<a name='4747'>
      INTEGER, INTENT(IN ),DIMENSION(its:ite) :: NCLDS<a name='4748'>
      INTEGER, INTENT(IN ),DIMENSION(its:ite,kts:kte+1) ::KTOPSW,KBTMSW<a name='4749'>
      REAL, INTENT(IN ),DIMENSION(its:ite,NB,kts:kte+1) ::CRR,CTT<a name='4750'>
           <a name='4751'>
      REAL, INTENT(OUT),DIMENSION(its:ite,kts:kte+1) ::     &amp;<a name='4752'>
                                       FSWC,HSWC,UFSWC,DFSWC,FSWL,HSWL,UFSWL,DFSWL<a name='4753'>
      REAL, INTENT(OUT),DIMENSION(its:ite) :: GDFVB,GDFVD,GDFNB,GDFND<a name='4754'>
      REAL, INTENT(IN), DIMENSION(NB) :: ABCFF,PWTS<a name='4755'>
<a name='4756'>
<font color=#447700>!     REAL, INTENT(IN), DIMENSION(its:ite,kts:kte*2+2) :: UCO2,UO3<a name='4757'></font>
<font color=#447700>!     REAL, INTENT(IN), DIMENSION(its:ite,kts:kte+1)   :: TUCO2,TUO3,TDO3,TDCO2<a name='4758'></font>
<a name='4759'>
      REAL, DIMENSION(its:ite,kts:kte*2+2) :: UCO2,UO3<a name='4760'>
      REAL, DIMENSION(its:ite,kts:kte+1)   :: TUCO2,TUO3,TDO3,TDCO2<a name='4761'>
<a name='4762'>
      REAL, DIMENSION(its:ite,kts:kte*2+2) :: TCO2,TO3<a name='4763'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: PP,DP,PR2,DU,DUCO2,DUO3,UD,TTD<a name='4764'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: UDCO2,UDO3,UR,URCO2,URO3,TTU<a name='4765'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: DFN,UFN<a name='4766'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: XAMT,FF,FFCO2,FFO3,CR,CT<a name='4767'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: PPTOP,DPCLD,TTDB1,TTUB1<a name='4768'>
      REAL, DIMENSION(its:ite,kts:kte+1) :: TDCL1,TUCL1,TDCL2,DFNTRN,  &amp;<a name='4769'>
                                            UFNTRN,TCLU,TCLD,ALFA,ALFAU, &amp;<a name='4770'>
                                            UFNCLU,DFNCLU<a name='4771'>
<a name='4772'>
      REAL, DIMENSION(its:ite,NB) :: DFNTOP<a name='4773'>
      REAL, DIMENSION(its:ite) :: SECZ,TMP1,RRAY,REFL,REFL2,CCMAX<a name='4774'>
<a name='4775'>
<font color=#447700>!                    EQUIVALENCE &amp;<a name='4776'></font>
<font color=#447700>!       (UDO3,UO3(its,1),DFNCLU), (URO3,UO3(its,kte+2), UFNCLU) &amp;<a name='4777'></font>
<font color=#447700>!     , (UDCO2,UCO2(its,1),TCLD), (URCO2,UCO2(its,kte+2), TCLU) &amp;<a name='4778'></font>
<font color=#447700>!     , (TDO3 ,TO3(its,1),DFNTRN),(TUO3,TO3(its,kte+2), UFNTRN) &amp;<a name='4779'></font>
<font color=#447700>!     , (TDCO2,TCO2(its,1)      ),(TUCO2,TCO2(its,kte+2)        ) &amp;<a name='4780'></font>
<font color=#447700>!     , (FF   , ALFA ),   (FFCO2 , ALFAU ),   (FFO3  , TTDB1 ) &amp;<a name='4781'></font>
<font color=#447700>!     , (DU   , TTUB1),   (DUCO2 , TUCL1 ),   (DUO3  , TDCL1 ) &amp;<a name='4782'></font>
<font color=#447700>!     , (PR2  , TDCL2)<a name='4783'></font>
<a name='4784'>
<font color=#447700>!                    EQUIVALENCE &amp;<a name='4785'></font>
<font color=#447700>!       (UDO3,DFNCLU), (URO3,UFNCLU) &amp;<a name='4786'></font>
<font color=#447700>!     , (UDCO2,TCLD ), (URCO2,TCLU) &amp;<a name='4787'></font>
<font color=#447700>!     , (TDO3 ,DFNTRN),(TUO3,UFNTRN) &amp;<a name='4788'></font>
<font color=#447700>!!    , (TDCO2,TCO2(its,1)      ),(TUCO2,TCO2(its,kte+2)        ) &amp;<a name='4789'></font>
<font color=#447700>!     , (FF   , ALFA ),   (FFCO2 , ALFAU ),   (FFO3  , TTDB1 ) &amp;<a name='4790'></font>
<font color=#447700>!     , (DU   , TTUB1),   (DUCO2 , TUCL1 ),   (DUO3  , TDCL1 ) &amp;<a name='4791'></font>
<font color=#447700>!     , (PR2  , TDCL2)<a name='4792'></font>
<a name='4793'>
      INTEGER :: K,I,KP,N,IP,MYIS1,KCLDS,NNCLDS,JTOP,KK,J2,J3,J1<a name='4794'>
      INTEGER :: L,LP1,LP2,LP3,LM1,LM2,LM3,MYIS,MYIE,LLP1,LL<a name='4795'>
      REAL    :: DENOM,HTEMP,TEMPF,TEMPG<a name='4796'>
<a name='4797'>
      L=kte<a name='4798'>
      LP1=L+1;  LP2=L+2;  LP3=L+3; LLP1 = 2*L + 1<a name='4799'>
      LM1=L-1;  LM2=L-2;  LM3=L-3; LL = 2*L<a name='4800'>
      MYIS=its; MYIE=ite<a name='4801'>
      MYIS1=MYIS+1    <font color=#447700>! ??<a name='4802'></font>
<a name='4803'>
      DO 100 I=MYIS,MYIE<a name='4804'>
        SECZ(I) = H35E1/SQRT(H1224E3*COSZRO(I)*COSZRO(I)+ONE)<a name='4805'>
        PP(I,1)   = ZERO<a name='4806'>
        PP(I,LP1) = PRESS(I,LP1)<a name='4807'>
        TMP1(I)  = ONE/PRESS(I,LP1)<a name='4808'>
100   CONTINUE<a name='4809'>
      DO 110 K=1,LM1<a name='4810'>
      DO 110 I=MYIS,MYIE<a name='4811'>
        PP(I,K+1) = HAF*(PRESS(I,K+1)+PRESS(I,K))<a name='4812'>
110   CONTINUE<a name='4813'>
      DO 120 K=1,L<a name='4814'>
      DO 120 I=MYIS,MYIE<a name='4815'>
        DP (I,K) = PP(I,K+1)-PP(I,K)<a name='4816'>
        PR2(I,K) = HAF*(PP(I,K)+PP(I,K+1))<a name='4817'>
120   CONTINUE<a name='4818'>
      DO 130 K=1,L<a name='4819'>
      DO 130 I=MYIS,MYIE<a name='4820'>
        PR2(I,K) = PR2(I,K)*TMP1(I)<a name='4821'>
130   CONTINUE<a name='4822'>
<font color=#447700>!     CALCULATE ENTERING FLUX AT THE TOP FOR EACH BAND(IN CGS UNITS)<a name='4823'></font>
      DO 140 N=1,NB<a name='4824'>
      DO 140 IP=MYIS,MYIE<a name='4825'>
        DFNTOP(IP,N) = SSOLAR*H69766E5*COSZRO(IP)*TAUDAR(IP)*PWTS(N)<a name='4826'>
140   CONTINUE<a name='4827'>
<font color=#447700>!     EXECUTE THE LACIS-HANSEN REFLECTIVITY PARAMETERIZATION<a name='4828'></font>
<font color=#447700>!     FOR THE VISIBLE BAND<a name='4829'></font>
      DO 150 I=MYIS,MYIE<a name='4830'>
        RRAY(I) = HP219/(ONE+HP816*COSZRO(I))<a name='4831'>
        REFL(I) = RRAY(I) + (ONE-RRAY(I))*(ONE-RRAYAV)*ALVB(I)/ &amp;<a name='4832'>
                  (ONE-ALVD(I)*RRAYAV)<a name='4833'>
150   CONTINUE<a name='4834'>
      DO 155 I=MYIS,MYIE<a name='4835'>
        RRAY(I) = 0.104/(ONE+4.8*COSZRO(I))<a name='4836'>
        REFL2(I)= RRAY(I) + (ONE-RRAY(I))*(ONE-0.093)*ALVB(I)/ &amp;<a name='4837'>
                  (ONE-ALVD(I)*0.093)<a name='4838'>
155   CONTINUE<a name='4839'>
<font color=#447700>!     CALCULATE PRESSURE-WEIGHTED OPTICAL PATHS FOR EACH LAYER<a name='4840'></font>
<font color=#447700>!     IN UNITS OF CM-ATM. PRESSURE WEIGHTING IS USING PR2.<a name='4841'></font>
<font color=#447700>!     DU= VALUE FOR H2O;DUCO2 FOR CO2;DUO3 FOR O3.<a name='4842'></font>
      DO 160 K=1,L<a name='4843'>
      DO 160 I=MYIS,MYIE<a name='4844'>
        DU   (I,K) = GINV*RH2O(I,K)*DP(I,K)*PR2(I,K)<a name='4845'>
        DUCO2(I,K) = (RRCO2*GINV*CFCO2)*DP(I,K)*PR2(I,K)<a name='4846'>
        DUO3 (I,K) = (GINV*CFO3)*QO3(I,K)*DP(I,K)<a name='4847'>
160   CONTINUE<a name='4848'>
<font color=#447700>!<a name='4849'></font>
<font color=#447700>!                 CALCULATE CLEAR SKY SW FLUX<a name='4850'></font>
<font color=#447700>!<a name='4851'></font>
<font color=#447700>!     OBTAIN THE OPTICAL PATH FROM THE TOP OF THE ATMOSPHERE TO THE<a name='4852'></font>
<font color=#447700>!     FLUX PRESSURE. ANGULAR FACTORS ARE NOW INCLUDED. UD=DOWNWARD<a name='4853'></font>
<font color=#447700>!     PATH FOR H2O,WIGTH UR THE UPWARD PATH FOR H2O. CORRESPONDING<a name='4854'></font>
<font color=#447700>!     QUANTITIES FOR CO2,O3 ARE UDCO2/URCO2 AND UDO3/URO3.<a name='4855'></font>
      DO 200 IP=MYIS,MYIE<a name='4856'>
        UD   (IP,1) = ZERO<a name='4857'>
        UDCO2(IP,1) = ZERO<a name='4858'>
        UDO3 (IP,1) = ZERO<a name='4859'>
<font color=#447700>! SH<a name='4860'></font>
        UO3  (IP,1) = UDO3 (IP,1)<a name='4861'>
        UCO2 (IP,1) = UDCO2(IP,1)<a name='4862'>
<a name='4863'>
200   CONTINUE<a name='4864'>
      DO 210 K=2,LP1<a name='4865'>
      DO 210 I=MYIS,MYIE<a name='4866'>
        UD   (I,K) = UD   (I,K-1)+DU   (I,K-1)*SECZ(I)<a name='4867'>
        UDCO2(I,K) = UDCO2(I,K-1)+DUCO2(I,K-1)*SECZ(I)<a name='4868'>
        UDO3 (I,K) = UDO3 (I,K-1)+DUO3 (I,K-1)*SECZ(I)<a name='4869'>
<font color=#447700>! SH<a name='4870'></font>
        UO3  (I,K) = UDO3 (I,K)<a name='4871'>
        UCO2 (I,K) = UDCO2(I,K)<a name='4872'>
<a name='4873'>
210   CONTINUE<a name='4874'>
      DO 220 IP=MYIS,MYIE<a name='4875'>
        UR   (IP,LP1) = UD   (IP,LP1)<a name='4876'>
        URCO2(IP,LP1) = UDCO2(IP,LP1)<a name='4877'>
        URO3 (IP,LP1) = UDO3 (IP,LP1)<a name='4878'>
<font color=#447700>! SH<a name='4879'></font>
        UO3  (IP,LP1+LP1) = URO3 (IP,LP1) <a name='4880'>
        UCO2 (IP,LP1+LP1) = URCO2(IP,LP1)<a name='4881'>
<a name='4882'>
220   CONTINUE<a name='4883'>
      DO 230 K=L,1,-1<a name='4884'>
      DO 230 IP=MYIS,MYIE<a name='4885'>
        UR   (IP,K) = UR   (IP,K+1)+DU   (IP,K)*DIFFCTR<a name='4886'>
        URCO2(IP,K) = URCO2(IP,K+1)+DUCO2(IP,K)*DIFFCTR<a name='4887'>
        URO3 (IP,K) = URO3 (IP,K+1)+DUO3 (IP,K)*O3DIFCTR<a name='4888'>
<font color=#447700>! SH<a name='4889'></font>
        UO3 (IP,LP1+K) = URO3 (IP,K)<a name='4890'>
        UCO2(IP,LP1+K) = URCO2(IP,K)<a name='4891'>
<a name='4892'>
230   CONTINUE<a name='4893'>
<font color=#447700>!     CALCULATE CO2 ABSORPTIONS . THEY WILL BE USED IN NEAR INFRARED<a name='4894'></font>
<font color=#447700>!     BANDS.SINCE THE ABSORPTION AMOUNT IS GIVEN (IN THE FORMULA USED<a name='4895'></font>
<font color=#447700>!     BELOW, DERIVED FROM SASAMORI) IN TERMS OF THE TOTAL SOLAR FLUX,<a name='4896'></font>
<font color=#447700>!     AND THE ABSORPTION IS ONLY INCLUDED IN THE NEAR IR (50 PERCENT<a name='4897'></font>
<font color=#447700>!     OF THE SOLAR SPECTRUM), THE ABSORPTIONS ARE MULTIPLIED BY 2.<a name='4898'></font>
<font color=#447700>!       SINCE CODE ACTUALLY REQUIRES TRANSMISSIONS, THESE ARE THE<a name='4899'></font>
<font color=#447700>!     VALUES ACTUALLY STORED IN TCO2.<a name='4900'></font>
      DO 240 K=1,LL<a name='4901'>
      DO 240 I=MYIS,MYIE<a name='4902'>
       TCO2(I,K+1)=ONE-TWO*(H235M3*EXP(HP26*LOG(UCO2(I,K+1)+H129M2)) &amp;<a name='4903'>
                             -H75826M4)<a name='4904'>
240   CONTINUE<a name='4905'>
<a name='4906'>
<font color=#447700>! SH<a name='4907'></font>
      DO 241 K=1,L<a name='4908'>
      DO 241 I=MYIS,MYIE<a name='4909'>
        TDCO2(I,K+1)=TCO2(I,K+1)<a name='4910'>
241   CONTINUE<a name='4911'>
      DO 242 K=1,L<a name='4912'>
      DO 242 I=MYIS,MYIE<a name='4913'>
        TUCO2(I,K)=TCO2(I,LP1+K)<a name='4914'>
242   CONTINUE<a name='4915'>
<a name='4916'>
<font color=#447700>!     NOW CALCULATE OZONE ABSORPTIONS. THESE WILL BE USED IN<a name='4917'></font>
<font color=#447700>!     THE VISIBLE BAND.JUST AS IN THE CO2 CASE, SINCE THIS BAND IS<a name='4918'></font>
<font color=#447700>!     50 PERCENT OF THE SOLAR SPECTRUM,THE ABSORPTIONS ARE MULTIPLIED<a name='4919'></font>
<font color=#447700>!     BY 2. THE TRANSMISSIONS ARE STORED IN TO3.<a name='4920'></font>
      HTEMP = H1036E2*H1036E2*H1036E2<a name='4921'>
      DO 250 K=1,LL<a name='4922'>
      DO 250 I=MYIS,MYIE<a name='4923'>
        TO3(I,K+1)=ONE-TWO*UO3(I,K+1)* &amp;<a name='4924'>
                  (H1P082*EXP(HMP805*LOG(ONE+H1386E2*UO3(I,K+1)))+ &amp;<a name='4925'>
                  H658M2/(ONE+HTEMP*UO3(I,K+1)*UO3(I,K+1)*UO3(I,K+1))+ &amp;<a name='4926'>
                  H2118M2/(ONE+UO3(I,K+1)*(H42M2+H323M4*UO3(I,K+1))))<a name='4927'>
250   CONTINUE<a name='4928'>
<a name='4929'>
<font color=#447700>! SH<a name='4930'></font>
      DO 251 K=1,L<a name='4931'>
      DO 251 I=MYIS,MYIE<a name='4932'>
        TDO3(I,K+1)=TO3(I,K+1)<a name='4933'>
251   CONTINUE<a name='4934'>
      DO 252 K=1,L<a name='4935'>
      DO 252 I=MYIS,MYIE<a name='4936'>
        TUO3(I,K)=TO3(I,LP1+K)<a name='4937'>
252   CONTINUE<a name='4938'>
<a name='4939'>
<a name='4940'>
<font color=#447700>!   START FREQUENCY LOOP (ON N) HERE<a name='4941'></font>
<font color=#447700>!<a name='4942'></font>
<font color=#447700>!--- BAND 1 (VISIBLE) INCLUDES O3 AND H2O ABSORPTION<a name='4943'></font>
      DO 260 K=1,L<a name='4944'>
      DO 260 I=MYIS,MYIE<a name='4945'>
        TTD(I,K+1) = EXP(HM1EZ*MIN(FIFTY,ABCFF(1)*UD(I,K+1)))<a name='4946'>
        TTU(I,K) = EXP(HM1EZ*MIN(FIFTY,ABCFF(1)*UR(I,K)))<a name='4947'>
        DFN(I,K+1) = TTD(I,K+1)*TDO3(I,K+1)<a name='4948'>
        UFN(I,K) = TTU(I,K)*TUO3(I,K)<a name='4949'>
260   CONTINUE<a name='4950'>
      DO 270 I=MYIS,MYIE<a name='4951'>
        DFN(I,1)   = ONE<a name='4952'>
        UFN(I,LP1) = DFN(I,LP1)<a name='4953'>
270   CONTINUE<a name='4954'>
<font color=#447700>!     SCALE VISIBLE BAND FLUXES BY SOLAR FLUX AT THE TOP OF THE<a name='4955'></font>
<font color=#447700>!     ATMOSPHERE (DFNTOP(I,1))<a name='4956'></font>
<font color=#447700>!     DFSW/UFSW WILL BE THE FLUXES, SUMMED OVER ALL BANDS<a name='4957'></font>
      DO 280  K=1,LP1<a name='4958'>
      DO 280  I=MYIS,MYIE<a name='4959'>
        DFSWL(I,K) =         DFN(I,K)*DFNTOP(I,1)<a name='4960'>
        UFSWL(I,K) = REFL(I)*UFN(I,K)*DFNTOP(I,1)<a name='4961'>
280   CONTINUE<a name='4962'>
      DO 285 I=MYIS,MYIE<a name='4963'>
        GDFVB(I) = DFSWL(I,LP1)*EXP(-0.15746*SECZ(I))<a name='4964'>
        GDFVD(I) = ((ONE-REFL2(I))*DFSWL(I,LP1) - &amp;<a name='4965'>
                    (ONE-ALVB(I)) *GDFVB(I)) / (ONE-ALVD(I))<a name='4966'>
        GDFNB(I) = ZERO<a name='4967'>
        GDFND(I) = ZERO<a name='4968'>
285   CONTINUE<a name='4969'>
<font color=#447700>!---NOW OBTAIN FLUXES FOR THE NEAR IR BANDS. THE METHODS ARE THE SAME<a name='4970'></font>
<font color=#447700>!   AS FOR THE VISIBLE BAND, EXCEPT THAT THE REFLECTION AND<a name='4971'></font>
<font color=#447700>!   TRANSMISSION COEFFICIENTS (OBTAINED BELOW) ARE DIFFERENT, AS<a name='4972'></font>
<font color=#447700>!   RAYLEIGH SCATTERING NEED NOT BE CONSIDERED.<a name='4973'></font>
      DO 350 N=2,NB<a name='4974'>
        IF (N.EQ.2) THEN<a name='4975'>
<font color=#447700>!   THE WATER VAPOR TRANSMISSION FUNCTION FOR BAND 2 IS EQUAL TO<a name='4976'></font>
<font color=#447700>!   THAT OF BAND 1 (SAVED AS TTD,TTU)<a name='4977'></font>
<font color=#447700>!--- BAND 2-9 (NEAR-IR) INCLUDES O3, CO2 AND H2O ABSORPTION<a name='4978'></font>
          DO 290 K=1,L<a name='4979'>
          DO 290 I=MYIS,MYIE<a name='4980'>
            DFN(I,K+1) = TTD(I,K+1)*TDCO2(I,K+1)<a name='4981'>
            UFN(I,K) = TTU(I,K)*TUCO2(I,K)<a name='4982'>
290       CONTINUE<a name='4983'>
        ELSE<a name='4984'>
<font color=#447700>!   CALCULATE WATER VAPOR TRANSMISSION FUNCTIONS FOR NEAR INFRARED<a name='4985'></font>
<font color=#447700>!   BANDS. INCLUDE CO2 TRANSMISSION (TDCO2/TUCO2), WHICH<a name='4986'></font>
<font color=#447700>!   IS THE SAME FOR ALL INFRARED BANDS.<a name='4987'></font>
          DO 300 K=1,L<a name='4988'>
          DO 300 I=MYIS,MYIE<a name='4989'>
            DFN(I,K+1)=EXP(HM1EZ*MIN(FIFTY,ABCFF(N)*UD(I,K+1))) &amp;<a name='4990'>
                       *TDCO2(I,K+1)<a name='4991'>
            UFN(I,K)=EXP(HM1EZ*MIN(FIFTY,ABCFF(N)*UR(I,K))) &amp;<a name='4992'>
                     *TUCO2(I,K)<a name='4993'>
300       CONTINUE<a name='4994'>
        ENDIF<a name='4995'>
<font color=#447700>!---AT THIS POINT,INCLUDE DFN(1),UFN(LP1), NOTING THAT DFN(1)=1 FOR<a name='4996'></font>
<font color=#447700>!   ALL BANDS, AND THAT UFN(LP1)=DFN(LP1) FOR ALL BANDS.<a name='4997'></font>
        DO 310 I=MYIS,MYIE<a name='4998'>
          DFN(I,1)   = ONE<a name='4999'>
          UFN(I,LP1) = DFN(I,LP1)<a name='5000'>
310     CONTINUE<a name='5001'>
<font color=#447700>!     SCALE THE PREVIOUSLY COMPUTED FLUXES BY THE FLUX AT THE TOP<a name='5002'></font>
<font color=#447700>!     AND SUM OVER BANDS<a name='5003'></font>
        DO 320 K=1,LP1<a name='5004'>
        DO 320 I=MYIS,MYIE<a name='5005'>
          DFSWL(I,K) = DFSWL(I,K) +         DFN(I,K)*DFNTOP(I,N)<a name='5006'>
          UFSWL(I,K) = UFSWL(I,K) + ALNB(I)*UFN(I,K)*DFNTOP(I,N)<a name='5007'>
320     CONTINUE<a name='5008'>
        DO 330 I=MYIS,MYIE<a name='5009'>
          GDFNB(I) = GDFNB(I) + DFN(I,LP1)*DFNTOP(I,N)<a name='5010'>
330     CONTINUE<a name='5011'>
350   CONTINUE<a name='5012'>
      DO 360 K=1,LP1<a name='5013'>
      DO 360 I=MYIS,MYIE<a name='5014'>
        FSWL(I,K) = UFSWL(I,K)-DFSWL(I,K)<a name='5015'>
360   CONTINUE<a name='5016'>
      DO 370 K=1,L<a name='5017'>
      DO 370 I=MYIS,MYIE<a name='5018'>
        HSWL(I,K)=RADCON*(FSWL(I,K+1)-FSWL(I,K))/DP(I,K)<a name='5019'>
370   CONTINUE<a name='5020'>
<font color=#447700>!<a name='5021'></font>
<font color=#447700>!---END OF FREQUENCY LOOP (OVER N)<a name='5022'></font>
<font color=#447700>!<a name='5023'></font>
<font color=#447700>!                 CALCULATE CLOUDY SKY SW FLUX<a name='5024'></font>
<font color=#447700>!<a name='5025'></font>
      KCLDS=NCLDS(MYIS)<a name='5026'>
      DO 400 I=MYIS1,MYIE<a name='5027'>
        KCLDS=MAX(NCLDS(I),KCLDS)<a name='5028'>
400   CONTINUE<a name='5029'>
        DO 410 K=1,LP1<a name='5030'>
        DO 410 I=MYIS,MYIE<a name='5031'>
          DFSWC(I,K) = DFSWL(I,K)<a name='5032'>
          UFSWC(I,K) = UFSWL(I,K)<a name='5033'>
          FSWC (I,K) = FSWL (I,K)<a name='5034'>
410     CONTINUE<a name='5035'>
        DO 420 K=1,L<a name='5036'>
        DO 420 I=MYIS,MYIE<a name='5037'>
          HSWC(I,K) = HSWL(I,K)<a name='5038'>
420     CONTINUE<a name='5039'>
<font color=#447700>!*******************************************************************<a name='5040'></font>
      IF (KCLDS .EQ. 0)  RETURN<a name='5041'>
<font color=#447700>!*******************************************************************<a name='5042'></font>
      DO 430 K=1,LP1<a name='5043'>
      DO 430 I=MYIS,MYIE<a name='5044'>
        XAMT(I,K) = CAMT(I,K)<a name='5045'>
430   CONTINUE<a name='5046'>
      DO 470 I=MYIS,MYIE<a name='5047'>
        NNCLDS   = NCLDS(I)<a name='5048'>
        CCMAX(I) = ZERO<a name='5049'>
        IF (NNCLDS .LE. 0) GO TO 470<a name='5050'>
        CCMAX(I) = ONE<a name='5051'>
        DO 450 K=1,NNCLDS<a name='5052'>
          CCMAX(I) = CCMAX(I) * (ONE - CAMT(I,K+1))<a name='5053'>
450     CONTINUE<a name='5054'>
        CCMAX(I) = ONE - CCMAX(I)<a name='5055'>
        IF (CCMAX(I) .GT. ZERO) THEN<a name='5056'>
          DO 460 K=1,NNCLDS<a name='5057'>
            XAMT(I,K+1) = CAMT(I,K+1)/CCMAX(I)<a name='5058'>
460       CONTINUE<a name='5059'>
        END IF<a name='5060'>
470   CONTINUE<a name='5061'>
      DO 480 K=1,LP1<a name='5062'>
      DO 480 I=MYIS,MYIE<a name='5063'>
        FF   (I,K) = DIFFCTR<a name='5064'>
        FFCO2(I,K) = DIFFCTR<a name='5065'>
        FFO3 (I,K) = O3DIFCTR<a name='5066'>
480   CONTINUE<a name='5067'>
      DO 490 IP=MYIS,MYIE<a name='5068'>
        JTOP = KTOPSW(IP,NCLDS(IP)+1)<a name='5069'>
      DO 490 K=1,JTOP<a name='5070'>
        FF   (IP,K) = SECZ(IP)<a name='5071'>
        FFCO2(IP,K) = SECZ(IP)<a name='5072'>
        FFO3 (IP,K) = SECZ(IP)<a name='5073'>
490   CONTINUE<a name='5074'>
      DO 500 I=MYIS,MYIE<a name='5075'>
        RRAY(I) = HP219/(ONE+HP816*COSZRO(I))<a name='5076'>
        REFL(I) = RRAY(I) + (ONE-RRAY(I))*(ONE-RRAYAV)*ALVD(I)/ &amp;<a name='5077'>
                  (ONE-ALVD(I)*RRAYAV)<a name='5078'>
500   CONTINUE<a name='5079'>
      DO 510 IP=MYIS,MYIE<a name='5080'>
        UD   (IP,1) = ZERO<a name='5081'>
        UDCO2(IP,1) = ZERO<a name='5082'>
        UDO3 (IP,1) = ZERO<a name='5083'>
<font color=#447700>! SH<a name='5084'></font>
        UO3  (IP,1) = UDO3 (IP,1)<a name='5085'>
        UCO2 (IP,1) = UDCO2(IP,1)<a name='5086'>
<a name='5087'>
510   CONTINUE<a name='5088'>
      DO 520 K=2,LP1<a name='5089'>
      DO 520 I=MYIS,MYIE<a name='5090'>
        UD   (I,K) = UD   (I,K-1)+DU   (I,K-1)*FF   (I,K)<a name='5091'>
        UDCO2(I,K) = UDCO2(I,K-1)+DUCO2(I,K-1)*FFCO2(I,K)<a name='5092'>
        UDO3 (I,K) = UDO3 (I,K-1)+DUO3 (I,K-1)*FFO3 (I,K)<a name='5093'>
<font color=#447700>! SH<a name='5094'></font>
        UO3 (I,K)  = UDO3 (I,K)<a name='5095'>
        UCO2(I,K)  = UDCO2(I,K)<a name='5096'>
<a name='5097'>
520   CONTINUE<a name='5098'>
      DO 530 IP=MYIS,MYIE<a name='5099'>
        UR   (IP,LP1) = UD   (IP,LP1)<a name='5100'>
        URCO2(IP,LP1) = UDCO2(IP,LP1)<a name='5101'>
        URO3 (IP,LP1) = UDO3 (IP,LP1)<a name='5102'>
<font color=#447700>! SH<a name='5103'></font>
        UO3  (IP,LP1+LP1) = URO3 (IP,LP1)<a name='5104'>
        UCO2 (IP,LP1+LP1) = URCO2(IP,LP1)<a name='5105'>
<a name='5106'>
530   CONTINUE<a name='5107'>
      DO 540 K=L,1,-1<a name='5108'>
      DO 540 IP=MYIS,MYIE<a name='5109'>
        UR   (IP,K) = UR   (IP,K+1)+DU   (IP,K)*DIFFCTR<a name='5110'>
        URCO2(IP,K) = URCO2(IP,K+1)+DUCO2(IP,K)*DIFFCTR<a name='5111'>
        URO3 (IP,K) = URO3 (IP,K+1)+DUO3 (IP,K)*O3DIFCTR<a name='5112'>
<font color=#447700>! SH<a name='5113'></font>
        UO3 (IP,LP1+K) = URO3 (IP,K)<a name='5114'>
        UCO2(IP,LP1+K) = URCO2(IP,K)<a name='5115'>
<a name='5116'>
540   CONTINUE<a name='5117'>
      DO 550 K=1,LL<a name='5118'>
      DO 550 I=MYIS,MYIE<a name='5119'>
        TCO2(I,K+1)=ONE-TWO*(H235M3*EXP(HP26*LOG(UCO2(I,K+1)+H129M2)) &amp;<a name='5120'>
                              -H75826M4)<a name='5121'>
550   CONTINUE<a name='5122'>
<font color=#447700>! SH<a name='5123'></font>
      DO 551 K=1,L<a name='5124'>
      DO 551 I=MYIS,MYIE<a name='5125'>
        TDCO2(I,K+1)=TCO2(I,K+1)<a name='5126'>
551   CONTINUE<a name='5127'>
      DO 552 K=1,L<a name='5128'>
      DO 552 I=MYIS,MYIE<a name='5129'>
        TUCO2(I,K)=TCO2(I,LP1+K)<a name='5130'>
552   CONTINUE<a name='5131'>
<a name='5132'>
      DO 560 K=1,LL<a name='5133'>
      DO 560 I=MYIS,MYIE<a name='5134'>
        TO3(I,K+1)=ONE-TWO*UO3(I,K+1)* &amp;<a name='5135'>
                 (H1P082*EXP(HMP805*LOG(ONE+H1386E2*UO3(I,K+1)))+ &amp;<a name='5136'>
                H658M2/(ONE+HTEMP*UO3(I,K+1)*UO3(I,K+1)*UO3(I,K+1))+ &amp;<a name='5137'>
                H2118M2/(ONE+UO3(I,K+1)*(H42M2+H323M4*UO3(I,K+1))))<a name='5138'>
560   CONTINUE<a name='5139'>
<font color=#447700>! SH<a name='5140'></font>
      DO 561 K=1,L<a name='5141'>
      DO 561 I=MYIS,MYIE<a name='5142'>
        TDO3(I,K+1)=TO3(I,K+1)<a name='5143'>
561   CONTINUE<a name='5144'>
      DO 562 K=1,L<a name='5145'>
      DO 562 I=MYIS,MYIE<a name='5146'>
        TUO3(I,K)=TO3(I,LP1+K)<a name='5147'>
562   CONTINUE<a name='5148'>
<a name='5149'>
<font color=#447700>!********************************************************************<a name='5150'></font>
<font color=#447700>!---THE FIRST CLOUD IS THE GROUND; ITS PROPERTIES ARE GIVEN<a name='5151'></font>
<font color=#447700>!   BY REFL (THE TRANSMISSION (0) IS IRRELEVANT FOR NOW!).<a name='5152'></font>
<font color=#447700>!********************************************************************<a name='5153'></font>
      DO 570 I=MYIS,MYIE<a name='5154'>
        CR(I,1) = REFL(I)<a name='5155'>
570   CONTINUE<a name='5156'>
<font color=#447700>!***OBTAIN CLOUD REFLECTION AND TRANSMISSION COEFFICIENTS FOR<a name='5157'></font>
<font color=#447700>!   REMAINING CLOUDS (IF ANY) IN THE VISIBLE BAND<a name='5158'></font>
<font color=#447700>!---THE MAXIMUM NO OF CLOUDS IN THE ROW (KCLDS) IS USED. THIS CREATES<a name='5159'></font>
<font color=#447700>!   EXTRA WORK (MAY BE REMOVED IN A SUBSEQUENT UPDATE).<a name='5160'></font>
      DO 581 I=MYIS,MYIE<a name='5161'>
      KCLDS=NCLDS(I)<a name='5162'>
      IF(KCLDS.EQ.0) GO TO 581<a name='5163'>
      DO 580 KK=2,KCLDS+1<a name='5164'>
        CR(I,KK) = CRR(I,1,KK)*XAMT(I,KK)<a name='5165'>
        CT(I,KK) = ONE - (ONE-CTT(I,1,KK))*XAMT(I,KK)<a name='5166'>
580   CONTINUE<a name='5167'>
581   CONTINUE<a name='5168'>
<font color=#447700>!---OBTAIN THE PRESSURE AT THE TOP,BOTTOM AND THE THICKNESS OF<a name='5169'></font>
<font color=#447700>!   "THICK" CLOUDS (THOSE AT LEAST 2 LAYERS THICK). THIS IS USED<a name='5170'></font>
<font color=#447700>!   LATER IS OBTAINING FLUXES INSIDE THE THICK CLOUDS, FOR ALL<a name='5171'></font>
<font color=#447700>!   FREQUENCY BANDS.<a name='5172'></font>
      DO 591 I=MYIS,MYIE<a name='5173'>
      KCLDS=NCLDS(I)<a name='5174'>
      IF(KCLDS.EQ.0) GO TO 591<a name='5175'>
      DO 590 KK=1,KCLDS<a name='5176'>
        IF ((KBTMSW(I,KK+1)-1).GT.KTOPSW(I,KK+1)) THEN<a name='5177'>
           PPTOP(I,KK)=PP(I,KTOPSW(I,KK+1))<a name='5178'>
           DPCLD(I,KK)=ONE/(PPTOP(I,KK)-PP(I,KBTMSW(I,KK+1)))<a name='5179'>
        ENDIF<a name='5180'>
590   CONTINUE<a name='5181'>
591   CONTINUE<a name='5182'>
      DO 600 K=1,L<a name='5183'>
      DO 600 I=MYIS,MYIE<a name='5184'>
        TTDB1(I,K+1) = EXP(HM1EZ*MIN(FIFTY,ABCFF(1)*UD(I,K+1)))<a name='5185'>
        TTUB1(I,K) = EXP(HM1EZ*MIN(FIFTY,ABCFF(1)*UR(I,K)))<a name='5186'>
        TTD  (I,K+1) = TTDB1(I,K+1)*TDO3(I,K+1)<a name='5187'>
        TTU  (I,K) = TTUB1(I,K)*TUO3(I,K)<a name='5188'>
600   CONTINUE<a name='5189'>
      DO 610 I=MYIS,MYIE<a name='5190'>
        TTD(I,1)   = ONE<a name='5191'>
        TTU(I,LP1) = TTD(I,LP1)<a name='5192'>
610   CONTINUE<a name='5193'>
<font color=#447700>!***FOR EXECUTION OF THE CLOUD LOOP, IT IS NECESSARY TO SEPARATE OUT<a name='5194'></font>
<font color=#447700>!   TRANSMISSION FCTNS AT THE TOP AND BOTTOM OF THE CLOUDS, FOR<a name='5195'></font>
<font color=#447700>!   EACH BAND N. THE REQUIRED QUANTITIES ARE:<a name='5196'></font>
<font color=#447700>!      TTD(I,KTOPSW(I,K),N)  K RUNS FROM 1 TO NCLDS(I)+1:<a name='5197'></font>
<font color=#447700>!      TTU(I,KTOPSW(I,K),N)  K RUNS FROM 1 TO NCLDS(I)+1:<a name='5198'></font>
<font color=#447700>!      TTD(I,KBTMSW(I,K),N)  K RUNS FROM 1 TO NCLDS(I)+1:<a name='5199'></font>
<font color=#447700>!      AND INVERSES OF THE FIRST TWO. THE ABOVE QUANTITIES ARE<a name='5200'></font>
<font color=#447700>!      STORED IN TDCL1,TUCL1,TDCL2, AND DFNTRN,UFNTRN, RESPECTIVELY,<a name='5201'></font>
<font color=#447700>!      AS THEY HAVE MULTIPLE USE IN THE PGM.<a name='5202'></font>
<font color=#447700>!---FOR FIRST CLOUD LAYER (GROUND) TDCL1,TUCL1 ARE KNOWN:<a name='5203'></font>
      DO 620 I=MYIS,MYIE<a name='5204'>
        TDCL1 (I,1) = TTD(I,LP1)<a name='5205'>
        TUCL1 (I,1) = TTU(I,LP1)<a name='5206'>
        TDCL2 (I,1) = TDCL1(I,1)<a name='5207'>
        DFNTRN(I,1) = ONE/TDCL1(I,1)<a name='5208'>
        UFNTRN(I,1) = DFNTRN(I,1)<a name='5209'>
620   CONTINUE<a name='5210'>
      DO 631 I=MYIS,MYIE<a name='5211'>
      KCLDS=NCLDS(I)<a name='5212'>
      IF(KCLDS.EQ.0) GO TO 631<a name='5213'>
      DO 630 KK=2,KCLDS+1<a name='5214'>
        TDCL1(I,KK) = TTD(I,KTOPSW(I,KK))<a name='5215'>
        TUCL1(I,KK) = TTU(I,KTOPSW(I,KK))<a name='5216'>
        TDCL2(I,KK) = TTD(I,KBTMSW(I,KK))<a name='5217'>
630   CONTINUE<a name='5218'>
631   CONTINUE<a name='5219'>
<font color=#447700>!---COMPUTE INVERSES<a name='5220'></font>
      DO 641 I=MYIS,MYIE<a name='5221'>
      KCLDS=NCLDS(I)<a name='5222'>
      IF(KCLDS.EQ.0) GO TO 641<a name='5223'>
<font color=#447700>! SH<a name='5224'></font>
      DO 640 KK=2,KCLDS+1<a name='5225'>
        DFNTRN(I,KK) = ONE/TDCL1(I,KK)<a name='5226'>
        UFNTRN(I,KK) = ONE/TUCL1(I,KK)<a name='5227'>
640   CONTINUE<a name='5228'>
641   CONTINUE<a name='5229'>
<font color=#447700>!---COMPUTE THE TRANSMISSIVITY FROM THE TOP OF CLOUD (K+1) TO THE<a name='5230'></font>
<font color=#447700>!   TOP OF CLOUD (K). THE CLOUD TRANSMISSION (CT) IS INCLUDED. THIS<a name='5231'></font>
<font color=#447700>!   QUANTITY IS CALLED TCLU (INDEX K). ALSO, OBTAIN THE TRANSMISSIVITY<a name='5232'></font>
<font color=#447700>!   FROM THE BOTTOM OF CLOUD (K+1) TO THE TOP OF CLOUD (K)(A PATH<a name='5233'></font>
<font color=#447700>!   ENTIRELY OUTSIDE CLOUDS). THIS QUANTITY IS CALLED TCLD (INDEX K).<a name='5234'></font>
      DO 651 I=MYIS,MYIE<a name='5235'>
      KCLDS=NCLDS(I)<a name='5236'>
      IF(KCLDS.EQ.0) GO TO 651<a name='5237'>
      DO 650 KK=1,KCLDS<a name='5238'>
        TCLU(I,KK) = TDCL1(I,KK)*DFNTRN(I,KK+1)*CT(I,KK+1)<a name='5239'>
        TCLD(I,KK) = TDCL1(I,KK)/TDCL2(I,KK+1)<a name='5240'>
650   CONTINUE<a name='5241'>
651   CONTINUE<a name='5242'>
<font color=#447700>!***THE FOLLOWING IS THE RECURSION RELATION FOR ALFA: THE REFLECTION<a name='5243'></font>
<font color=#447700>!   COEFFICIENT FOR A SYSTEM INCLUDING THE CLOUD IN QUESTION AND THE<a name='5244'></font>
<font color=#447700>!   FLUX COMING OUT OF THE CLOUD SYSTEM INCLUDING ALL CLOUDS BELOW<a name='5245'></font>
<font color=#447700>!   THE CLOUD IN QUESTION.<a name='5246'></font>
<font color=#447700>!---ALFAU IS ALFA WITHOUT THE REFLECTION OF THE CLOUD IN QUESTION<a name='5247'></font>
      DO 660 I=MYIS,MYIE<a name='5248'>
      KCLDS=NCLDS(I)<a name='5249'>
      IF(KCLDS.EQ.0) GO TO 660<a name='5250'>
        ALFA (I,1)=CR(I,1)<a name='5251'>
        ALFAU(I,1)=ZERO<a name='5252'>
660   CONTINUE<a name='5253'>
<font color=#447700>!---AGAIN,EXCESSIVE CALCULATIONS-MAY BE CHANGED LATER!<a name='5254'></font>
      DO 671 I=MYIS,MYIE<a name='5255'>
      KCLDS=NCLDS(I)<a name='5256'>
      IF(KCLDS.EQ.0) GO TO 671<a name='5257'>
      DO 670 KK=2,KCLDS+1<a name='5258'>
        ALFAU(I,KK)= TCLU(I,KK-1)*TCLU(I,KK-1)*ALFA(I,KK-1)/ &amp;<a name='5259'>
              (ONE - TCLD(I,KK-1)*TCLD(I,KK-1)*ALFA(I,KK-1)*CR(I,KK))<a name='5260'>
        ALFA (I,KK)= ALFAU(I,KK)+CR(I,KK)<a name='5261'>
670   CONTINUE<a name='5262'>
671   CONTINUE<a name='5263'>
<font color=#447700>!     CALCULATE UFN AT CLOUD TOPS AND DFN AT CLOUD BOTTOMS<a name='5264'></font>
<font color=#447700>!---NOTE THAT UFNCLU(I,KCLDS+1) GIVES THE UPWARD FLUX AT THE TOP<a name='5265'></font>
<font color=#447700>!   OF THE HIGHEST REAL CLOUD (IF NCLDS(I)=KCLDS). IT GIVES THE FLUX<a name='5266'></font>
<font color=#447700>!   AT THE TOP OF THE ATMOSPHERE IF NCLDS(I) &lt; KCLDS. IN THE FIRST<a name='5267'></font>
<font color=#447700>!   CASE, TDCL1 EQUALS THE TRANSMISSION FCTN TO THE TOP OF THE<a name='5268'></font>
<font color=#447700>!   HIGHEST CLOUD, AS WE WANT. IN THE SECOND CASE, TDCL1=1, SO UFNCLU<a name='5269'></font>
<font color=#447700>!   EQUALS ALFA. THIS IS ALSO CORRECT.<a name='5270'></font>
      DO 680 I=MYIS,MYIE<a name='5271'>
      KCLDS=NCLDS(I)<a name='5272'>
      IF(KCLDS.EQ.0) GO TO 680<a name='5273'>
        UFNCLU(I,KCLDS+1) = ALFA(I,KCLDS+1)*TDCL1(I,KCLDS+1)<a name='5274'>
        DFNCLU(I,KCLDS+1) = TDCL1(I,KCLDS+1)<a name='5275'>
680   CONTINUE<a name='5276'>
<font color=#447700>!---THIS CALCULATION IS THE REVERSE OF THE RECURSION RELATION USED<a name='5277'></font>
<font color=#447700>!  ABOVE<a name='5278'></font>
      DO 691 I=MYIS,MYIE<a name='5279'>
      KCLDS=NCLDS(I)<a name='5280'>
      IF(KCLDS.EQ.0) GO TO 691<a name='5281'>
      DO 690 KK=KCLDS,1,-1<a name='5282'>
        UFNCLU(I,KK) = UFNCLU(I,KK+1)*ALFAU(I,KK+1)/(ALFA(I,KK+1)* &amp;<a name='5283'>
                       TCLU(I,KK))<a name='5284'>
        DFNCLU(I,KK) = UFNCLU(I,KK)/ALFA(I,KK)<a name='5285'>
690   CONTINUE<a name='5286'>
691   CONTINUE<a name='5287'>
      DO 701 I=MYIS,MYIE<a name='5288'>
      KCLDS=NCLDS(I)<a name='5289'>
      IF(KCLDS.EQ.0) GO TO 701<a name='5290'>
      DO 700 KK=1,KCLDS+1<a name='5291'>
        UFNTRN(I,KK) = UFNCLU(I,KK)*UFNTRN(I,KK)<a name='5292'>
        DFNTRN(I,KK) = DFNCLU(I,KK)*DFNTRN(I,KK)<a name='5293'>
700   CONTINUE<a name='5294'>
701   CONTINUE<a name='5295'>
<font color=#447700>!---CASE OF KK=1( FROM THE GROUND TO THE BOTTOM OF THE LOWEST CLOUD)<a name='5296'></font>
      DO 720 I=MYIS,MYIE<a name='5297'>
      KCLDS=NCLDS(I)<a name='5298'>
      IF(KCLDS.EQ.0) GO TO 720<a name='5299'>
        J2=KBTMSW(I,2)<a name='5300'>
        DO 710 K=J2,LP1<a name='5301'>
          UFN(I,K) = UFNTRN(I,1)*TTU(I,K)<a name='5302'>
          DFN(I,K) = DFNTRN(I,1)*TTD(I,K)<a name='5303'>
710     CONTINUE<a name='5304'>
720   CONTINUE<a name='5305'>
<font color=#447700>!---REMAINING LEVELS (IF ANY!)<a name='5306'></font>
      DO 760 I=MYIS,MYIE<a name='5307'>
      KCLDS=NCLDS(I)<a name='5308'>
      IF(KCLDS.EQ.0) GO TO 760<a name='5309'>
      DO 755 KK=2,KCLDS+1<a name='5310'>
        J1=KTOPSW(I,KK)<a name='5311'>
        J2=KBTMSW(I,KK+1)<a name='5312'>
        IF (J1.EQ.1) GO TO 755<a name='5313'>
        DO 730 K=J2,J1<a name='5314'>
          UFN(I,K) = UFNTRN(I,KK)*TTU(I,K)<a name='5315'>
          DFN(I,K) = DFNTRN(I,KK)*TTD(I,K)<a name='5316'>
730     CONTINUE<a name='5317'>
<font color=#447700>!---FOR THE THICK CLOUDS, THE FLUX DIVERGENCE THROUGH THE CLOUD<a name='5318'></font>
<font color=#447700>!   LAYER IS ASSUMED TO BE CONSTANT. THE FLUX DERIVATIVE IS GIVEN BY<a name='5319'></font>
<font color=#447700>!   TEMPF (FOR THE UPWARD FLUX) AND TEMPG (FOR THE DOWNWARD FLUX).<a name='5320'></font>
        J3=KBTMSW(I,KK)<a name='5321'>
        IF ((J3-J1).GT.1) THEN<a name='5322'>
          TEMPF = (UFNCLU(I,KK)-UFN(I,J3))*DPCLD(I,KK-1)<a name='5323'>
          TEMPG = (DFNCLU(I,KK)-DFN(I,J3))*DPCLD(I,KK-1)<a name='5324'>
          DO 740 K=J1+1,J3-1<a name='5325'>
            UFN(I,K) = UFNCLU(I,KK)+TEMPF*(PP(I,K)-PPTOP(I,KK-1))<a name='5326'>
            DFN(I,K) = DFNCLU(I,KK)+TEMPG*(PP(I,K)-PPTOP(I,KK-1))<a name='5327'>
740       CONTINUE<a name='5328'>
        ENDIF<a name='5329'>
755   CONTINUE<a name='5330'>
760   CONTINUE<a name='5331'>
      DO 770 I=MYIS,MYIE<a name='5332'>
      KCLDS=NCLDS(I)<a name='5333'>
      IF(KCLDS.EQ.0) GO TO 770<a name='5334'>
      DO 771 K=1,LP1<a name='5335'>
        DFSWC(I,K) = DFN(I,K)*DFNTOP(I,1)<a name='5336'>
        UFSWC(I,K) = UFN(I,K)*DFNTOP(I,1)<a name='5337'>
771   CONTINUE<a name='5338'>
770   CONTINUE<a name='5339'>
      DO 780 I=MYIS,MYIE<a name='5340'>
      KCLDS=NCLDS(I)<a name='5341'>
      IF(KCLDS.EQ.0) GO TO 780<a name='5342'>
        TMP1(I) = ONE - CCMAX(I)<a name='5343'>
        GDFVB(I) = TMP1(I)*GDFVB(I)<a name='5344'>
        GDFNB(I) = TMP1(I)*GDFNB(I)<a name='5345'>
        GDFVD(I) = TMP1(I)*GDFVD(I) + CCMAX(I)*DFSWC(I,LP1)<a name='5346'>
780   CONTINUE<a name='5347'>
<font color=#447700>!---NOW OBTAIN FLUXES FOR THE NEAR IR BANDS. THE METHODS ARE THE SAME<a name='5348'></font>
<font color=#447700>!   AS FOR THE VISIBLE BAND, EXCEPT THAT THE REFLECTION AND<a name='5349'></font>
<font color=#447700>!   TRANSMISSION COEFFICIENTS ARE DIFFERENT, AS<a name='5350'></font>
<font color=#447700>!   RAYLEIGH SCATTERING NEED NOT BE CONSIDERED.<a name='5351'></font>
<font color=#447700>!<a name='5352'></font>
      DO 1000 N=2,NB<a name='5353'>
<font color=#447700>!YH93<a name='5354'></font>
        DO 791 I=MYIS,MYIE<a name='5355'>
        KCLDS=NCLDS(I)<a name='5356'>
        IF(KCLDS.EQ.0) GO TO 791<a name='5357'>
        DO 790 K=1,KCLDS+1<a name='5358'>
          CR(I,K) = CRR(I,N,K)*XAMT(I,K)<a name='5359'>
          CT(I,K) = ONE - (ONE-CTT(I,N,K))*XAMT(I,K)<a name='5360'>
790     CONTINUE<a name='5361'>
791     CONTINUE<a name='5362'>
<font color=#447700>!YH93<a name='5363'></font>
        IF (N.EQ.2) THEN<a name='5364'>
<font color=#447700>!   THE WATER VAPOR TRANSMISSION FUNCTION FOR BAND 2 IS EQUAL TO<a name='5365'></font>
<font color=#447700>!   THAT OF BAND 1 (SAVED AS TTDB1,TTUB1)<a name='5366'></font>
          DO 800 I=MYIS,MYIE<a name='5367'>
        KCLDS=NCLDS(I)<a name='5368'>
        IF(KCLDS.EQ.0) GO TO 800<a name='5369'>
        DO 801 KK=2,LP1<a name='5370'>
            TTD(I,KK) = TTDB1(I,KK)*TDCO2(I,KK)<a name='5371'>
801     CONTINUE<a name='5372'>
        DO 802 KK=1,L<a name='5373'>
            TTU(I,KK) = TTUB1(I,KK)*TUCO2(I,KK)<a name='5374'>
802     CONTINUE<a name='5375'>
800       CONTINUE<a name='5376'>
        ELSE<a name='5377'>
          DO 810 I=MYIS,MYIE<a name='5378'>
        KCLDS=NCLDS(I)<a name='5379'>
        IF(KCLDS.EQ.0) GO TO 810<a name='5380'>
        DO 811 KK=2,LP1<a name='5381'>
            TTD(I,KK) = EXP(HM1EZ*MIN(FIFTY,ABCFF(N)*UD(I,KK))) &amp;<a name='5382'>
                     * TDCO2(I,KK)<a name='5383'>
811     CONTINUE<a name='5384'>
        DO 812 KK=1,L<a name='5385'>
            TTU(I,KK) = EXP(HM1EZ*MIN(FIFTY,ABCFF(N)*UR(I,KK))) &amp;<a name='5386'>
                     * TUCO2(I,KK)<a name='5387'>
812     CONTINUE<a name='5388'>
810       CONTINUE<a name='5389'>
        ENDIF<a name='5390'>
<font color=#447700>!---AT THIS POINT,INCLUDE TTD(1),TTU(LP1), NOTING THAT TTD(1)=1 FOR<a name='5391'></font>
<font color=#447700>!   ALL BANDS, AND THAT TTU(LP1)=TTD(LP1) FOR ALL BANDS.<a name='5392'></font>
        DO 820 I=MYIS,MYIE<a name='5393'>
        KCLDS=NCLDS(I)<a name='5394'>
        IF(KCLDS.EQ.0) GO TO 820<a name='5395'>
          TTU(I,LP1) = TTD(I,LP1)<a name='5396'>
          TTD(I,1)   = ONE<a name='5397'>
820     CONTINUE<a name='5398'>
<font color=#447700>!***FOR EXECUTION OF THE CLOUD LOOP, IT IS NECESSARY TO SEPARATE OUT<a name='5399'></font>
<font color=#447700>!   TRANSMISSION FCTNS AT THE TOP AND BOTTOM OF THE CLOUDS, FOR<a name='5400'></font>
<font color=#447700>!   EACH BAND N. THE REQUIRED QUANTITIES ARE:<a name='5401'></font>
<font color=#447700>!      TTD(I,KTOPSW(I,K),N)  K RUNS FROM 1 TO NCLDS(I)+1:<a name='5402'></font>
<font color=#447700>!      TTD(I,KBTMSW(I,K),N)  K RUNS FROM 2 TO NCLDS(I)+1:<a name='5403'></font>
<font color=#447700>!      TTU(I,KTOPSW(I,K),N)  K RUNS FROM 1 TO NCLDS(I)+1:<a name='5404'></font>
<font color=#447700>!      AND INVERSES OF THE ABOVE. THE ABOVE QUANTITIES ARE STORED<a name='5405'></font>
<font color=#447700>!      IN TDCL1,TDCL2,TUCL1,AND DFNTRN,UFNTRN,RESPECTIVELY, AS<a name='5406'></font>
<font color=#447700>!      THEY HAVE MULTIPLE USE IN THE PGM.<a name='5407'></font>
<font color=#447700>!---FOR FIRST CLOUD LAYER (GROUND) TDCL1,TUCL1 ARE KNOWN:<a name='5408'></font>
        DO 830 I=MYIS,MYIE<a name='5409'>
        KCLDS=NCLDS(I)<a name='5410'>
        IF(KCLDS.EQ.0) GO TO 830<a name='5411'>
          TDCL1 (I,1) = TTD(I,LP1)<a name='5412'>
          TUCL1 (I,1) = TTU(I,LP1)<a name='5413'>
          TDCL2 (I,1) = TDCL1(I,1)<a name='5414'>
          DFNTRN(I,1) = ONE/TDCL1(I,1)<a name='5415'>
          UFNTRN(I,1) = DFNTRN(I,1)<a name='5416'>
830     CONTINUE<a name='5417'>
        DO 841 I=MYIS,MYIE<a name='5418'>
        KCLDS=NCLDS(I)<a name='5419'>
        IF(KCLDS.EQ.0) GO TO 841<a name='5420'>
        DO 840 KK=2,KCLDS+1<a name='5421'>
          TDCL1(I,KK) = TTD(I,KTOPSW(I,KK))<a name='5422'>
          TUCL1(I,KK) = TTU(I,KTOPSW(I,KK))<a name='5423'>
          TDCL2(I,KK) = TTD(I,KBTMSW(I,KK))<a name='5424'>
840     CONTINUE<a name='5425'>
841     CONTINUE<a name='5426'>
        DO 851 I=MYIS,MYIE<a name='5427'>
        KCLDS=NCLDS(I)<a name='5428'>
        IF(KCLDS.EQ.0) GO TO 851<a name='5429'>
        DO 850 KK=2,KCLDS+1<a name='5430'>
          DFNTRN(I,KK) = ONE/TDCL1(I,KK)<a name='5431'>
          UFNTRN(I,KK) = ONE/TUCL1(I,KK)<a name='5432'>
850     CONTINUE<a name='5433'>
851     CONTINUE<a name='5434'>
        DO 861 I=MYIS,MYIE<a name='5435'>
        KCLDS=NCLDS(I)<a name='5436'>
        IF(KCLDS.EQ.0) GO TO 861<a name='5437'>
        DO 860 KK=1,KCLDS<a name='5438'>
          TCLU(I,KK) = TDCL1(I,KK)*DFNTRN(I,KK+1)*CT(I,KK+1)<a name='5439'>
          TCLD(I,KK) = TDCL1(I,KK)/TDCL2(I,KK+1)<a name='5440'>
860     CONTINUE<a name='5441'>
861     CONTINUE<a name='5442'>
<font color=#447700>!***THE FOLLOWING IS THE RECURSION RELATION FOR ALFA: THE REFLECTION<a name='5443'></font>
<font color=#447700>!   COEFFICIENT FOR A SYSTEM INCLUDING THE CLOUD IN QUESTION AND THE<a name='5444'></font>
<font color=#447700>!   FLUX COMING OUT OF THE CLOUD SYSTEM INCLUDING ALL CLOUDS BELOW<a name='5445'></font>
<font color=#447700>!   THE CLOUD IN QUESTION.<a name='5446'></font>
        DO 870 I=MYIS,MYIE<a name='5447'>
        KCLDS=NCLDS(I)<a name='5448'>
        IF(KCLDS.EQ.0) GO TO 870<a name='5449'>
          ALFA (I,1) = CR(I,1)<a name='5450'>
          ALFAU(I,1) = ZERO<a name='5451'>
870     CONTINUE<a name='5452'>
<font color=#447700>!---AGAIN,EXCESSIVE CALCULATIONS-MAY BE CHANGED LATER!<a name='5453'></font>
        DO 881 I=MYIS,MYIE<a name='5454'>
        KCLDS=NCLDS(I)<a name='5455'>
        IF(KCLDS.EQ.0) GO TO 881<a name='5456'>
        DO 880 KK=2,KCLDS+1<a name='5457'>
          ALFAU(I,KK) = TCLU(I,KK-1)*TCLU(I,KK-1)*ALFA(I,KK-1)/(ONE - &amp;<a name='5458'>
                   TCLD(I,KK-1)*TCLD(I,KK-1)*ALFA(I,KK-1)*CR(I,KK))<a name='5459'>
          ALFA (I,KK) = ALFAU(I,KK)+CR(I,KK)<a name='5460'>
880     CONTINUE<a name='5461'>
881     CONTINUE<a name='5462'>
<font color=#447700>!     CALCULATE UFN AT CLOUD TOPS AND DFN AT CLOUD BOTTOMS<a name='5463'></font>
<font color=#447700>!---NOTE THAT UFNCLU(I,KCLDS+1) GIVES THE UPWARD FLUX AT THE TOP<a name='5464'></font>
<font color=#447700>!   OF THE HIGHEST REAL CLOUD (IF NCLDS(I)=KCLDS). IT GIVES THE FLUX<a name='5465'></font>
<font color=#447700>!   AT THE TOP OF THE ATMOSPHERE IF NCLDS(I) &lt; KCLDS. IT THE FIRST<a name='5466'></font>
<font color=#447700>!   CASE, TDCL1 EQUALS THE TRANSMISSION FCTN TO THE TOP OF THE<a name='5467'></font>
<font color=#447700>!   HIGHEST CLOUD, AS WE WANT. IN THE SECOND CASE, TDCL1=1, SO UFNCLU<a name='5468'></font>
<font color=#447700>!   EQUALS ALFA. THIS IS ALSO CORRECT.<a name='5469'></font>
        DO 890 I=MYIS,MYIE<a name='5470'>
        KCLDS=NCLDS(I)<a name='5471'>
        IF(KCLDS.EQ.0) GO TO 890<a name='5472'>
          UFNCLU(I,KCLDS+1) = ALFA(I,KCLDS+1)*TDCL1(I,KCLDS+1)<a name='5473'>
          DFNCLU(I,KCLDS+1) = TDCL1(I,KCLDS+1)<a name='5474'>
890     CONTINUE<a name='5475'>
        DO 901 I=MYIS,MYIE<a name='5476'>
        KCLDS=NCLDS(I)<a name='5477'>
        IF(KCLDS.EQ.0) GO TO 901<a name='5478'>
        DO 900 KK=KCLDS,1,-1<a name='5479'>
<font color=#447700>!<a name='5480'></font>
<font color=#447700>!***  ACCOUNT FOR UNREALISTICALLY SMALL CLOUD AMOUNT<a name='5481'></font>
<font color=#447700>!<a name='5482'></font>
        DENOM=ALFA(I,KK+1)*TCLU(I,KK)<a name='5483'>
        IF(DENOM.GT.RTHRESH)THEN<a name='5484'>
          UFNCLU(I,KK)=UFNCLU(I,KK+1)*ALFAU(I,KK+1)/DENOM<a name='5485'>
        ELSE<a name='5486'>
          UFNCLU(I,KK)=0.<a name='5487'>
        ENDIF<a name='5488'>
        IF(ALFA(I,KK).GT.RTHRESH)THEN<a name='5489'>
          DFNCLU(I,KK)=UFNCLU(I,KK)/ALFA(I,KK)<a name='5490'>
        ELSE<a name='5491'>
          DFNCLU(I,KK)=0.<a name='5492'>
        ENDIF<a name='5493'>
900     CONTINUE<a name='5494'>
901     CONTINUE<a name='5495'>
<font color=#447700>!     NOW OBTAIN DFN AND UFN FOR LEVELS BETWEEN THE CLOUDS<a name='5496'></font>
        DO 911 I=MYIS,MYIE<a name='5497'>
        KCLDS=NCLDS(I)<a name='5498'>
        IF(KCLDS.EQ.0) GO TO 911<a name='5499'>
        DO 910 KK=1,KCLDS+1<a name='5500'>
          UFNTRN(I,KK) = UFNCLU(I,KK)*UFNTRN(I,KK)<a name='5501'>
          DFNTRN(I,KK) = DFNCLU(I,KK)*DFNTRN(I,KK)<a name='5502'>
910     CONTINUE<a name='5503'>
911     CONTINUE<a name='5504'>
        DO 930 I=MYIS,MYIE<a name='5505'>
        KCLDS=NCLDS(I)<a name='5506'>
        IF(KCLDS.EQ.0) GO TO 930<a name='5507'>
          J2=KBTMSW(I,2)<a name='5508'>
          DO 920 K=J2,LP1<a name='5509'>
            UFN(I,K) = UFNTRN(I,1)*TTU(I,K)<a name='5510'>
            DFN(I,K) = DFNTRN(I,1)*TTD(I,K)<a name='5511'>
920       CONTINUE<a name='5512'>
930     CONTINUE<a name='5513'>
        DO 970  I=MYIS,MYIE<a name='5514'>
        KCLDS=NCLDS(I)<a name='5515'>
        IF(KCLDS.EQ.0) GO TO 970<a name='5516'>
        DO 965  KK=2,KCLDS+1<a name='5517'>
          J1 = KTOPSW(I,KK)<a name='5518'>
          J2 = KBTMSW(I,KK+1)<a name='5519'>
          IF (J1.EQ.1) GO TO 965<a name='5520'>
          DO 940 K=J2,J1<a name='5521'>
            UFN(I,K) = UFNTRN(I,KK)*TTU(I,K)<a name='5522'>
            DFN(I,K) = DFNTRN(I,KK)*TTD(I,K)<a name='5523'>
940       CONTINUE<a name='5524'>
          J3 = KBTMSW(I,KK)<a name='5525'>
          IF ((J3-J1).GT.1) THEN<a name='5526'>
            TEMPF = (UFNCLU(I,KK)-UFN(I,J3))*DPCLD(I,KK-1)<a name='5527'>
            TEMPG = (DFNCLU(I,KK)-DFN(I,J3))*DPCLD(I,KK-1)<a name='5528'>
            DO 950 K=J1+1,J3-1<a name='5529'>
              UFN(I,K) = UFNCLU(I,KK)+TEMPF*(PP(I,K)-PPTOP(I,KK-1))<a name='5530'>
              DFN(I,K) = DFNCLU(I,KK)+TEMPG*(PP(I,K)-PPTOP(I,KK-1))<a name='5531'>
950         CONTINUE<a name='5532'>
          ENDIF<a name='5533'>
965     CONTINUE<a name='5534'>
970     CONTINUE<a name='5535'>
        DO 980 I=MYIS,MYIE<a name='5536'>
        KCLDS=NCLDS(I)<a name='5537'>
        IF(KCLDS.EQ.0) GO TO 980<a name='5538'>
        DO 981 K=1,LP1<a name='5539'>
          DFSWC(I,K) = DFSWC(I,K) + DFN(I,K)*DFNTOP(I,N)<a name='5540'>
          UFSWC(I,K) = UFSWC(I,K) + UFN(I,K)*DFNTOP(I,N)<a name='5541'>
981     CONTINUE<a name='5542'>
980     CONTINUE<a name='5543'>
        DO 990 I=MYIS,MYIE<a name='5544'>
        KCLDS=NCLDS(I)<a name='5545'>
        IF(KCLDS.EQ.0) GO TO 990<a name='5546'>
          GDFND(I) = GDFND(I) + CCMAX(I)*DFN(I,LP1)*DFNTOP(I,N)<a name='5547'>
990     CONTINUE<a name='5548'>
1000  CONTINUE<a name='5549'>
      DO 1100 I=MYIS,MYIE<a name='5550'>
        KCLDS=NCLDS(I)<a name='5551'>
        IF(KCLDS.EQ.0) GO TO 1100<a name='5552'>
      DO 1101 K=1,LP1<a name='5553'>
        DFSWC(I,K) = TMP1(I)*DFSWL(I,K) + CCMAX(I)*DFSWC(I,K)<a name='5554'>
        UFSWC(I,K) = TMP1(I)*UFSWL(I,K) + CCMAX(I)*UFSWC(I,K)<a name='5555'>
1101  CONTINUE<a name='5556'>
1100  CONTINUE<a name='5557'>
      DO 1200 I=MYIS,MYIE<a name='5558'>
        KCLDS=NCLDS(I)<a name='5559'>
        IF(KCLDS.EQ.0) GO TO 1200<a name='5560'>
        DO 1201 KK=1,LP1<a name='5561'>
        FSWC(I,KK) = UFSWC(I,KK)-DFSWC(I,KK)<a name='5562'>
1201    CONTINUE<a name='5563'>
1200  CONTINUE<a name='5564'>
      DO 1250 I=MYIS,MYIE<a name='5565'>
        KCLDS=NCLDS(I)<a name='5566'>
        IF(KCLDS.EQ.0) GO TO 1250<a name='5567'>
        DO 1251 KK=1, L<a name='5568'>
        HSWC(I,KK) = RADCON*(FSWC(I,KK+1)-FSWC(I,KK))/DP(I,KK)<a name='5569'>
1251    CONTINUE<a name='5570'>
1250  CONTINUE<a name='5571'>
<a name='5572'>
  END SUBROUTINE SWR93<a name='5573'>
<font color=#447700>!-----------------------------------------------------------------------<a name='5574'></font>
<a name='5575'>
<A NAME='RADFS'><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADFS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5576'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>RADFS</font> &amp;  <A href='../../call_to/RADFS.html' TARGET='index'>1</A>,<A href='../../call_from/RADFS.html' TARGET='index'>4</A><a name='5577'>
<a name='5578'>
<font color=#447700>!     *****************************************************************<a name='5579'></font>
<font color=#447700>!     *                                                               *<a name='5580'></font>
<font color=#447700>!     *   THE INTERNAL DRIVE FOR GFDL RADIATION                       *<a name='5581'></font>
<font color=#447700>!     *   THIS SUBROUTINE WAS FROM Y.H AND K.A.C (1993)               *<a name='5582'></font>
<font color=#447700>!     *   AND MODIFIED BY Q. ZHAO FOR USE IN THE ETA MODEL            *<a name='5583'></font>
<font color=#447700>!     *                   NOV. 18,  1993                              *<a name='5584'></font>
<font color=#447700>!     *                                                               *<a name='5585'></font>
<font color=#447700>!     * UPDATE: THIS SUBROUTINE WAS MODIFIED TO USE CLOUD FRACTION    *<a name='5586'></font>
<font color=#447700>!     *         ON EACH MODEL LAYER.                                  *<a name='5587'></font>
<font color=#447700>!     *                                QINGYUN  ZHAO   95-3-22        *<a name='5588'></font>
<font color=#447700>!     *                                                               *<a name='5589'></font>
<font color=#447700>!     * UPDATE: R1 HAS BEEN ADDED TO THE INPUTS FROM RADTN TO         *<a name='5590'></font>
<font color=#447700>!     *         COMPUTE THE VARIATION OF SOLAR CONSTANT AT THE TOP    *<a name='5591'></font>
<font color=#447700>!     *         OF ATMOSPHERE WITH JULIAN DAY IN A YEAR.              *<a name='5592'></font>
<font color=#447700>!     *                                QINGYUN  ZHAO   96-7-23        *<a name='5593'></font>
<font color=#447700>!     *****************************************************************<a name='5594'></font>
<font color=#447700>!***<a name='5595'></font>
<font color=#447700>!***  REQUIRED INPUT:<a name='5596'></font>
<font color=#447700>!***<a name='5597'></font>
                (QS,PP,PPI,QQH2O,TT,O3QO3,TSFC,SLMSK,ALBEDO,XLAT &amp;<a name='5598'>
      ,          CAMT,KTOP,KBTM,NCLDS,EMCLD,RRCL,TTCL &amp;<a name='5599'>
      ,          COSZRO,TAUDAR,IBEG &amp;<a name='5600'>
      ,          KO3,KALB &amp;<a name='5601'>
      ,          ITIMSW,ITIMLW &amp;<a name='5602'>
<font color=#447700>!***************************************************************************<a name='5603'></font>
<font color=#447700>!*              IX IS THE LENGTH OF A ROW IN THE DOMAIN<a name='5604'></font>
<font color=#447700>!<a name='5605'></font>
<font color=#447700>!*   QS(IX):		THE SURFACE PRESSURE (PA)<a name='5606'></font>
<font color=#447700>!*   PP(IX,L):		THE MIDLAYER PRESSURES (PA)  (L IS THE VERT. DIMEN.)<a name='5607'></font>
<font color=#447700>!*   PPI(IX,LP1)	THE INTERFACE PRESSURES (PA)<a name='5608'></font>
<font color=#447700>!*   QQH2O(IX,L):	THE MIDLAYER WATER VAPOR MIXING RATIO (KG/KG)<a name='5609'></font>
<font color=#447700>!*   TT(IX,L):		THE MIDLAYER TEMPERATURE (K)<a name='5610'></font>
<font color=#447700>!*   O3QO3(IX,L):	THE MIDLAYER OZONE MIXING RATIO<a name='5611'></font>
<font color=#447700>!*   TSFC(IX):		THE SKIN TEMP. (K); NEGATIVE OVER WATER<a name='5612'></font>
<font color=#447700>!*   SLMSK(IX):		THE SEA MASK (LAND=0,SEA=1)<a name='5613'></font>
<font color=#447700>!*   ALBEDO(IX):	THE SURFACE ALBEDO (EXPRESSED AS A FRACTION)<a name='5614'></font>
<font color=#447700>!*   XLAT(IX):		THE GEODETIC LATITUDES OF EACH COLUMN IN DEGREES<a name='5615'></font>
<font color=#447700>!*				(N.H.&gt; 0)<a name='5616'></font>
<font color=#447700>!* THE FOLLOWING ARE CLOUD INFORMATION FOR EACH CLOUD LAYER<a name='5617'></font>
<font color=#447700>!*                      LAYER=1:SURFACE<a name='5618'></font>
<font color=#447700>!*                      LAYER=2:FIRST LAYER ABOVE GROUND, AND SO ON<a name='5619'></font>
<font color=#447700>!*   CAMT(IX,LP1):      CLOUD FRACTION OF EACH CLOUD LAYER<a name='5620'></font>
<font color=#447700>!*   ITYP(IX,LP1):      CLOUD TYPE(=1: STRATIFORM, =2:CONVECTIVE)<a name='5621'></font>
<font color=#447700>!*   KTOP(IX,LP1):      HEIGHT OF CLOUD TOP OF EACH CLOUD LAYER (IN ETA LEVEL)<a name='5622'></font>
<font color=#447700>!*   KBTM(IX,LP1):      BOTTOM OF EACH CLOUD LAYER<a name='5623'></font>
<font color=#447700>!*   NCLDS(IX):         NUMBER OF CLOUD LAYERS<a name='5624'></font>
<font color=#447700>!*   EMCLD(IX,LP1):     CLOUD EMISSIVITY<a name='5625'></font>
<font color=#447700>!*   RRCL(IX,NB,LP1)    CLOUD REFLECTTANCES FOR SW SPECTRAL BANDS<a name='5626'></font>
<font color=#447700>!*   TTCL(IX,NB,LP1)    CLOUD TRANSMITANCES FOR SW SPECTRAL BANDS<a name='5627'></font>
<font color=#447700>!* THE ABOVE ARE CLOUD INFORMATION FOR EACH CLOUD LAYER<a name='5628'></font>
<font color=#447700>!*<a name='5629'></font>
<font color=#447700>!*   COSZRO(IX):	THE COSINE OF THE SOLAR ZENITH ANGLE<a name='5630'></font>
<font color=#447700>!*   TAUDAR:		=1.0<a name='5631'></font>
<font color=#447700>!*   IBEG:		=1<a name='5632'></font>
<font color=#447700>!*   KO3:		=1 ( READ IN THE QZONE DATA)<a name='5633'></font>
<font color=#447700>!*   KALB:		=0<a name='5634'></font>
<font color=#447700>!*   SLMRF(LP1):	THE INTERFACE'S ETA (LP1=L+1)<a name='5635'></font>
<font color=#447700>!*   SLYMRF(L):		THE MIDLAYER ETA <a name='5636'></font>
<font color=#447700>!*   ITIMSW:		=1/0 (SHORTWAVE CALC. ARE DESIRED/NOT DESIRED)<a name='5637'></font>
<font color=#447700>!*   ITIMLW:		=1/0 (LONGWAVE CALC. ARE DESIRED/NOT DESIRED)<a name='5638'></font>
<font color=#447700>!************************************************************************<a name='5639'></font>
<font color=#447700>!***<a name='5640'></font>
<font color=#447700>!*** THE FOLLOWING ARE ADDITIONAL FOR ETA MODEL<a name='5641'></font>
<font color=#447700>!***<a name='5642'></font>
      ,          JD,GMT &amp;<a name='5643'>
<font color=#447700>!**************************************************************************<a name='5644'></font>
<font color=#447700>!*   JD: JULIAN DAY IN A YEAR<a name='5645'></font>
<font color=#447700>!*   R1: THE NON-DIMENSIONAL SUN-EARTH DISTANCE<a name='5646'></font>
<font color=#447700>!*   GMT:HOUR<a name='5647'></font>
<font color=#447700>!**************************************************************************<a name='5648'></font>
<font color=#447700>!***<a name='5649'></font>
<font color=#447700>!*** GENERATED OUTPUT REQUIRED BY THE ETA MODEL<a name='5650'></font>
<font color=#447700>!***<a name='5651'></font>
      ,          SWH,HLW &amp;<a name='5652'>
<font color=#447700>!     ,          T1,T2,T4,EM1V,EM1VW,EM3V                       &amp;<a name='5653'></font>
      ,          FLWUP,FSWUP,FSWDN,FSWDNS,FSWUPS,FLWDNS,FLWUPS  &amp;<a name='5654'>
<font color=#447700>!     ,          DDUO3N,DDO3N2,DDO3N3,DDO3N4                    &amp;<a name='5655'></font>
<font color=#447700>!     ,          SKO3R,AB15WD,SKC1R,SKO2D                       &amp;<a name='5656'></font>
      ,          ids,ide, jds,jde, kds,kde                      &amp;<a name='5657'>
      ,          ims,ime, jms,jme, kms,kme                      &amp;<a name='5658'>
      ,          its,ite, jts,jte, kts,kte                      )<a name='5659'>
<font color=#447700>!************************************************************************<a name='5660'></font>
<font color=#447700>!*    SWH: ATMOSPHERIC SHORTWAVE HEATING RATES IN K/S.<a name='5661'></font>
<font color=#447700>!*         SWH IS A REAL ARRAY DIMENSIONED (NCOL X LM).<a name='5662'></font>
<font color=#447700>!*    HLW: ATMOSPHERIC LONGWAVE HEATING RATES IN K/S.<a name='5663'></font>
<font color=#447700>!*         HLW IS A REAL ARRAY DIMENSIONED (NCOL X LM).<a name='5664'></font>
<font color=#447700>!*  FLWUP: UPWARD LONGWAVE FLUX AT TOP OF THE ATMOSPHERE IN W/M**2.<a name='5665'></font>
<font color=#447700>!*         FLWUP IS A REAL ARRAY DIMENSIONED (NCOL).<a name='5666'></font>
<font color=#447700>!*  FSWUP: UPWARD SHORTWAVE FLUX AT TOP OF THE ATMOSPHERE IN W/M**2.<a name='5667'></font>
<font color=#447700>!*         FSWUP IS A REAL ARRAY DIMENSIONED (NCOL).<a name='5668'></font>
<font color=#447700>!*  FSWDN: DOWNWARD SHORTWAVE FLUX AT TOP OF THE ATMOSPHERE IN W/M**2.<a name='5669'></font>
<font color=#447700>!*         FSWDN IS A REAL ARRAY DIMENSIONED (NCOL).<a name='5670'></font>
<font color=#447700>!* FSWDNS: DOWNWARD SHORTWAVE FLUX AT THE SURFACE IN W/M**2.<a name='5671'></font>
<font color=#447700>!*         FSWDNS IS A REAL ARRAY DIMENSIONED (NCOL).<a name='5672'></font>
<font color=#447700>!* FSWUPS: UPWARD SHORTWAVE FLUX AT THE SURFACE IN W/M**2.<a name='5673'></font>
<font color=#447700>!*         FSWUPS IS A REAL ARRAY DIMENSIONED (NCOL).<a name='5674'></font>
<font color=#447700>!* FLWDNS: DOWNWARD LONGWAVE FLUX AT THE SURFACE IN W/M**2.<a name='5675'></font>
<font color=#447700>!*         FLWDNS IS A REAL ARRAY DIMENSIONED (NCOL).<a name='5676'></font>
<font color=#447700>!* FLWUPS: UPWARD LONGWAVE FLUX AT THE SURFACE IN W/M**2.<a name='5677'></font>
<font color=#447700>!*         FLWUPS IS A REAL ARRAY DIMENSIONED (NCOL).<a name='5678'></font>
<font color=#447700>!************************************************************************<a name='5679'></font>
<font color=#447700>!***<a name='5680'></font>
<font color=#447700>!*** THE FOLLOWING OUTPUTS ARE NOT REQUIRED BY THE ETA MODEL<a name='5681'></font>
<font color=#447700>!***<a name='5682'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='5683'></font>
 IMPLICIT NONE<a name='5684'>
<font color=#447700>!----------------------------------------------------------------------<a name='5685'></font>
<font color=#447700>!INTEGER, PARAMETER :: NBLY=15<a name='5686'></font>
 INTEGER, PARAMETER :: NB=12<a name='5687'>
 INTEGER, PARAMETER :: NBLX=47<a name='5688'>
 INTEGER , PARAMETER:: NBLW = 163<a name='5689'>
<a name='5690'>
 REAL,PARAMETER ::      AMOLWT=28.9644<a name='5691'>
 REAL,PARAMETER ::      CSUBP=1.00484E7<a name='5692'>
 REAL,PARAMETER ::      DIFFCTR=1.66<a name='5693'>
 REAL,PARAMETER ::      G=980.665<a name='5694'>
 REAL,PARAMETER ::      GINV=1./G<a name='5695'>
 REAL,PARAMETER ::      GRAVDR=980.0<a name='5696'>
 REAL,PARAMETER ::      O3DIFCTR=1.90<a name='5697'>
 REAL,PARAMETER ::      P0=1013250.<a name='5698'>
 REAL,PARAMETER ::      P0INV=1./P0<a name='5699'>
 REAL,PARAMETER ::      GP0INV=GINV*P0INV<a name='5700'>
 REAL,PARAMETER ::      P0XZP2=202649.902<a name='5701'>
 REAL,PARAMETER ::      P0XZP8=810600.098<a name='5702'>
 REAL,PARAMETER ::      P0X2=2.*1013250.<a name='5703'>
 REAL,PARAMETER ::      RADCON=8.427<a name='5704'>
 REAL,PARAMETER ::      RADCON1=1./8.427<a name='5705'>
 REAL,PARAMETER ::      RATCO2MW=1.519449738<a name='5706'>
 REAL,PARAMETER ::      RATH2OMW=.622<a name='5707'>
 REAL,PARAMETER ::      RGAS=8.3142E7<a name='5708'>
 REAL,PARAMETER ::      RGASSP=8.31432E7<a name='5709'>
 REAL,PARAMETER ::      SECPDA=8.64E4<a name='5710'>
<font color=#447700>!<a name='5711'></font>
<font color=#447700>!******THE FOLLOWING ARE MATHEMATICAL CONSTANTS*******<a name='5712'></font>
<font color=#447700>!        ARRANGED IN DECREASING ORDER<a name='5713'></font>
 REAL,PARAMETER ::      HUNDRED=100.<a name='5714'>
 REAL,PARAMETER ::      HNINETY=90.<a name='5715'>
 REAL,PARAMETER ::      HNINE=9.0<a name='5716'>
 REAL,PARAMETER ::      SIXTY=60.<a name='5717'>
 REAL,PARAMETER ::      FIFTY=50.<a name='5718'>
 REAL,PARAMETER ::      TEN=10.<a name='5719'>
 REAL,PARAMETER ::      EIGHT=8.<a name='5720'>
 REAL,PARAMETER ::      FIVE=5.<a name='5721'>
 REAL,PARAMETER ::      FOUR=4.<a name='5722'>
 REAL,PARAMETER ::      THREE=3.<a name='5723'>
 REAL,PARAMETER ::      TWO=2.<a name='5724'>
 REAL,PARAMETER ::      ONE=1.<a name='5725'>
 REAL,PARAMETER ::      HAF=0.5<a name='5726'>
 REAL,PARAMETER ::      QUARTR=0.25<a name='5727'>
 REAL,PARAMETER ::      ZERO=0.<a name='5728'>
<font color=#447700>!<a name='5729'></font>
<font color=#447700>!******FOLLOWING ARE POSITIVE FLOATING POINT CONSTANTS(H'S)<a name='5730'></font>
<font color=#447700>!       ARRANGED IN DECREASING ORDER<a name='5731'></font>
 REAL,PARAMETER ::      H83E26=8.3E26<a name='5732'>
 REAL,PARAMETER ::      H71E26=7.1E26<a name='5733'>
 REAL,PARAMETER ::      H1E15=1.E15<a name='5734'>
 REAL,PARAMETER ::      H1E13=1.E13<a name='5735'>
 REAL,PARAMETER ::      H1E11=1.E11<a name='5736'>
 REAL,PARAMETER ::      H1E8=1.E8<a name='5737'>
 REAL,PARAMETER ::      H2E6=2.0E6<a name='5738'>
 REAL,PARAMETER ::      H1E6=1.0E6<a name='5739'>
 REAL,PARAMETER ::      H69766E5=6.97667E5<a name='5740'>
 REAL,PARAMETER ::      H4E5=4.E5<a name='5741'>
 REAL,PARAMETER ::      H165E5=1.65E5<a name='5742'>
 REAL,PARAMETER ::      H5725E4=57250.<a name='5743'>
 REAL,PARAMETER ::      H488E4=48800.<a name='5744'>
 REAL,PARAMETER ::      H1E4=1.E4<a name='5745'>
 REAL,PARAMETER ::      H24E3=2400.<a name='5746'>
 REAL,PARAMETER ::      H20788E3=2078.8<a name='5747'>
 REAL,PARAMETER ::      H2075E3=2075.<a name='5748'>
 REAL,PARAMETER ::      H18E3=1800.<a name='5749'>
 REAL,PARAMETER ::      H1224E3=1224.<a name='5750'>
 REAL,PARAMETER ::      H67390E2=673.9057<a name='5751'>
 REAL,PARAMETER ::      H5E2=500.<a name='5752'>
 REAL,PARAMETER ::      H3082E2=308.2<a name='5753'>
 REAL,PARAMETER ::      H3E2=300.<a name='5754'>
 REAL,PARAMETER ::      H2945E2=294.5<a name='5755'>
 REAL,PARAMETER ::      H29316E2=293.16<a name='5756'>
 REAL,PARAMETER ::      H26E2=260.0<a name='5757'>
 REAL,PARAMETER ::      H25E2=250.<a name='5758'>
 REAL,PARAMETER ::      H23E2=230.<a name='5759'>
 REAL,PARAMETER ::      H2E2=200.0<a name='5760'>
 REAL,PARAMETER ::      H15E2=150.<a name='5761'>
 REAL,PARAMETER ::      H1386E2=138.6<a name='5762'>
 REAL,PARAMETER ::      H1036E2=103.6<a name='5763'>
 REAL,PARAMETER ::      H8121E1=81.21<a name='5764'>
 REAL,PARAMETER ::      H35E1=35.<a name='5765'>
 REAL,PARAMETER ::      H3116E1=31.16<a name='5766'>
 REAL,PARAMETER ::      H28E1=28.<a name='5767'>
 REAL,PARAMETER ::      H181E1=18.1<a name='5768'>
 REAL,PARAMETER ::      H18E1=18.<a name='5769'>
 REAL,PARAMETER ::      H161E1=16.1<a name='5770'>
 REAL,PARAMETER ::      H16E1=16.<a name='5771'>
 REAL,PARAMETER ::      H1226E1=12.26<a name='5772'>
 REAL,PARAMETER ::      H9P94=9.94<a name='5773'>
 REAL,PARAMETER ::      H6P08108=6.081081081<a name='5774'>
 REAL,PARAMETER ::      H3P6=3.6<a name='5775'>
 REAL,PARAMETER ::      H3P5=3.5<a name='5776'>
 REAL,PARAMETER ::      H2P9=2.9<a name='5777'>
 REAL,PARAMETER ::      H2P8=2.8<a name='5778'>
 REAL,PARAMETER ::      H2P5=2.5<a name='5779'>
 REAL,PARAMETER ::      H1P8=1.8<a name='5780'>
 REAL,PARAMETER ::      H1P4387=1.4387<a name='5781'>
 REAL,PARAMETER ::      H1P41819=1.418191<a name='5782'>
 REAL,PARAMETER ::      H1P4=1.4<a name='5783'>
 REAL,PARAMETER ::      H1P25892=1.258925411<a name='5784'>
 REAL,PARAMETER ::      H1P082=1.082<a name='5785'>
 REAL,PARAMETER ::      HP816=0.816<a name='5786'>
 REAL,PARAMETER ::      HP805=0.805<a name='5787'>
 REAL,PARAMETER ::      HP8=0.8<a name='5788'>
 REAL,PARAMETER ::      HP60241=0.60241<a name='5789'>
 REAL,PARAMETER ::      HP602409=0.60240964<a name='5790'>
 REAL,PARAMETER ::      HP6=0.6<a name='5791'>
 REAL,PARAMETER ::      HP526315=0.52631579<a name='5792'>
 REAL,PARAMETER ::      HP518=0.518<a name='5793'>
 REAL,PARAMETER ::      HP5048=0.5048<a name='5794'>
 REAL,PARAMETER ::      HP3795=0.3795<a name='5795'>
 REAL,PARAMETER ::      HP369=0.369<a name='5796'>
 REAL,PARAMETER ::      HP26=0.26<a name='5797'>
 REAL,PARAMETER ::      HP228=0.228<a name='5798'>
 REAL,PARAMETER ::      HP219=0.219<a name='5799'>
 REAL,PARAMETER ::      HP166666=.166666<a name='5800'>
 REAL,PARAMETER ::      HP144=0.144<a name='5801'>
 REAL,PARAMETER ::      HP118666=0.118666192<a name='5802'>
 REAL,PARAMETER ::      HP1=0.1<a name='5803'>
<font color=#447700>!        (NEGATIVE EXPONENTIALS BEGIN HERE)<a name='5804'></font>
 REAL,PARAMETER ::      H658M2=0.0658<a name='5805'>
 REAL,PARAMETER ::      H625M2=0.0625<a name='5806'>
 REAL,PARAMETER ::      H44871M2=4.4871E-2<a name='5807'>
 REAL,PARAMETER ::      H44194M2=.044194<a name='5808'>
 REAL,PARAMETER ::      H42M2=0.042<a name='5809'>
 REAL,PARAMETER ::      H41666M2=0.0416666<a name='5810'>
 REAL,PARAMETER ::      H28571M2=.02857142857<a name='5811'>
 REAL,PARAMETER ::      H2118M2=0.02118<a name='5812'>
 REAL,PARAMETER ::      H129M2=0.0129<a name='5813'>
 REAL,PARAMETER ::      H1M2=.01<a name='5814'>
 REAL,PARAMETER ::      H559M3=5.59E-3<a name='5815'>
 REAL,PARAMETER ::      H3M3=0.003<a name='5816'>
 REAL,PARAMETER ::      H235M3=2.35E-3<a name='5817'>
 REAL,PARAMETER ::      H1M3=1.0E-3<a name='5818'>
 REAL,PARAMETER ::      H987M4=9.87E-4<a name='5819'>
 REAL,PARAMETER ::      H323M4=0.000323<a name='5820'>
 REAL,PARAMETER ::      H3M4=0.0003<a name='5821'>
 REAL,PARAMETER ::      H285M4=2.85E-4<a name='5822'>
 REAL,PARAMETER ::      H1M4=0.0001<a name='5823'>
 REAL,PARAMETER ::      H75826M4=7.58265E-4<a name='5824'>
 REAL,PARAMETER ::      H6938M5=6.938E-5<a name='5825'>
 REAL,PARAMETER ::      H394M5=3.94E-5<a name='5826'>
 REAL,PARAMETER ::      H37412M5=3.7412E-5<a name='5827'>
 REAL,PARAMETER ::      H15M5=1.5E-5<a name='5828'>
 REAL,PARAMETER ::      H1439M5=1.439E-5<a name='5829'>
 REAL,PARAMETER ::      H128M5=1.28E-5<a name='5830'>
 REAL,PARAMETER ::      H102M5=1.02E-5<a name='5831'>
 REAL,PARAMETER ::      H1M5=1.0E-5<a name='5832'>
 REAL,PARAMETER ::      H7M6=7.E-6<a name='5833'>
 REAL,PARAMETER ::      H4999M6=4.999E-6<a name='5834'>
 REAL,PARAMETER ::      H451M6=4.51E-6<a name='5835'>
 REAL,PARAMETER ::      H25452M6=2.5452E-6<a name='5836'>
 REAL,PARAMETER ::      H1M6=1.E-6<a name='5837'>
 REAL,PARAMETER ::      H391M7=3.91E-7<a name='5838'>
 REAL,PARAMETER ::      H1174M7=1.174E-7<a name='5839'>
 REAL,PARAMETER ::      H8725M8=8.725E-8<a name='5840'>
 REAL,PARAMETER ::      H327M8=3.27E-8<a name='5841'>
 REAL,PARAMETER ::      H257M8=2.57E-8<a name='5842'>
 REAL,PARAMETER ::      H1M8=1.0E-8<a name='5843'>
 REAL,PARAMETER ::      H23M10=2.3E-10<a name='5844'>
 REAL,PARAMETER ::      H14M10=1.4E-10<a name='5845'>
 REAL,PARAMETER ::      H11M10=1.1E-10<a name='5846'>
 REAL,PARAMETER ::      H1M10=1.E-10<a name='5847'>
 REAL,PARAMETER ::      H83M11=8.3E-11<a name='5848'>
 REAL,PARAMETER ::      H82M11=8.2E-11<a name='5849'>
 REAL,PARAMETER ::      H8M11=8.E-11<a name='5850'>
 REAL,PARAMETER ::      H77M11=7.7E-11<a name='5851'>
 REAL,PARAMETER ::      H72M11=7.2E-11<a name='5852'>
 REAL,PARAMETER ::      H53M11=5.3E-11<a name='5853'>
 REAL,PARAMETER ::      H48M11=4.8E-11<a name='5854'>
 REAL,PARAMETER ::      H44M11=4.4E-11<a name='5855'>
 REAL,PARAMETER ::      H42M11=4.2E-11<a name='5856'>
 REAL,PARAMETER ::      H37M11=3.7E-11<a name='5857'>
 REAL,PARAMETER ::      H35M11=3.5E-11<a name='5858'>
 REAL,PARAMETER ::      H32M11=3.2E-11<a name='5859'>
 REAL,PARAMETER ::      H3M11=3.0E-11<a name='5860'>
 REAL,PARAMETER ::      H28M11=2.8E-11<a name='5861'>
 REAL,PARAMETER ::      H24M11=2.4E-11<a name='5862'>
 REAL,PARAMETER ::      H23M11=2.3E-11<a name='5863'>
 REAL,PARAMETER ::      H2M11=2.E-11<a name='5864'>
 REAL,PARAMETER ::      H18M11=1.8E-11<a name='5865'>
 REAL,PARAMETER ::      H15M11=1.5E-11<a name='5866'>
 REAL,PARAMETER ::      H14M11=1.4E-11<a name='5867'>
 REAL,PARAMETER ::      H114M11=1.14E-11<a name='5868'>
 REAL,PARAMETER ::      H11M11=1.1E-11<a name='5869'>
 REAL,PARAMETER ::      H1M11=1.E-11<a name='5870'>
 REAL,PARAMETER ::      H96M12=9.6E-12<a name='5871'>
 REAL,PARAMETER ::      H93M12=9.3E-12<a name='5872'>
 REAL,PARAMETER ::      H77M12=7.7E-12<a name='5873'>
 REAL,PARAMETER ::      H74M12=7.4E-12<a name='5874'>
 REAL,PARAMETER ::      H65M12=6.5E-12<a name='5875'>
 REAL,PARAMETER ::      H62M12=6.2E-12<a name='5876'>
 REAL,PARAMETER ::      H6M12=6.E-12<a name='5877'>
 REAL,PARAMETER ::      H45M12=4.5E-12<a name='5878'>
 REAL,PARAMETER ::      H44M12=4.4E-12<a name='5879'>
 REAL,PARAMETER ::      H4M12=4.E-12<a name='5880'>
 REAL,PARAMETER ::      H38M12=3.8E-12<a name='5881'>
 REAL,PARAMETER ::      H37M12=3.7E-12<a name='5882'>
 REAL,PARAMETER ::      H3M12=3.E-12<a name='5883'>
 REAL,PARAMETER ::      H29M12=2.9E-12<a name='5884'>
 REAL,PARAMETER ::      H28M12=2.8E-12<a name='5885'>
 REAL,PARAMETER ::      H24M12=2.4E-12<a name='5886'>
 REAL,PARAMETER ::      H21M12=2.1E-12<a name='5887'>
 REAL,PARAMETER ::      H16M12=1.6E-12<a name='5888'>
 REAL,PARAMETER ::      H14M12=1.4E-12<a name='5889'>
 REAL,PARAMETER ::      H12M12=1.2E-12<a name='5890'>
 REAL,PARAMETER ::      H8M13=8.E-13<a name='5891'>
 REAL,PARAMETER ::      H46M13=4.6E-13<a name='5892'>
 REAL,PARAMETER ::      H36M13=3.6E-13<a name='5893'>
 REAL,PARAMETER ::      H135M13=1.35E-13<a name='5894'>
 REAL,PARAMETER ::      H12M13=1.2E-13<a name='5895'>
 REAL,PARAMETER ::      H1M13=1.E-13<a name='5896'>
 REAL,PARAMETER ::      H3M14=3.E-14<a name='5897'>
 REAL,PARAMETER ::      H15M14=1.5E-14<a name='5898'>
 REAL,PARAMETER ::      H14M14=1.4E-14<a name='5899'>
<font color=#447700>!<a name='5900'></font>
<font color=#447700>!******FOLLOWING ARE NEGATIVE FLOATING POINT CONSTANTS (HM'S)<a name='5901'></font>
<font color=#447700>!          ARRANGED IN DESCENDING ORDER<a name='5902'></font>
 REAL,PARAMETER ::      HM2M2=-.02<a name='5903'>
 REAL,PARAMETER ::      HM6666M2=-.066667<a name='5904'>
 REAL,PARAMETER ::      HMP5=-0.5<a name='5905'>
 REAL,PARAMETER ::      HMP575=-0.575<a name='5906'>
 REAL,PARAMETER ::      HMP66667=-.66667<a name='5907'>
 REAL,PARAMETER ::      HMP805=-0.805<a name='5908'>
 REAL,PARAMETER ::      HM1EZ=-1.<a name='5909'>
 REAL,PARAMETER ::      HM13EZ=-1.3<a name='5910'>
 REAL,PARAMETER ::      HM19EZ=-1.9<a name='5911'>
 REAL,PARAMETER ::      HM1E1=-10.<a name='5912'>
 REAL,PARAMETER ::      HM1597E1=-15.97469413<a name='5913'>
 REAL,PARAMETER ::      HM161E1=-16.1<a name='5914'>
 REAL,PARAMETER ::      HM1797E1=-17.97469413<a name='5915'>
 REAL,PARAMETER ::      HM181E1=-18.1<a name='5916'>
 REAL,PARAMETER ::      HM8E1=-80.<a name='5917'>
 REAL,PARAMETER ::      HM1E2=-100.<a name='5918'>
<font color=#447700>!<a name='5919'></font>
 REAL,PARAMETER ::      H1M16=1.0E-16<a name='5920'>
 REAL,PARAMETER ::      H1M20=1.E-20<a name='5921'>
 REAL,PARAMETER ::      HP98=0.98<a name='5922'>
 REAL,PARAMETER ::      Q19001=19.001<a name='5923'>
 REAL,PARAMETER ::      DAYSEC=1.1574E-5<a name='5924'>
 REAL,PARAMETER ::      HSIGMA=5.673E-5<a name='5925'>
 REAL,PARAMETER ::      TWENTY=20.0<a name='5926'>
 REAL,PARAMETER ::      HP537=0.537<a name='5927'>
 REAL,PARAMETER ::      HP2=0.2<a name='5928'>
 REAL,PARAMETER ::      RCO2=3.3E-4<a name='5929'>
 REAL,PARAMETER ::      Q14330=1.43306E-6<a name='5930'>
 REAL,PARAMETER ::      H3M6=3.0E-6<a name='5931'>
 REAL,PARAMETER ::      PI=3.1415927<a name='5932'>
 REAL,PARAMETER ::      DEGRAD=180.0/PI<a name='5933'>
 REAL,PARAMETER ::      H74E1=74.0<a name='5934'>
 REAL,PARAMETER ::      H15E1=15.0<a name='5935'>
<a name='5936'>
 REAL, PARAMETER:: B0 = -.51926410E-4<a name='5937'>
 REAL, PARAMETER:: B1 = -.18113332E-3<a name='5938'>
 REAL, PARAMETER:: B2 = -.10680132E-5<a name='5939'>
 REAL, PARAMETER:: B3 = -.67303519E-7<a name='5940'>
 REAL, PARAMETER:: AWIDE = 0.309801E+01<a name='5941'>
 REAL, PARAMETER:: BWIDE = 0.495357E-01<a name='5942'>
 REAL, PARAMETER:: BETAWD = 0.347839E+02<a name='5943'>
 REAL, PARAMETER:: BETINW = 0.766811E+01<a name='5944'>
<a name='5945'>
<a name='5946'>
      INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='5947'>
                                    ims,ime, jms,jme, kms,kme ,      &amp;<a name='5948'>
                                    its,ite, jts,jte, kts,kte<a name='5949'>
      INTEGER, INTENT(IN)        :: IBEG,KO3,KALB,ITIMSW,ITIMLW,JD<a name='5950'>
      REAL,    INTENT(IN)        :: GMT<a name='5951'>
<font color=#447700>!----------------------------------------------------------------------<a name='5952'></font>
<font color=#447700>!      ****************************************************************<a name='5953'></font>
<font color=#447700>!      *  GENERALIZED FOR PLUG-COMPATIBILITY -                        *<a name='5954'></font>
<font color=#447700>!      *    ORIGINAL CODE WAS CLEANED-UP GFDL CODE...K.CAMPANA MAR89..*<a name='5955'></font>
<font color=#447700>!......*  EXAMPLE FOR MRF:                                            *<a name='5956'></font>
<font color=#447700>!      *    KO3  =0  AND O3QO3=DUMMY ARRAY.   (GFDL CLIMO O3 USED)    *<a name='5957'></font>
<font color=#447700>!      *    KEMIS=0  AND HI CLD EMIS COMPUTED HERE (CEMIS=DUMMY INPUT)*<a name='5958'></font>
<font color=#447700>!      *    KALB =0  AND SFC ALBEDO OVER OPEN WATER COMPUTED BELOW... *<a name='5959'></font>
<font color=#447700>!      *    KCCO2=0,CO2 OBTAINED FROM BLOCK DATA                      *<a name='5960'></font>
<font color=#447700>!      *         =1,CO2 COMPUTED IN HERE --- NOT AVAILABLE YET...     *<a name='5961'></font>
<font color=#447700>!      *    SLMRF = INTERFACE (LEVELS) SIGMA                          *<a name='5962'></font>
<font color=#447700>!      *    SLYMRF= LAYER SIGMA                                       *<a name='5963'></font>
<font color=#447700>!      *  UPDATED FOR YUTAI HOU SIB SW RADIATION....KAC 6 MAR 92      *<a name='5964'></font>
<font color=#447700>!      *    OCEAN ALBEDO FOR BEAM SET TO BULK SFCALB, SINCE           *<a name='5965'></font>
<font color=#447700>!      *       COSINE ZENITH ANGLE EFFECTS ALREADY THERE(REF:PAYNE)   *<a name='5966'></font>
<font color=#447700>!      *       SLMSK = 0.                                             *<a name='5967'></font>
<font color=#447700>!      *    SNOW ICE ALBEDO FOR BEAM NOT ENHANCED VIA COSINE ZENITH   *<a name='5968'></font>
<font color=#447700>!      *       ANGLE EITHER CAUSE VALU ALREADY HIGH (WE SEE POLAR     *<a name='5969'></font>
<font color=#447700>!      *       COOLING IF WE DO BEAM CALCULATION)....KAC 17MAR92      *<a name='5970'></font>
<font color=#447700>!      *       ALBEDO GE .5                                           *<a name='5971'></font>
<font color=#447700>!      *   UPDATED TO OBTAIN CLEAR SKY FLUXES "ON THE FLY" FOR        *<a name='5972'></font>
<font color=#447700>!      *       CLOUD FORCING DIAGNOSTICS ELSEWHERE...KAC 7AUG92       *<a name='5973'></font>
<font color=#447700>!      *       SEE ##CLR LINES...RADFS,LWR88,FST88,SPA88 .......      *<a name='5974'></font>
<font color=#447700>!      *  UPDATED FOR USE NEW CLD SCHEME      ......YH  DEC 92        *<a name='5975'></font>
<font color=#447700>!      *    INPUT CLD MAY BE AS ORIGINAL IN 3 DOMAIN (CLD,MTOP,MBOT)  *<a name='5976'></font>
<font color=#447700>!      *       OR IN A VERTICAL ARRAY OF 18 MDL LAYERS (CLDARY)       *<a name='5977'></font>
<font color=#447700>!      *    IEMIS=0  USE THE ORG. CLD EMIS SCHEME                     *<a name='5978'></font>
<font color=#447700>!      *         =1  USE TEMP DEP. CLD EMIS SCHEME                    *<a name='5979'></font>
<font color=#447700>!      *  UPDATED TO COMPUTE CLD LAYER REFLECTTANCE AND TRANSMITTANCE *<a name='5980'></font>
<font color=#447700>!      *    INPUT CLD EMISSIVITY AND OPTICAL THICKNESS 'EMIS0,TAUC0'  *<a name='5981'></font>
<font color=#447700>!      *                                      ......YH FEB 93         *<a name='5982'></font>
<font color=#447700>!      ****************************************************************<a name='5983'></font>
<font color=#447700>!--------------------------------<a name='5984'></font>
<font color=#447700>!     INTEGER, PARAMETER:: LNGTH=37*kte<a name='5985'></font>
<font color=#447700>!--------------------------------<a name='5986'></font>
     <a name='5987'>
<font color=#447700>!     REAL, INTENT(IN) :: SKO3R,AB15WD,SKC1R,SKO2D<a name='5988'></font>
<a name='5989'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte):: PP,TT<a name='5990'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte):: QQH2O<a name='5991'>
      REAL,    INTENT(IN), DIMENSION(its:ite,kts:kte+1):: PPI,CAMT,EMCLD<a name='5992'>
      REAL,    INTENT(IN), DIMENSION(its:ite):: QS,TSFC,SLMSK,ALBEDO,XLAT<a name='5993'>
      REAL,    INTENT(IN), DIMENSION(its:ite):: COSZRO,TAUDAR<a name='5994'>
      REAL,    INTENT(OUT), DIMENSION(its:ite):: FLWUPS<a name='5995'>
      INTEGER, INTENT(IN), DIMENSION(its:ite):: NCLDS<a name='5996'>
      INTEGER, INTENT(IN), DIMENSION(its:ite,kts:kte+1):: KTOP,KBTM<a name='5997'>
      REAL,    INTENT(INOUT), DIMENSION(its:ite,NB,kts:kte+1):: TTCL,RRCL<a name='5998'>
      REAL, intent(IN), DIMENSION(its:ite,kts:kte):: O3QO3<a name='5999'>
<font color=#447700>!     REAL,  INTENT(IN),  DIMENSION(5040):: T1,T2,T4,EM1V,EM1VW<a name='6000'></font>
<font color=#447700>!     REAL,  INTENT(IN),  DIMENSION(5040) :: EM3V<a name='6001'></font>
<a name='6002'>
<font color=#447700>!     REAL, DIMENSION(its:ite)::ALVBR,ALNBR, ALVDR,ALNDR<a name='6003'></font>
<a name='6004'>
<font color=#447700>! TABLE ???<a name='6005'></font>
<a name='6006'>
      REAL,  DIMENSION(3) :: BO3RND,AO3RND<a name='6007'>
      REAL,  DIMENSION(NBLY) :: APCM,BPCM,ATPCM,BTPCM,ACOMB, &amp;<a name='6008'>
                                BCOMB,BETACM<a name='6009'>
<a name='6010'>
      DATA AO3RND / 0.543368E+02,  0.234676E+04,  0.384881E+02/ <a name='6011'>
      DATA BO3RND / 0.526064E+01,  0.922424E+01,  0.496515E+01/<a name='6012'>
<a name='6013'>
      DATA ACOMB  / &amp;<a name='6014'>
         0.152070E+05,  0.332194E+04,  0.527177E+03,  0.163124E+03, &amp;<a name='6015'>
         0.268808E+03,  0.534591E+02,  0.268071E+02,  0.123133E+02, &amp;<a name='6016'>
         0.600199E+01,  0.640803E+00,  0.501549E-01,  0.167961E-01, &amp;<a name='6017'>
         0.178110E-01,  0.170166E+00,  0.537083E-02/<a name='6018'>
      DATA BCOMB  / &amp;<a name='6019'>
         0.152538E+00,  0.118677E+00,  0.103660E+00,  0.100119E+00, &amp;<a name='6020'>
         0.127518E+00,  0.118409E+00,  0.904061E-01,  0.642011E-01, &amp;<a name='6021'>
         0.629660E-01,  0.643346E-01,  0.717082E-01,  0.629730E-01, &amp;<a name='6022'>
         0.875182E-01,  0.857907E-01,  0.214005E+00/<a name='6023'>
      DATA APCM   / &amp;<a name='6024'>
        -0.671879E-03,  0.654345E-02,  0.143657E-01,  0.923593E-02, &amp;<a name='6025'>
         0.117022E-01,  0.159596E-01,  0.181600E-01,  0.145013E-01, &amp;<a name='6026'>
         0.170062E-01,  0.233303E-01,  0.256735E-01,  0.274745E-01, &amp;<a name='6027'>
         0.279259E-01,  0.197002E-01,  0.349782E-01/<a name='6028'>
      DATA BPCM   / &amp;<a name='6029'>
        -0.113520E-04, -0.323965E-04, -0.448417E-04, -0.230779E-04, &amp;<a name='6030'>
        -0.361981E-04, -0.145117E-04,  0.198349E-04, -0.486529E-04, &amp;<a name='6031'>
        -0.550050E-04, -0.684057E-04, -0.447093E-04, -0.778390E-04, &amp;<a name='6032'>
        -0.982953E-04, -0.772497E-04, -0.748263E-04/<a name='6033'>
      DATA ATPCM  / &amp;<a name='6034'>
        -0.106346E-02,  0.641531E-02,  0.137362E-01,  0.922513E-02, &amp;<a name='6035'>
         0.136162E-01,  0.169791E-01,  0.206959E-01,  0.166223E-01, &amp;<a name='6036'>
         0.171776E-01,  0.229724E-01,  0.275530E-01,  0.302731E-01, &amp;<a name='6037'>
         0.281662E-01,  0.199525E-01,  0.370962E-01/<a name='6038'>
      DATA BTPCM  / &amp;<a name='6039'>
        -0.735731E-05, -0.294149E-04, -0.505592E-04, -0.280894E-04, &amp;<a name='6040'>
        -0.492972E-04, -0.341508E-04, -0.362947E-04, -0.250487E-04, &amp;<a name='6041'>
        -0.521369E-04, -0.746260E-04, -0.744124E-04, -0.881905E-04, &amp;<a name='6042'>
        -0.933645E-04, -0.664045E-04, -0.115290E-03/<a name='6043'>
      DATA BETACM / &amp;<a name='6044'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='6045'>
         0.188625E+03,  0.144293E+03,  0.174098E+03,  0.909366E+02, &amp;<a name='6046'>
         0.497489E+02,  0.221212E+02,  0.113124E+02,  0.754174E+01, &amp;<a name='6047'>
         0.589554E+01,  0.495227E+01,  0.000000E+00/<a name='6048'>
<a name='6049'>
<a name='6050'>
<font color=#447700>!        *********************************************<a name='6051'></font>
<font color=#447700>!====&gt;   *   OUTPUT TO CALLING PROGRAM               *<a name='6052'></font>
<font color=#447700>!        *********************************************<a name='6053'></font>
<a name='6054'>
       REAL, INTENT(INOUT),DIMENSION(its:ite,kts:kte)::SWH,HLW<a name='6055'>
       REAL, INTENT(OUT), DIMENSION(its:ite):: FSWUP,FSWUPS,FSWDN, &amp;<a name='6056'>
                           FSWDNS,FLWUP,FLWDNS<a name='6057'>
      <a name='6058'>
<font color=#447700>!        *********************************************<a name='6059'></font>
<font color=#447700>!====&gt;   *   POSSIBLE OUTPUT TO CALLING PROGRAM      *<a name='6060'></font>
<font color=#447700>!        *********************************************<a name='6061'></font>
<a name='6062'>
      REAL, DIMENSION(its:ite):: GDFVBR,GDFNBR,GDFVDR,GDFNDR<a name='6063'>
<a name='6064'>
<font color=#447700>!        ************************************************************<a name='6065'></font>
<font color=#447700>!====&gt;   *   ARRAYS NEEDED BY SWR91SIB..FOR CLEAR SKY DATA(EG.FSWL) *<a name='6066'></font>
<font color=#447700>!        ************************************************************<a name='6067'></font>
<a name='6068'>
      REAL, DIMENSION(its:ite,kts:kte+1)::FSWL,HSWL,UFL,DFL<a name='6069'>
<a name='6070'>
<font color=#447700>!        ******************************************************<a name='6071'></font>
<font color=#447700>!====&gt;   *   ARRAYS NEEDED BY CLO88, LWR88, SWR89 OR SWR91SIB *<a name='6072'></font>
<font color=#447700>!        ******************************************************<a name='6073'></font>
<a name='6074'>
       REAL, DIMENSION(its:ite,kts:kte+1,kts:kte+1)::CLDFAC<a name='6075'>
       REAL, DIMENSION(its:ite,kts:kte+1)::EQCMT,PRESS,TEMP,FSW,HSW,UF,DF<a name='6076'>
       REAL, DIMENSION(its:ite,kts:kte)::RH2O,QO3,HEATRA<a name='6077'>
       REAL, DIMENSION(its:ite):: COSZEN,TAUDA,GRNFLX,TOPFLX,GRDFLX<a name='6078'>
       REAL, DIMENSION(kts:kte+1)::PHALF<a name='6079'>
<font color=#447700>!..... ADD PRESSURE INTERFACE<a name='6080'></font>
<a name='6081'>
       REAL,    DIMENSION(NB) :: ABCFF,PWTS<a name='6082'>
<a name='6083'>
       DATA ABCFF/2*4.0E-5,.002,.035,.377,1.95,9.40,44.6,190., &amp;<a name='6084'>
                  989.,2706.,39011./<a name='6085'>
       DATA PWTS/.5000,.121416,.0698,.1558,.0631,.0362,.0243,.0158,.0087, &amp;<a name='6086'>
                 .001467,.002342,.001075/<a name='6087'>
<a name='6088'>
       REAL     :: CFCO2,CFO3,REFLO3,RRAYAV<a name='6089'>
<a name='6090'>
       DATA CFCO2,CFO3/508.96,466.64/<a name='6091'>
       DATA REFLO3/1.9/<a name='6092'>
       DATA RRAYAV/0.144/<a name='6093'>
<a name='6094'>
<font color=#447700>!        *********************************************<a name='6095'></font>
<font color=#447700>!====&gt;   *   VECTOR TEMPORARIES FOR CLOUD CALC.      *<a name='6096'></font>
<font color=#447700>!        *********************************************<a name='6097'></font>
<a name='6098'>
       REAL,    DIMENSION(its:ite):: TTHAN<a name='6099'>
       REAL,    DIMENSION(its:ite,kts:kte):: DO3V,DO3VP<a name='6100'>
       INTEGER, DIMENSION(its:ite):: JJROW<a name='6101'>
<a name='6102'>
<font color=#447700>!====&gt;    **************************************************************<a name='6103'></font>
<font color=#447700>!--     SEASONAL CLIMATOLOGIES OF O3 (OBTAINED FROM A PREVIOUSLY RUN<a name='6104'></font>
<font color=#447700>!             CODE WHICH INTERPOLATES O3 TO USER VERTICAL COORDINATE).<a name='6105'></font>
<font color=#447700>!         DEFINED AS 5 DEG LAT MEANS N.P.-&gt;S.P.<a name='6106'></font>
<font color=#447700>!         COMMON /SAVMEM/ &amp;<a name='6107'></font>
<font color=#447700>!-       ...WINTER....  ...SPRING....  ...SUMMER....  ....FALL.....<a name='6108'></font>
<font color=#447700>!        DDUO3N(37,L), DDO3N2(37,L), DDO3N3(37,L), DDO3N4(37,L)<a name='6109'></font>
<a name='6110'>
       REAL, DIMENSION(37,kte) :: DDUO3N,DDO3N2,DDO3N3,DDO3N4<a name='6111'>
<a name='6112'>
<font color=#447700>!     DIMENSION RAD1(37*kte), RAD2(37*kte), RAD3(37*kte), RAD4(37*kte)<a name='6113'></font>
<font color=#447700>!     EQUIVALENCE (RAD1(1),DDUO3N(1,1)),(RAD2(1),DDO3N2(1,1))<a name='6114'></font>
<font color=#447700>!     EQUIVALENCE (RAD3(1),DDO3N3(1,1)),(RAD4(1),DDO3N4(1,1))<a name='6115'></font>
<font color=#447700>!====&gt;    **************************************************************<a name='6116'></font>
<font color=#447700>!<a name='6117'></font>
      REAL,   DIMENSION(21,20) :: ALBD<a name='6118'>
      REAL,   DIMENSION(20)    :: ZA<a name='6119'>
      REAL,   DIMENSION(21)    :: TRN<a name='6120'>
      REAL,   DIMENSION(19)    :: DZA<a name='6121'>
<a name='6122'>
      REAL    :: YEAR,RLAG,TPI,SC,SSOLAR,DATE,RANG,TH2,ZEN,DZEN,ALB1,ALB2<a name='6123'>
      INTEGER :: IR,IQ,JX<a name='6124'>
      DATA TRN/.00,.05,.10,.15,.20,.25,.30,.35,.40,.45,.50,.55,.60,.65, &amp;<a name='6125'>
               .70,.75,.80,.85,.90,.95,1.00/<a name='6126'>
<a name='6127'>
      REAL ::  ALB11(21,7),ALB22(21,7),ALB33(21,6)<a name='6128'>
<a name='6129'>
      EQUIVALENCE (ALB11(1,1),ALBD(1,1)),(ALB22(1,1),ALBD(1,8)), &amp;<a name='6130'>
                  (ALB33(1,1),ALBD(1,15))<a name='6131'>
      DATA ALB11/ .061,.062,.072,.087,.115,.163,.235,.318,.395,.472,.542, &amp;<a name='6132'>
       .604,.655,.693,.719,.732,.730,.681,.581,.453,.425,.061,.062,.070, &amp;<a name='6133'>
       .083,.108,.145,.198,.263,.336,.415,.487,.547,.595,.631,.656,.670, &amp;<a name='6134'>
       .652,.602,.494,.398,.370,.061,.061,.068,.079,.098,.130,.174,.228, &amp;<a name='6135'>
       .290,.357,.424,.498,.556,.588,.603,.592,.556,.488,.393,.342,.325, &amp;<a name='6136'>
       .061,.061,.065,.073,.086,.110,.150,.192,.248,.306,.360,.407,.444, &amp;<a name='6137'>
       .469,.480,.474,.444,.386,.333,.301,.290,.061,.061,.065,.070,.082, &amp;<a name='6138'>
       .101,.131,.168,.208,.252,.295,.331,.358,.375,.385,.377,.356,.320, &amp;<a name='6139'>
       .288,.266,.255,.061,.061,.063,.068,.077,.092,.114,.143,.176,.210, &amp;<a name='6140'>
       .242,.272,.288,.296,.300,.291,.273,.252,.237,.266,.220,.061,.061, &amp;<a name='6141'>
       .062,.066,.072,.084,.103,.127,.151,.176,.198,.219,.236,.245,.250, &amp;<a name='6142'>
       .246,.235,.222,.211,.205,.200/<a name='6143'>
      DATA ALB22/ .061,.061,.061,.065,.071,.079,.094,.113,.134,.154,.173, &amp;<a name='6144'>
       .185,.190,.193,.193,.190,.188,.185,.182,.180,.178,.061,.061,.061, &amp;<a name='6145'>
       .064,.067,.072,.083,.099,.117,.135,.150,.160,.164,.165,.164,.162, &amp;<a name='6146'>
       .160,.159,.158,.157,.157,.061,.061,.061,.062,.065,.068,.074,.084, &amp;<a name='6147'>
       .097,.111,.121,.127,.130,.131,.131,.130,.129,.127,.126,.125,.122, &amp;<a name='6148'>
       .061,.061,.061,.061,.062,.064,.070,.076,.085,.094,.101,.105,.107, &amp;<a name='6149'>
       .106,.103,.100,.097,.096,.095,.095,.095,.061,.061,.061,.060,.061, &amp;<a name='6150'>
       .062,.065,.070,.075,.081,.086,.089,.090,.088,.084,.080,.077,.075, &amp;<a name='6151'>
       .074,.074,.074,.061,.061,.060,.060,.060,.061,.063,.065,.068,.072, &amp;<a name='6152'>
       .076,.077,.076,.074,.071,.067,.064,.062,.061,.061,.061,.061,.061, &amp;<a name='6153'>
       .060,.060,.060,.060,.061,.062,.065,.068,.069,.069,.068,.065,.061, &amp;<a name='6154'>
       .058,.055,.054,.053,.052,.052/<a name='6155'>
      DATA ALB33/ .061,.061,.060,.060,.060,.060,.060,.060,.062,.065,.065, &amp;<a name='6156'>
       .063,.060,.057,.054,.050,.047,.046,.045,.044,.044,.061,.061,.060, &amp;<a name='6157'>
       .060,.060,.059,.059,.059,.059,.059,.058,.055,.051,.047,.043,.039, &amp;<a name='6158'>
       .035,.033,.032,.031,.031,.061,.061,.060,.060,.060,.059,.059,.058, &amp;<a name='6159'>
       .057,.056,.054,.051,.047,.043,.039,.036,.033,.030,.028,.027,.026, &amp;<a name='6160'>
       .061,.061,.060,.060,.060,.059,.059,.058,.057,.055,.052,.049,.045, &amp;<a name='6161'>
       .040,.036,.032,.029,.027,.026,.025,.025,.061,.061,.060,.060,.060, &amp;<a name='6162'>
       .059,.059,.058,.056,.053,.050,.046,.042,.038,.034,.031,.028,.026, &amp;<a name='6163'>
       .025,.025,.025,.061,.061,.060,.060,.059,.058,.058,.057,.055,.053, &amp;<a name='6164'>
       .050,.046,.042,.038,.034,.030,.028,.029,.025,.025,.025/<a name='6165'>
      DATA ZA/90.,88.,86.,84.,82.,80.,78.,76.,74.,70.,66.,62.,58.,54., &amp;<a name='6166'>
              50.,40.,30.,20.,10.,0.0/<a name='6167'>
      DATA DZA/8*2.0,6*4.0,5*10.0/<a name='6168'>
<a name='6169'>
<font color=#447700>!    ***********************************************************<a name='6170'></font>
<font color=#447700>!<a name='6171'></font>
<a name='6172'>
       REAL,    DIMENSION(its:ite)        :: ALVB,ALNB,ALVD,ALND, &amp;<a name='6173'>
                                             GDFVB,   &amp;<a name='6174'>
                                             GDFNB,GDFVD,GDFND,   &amp;<a name='6175'>
                                             SFCALB<a name='6176'>
       REAL :: SOLC,RSIN1,RCOS1,RCOS2<a name='6177'>
<a name='6178'>
       REAL    :: ALBD0,ALVD1,ALND1,RRVCO2,RRCO2<a name='6179'>
       INTEGER :: N<a name='6180'>
<a name='6181'>
<font color=#447700>!====&gt;    BEGIN HERE             .......................<a name='6182'></font>
<font color=#447700>!<a name='6183'></font>
<font color=#447700>!         SOLC,THE SOLAR CONSTANT IS SCALED TO A MORE CURRENT VALUE.<a name='6184'></font>
<font color=#447700>!          I.E. IF SOLC=2.0 LY/MIN THEN SSOLAR=1.96 LY/MIN.<a name='6185'></font>
<font color=#447700>!..     RE-COMPUTED CAUSE SSOLAR OVERWRITTEN AS PART OF SCRATCH COMMON<a name='6186'></font>
<font color=#447700>!<a name='6187'></font>
<a name='6188'>
<a name='6189'>
      INTEGER :: K, I,KP,LLM2,J1,J3,KMAX,KMIN,KCLDS,ICNT,LLM1<a name='6190'>
      INTEGER :: L,LP1,LP2,LP3,LM1,LM2,LM3,MYIS,MYIE,LLP1,LL,KK,KLEN<a name='6191'>
<a name='6192'>
      L=kte<a name='6193'>
      LP1=L+1;  LP2=L+2;  LP3=L+3; LLP1 = 2*L + 1<a name='6194'>
      LM1=L-1;  LM2=L-2;  LM3=L-3; LL = 2*L<a name='6195'>
      LLM2 = LL-2; LLM1=LL-1<a name='6196'>
      MYIS=its; MYIE=ite<a name='6197'>
<a name='6198'>
<font color=#447700>!******ZHAO<a name='6199'></font>
<font color=#447700>!  NOTE: XLAT IS IN DEGREE HERE<a name='6200'></font>
<font color=#447700>!*****ZHAO<a name='6201'></font>
      YEAR=365.25<a name='6202'>
      RLAG=14.8125<a name='6203'>
      TPI=6.283185308<a name='6204'>
      SC=2.<a name='6205'>
      SOLC=SC/(R1*R1)<a name='6206'>
<font color=#447700>!*****************************<a name='6207'></font>
<font color=#447700>! Special note: The solar constant is reduced extra 3 percent to account<a name='6208'></font>
<font color=#447700>!               for the lack of aerosols in the shortwave radiation<a name='6209'></font>
<font color=#447700>!               parameterization.       Q. Zhao    96-7-23<a name='6210'></font>
<font color=#447700>!****************************<a name='6211'></font>
      SSOLAR=SOLC*HP98<a name='6212'>
      SSOLAR=SSOLAR*0.97<a name='6213'>
      DATE=JD+GMT/24.0<a name='6214'>
      RANG=TPI*(DATE-RLAG)/YEAR<a name='6215'>
      RSIN1=SIN(RANG)<a name='6216'>
      RCOS1=COS(RANG)<a name='6217'>
      RCOS2=COS(2.0*RANG)<a name='6218'>
      DO 40 I=MYIS,MYIE<a name='6219'>
        IR = I + IBEG - 1<a name='6220'>
        TH2=HP2*XLAT(IR)<a name='6221'>
        JJROW(I)=Q19001-TH2<a name='6222'>
        TTHAN(I)=(19-JJROW(I))-TH2<a name='6223'>
<font color=#447700>!.....  NOTE THAT THE NMC VARIABLES ARE IN MKS (THUS PRESSURE IS IN<a name='6224'></font>
<font color=#447700>!          CENTIBARS)WHILE ALL GFDL VARIABLES ARE IN CGS UNITS<a name='6225'></font>
        SFCALB(I) = ALBEDO(IR)<a name='6226'>
<font color=#447700>!.....  NOW PUT SFC TEMP,PRESSURES, ZENITH ANGLE INTO SW COMMON BLOCK...<a name='6227'></font>
<font color=#447700>!***ZHAO<a name='6228'></font>
<font color=#447700>!  NOTE: ALL PRESSURES INPUT FROM THE ETA MODEL ARE IN PA<a name='6229'></font>
<font color=#447700>!        THE UNIT FOR PRESS IS MICRO BAR <a name='6230'></font>
<font color=#447700>!        SURFACE TEMPERATURE ARE NEGATIVE OVER OCEANS IN THE ETA MODEL<a name='6231'></font>
<font color=#447700>!***ZHAO<a name='6232'></font>
        PRESS(I,LP1)=QS(IR)*10.0<a name='6233'>
        TEMP(I,LP1)=ABS(TSFC(IR))<a name='6234'>
        COSZEN(I) = COSZRO(IR)<a name='6235'>
        TAUDA(I) = TAUDAR(IR)<a name='6236'>
   40 CONTINUE<a name='6237'>
<font color=#447700>!***ZHAO<a name='6238'></font>
<font color=#447700>!.....  ALL GFDL VARIABLES HAVE K=1 AT THE TOP OF THE ATMOSPHERE.NMC<a name='6239'></font>
<font color=#447700>!       ETA MODEL HAS THE SAME STRUCTURE<a name='6240'></font>
<font color=#447700>!***ZHAO<a name='6241'></font>
      DO 50 K=1,L<a name='6242'>
       DO 50 I=MYIS,MYIE<a name='6243'>
        IR = I + IBEG - 1<a name='6244'>
<font color=#447700>!.....  NOW PUT TEMP,PRESSURES, INTO SW COMMON BLOCK..........<a name='6245'></font>
        TEMP(I,K) = TT(IR,K)<a name='6246'>
        PRESS(I,K) = 10.0 * PP(IR,K)<a name='6247'>
<font color=#447700>!.... STORE LYR MOISTURE AND ADD TO SW COMMON BLOCK<a name='6248'></font>
        RH2O(I,K)=QQH2O(IR,K)<a name='6249'>
        IF(RH2O(I,K).LT.H3M6) RH2O(I,K)=H3M6<a name='6250'>
   50 CONTINUE<a name='6251'>
<font color=#447700>!...    *************************<a name='6252'></font>
      IF (KO3.EQ.0) GO TO 65<a name='6253'>
<font color=#447700>!...    *************************<a name='6254'></font>
      DO 60 K=1,L<a name='6255'>
       DO 60 I=MYIS,MYIE<a name='6256'>
        QO3(I,K) = O3QO3(I+IBEG-1,K)<a name='6257'>
   60 CONTINUE<a name='6258'>
   65 CONTINUE<a name='6259'>
<font color=#447700>!...   ************************************<a name='6260'></font>
      IF (KALB.GT.0) GO TO 110<a name='6261'>
<font color=#447700>!...   ************************************<a name='6262'></font>
<font color=#447700>!..... THE FOLLOWING CODE GETS ALBEDO FROM PAYNE,1972 TABLES IF<a name='6263'></font>
<font color=#447700>!         1) OPEN SEA POINT (SLMSK=1);2) KALB=0<a name='6264'></font>
      IQ=INT(TWENTY*HP537+ONE)<a name='6265'>
      DO 105 I=MYIS,MYIE<a name='6266'>
         IF(COSZEN(I).GT.0.0 .AND. SLMSK(I+IBEG-1).GT.0.5) THEN<a name='6267'>
           ZEN=DEGRAD*ACOS(MAX(COSZEN(I),0.0))<a name='6268'>
           IF(ZEN.GE.H74E1) JX=INT(HAF*(HNINETY-ZEN)+ONE)<a name='6269'>
           IF(ZEN.LT.H74E1.AND.ZEN.GE.FIFTY) &amp;<a name='6270'>
              JX=INT(QUARTR*(H74E1-ZEN)+HNINE)<a name='6271'>
           IF(ZEN.LT.FIFTY) JX=INT(HP1*(FIFTY-ZEN)+H15E1)<a name='6272'>
           DZEN=-(ZEN-ZA(JX))/DZA(JX)<a name='6273'>
           ALB1=ALBD(IQ,JX)+DZEN*(ALBD(IQ,JX+1)-ALBD(IQ,JX))<a name='6274'>
           ALB2=ALBD(IQ+1,JX)+DZEN*(ALBD(IQ+1,JX+1)-ALBD(IQ+1,JX))<a name='6275'>
           SFCALB(I)=ALB1+TWENTY*(ALB2-ALB1)*(HP537-TRN(IQ))<a name='6276'>
         ENDIF<a name='6277'>
  105 CONTINUE<a name='6278'>
  110 CONTINUE<a name='6279'>
<font color=#447700>!        **********************************<a name='6280'></font>
      IF (KO3.GT.0) GO TO 135<a name='6281'>
<font color=#447700>!        **********************************<a name='6282'></font>
<font color=#447700>!.... COMPUTE CLIMATOLOGICAL ZONAL MEAN OZONE,<a name='6283'></font>
<font color=#447700>!....   SEASONAL AND SPATIAL INTERPOLATION DONE BELOW.<a name='6284'></font>
      DO 125 I=MYIS,MYIE<a name='6285'>
<a name='6286'>
         PHALF(1)=0.<a name='6287'>
         PHALF(LP1)=PPI(I,kme)<a name='6288'>
         DO L=1,LM1<a name='6289'>
            PHALF(L+1)=PP(I,L) <font color=#447700>!  AETA(L)*PDIF+PT<a name='6290'></font>
         ENDDO<a name='6291'>
<a name='6292'>
         CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#O3INT'>O3INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADFS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="O3INT_1">(PHALF,DDUO3N,DDO3N2,DDO3N3,DDO3N4, &amp;<a name='6293'>
                 ids,ide, jds,jde, kds,kde,            &amp;<a name='6294'>
                 ims,ime, jms,jme, kms,kme,            &amp;<a name='6295'>
                 its,ite, jts,jte, kts,kte             )<a name='6296'>
<a name='6297'>
         DO 130 K=1,L<a name='6298'>
          DO3V(I,K)  = DDUO3N(JJROW(I),K) + RSIN1*DDO3N2(JJROW(I),K) &amp;<a name='6299'>
                      +RCOS1*DDO3N3(JJROW(I),K) &amp;<a name='6300'>
                      +RCOS2*DDO3N4(JJROW(I),K)<a name='6301'>
          DO3VP(I,K) = DDUO3N(JJROW(I)+1,K) + RSIN1*DDO3N2(JJROW(I)+1,K) &amp;<a name='6302'>
                     +RCOS1*DDO3N3(JJROW(I)+1,K) &amp;<a name='6303'>
                     +RCOS2*DDO3N4(JJROW(I)+1,K)<a name='6304'>
<font color=#447700>!...   NOW LATITUDINAL INTERPOLATION, AND<a name='6305'></font>
<font color=#447700>!          CONVERT O3 INTO MASS MIXING RATIO(ORIGINAL DATA MPY BY 1.E4)<a name='6306'></font>
          QO3(I,K) = H1M4 * (DO3V(I,K)+TTHAN(I)*(DO3VP(I,K)-DO3V(I,K)))<a name='6307'>
  130   CONTINUE<a name='6308'>
  125 CONTINUE<a name='6309'>
  135 CONTINUE<a name='6310'>
<font color=#447700>!.............<a name='6311'></font>
      DO 195 I=MYIS,MYIE<a name='6312'>
<font color=#447700>!.....     VISIBLE AND NEAR IR DIFFUSE ALBEDO<a name='6313'></font>
        ALVD(I) = SFCALB(I)<a name='6314'>
        ALND(I) = SFCALB(I)<a name='6315'>
<font color=#447700>!.....     VISIBLE AND NEAR IR DIRECT BEAM ALBEDO<a name='6316'></font>
        ALVB(I) = SFCALB(I)<a name='6317'>
        ALNB(I) = SFCALB(I)<a name='6318'>
<font color=#447700>!.....     VISIBLE AND NEAR IR DIRECT BEAM ALBEDO,IF NOT OCEAN NOR SNOW<a name='6319'></font>
<font color=#447700>!            ..FUNCTION OF COSINE SOLAR ZENITH ANGLE..<a name='6320'></font>
        IF (SLMSK(I+IBEG-1).LT.0.5) THEN<a name='6321'>
         IF (SFCALB(I).LE.0.5) THEN<a name='6322'>
          ALBD0 = -18.0 * (0.5 - ACOS(COSZEN(I))/PI)<a name='6323'>
          ALBD0 = EXP (ALBD0)<a name='6324'>
          ALVD1 = (ALVD(I) - 0.054313) / 0.945687<a name='6325'>
          ALND1 = (ALND(I) - 0.054313) / 0.945687<a name='6326'>
          ALVB(I) = ALVD1 + (1.0 - ALVD1) * ALBD0<a name='6327'>
          ALNB(I) = ALND1 + (1.0 - ALND1) * ALBD0<a name='6328'>
         END IF<a name='6329'>
        END IF<a name='6330'>
  195 CONTINUE<a name='6331'>
<font color=#447700>!.....SURFACE VALUES OF RRCL AND TTCL<a name='6332'></font>
      DO 200 N=1,2<a name='6333'>
        DO 200 I=MYIS,MYIE<a name='6334'>
      RRCL(I,N,1)=ALVD(I)<a name='6335'>
      TTCL(I,N,1)=ZERO<a name='6336'>
  200 CONTINUE<a name='6337'>
      DO 220 N=3,NB<a name='6338'>
      DO 220 I=MYIS,MYIE<a name='6339'>
         RRCL(I,N,1)=ALND(I)<a name='6340'>
         TTCL(I,N,1)=ZERO<a name='6341'>
  220 CONTINUE<a name='6342'>
<font color=#447700>!...     **************************<a name='6343'></font>
<font color=#447700>!...     *  END OF CLOUD SECTION  *<a name='6344'></font>
<font color=#447700>!...     **************************<a name='6345'></font>
<font color=#447700>!... THE FOLLOWING CODE CONVERTS RRVCO2,THE VOLUME MIXING RATIO OF CO2<a name='6346'></font>
<font color=#447700>!   INTO RRCO2,THE MASS MIXING RATIO.<a name='6347'></font>
      RRVCO2=RCO2<a name='6348'>
      RRCO2=RRVCO2*RATCO2MW<a name='6349'>
  250 IF(ITIMLW .EQ. 0) GO TO 300<a name='6350'>
<font color=#447700>!<a name='6351'></font>
<font color=#447700>!             ***********************<a name='6352'></font>
<font color=#447700>!====&gt;        * LONG WAVE RADIATION *<a name='6353'></font>
<font color=#447700>!             ***********************<a name='6354'></font>
<font color=#447700>!<a name='6355'></font>
<font color=#447700>!....     ACCOUNT FOR REDUCED EMISSIVITY OF ANY CLDS<a name='6356'></font>
      DO 240 K=1,LP1<a name='6357'>
      DO 240 I=MYIS,MYIE<a name='6358'>
        EQCMT(I,K)=CAMT(I,K)*EMCLD(I,K)<a name='6359'>
  240 CONTINUE<a name='6360'>
<font color=#447700>!....    GET CLD FACTOR FOR LW CALCULATIONS<a name='6361'></font>
<font color=#447700>!....<a name='6362'></font>
<a name='6363'>
<font color=#447700>! shuhua<a name='6364'></font>
<a name='6365'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CLO89'>CLO89</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADFS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CLO89_1">(CLDFAC,EQCMT,NCLDS,KBTM,KTOP, &amp;<a name='6366'>
                 ids,ide, jds,jde, kds,kde,    &amp;<a name='6367'>
                 ims,ime, jms,jme, kms,kme,    &amp;<a name='6368'>
                 its,ite, jts,jte, kts,kte     )<a name='6369'>
<a name='6370'>
<font color=#447700>! shuhua<a name='6371'></font>
<font color=#447700>!===&gt;        LONG WAVE RADIATION<a name='6372'></font>
<font color=#447700>!     CALL LWR88(HEATRA,GRNFLX,TOPFLX,         &amp;<a name='6373'></font>
<font color=#447700>!                PRESS,TEMP,RH2O,QO3,CLDFAC,   &amp;<a name='6374'></font>
<font color=#447700>!                EQCMT,NCLDS,KTOP,KBTM,        &amp;<a name='6375'></font>
<font color=#447700>!<a name='6376'></font>
<font color=#447700>!!               BO3RND,AO3RND,T1,T2,T4,EM1V,EM1VW,EM3V, &amp;<a name='6377'></font>
<font color=#447700>!                BO3RND,AO3RND, &amp;<a name='6378'></font>
<font color=#447700>!                APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='6379'></font>
<font color=#447700>!                ZERO,ONE,H18E3,P0INV,H6P08108,DIFFCTR,        &amp;<a name='6380'></font>
<font color=#447700>!                GINV,H3M4,BETINW,RATH2OMW,GP0INV,P0,P0XZP8,   &amp;<a name='6381'></font>
<font color=#447700>!                P0XZP2,H3M3,H1M3,H1M2,H25E2,B0,B2,B1,B3,HAF,  &amp;<a name='6382'></font>
<font color=#447700>!                TEN,HP1,FOUR,HM1EZ,SKO3R,                     &amp;<a name='6383'></font>
<font color=#447700>!                AB15WD,SKC1R,RADCON,QUARTR,TWO,               &amp;<a name='6384'></font>
<font color=#447700>!                HM6666M2,HMP66667,HMP5, HP166666,H41666M2,    &amp;<a name='6385'></font>
<font color=#447700>!                RADCON1,H16E1, H28E1,H44194M2,H1P41819,SKO2D, &amp;<a name='6386'></font>
<font color=#447700>!                ids,ide, jds,jde, kds,kde,                    &amp;<a name='6387'></font>
<font color=#447700>!                ims,ime, jms,jme, kms,kme,                    &amp;<a name='6388'></font>
<font color=#447700>!                its,ite, jts,jte, kts,kte                    )<a name='6389'></font>
<a name='6390'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#LWR88'>LWR88</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADFS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LWR88_1">(HEATRA,GRNFLX,TOPFLX,         &amp;<a name='6391'>
                 PRESS,TEMP,RH2O,QO3,CLDFAC,   &amp;<a name='6392'>
                 EQCMT,NCLDS,KTOP,KBTM,        &amp;<a name='6393'>
<font color=#447700>!<a name='6394'></font>
<font color=#447700>!                BO3RND,AO3RND,T1,T2,T4,EM1V,EM1VW,EM3V, &amp;<a name='6395'></font>
                 BO3RND,AO3RND, &amp;<a name='6396'>
                 APCM,BPCM,ATPCM,BTPCM,ACOMB,BCOMB,BETACM,     &amp;<a name='6397'>
                 ZERO,ONE,H18E3,P0INV,H6P08108,DIFFCTR,        &amp;<a name='6398'>
                 GINV,H3M4,BETINW,RATH2OMW,GP0INV,P0,P0XZP8,   &amp;<a name='6399'>
                 P0XZP2,H3M3,H1M3,H1M2,H25E2,B0,B2,B1,B3,HAF,  &amp;<a name='6400'>
                 TEN,HP1,FOUR,HM1EZ,                           &amp;<a name='6401'>
                 RADCON,QUARTR,TWO,                            &amp;<a name='6402'>
                 HM6666M2,HMP66667,HMP5, HP166666,H41666M2,    &amp;<a name='6403'>
                 RADCON1,H16E1, H28E1,H44194M2,H1P41819,       &amp;<a name='6404'>
                 ids,ide, jds,jde, kds,kde,                    &amp;<a name='6405'>
                 ims,ime, jms,jme, kms,kme,                    &amp;<a name='6406'>
                  its,ite, jts,jte, kts,kte                    )<a name='6407'>
<a name='6408'>
<font color=#447700>!....<a name='6409'></font>
      DO 280 I=MYIS,MYIE<a name='6410'>
        IR = I + IBEG - 1<a name='6411'>
        FLWUP(IR) = TOPFLX(I) * .001E0<a name='6412'>
        GRNFLX(I)=Q14330*(HSIGMA*TEMP(I,LP1)**4-GRNFLX(I))<a name='6413'>
<font color=#447700>!.... GET LW FLUX DOWN AND UP AT GROUND(WATTS/M**2) - GRNFLX=LW DOWN.<a name='6414'></font>
        FLWDNS(IR)=GRNFLX(I)/(1.43306E-06*1000.E0)<a name='6415'>
        FLWUPS(IR)=HSIGMA*.001E0 * TEMP(I,LP1)**4<a name='6416'>
  280 CONTINUE<a name='6417'>
<font color=#447700>!....      CONVERT HEATING RATES TO DEG/SEC<a name='6418'></font>
      DO 290 K=1,L<a name='6419'>
        DO 290 I=MYIS,MYIE<a name='6420'>
          HLW(I+IBEG-1,K)=HEATRA(I,K)*DAYSEC<a name='6421'>
  290 CONTINUE<a name='6422'>
  300 CONTINUE<a name='6423'>
      IF(ITIMSW .EQ. 0) GO TO 350<a name='6424'>
<font color=#447700>!SW<a name='6425'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#SWR93'>SWR93</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#RADFS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWR93_1">(FSW,HSW,UF,DF,FSWL,HSWL,UFL,DFL, &amp;<a name='6426'>
                 PRESS,COSZEN,TAUDA,RH2O,RRCO2,SSOLAR,QO3, &amp;<a name='6427'>
                 NCLDS,KTOP,KBTM,CAMT,RRCL,TTCL, &amp;<a name='6428'>
                 ALVB,ALNB,ALVD,ALND,GDFVB,GDFNB,GDFVD,GDFND, &amp;<a name='6429'>
<font color=#447700>!<a name='6430'></font>
<font color=#447700>!                UCO2,UO3,TUCO2,TUO3,TDO3,TDCO2,                &amp;<a name='6431'></font>
                 ABCFF,PWTS,                                    &amp;<a name='6432'>
                 H35E1,H1224E3,ONE,ZERO,HAF,H69766E5,HP219,     &amp;<a name='6433'>
                 HP816,RRAYAV,GINV,CFCO2,CFO3,                  &amp;<a name='6434'>
                 TWO,H235M3,HP26,H129M2,H75826M4,H1036E2,       &amp;<a name='6435'>
                 H1P082,HMP805,H1386E2,H658M2,H2118M2,H42M2,    &amp;<a name='6436'>
                 H323M4,HM1EZ,DIFFCTR,O3DIFCTR,FIFTY,RADCON,    &amp;<a name='6437'>
                 ids,ide, jds,jde, kds,kde,                     &amp;<a name='6438'>
                 ims,ime, jms,jme, kms,kme,                     &amp;<a name='6439'>
                 its,ite, jts,jte, kts,kte                      )<a name='6440'>
<a name='6441'>
<font color=#447700>!SW<a name='6442'></font>
<font color=#447700>!<a name='6443'></font>
<font color=#447700>!.....    GET SW FLUXES IN WATTS/M**2<a name='6444'></font>
      DO 320 I=MYIS,MYIE<a name='6445'>
       IR = I + IBEG - 1<a name='6446'>
       FSWUP(IR) = UF(I,1) * 1.E-3<a name='6447'>
       FSWDN(IR) = DF(I,1) * 1.E-3<a name='6448'>
       FSWUPS(IR) = UF(I,LP1) * 1.E-3<a name='6449'>
<font color=#447700>!C..COUPLE W/M2 DIFF, IF FSWDNS(IR)=DF(I,LP1)*1.#E-3<a name='6450'></font>
       FSWDNS(IR) = (GDFVB(I)+GDFNB(I)+GDFVD(I)+GDFND(I)) * 1.E-3<a name='6451'>
<font color=#447700>!...    DOWNWARD SFC FLUX FOR THE SIB PARAMETERATION<a name='6452'></font>
<font color=#447700>!.....     VISIBLE AND NEAR IR DIFFUSE<a name='6453'></font>
       GDFVDR(IR) = GDFVD(I) * 1.E-3<a name='6454'>
       GDFNDR(IR) = GDFND(I) * 1.E-3<a name='6455'>
<font color=#447700>!.....     VISIBLE AND NEAR IR DIRECT BEAM<a name='6456'></font>
       GDFVBR(IR) = GDFVB(I) * 1.E-3<a name='6457'>
       GDFNBR(IR) = GDFNB(I) * 1.E-3<a name='6458'>
  320 CONTINUE<a name='6459'>
<font color=#447700>!....      CONVERT HEATING RATES TO DEG/SEC<a name='6460'></font>
      DO 330 K=1,L<a name='6461'>
        DO 330 I=MYIS,MYIE<a name='6462'>
          SWH(I+IBEG-1,K)=HSW(I,K)*DAYSEC<a name='6463'>
  330 CONTINUE<a name='6464'>
  350 CONTINUE<a name='6465'>
      RETURN<a name='6466'>
 1000 FORMAT(1H ,' YOU ARE CALLING GFDL RADIATION CODE FOR',I5,' PTS', &amp;<a name='6467'>
                 'AND',I4,' LYRS,WITH KDAPRX,KO3,KCZ,KEMIS,KALB = ',5I2)<a name='6468'>
 <a name='6469'>
  END SUBROUTINE RADFS <a name='6470'>
<a name='6471'>
<font color=#447700>!-----------------------------------------------------------------------<a name='6472'></font>
<A NAME='O3CLIM'><A href='../../html_code/phys/module_ra_gfdleta.F.html#O3CLIM' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6473'>
    <font color=#993300>SUBROUTINE </font><font color=#cc0000>O3CLIM</font> <A href='../../call_to/O3CLIM.html' TARGET='index'>1</A><a name='6474'>
<font color=#447700>!                (XDUO3N,XDO3N2,XDO3N3,XDO3N4,PRGFDL,         &amp;<a name='6475'></font>
<font color=#447700>!                ids,ide, jds,jde, kds,kde,                   &amp;<a name='6476'></font>
<font color=#447700>!                ims,ime, jms,jme, kms,kme,                   &amp;<a name='6477'></font>
<font color=#447700>!                its,ite, jts,jte, kts,kte                    )<a name='6478'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='6479'></font>
 IMPLICIT NONE<a name='6480'>
<font color=#447700>!----------------------------------------------------------------------<a name='6481'></font>
<font color=#447700>!     INTEGER, INTENT(IN)        :: ids,ide, jds,jde, kds,kde ,      &amp;<a name='6482'></font>
<font color=#447700>!                                   ims,ime, jms,jme, kms,kme ,      &amp;<a name='6483'></font>
<font color=#447700>!                                   its,ite, jts,jte, kts,kte<a name='6484'></font>
<a name='6485'>
<font color=#447700>!     ******************************************************************<a name='6486'></font>
<font color=#447700>!$$$  SUBPROGRAM DOCUMENTATION BLOCK<a name='6487'></font>
<font color=#447700>!                .      .    .     <a name='6488'></font>
<font color=#447700>! SUBPROGRAM:    O3CLIM      GENERATE SEASONAL OZONE DISTRIBUTION<a name='6489'></font>
<font color=#447700>!   PRGRMMR: GFDL/CAMPANA    ORG: W/NP22     DATE: ??-??-??<a name='6490'></font>
<font color=#447700>!     <a name='6491'></font>
<font color=#447700>! ABSTRACT:<a name='6492'></font>
<font color=#447700>!     O3CLIM COMPUTES THE SEASONAL CLIMATOLOGY OF OZONE USING<a name='6493'></font>
<font color=#447700>!     81-LAYER DATA FROM GFDL.<a name='6494'></font>
<font color=#447700>!     <a name='6495'></font>
<font color=#447700>! PROGRAM HISTORY LOG:<a name='6496'></font>
<font color=#447700>!   ??-??-??  GFDL/KC    - ORIGINATOR<a name='6497'></font>
<font color=#447700>!   96-07-26  BLACK      - MODIFIED FOR ETA MODEL<a name='6498'></font>
<font color=#447700>!     <a name='6499'></font>
<font color=#447700>! USAGE: CALL O3CLIM FROM SUBROUTINE RADTN<a name='6500'></font>
<font color=#447700>!   INPUT ARGUMENT LIST:<a name='6501'></font>
<font color=#447700>!     NONE     <a name='6502'></font>
<font color=#447700>!  <a name='6503'></font>
<font color=#447700>!   OUTPUT ARGUMENT LIST: <a name='6504'></font>
<font color=#447700>!     NONE<a name='6505'></font>
<font color=#447700>!     <a name='6506'></font>
<font color=#447700>!   OUTPUT FILES:<a name='6507'></font>
<font color=#447700>!     NONE<a name='6508'></font>
<font color=#447700>!     <a name='6509'></font>
<font color=#447700>!   SUBPROGRAMS CALLED:<a name='6510'></font>
<font color=#447700>!  <a name='6511'></font>
<font color=#447700>!     UNIQUE:<a name='6512'></font>
<font color=#447700>!        NONE<a name='6513'></font>
<font color=#447700>!  <a name='6514'></font>
<font color=#447700>!     LIBRARY:<a name='6515'></font>
<font color=#447700>!        NONE<a name='6516'></font>
<font color=#447700>!  <a name='6517'></font>
<font color=#447700>!   COMMON BLOCKS: SEASO3<a name='6518'></font>
<font color=#447700>!                  O3DATA<a name='6519'></font>
<font color=#447700>!   <a name='6520'></font>
<font color=#447700>! ATTRIBUTES:<a name='6521'></font>
<font color=#447700>!   LANGUAGE: FORTRAN 90<a name='6522'></font>
<font color=#447700>!   MACHINE : IBM SP<a name='6523'></font>
<font color=#447700>!$$$  <a name='6524'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='6525'></font>
<font color=#447700>!      INTEGER   :: NL,NLP1,NLGTH,NKK,NK,NKP<a name='6526'></font>
       INTEGER, PARAMETER :: NL=81,NLP1=NL+1,NLGTH=37*NL,NKK=41,NK=81,NKP=NK+1<a name='6527'>
<font color=#447700>!----------------------------------------------------------------------<a name='6528'></font>
<font color=#447700>!     INCLUDE "SEASO3.comm"<a name='6529'></font>
<font color=#447700>!---------------------------------------------------------------------<a name='6530'></font>
<font color=#447700>!     REAL, INTENT(OUT), DIMENSION(37,NL) :: XDUO3N,XDO3N2,XDO3N3,XDO3N4<a name='6531'></font>
<font color=#447700>!     REAL, INTENT(OUT), DIMENSION(NL)    :: PRGFDL<a name='6532'></font>
<a name='6533'>
<font color=#447700>!      COMMON /SEASO3/<a name='6534'></font>
<font color=#447700>!      ...WINTER....  ...SPRING....  ...SUMMER....  ....FALL.....<a name='6535'></font>
<font color=#447700>!    &amp; XDUO3N(37,NL), XDO3N2(37,NL), XDO3N3(37,NL), XDO3N4(37,NL)<a name='6536'></font>
<font color=#447700>!<a name='6537'></font>
<font color=#447700>!    &amp;,PRGFDL(NL)<a name='6538'></font>
<font color=#447700>!---------------------------------------------------------------------<a name='6539'></font>
       REAL :: PH1(45),PH2(37),P1(48),P2(33),O3HI1(10,16),O3HI2(10,9) &amp;<a name='6540'>
              ,O3LO1(10,16),O3LO2(10,16),O3LO3(10,16),O3LO4(10,16)<a name='6541'>
<font color=#447700>!----------------------------------------------------------------------<a name='6542'></font>
       REAL    :: AVG,A1,B1,B2<a name='6543'>
       INTEGER :: K,N,NCASE,IPLACE,KK,NKM,NKMM,KI,KQ,JJ,KEN,I,iindex,jindex<a name='6544'>
<font color=#447700>!----------------------------------------------------------------------<a name='6545'></font>
       REAL :: PSTD(NL),TEMPN(19),O3O3(37,NL,4),O35DEG(37,NL) &amp;<a name='6546'>
      ,XRAD1(NLGTH),XRAD2(NLGTH),XRAD3(NLGTH),XRAD4(NLGTH) &amp;<a name='6547'>
      ,DDUO3N(19,NL),DUO3N(19,41) &amp;<a name='6548'>
      ,RO3(10,41),RO3M(10,40),RO31(10,41),RO32(10,41) &amp;<a name='6549'>
      ,O3HI(10,25) &amp;<a name='6550'>
      ,RSTD(81),RBAR(NL),RDATA(81) &amp;<a name='6551'>
      ,PHALF(NL),P(81),PH(82)<a name='6552'>
<font color=#447700>!----------------------------------------------------------------------<a name='6553'></font>
                           EQUIVALENCE &amp;<a name='6554'>
       (O3HI1(1,1),O3HI(1,1)),(O3HI2(1,1),O3HI(1,17)) &amp;<a name='6555'>
      ,(PH1(1),PH(1)),(PH2(1),PH(46)) &amp;<a name='6556'>
      ,(P1(1),P(1)),(P2(1),P(49))<a name='6557'>
<font color=#447700>!----------------------------------------------------------------------<a name='6558'></font>
<font color=#447700>!                          EQUIVALENCE &amp;<a name='6559'></font>
<font color=#447700>!      (XRAD1(1),XDUO3N(1,1),O3O3(1,1,1)) &amp;<a name='6560'></font>
<font color=#447700>!     ,(XRAD2(1),XDO3N2(1,1)) &amp;<a name='6561'></font>
<font color=#447700>!     ,(XRAD3(1),XDO3N3(1,1)),(XRAD4(1),XDO3N4(1,1),)<a name='6562'></font>
                           EQUIVALENCE &amp;<a name='6563'>
       (XRAD1(1),O3O3(1,1,1)) &amp;<a name='6564'>
      ,(XRAD2(1),O3O3(1,1,2)) &amp;<a name='6565'>
      ,(XRAD3(1),O3O3(1,1,3)),(XRAD4(1),O3O3(1,1,4))<a name='6566'>
<font color=#447700>!----------------------------------------------------------------------<a name='6567'></font>
<font color=#447700>!---------------------------------------------------------------------<a name='6568'></font>
      DATA PH1/      0.,     &amp;<a name='6569'>
           0.1027246E-04, 0.1239831E-04, 0.1491845E-04, 0.1788053E-04,     &amp;<a name='6570'>
           0.2135032E-04, 0.2540162E-04, 0.3011718E-04, 0.3558949E-04,     &amp;<a name='6571'>
           0.4192172E-04, 0.4922875E-04, 0.5763817E-04, 0.6729146E-04,     &amp;<a name='6572'>
           0.7834518E-04, 0.9097232E-04, 0.1053635E-03, 0.1217288E-03,     &amp;<a name='6573'>
           0.1402989E-03, 0.1613270E-03, 0.1850904E-03, 0.2119495E-03,     &amp;<a name='6574'>
           0.2423836E-03, 0.2768980E-03, 0.3160017E-03, 0.3602623E-03,     &amp;<a name='6575'>
           0.4103126E-03, 0.4668569E-03, 0.5306792E-03, 0.6026516E-03,     &amp;<a name='6576'>
           0.6839018E-03, 0.7759249E-03, 0.8803303E-03, 0.9987843E-03,     &amp;<a name='6577'>
           0.1133178E-02, 0.1285955E-02, 0.1460360E-02, 0.1660001E-02,     &amp;<a name='6578'>
           0.1888764E-02, 0.2151165E-02, 0.2452466E-02, 0.2798806E-02,     &amp;<a name='6579'>
           0.3197345E-02, 0.3656456E-02, 0.4185934E-02, 0.4797257E-02/     <a name='6580'>
      DATA PH2/     &amp;<a name='6581'>
           0.5503893E-02, 0.6321654E-02, 0.7269144E-02, 0.8368272E-02,     &amp;<a name='6582'>
           0.9644873E-02, 0.1112946E-01, 0.1285810E-01, 0.1487354E-01,     &amp;<a name='6583'>
           0.1722643E-01, 0.1997696E-01, 0.2319670E-01, 0.2697093E-01,     &amp;<a name='6584'>
           0.3140135E-01, 0.3660952E-01, 0.4274090E-01, 0.4996992E-01,     &amp;<a name='6585'>
           0.5848471E-01, 0.6847525E-01, 0.8017242E-01, 0.9386772E-01,     &amp;<a name='6586'>
           0.1099026E+00, 0.1286765E+00, 0.1506574E+00, 0.1763932E+00,     &amp;<a name='6587'>
           0.2065253E+00, 0.2415209E+00, 0.2814823E+00, 0.3266369E+00,     &amp;<a name='6588'>
           0.3774861E+00, 0.4345638E+00, 0.4984375E+00, 0.5697097E+00,     &amp;<a name='6589'>
           0.6490189E+00, 0.7370409E+00, 0.8344896E+00, 0.9421190E+00,     &amp;<a name='6590'>
           0.1000000E+01/     <a name='6591'>
      DATA P1/     &amp;<a name='6592'>
           0.9300000E-05, 0.1129521E-04, 0.1360915E-04, 0.1635370E-04,     &amp;<a name='6593'>
           0.1954990E-04, 0.2331653E-04, 0.2767314E-04, 0.3277707E-04,     &amp;<a name='6594'>
           0.3864321E-04, 0.4547839E-04, 0.5328839E-04, 0.6234301E-04,     &amp;<a name='6595'>
           0.7263268E-04, 0.8450696E-04, 0.9793231E-04, 0.1133587E-03,     &amp;<a name='6596'>
           0.1307170E-03, 0.1505832E-03, 0.1728373E-03, 0.1982122E-03,     &amp;<a name='6597'>
           0.2266389E-03, 0.2592220E-03, 0.2957792E-03, 0.3376068E-03,     &amp;<a name='6598'>
           0.3844381E-03, 0.4379281E-03, 0.4976965E-03, 0.5658476E-03,     &amp;<a name='6599'>
           0.6418494E-03, 0.7287094E-03, 0.8261995E-03, 0.9380076E-03,     &amp;<a name='6600'>
           0.1063498E-02, 0.1207423E-02, 0.1369594E-02, 0.1557141E-02,     &amp;<a name='6601'>
           0.1769657E-02, 0.2015887E-02, 0.2295520E-02, 0.2620143E-02,     &amp;<a name='6602'>
           0.2989651E-02, 0.3419469E-02, 0.3909867E-02, 0.4481491E-02,     &amp;<a name='6603'>
           0.5135272E-02, 0.5898971E-02, 0.6774619E-02, 0.7799763E-02/     <a name='6604'>
      DATA P2/     &amp;<a name='6605'>
           0.8978218E-02, 0.1036103E-01, 0.1195488E-01, 0.1382957E-01,     &amp;<a name='6606'>
           0.1599631E-01, 0.1855114E-01, 0.2151235E-01, 0.2501293E-01,     &amp;<a name='6607'>
           0.2908220E-01, 0.3390544E-01, 0.3952926E-01, 0.4621349E-01,     &amp;<a name='6608'>
           0.5403168E-01, 0.6330472E-01, 0.7406807E-01, 0.8677983E-01,     &amp;<a name='6609'>
           0.1015345E+00, 0.1189603E+00, 0.1391863E+00, 0.1630739E+00,     &amp;<a name='6610'>
           0.1908004E+00, 0.2235461E+00, 0.2609410E+00, 0.3036404E+00,     &amp;<a name='6611'>
           0.3513750E+00, 0.4055375E+00, 0.4656677E+00, 0.5335132E+00,     &amp;<a name='6612'>
           0.6083618E+00, 0.6923932E+00, 0.7845676E+00, 0.8875882E+00,     &amp;<a name='6613'>
           0.1000000E+01/     <a name='6614'>
      DATA O3HI1/     &amp;<a name='6615'>
       .55,.50,.45,.45,.40,.35,.35,.30,.30,.30,     &amp;<a name='6616'>
       .55,.51,.46,.47,.42,.38,.37,.36,.35,.35,     &amp;<a name='6617'>
       .55,.53,.48,.49,.44,.42,.41,.40,.38,.38,     &amp;<a name='6618'>
       .60,.55,.52,.52,.50,.47,.46,.44,.42,.41,     &amp;<a name='6619'>
       .65,.60,.55,.56,.53,.52,.50,.48,.45,.45,     &amp;<a name='6620'>
       .75,.65,.60,.60,.55,.55,.55,.50,.48,.47,     &amp;<a name='6621'>
       .80,.75,.75,.75,.70,.70,.65,.63,.60,.60,     &amp;<a name='6622'>
       .90,.85,.85,.80,.80,.75,.75,.74,.72,.71,     &amp;<a name='6623'>
       1.10,1.05,1.00,.90,.90,.90,.85,.83,.80,.80,        &amp;<a name='6624'>
       1.40,1.30,1.25,1.25,1.25,1.20,1.15,1.10,1.05,1.00, &amp;<a name='6625'>
       1.7,1.7,1.6,1.6,1.6,1.6,1.6,1.6,1.5,1.5,     &amp;<a name='6626'>
       2.1,2.0,1.9,1.9,1.9,1.8,1.8,1.8,1.7,1.7,     &amp;<a name='6627'>
       2.4,2.3,2.2,2.2,2.2,2.1,2.1,2.1,2.0,2.0,     &amp;<a name='6628'>
       2.7,2.5,2.5,2.5,2.5,2.5,2.4,2.4,2.3,2.3,     &amp;<a name='6629'>
       2.9,2.8,2.7,2.7,2.7,2.7,2.7,2.7,2.6,2.6,     &amp;<a name='6630'>
       3.1,3.1,3.0,3.0,3.0,3.0,3.0,3.0,2.9,2.8/     <a name='6631'>
      DATA O3HI2/     &amp;<a name='6632'>
       3.3,3.4,3.4,3.6,3.7,3.9,4.0,4.1,4.0,3.8,     &amp;<a name='6633'>
       3.6,3.8,3.9,4.2,4.7,5.3,5.6,5.7,5.5,5.2,     &amp;<a name='6634'>
       4.1,4.3,4.7,5.2,6.0,6.7,7.0,6.8,6.4,6.2,     &amp;<a name='6635'>
       5.4,5.7,6.0,6.6,7.3,8.0,8.4,7.7,7.1,6.7,     &amp;<a name='6636'>
       6.7,6.8,7.0,7.6,8.3,10.0,9.6,8.2,7.5,7.2,     &amp;<a name='6637'>
       9.2,9.3,9.4,9.6,10.3,10.6,10.0,8.5,7.7,7.3,     &amp;<a name='6638'>
       12.6,12.1,12.0,12.1,11.7,11.0,10.0,8.6,7.8,7.4, &amp;<a name='6639'>
       14.2,13.5,13.1,12.8,11.9,10.9,9.8,8.5,7.8,7.5,  &amp;<a name='6640'>
       14.3,14.0,13.4,12.7,11.6,10.6,9.3,8.4,7.6,7.3/     <a name='6641'>
      DATA O3LO1/     &amp;<a name='6642'>
       14.9,14.2,13.3,12.5,11.2,10.3,9.5,8.6,7.5,7.4,  &amp;<a name='6643'>
       14.5,14.1,13.0,11.8,10.5,9.8,9.2,7.9,7.4,7.4,   &amp;<a name='6644'>
       11.8,11.5,10.9,10.5,9.9,9.6,8.9,7.5,7.2,7.2,    &amp;<a name='6645'>
       7.3,7.7,7.8,8.4,8.4,8.5,7.9,7.4,7.1,7.1,     &amp;<a name='6646'>
       4.1,4.4,5.3,6.6,6.9,7.5,7.4,7.2,7.0,6.9,     &amp;<a name='6647'>
       1.8,1.9,2.5,3.3,4.5,5.8,6.3,6.3,6.4,6.1,     &amp;<a name='6648'>
       0.4,0.5,0.8,1.2,2.7,3.6,4.6,4.7,5.0,5.2,     &amp;<a name='6649'>
       .10,.15,.20,.50,1.4,2.1,3.0,3.2,3.5,3.9,     &amp;<a name='6650'>
       .07,.10,.12,.30,1.0,1.4,1.8,1.9,2.3,2.5,     &amp;<a name='6651'>
       .06,.08,.10,.15,.60,.80,1.4,1.5,1.5,1.6,     &amp;<a name='6652'>
       .05,.05,.06,.09,.20,.40,.70,.80,.90,.90,     &amp;<a name='6653'>
       .05,.05,.06,.08,.10,.13,.20,.25,.30,.40,     &amp;<a name='6654'>
       .05,.05,.05,.06,.07,.07,.08,.09,.10,.13,     &amp;<a name='6655'>
       .05,.05,.05,.05,.06,.06,.06,.06,.07,.07,     &amp;<a name='6656'>
       .05,.05,.05,.05,.05,.05,.05,.06,.06,.06,     &amp;<a name='6657'>
       .04,.04,.04,.04,.04,.04,.04,.05,.05,.05/     <a name='6658'>
      DATA O3LO2/     &amp;<a name='6659'>
       14.8,14.2,13.8,12.2,11.0,9.8,8.5,7.8,7.4,6.9,   &amp;<a name='6660'>
       13.2,13.0,12.5,11.3,10.4,9.0,7.8,7.5,7.0,6.6,   &amp;<a name='6661'>
       10.6,10.6,10.7,10.1,9.4,8.6,7.5,7.0,6.5,6.1,    &amp;<a name='6662'>
       7.0,7.3,7.5,7.5,7.5,7.3,6.7,6.4,6.0,5.8,     &amp;<a name='6663'>
       3.8,4.0,4.7,5.0,5.2,5.9,5.8,5.6,5.5,5.5,     &amp;<a name='6664'>
       1.4,1.6,2.4,3.0,3.7,4.1,4.6,4.8,5.1,5.0,     &amp;<a name='6665'>
       .40,.50,.90,1.2,2.0,2.7,3.2,3.6,4.3,4.1,     &amp;<a name='6666'>
       .07,.10,.20,.30,.80,1.4,2.1,2.4,2.7,3.0,     &amp;<a name='6667'>
       .06,.07,.09,.15,.30,.70,1.2,1.4,1.6,2.0,     &amp;<a name='6668'>
       .05,.05,.06,.12,.15,.30,.60,.70,.80,.80,     &amp;<a name='6669'>
       .04,.05,.06,.08,.09,.15,.30,.40,.40,.40,     &amp;<a name='6670'>
       .04,.04,.05,.055,.06,.09,.12,.13,.15,.15,    &amp;<a name='6671'>
       .03,.03,.045,.052,.055,.06,.07,.07,.06,.07,  &amp;<a name='6672'>
       .03,.03,.04,.051,.052,.052,.06,.06,.05,.05,  &amp;<a name='6673'>
       .02,.02,.03,.05,.05,.05,.04,.04,.04,.04,     &amp;<a name='6674'>
       .02,.02,.02,.04,.04,.04,.03,.03,.03,.03/     <a name='6675'>
      DATA O3LO3/     &amp;<a name='6676'>
       14.5,14.0,13.5,11.3,11.0,10.0,9.0,8.3,7.5,7.3,    &amp;<a name='6677'>
       13.5,13.2,12.5,11.1,10.4,9.7,8.2,7.8,7.4,6.8,     &amp;<a name='6678'>
       10.8,10.9,11.0,10.4,10.0,9.6,7.9,7.5,7.0,6.7,     &amp;<a name='6679'>
       7.3,7.5,7.8,8.5,9.0,8.5,7.7,7.4,6.9,6.5,     &amp;<a name='6680'>
       4.1,4.5,5.3,6.2,7.3,7.7,7.3,7.0,6.6,6.4,     &amp;<a name='6681'>
       1.8,2.0,2.2,3.8,4.3,5.6,6.2,6.2,6.4,6.2,     &amp;<a name='6682'>
       .30,.50,.60,1.5,2.8,3.7,4.5,4.7,5.5,5.6,     &amp;<a name='6683'>
       .09,.10,.15,.60,1.2,2.1,3.0,3.5,4.0,4.3,     &amp;<a name='6684'>
       .06,.08,.10,.30,.60,1.1,1.9,2.2,2.9,3.0,     &amp;<a name='6685'>
       .04,.05,.06,.15,.45,.60,1.1,1.3,1.6,1.8,     &amp;<a name='6686'>
       .04,.04,.04,.08,.20,.30,.55,.60,.75,.90,     &amp;<a name='6687'>
       .04,.04,.04,.05,.06,.10,.12,.15,.20,.25,     &amp;<a name='6688'>
       .04,.04,.03,.04,.05,.06,.07,.07,.07,.08,     &amp;<a name='6689'>
       .03,.03,.04,.05,.05,.05,.05,.05,.05,.05,     &amp;<a name='6690'>
       .03,.03,.03,.04,.04,.04,.05,.05,.04,.04,     &amp;<a name='6691'>
       .02,.02,.02,.04,.04,.04,.04,.04,.03,.03/      <a name='6692'>
      DATA O3LO4/     &amp;<a name='6693'>
       14.2,13.8,13.2,12.5,11.7,10.5,8.6,7.8,7.5,6.6,  &amp;<a name='6694'>
       12.5,12.4,12.2,11.7,10.8,9.8,7.8,7.2,6.5,6.1,   &amp;<a name='6695'>
       10.6,10.5,10.4,10.1,9.6,9.0,7.1,6.8,6.1,5.9,    &amp;<a name='6696'>
       7.0,7.4,7.9,7.8,7.6,7.3,6.2,6.1,5.8,5.6,     &amp;<a name='6697'>
       4.2,4.6,5.1,5.6,5.9,5.9,5.9,5.8,5.6,5.3,     &amp;<a name='6698'>
       2.1,2.3,2.6,2.9,3.5,4.3,4.8,4.9,5.1,5.1,     &amp;<a name='6699'>
       0.7,0.8,1.0,1.5,2.0,2.8,3.5,3.6,3.7,4.0,     &amp;<a name='6700'>
       .15,.20,.40,.50,.60,1.4,2.1,2.2,2.3,2.5,     &amp;<a name='6701'>
       .08,.10,.15,.25,.30,.90,1.2,1.3,1.4,1.6,     &amp;<a name='6702'>
       .07,.08,.10,.14,.20,.50,.70,.90,.90,.80,     &amp;<a name='6703'>
       .05,.06,.08,.12,.14,.20,.35,.40,.60,.50,     &amp;<a name='6704'>
       .05,.05,.08,.09,.09,.09,.11,.12,.15,.18,     &amp;<a name='6705'>
       .04,.05,.06,.07,.07,.08,.08,.08,.08,.08,     &amp;<a name='6706'>
       .04,.04,.05,.07,.07,.07,.07,.07,.06,.05,     &amp;<a name='6707'>
       .02,.02,.04,.05,.05,.05,.05,.05,.04,.04,     &amp;<a name='6708'>
       .02,.02,.03,.04,.04,.04,.04,.04,.03,.03/     <a name='6709'>
<font color=#447700>!----------------------------------------------------------------------<a name='6710'></font>
<font color=#447700>!***<a name='6711'></font>
<font color=#447700>!***  COMPUTE DETAILED O3 PROFILE FROM THE ORIGINAL GFDL PRESSURES<a name='6712'></font>
<font color=#447700>!***  WHERE OUTPUT FROM O3INT (PSTD) IS TOP DOWN IN MB*1.E3<a name='6713'></font>
<font color=#447700>!***  AND PSFC=1013.25 MB    ......K.A.C. DEC94<a name='6714'></font>
<font color=#447700>!***<a name='6715'></font>
      DO K=1,NK<a name='6716'>
        PH(K)=PH(K)*1013250.<a name='6717'>
        P(K)=P(K)*1013250.<a name='6718'>
      ENDDO<a name='6719'>
<font color=#447700>!<a name='6720'></font>
      PH(NKP)=PH(NKP)*1013250.<a name='6721'>
<font color=#447700>!<a name='6722'></font>
      DO K=1,NL<a name='6723'>
        PSTD(K)=P(K)<a name='6724'>
      ENDDO<a name='6725'>
<font color=#447700>!<a name='6726'></font>
      DO K=1,25<a name='6727'>
      DO N=1,10<a name='6728'>
        RO31(N,K)=O3HI(N,K)<a name='6729'>
        RO32(N,K)=O3HI(N,K)<a name='6730'>
      ENDDO<a name='6731'>
      ENDDO<a name='6732'>
<font color=#447700>!----------------------------------------------------------------------<a name='6733'></font>
      DO 100 NCASE=1,4<a name='6734'>
<font color=#447700>!<a name='6735'></font>
<font color=#447700>!***  NCASE=1: SPRING (IN N.H.)<a name='6736'></font>
<font color=#447700>!***  NCASE=2: FALL   (IN N.H.)<a name='6737'></font>
<font color=#447700>!***  NCASE=3: WINTER (IN N.H.)<a name='6738'></font>
<font color=#447700>!***  NCASE=4: SUMMER (IN N.H.)<a name='6739'></font>
<font color=#447700>!<a name='6740'></font>
      IPLACE=2<a name='6741'>
      IF(NCASE.EQ.2)IPLACE=4<a name='6742'>
      IF(NCASE.EQ.3)IPLACE=1<a name='6743'>
      IF(NCASE.EQ.4)IPLACE=3<a name='6744'>
<font color=#447700>!<a name='6745'></font>
      IF(NCASE.EQ.1.OR.NCASE.EQ.2)THEN<a name='6746'>
        DO K=26,41<a name='6747'>
        DO N=1,10<a name='6748'>
          RO31(N,K)=O3LO1(N,K-25)<a name='6749'>
          RO32(N,K)=O3LO2(N,K-25)<a name='6750'>
        ENDDO<a name='6751'>
        ENDDO<a name='6752'>
      ENDIF<a name='6753'>
<font color=#447700>!<a name='6754'></font>
      IF(NCASE.EQ.3.OR.NCASE.EQ.4)THEN<a name='6755'>
        DO K=26,41<a name='6756'>
        DO N=1,10<a name='6757'>
          RO31(N,K)=O3LO3(N,K-25)<a name='6758'>
          RO32(N,K)=O3LO4(N,K-25)<a name='6759'>
        ENDDO<a name='6760'>
        ENDDO<a name='6761'>
      ENDIF<a name='6762'>
<font color=#447700>!<a name='6763'></font>
      DO 25 KK=1,NKK<a name='6764'>
      DO N=1,10<a name='6765'>
        DUO3N(N,KK)=RO31(11-N,KK)<a name='6766'>
        DUO3N(N+9,KK)=RO32(N,KK)<a name='6767'>
      ENDDO<a name='6768'>
      DUO3N(10,KK)=0.5*(RO31(1,KK)+RO32(1,KK))<a name='6769'>
   25 CONTINUE<a name='6770'>
<font color=#447700>!<a name='6771'></font>
<font color=#447700>!***FOR NCASE=2 OR NCASE=4,REVERSE LATITUDE ARRANGEMENT OF CORR. SEASON<a name='6772'></font>
<font color=#447700>!<a name='6773'></font>
      IF(NCASE.EQ.2.OR.NCASE.EQ.4)THEN<a name='6774'>
        DO 50 KK=1,NKK<a name='6775'>
        DO N=1,19<a name='6776'>
          TEMPN(N)=DUO3N(20-N,KK)<a name='6777'>
        ENDDO<a name='6778'>
         DO N=1,19<a name='6779'>
           DUO3N(N,KK)=TEMPN(N)<a name='6780'>
         ENDDO<a name='6781'>
   50   CONTINUE<a name='6782'>
      ENDIF<a name='6783'>
<font color=#447700>!<a name='6784'></font>
<font color=#447700>!***  DUO3N NOW IS O3 PROFILE FOR APPROPRIATE SEASON AT STD PRESSURE<a name='6785'></font>
<font color=#447700>!***  LEVELS<a name='6786'></font>
<font color=#447700>!<a name='6787'></font>
<font color=#447700>!***  BEGIN LATITUDE (10 DEG) LOOP<a name='6788'></font>
<font color=#447700>!<a name='6789'></font>
      DO 75 N=1,19<a name='6790'>
<font color=#447700>!<a name='6791'></font>
      DO KK=1,NKK<a name='6792'>
        RSTD(KK)=DUO3N(N,KK)<a name='6793'>
      ENDDO<a name='6794'>
<font color=#447700>!<a name='6795'></font>
      NKM=NK-1<a name='6796'>
      NKMM=NK-3<a name='6797'>
<font color=#447700>!***<a name='6798'></font>
<font color=#447700>!***  BESSELS HALF-POINT INTERPOLATION FORMULA<a name='6799'></font>
<font color=#447700>!***<a name='6800'></font>
      DO K=4,NKMM,2<a name='6801'>
        KI=K/2<a name='6802'>
        RDATA(K)=0.5*(RSTD(KI)+RSTD(KI+1))-(RSTD(KI+2)-RSTD(KI+1) &amp;<a name='6803'>
                                           -RSTD(KI)+RSTD(KI-1))/16.<a name='6804'>
      ENDDO<a name='6805'>
<font color=#447700>!<a name='6806'></font>
      RDATA(2)=0.5*(RSTD(2)+RSTD(1))<a name='6807'>
      RDATA(NKM)=0.5*(RSTD(NKK)+RSTD(NKK-1))<a name='6808'>
<font color=#447700>!<a name='6809'></font>
<font color=#447700>!***  PUT UNCHANGED DATA INTO NEW ARRAY<a name='6810'></font>
<font color=#447700>!<a name='6811'></font>
      DO K=1,NK,2<a name='6812'>
        KQ=(K+1)/2<a name='6813'>
        RDATA(K)=RSTD(KQ)<a name='6814'>
      ENDDO<a name='6815'>
<font color=#447700>!<a name='6816'></font>
      DO KK=1,NL<a name='6817'>
        DDUO3N(N,KK)=RDATA(KK)*.01<a name='6818'>
      ENDDO<a name='6819'>
<font color=#447700>!<a name='6820'></font>
   75 CONTINUE<a name='6821'>
<font color=#447700>!<a name='6822'></font>
<font color=#447700>!***  END OF LATITUDE LOOP<a name='6823'></font>
<font color=#447700>!<a name='6824'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='6825'></font>
<font color=#447700>!***<a name='6826'></font>
<font color=#447700>!***  CREATE 5 DEG OZONE QUANTITIES BY LINEAR INTERPOLATION OF<a name='6827'></font>
<font color=#447700>!***  10 DEG VALUES<a name='6828'></font>
<font color=#447700>!***<a name='6829'></font>
      DO 90 KK=1,NL<a name='6830'>
<font color=#447700>!<a name='6831'></font>
      DO N=1,19<a name='6832'>
        O35DEG(2*N-1,KK)=DDUO3N(N,KK)<a name='6833'>
      ENDDO<a name='6834'>
<font color=#447700>!<a name='6835'></font>
      DO N=1,18<a name='6836'>
        O35DEG(2*N,KK)=0.5*(DDUO3N(N,KK)+DDUO3N(N+1,KK))<a name='6837'>
      ENDDO<a name='6838'>
<font color=#447700>!<a name='6839'></font>
   90 CONTINUE<a name='6840'>
<font color=#447700>!<a name='6841'></font>
      DO JJ=1,37<a name='6842'>
      DO KEN=1,NL<a name='6843'>
        O3O3(JJ,KEN,IPLACE)=O35DEG(JJ,KEN)<a name='6844'>
      ENDDO<a name='6845'>
      ENDDO<a name='6846'>
<font color=#447700>!<a name='6847'></font>
  100 CONTINUE<a name='6848'>
<font color=#447700>!----------------------------------------------------------------------<a name='6849'></font>
<font color=#447700>!***  END OF LOOP OVER CASES<a name='6850'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='6851'></font>
<font color=#447700>!***<a name='6852'></font>
<font color=#447700>!***  AVERAGE CLIMATOLOGICAL VALUS OF O3 FROM 5 DEG LAT MEANS, SO THAT<a name='6853'></font>
<font color=#447700>!***  TIME AND SPACE INTERPOLATION WILL WORK (SEE SUBR OZON2D)<a name='6854'></font>
<font color=#447700>!***<a name='6855'></font>
      DO I=1,NLGTH<a name='6856'>
        AVG=0.25*(XRAD1(I)+XRAD2(I)+XRAD3(I)+XRAD4(I))<a name='6857'>
        A1=0.5*(XRAD2(I)-XRAD4(I))<a name='6858'>
        B1=0.5*(XRAD1(I)-XRAD3(I))<a name='6859'>
        B2=0.25*((XRAD1(I)+XRAD3(I))-(XRAD2(I)+XRAD4(I)))<a name='6860'>
<a name='6861'>
<font color=#447700>!       XRAD1(I)=AVG<a name='6862'></font>
<font color=#447700>!       XRAD2(I)=A1<a name='6863'></font>
<font color=#447700>!       XRAD3(I)=B1<a name='6864'></font>
<font color=#447700>!       XRAD4(I)=B2<a name='6865'></font>
<a name='6866'>
        iindex = 1+mod((I-1),37)<a name='6867'>
        jindex = 1+(I-1)/37<a name='6868'>
        XDUO3N(iindex,jindex)=AVG<a name='6869'>
        XDO3N2(iindex,jindex)=A1<a name='6870'>
        XDO3N3(iindex,jindex)=B1<a name='6871'>
        XDO3N4(iindex,jindex)=B2<a name='6872'>
      ENDDO<a name='6873'>
<font color=#447700>!***<a name='6874'></font>
<font color=#447700>!***  CONVERT GFDL PRESSURE (MICROBARS) TO PA <a name='6875'></font>
<font color=#447700>!***<a name='6876'></font>
      DO N=1,NL<a name='6877'>
        PRGFDL(N)=PSTD(N)*1.E-1<a name='6878'>
      ENDDO<a name='6879'>
<font color=#447700>!<a name='6880'></font>
    END SUBROUTINE O3CLIM<a name='6881'>
<a name='6882'>
<font color=#447700>!---------------------------------------------------------------------<a name='6883'></font>
<A NAME='TABLE'><A href='../../html_code/phys/module_ra_gfdleta.F.html#TABLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6884'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TABLE</font>  <A href='../../call_to/TABLE.html' TARGET='index'>1</A><a name='6885'>
<font color=#447700>!                     (TABLE1,TABLE2,TABLE3,EM1,EM1WDE,EM3,          &amp;<a name='6886'></font>
<font color=#447700>!                      SOURCE,DSRCE                                  )<a name='6887'></font>
<font color=#447700>!---------------------------------------------------------------------<a name='6888'></font>
 IMPLICIT NONE<a name='6889'>
<font color=#447700>!----------------------------------------------------------------------<a name='6890'></font>
<a name='6891'>
<font color=#447700>!INTEGER, PARAMETER :: NBLY=15<a name='6892'></font>
 INTEGER, PARAMETER :: NB=12<a name='6893'>
 INTEGER, PARAMETER :: NBLX=47<a name='6894'>
 INTEGER , PARAMETER:: NBLW = 163<a name='6895'>
<a name='6896'>
 REAL,PARAMETER ::      AMOLWT=28.9644<a name='6897'>
 REAL,PARAMETER ::      CSUBP=1.00484E7<a name='6898'>
 REAL,PARAMETER ::      DIFFCTR=1.66<a name='6899'>
 REAL,PARAMETER ::      G=980.665<a name='6900'>
 REAL,PARAMETER ::      GINV=1./G<a name='6901'>
 REAL,PARAMETER ::      GRAVDR=980.0<a name='6902'>
 REAL,PARAMETER ::      O3DIFCTR=1.90<a name='6903'>
 REAL,PARAMETER ::      P0=1013250.<a name='6904'>
 REAL,PARAMETER ::      P0INV=1./P0<a name='6905'>
 REAL,PARAMETER ::      GP0INV=GINV*P0INV<a name='6906'>
 REAL,PARAMETER ::      P0XZP2=202649.902<a name='6907'>
 REAL,PARAMETER ::      P0XZP8=810600.098<a name='6908'>
 REAL,PARAMETER ::      P0X2=2.*1013250.<a name='6909'>
 REAL,PARAMETER ::      RADCON=8.427<a name='6910'>
 REAL,PARAMETER ::      RADCON1=1./8.427<a name='6911'>
 REAL,PARAMETER ::      RATCO2MW=1.519449738<a name='6912'>
 REAL,PARAMETER ::      RATH2OMW=.622<a name='6913'>
 REAL,PARAMETER ::      RGAS=8.3142E7<a name='6914'>
 REAL,PARAMETER ::      RGASSP=8.31432E7<a name='6915'>
 REAL,PARAMETER ::      SECPDA=8.64E4<a name='6916'>
<font color=#447700>!<a name='6917'></font>
<font color=#447700>!******THE FOLLOWING ARE MATHEMATICAL CONSTANTS*******<a name='6918'></font>
<font color=#447700>!        ARRANGED IN DECREASING ORDER<a name='6919'></font>
 REAL,PARAMETER ::      HUNDRED=100.<a name='6920'>
 REAL,PARAMETER ::      HNINETY=90.<a name='6921'>
 REAL,PARAMETER ::      HNINE=9.0<a name='6922'>
 REAL,PARAMETER ::      SIXTY=60.<a name='6923'>
 REAL,PARAMETER ::      FIFTY=50.<a name='6924'>
 REAL,PARAMETER ::      TEN=10.<a name='6925'>
 REAL,PARAMETER ::      EIGHT=8.<a name='6926'>
 REAL,PARAMETER ::      FIVE=5.<a name='6927'>
 REAL,PARAMETER ::      FOUR=4.<a name='6928'>
 REAL,PARAMETER ::      THREE=3.<a name='6929'>
 REAL,PARAMETER ::      TWO=2.<a name='6930'>
 REAL,PARAMETER ::      ONE=1.<a name='6931'>
 REAL,PARAMETER ::      HAF=0.5<a name='6932'>
 REAL,PARAMETER ::      QUARTR=0.25<a name='6933'>
 REAL,PARAMETER ::      ZERO=0.<a name='6934'>
<font color=#447700>!<a name='6935'></font>
<font color=#447700>!******FOLLOWING ARE POSITIVE FLOATING POINT CONSTANTS(H'S)<a name='6936'></font>
<font color=#447700>!       ARRANGED IN DECREASING ORDER<a name='6937'></font>
 REAL,PARAMETER ::      H83E26=8.3E26<a name='6938'>
 REAL,PARAMETER ::      H71E26=7.1E26<a name='6939'>
 REAL,PARAMETER ::      H1E15=1.E15<a name='6940'>
 REAL,PARAMETER ::      H1E13=1.E13<a name='6941'>
 REAL,PARAMETER ::      H1E11=1.E11<a name='6942'>
 REAL,PARAMETER ::      H1E8=1.E8<a name='6943'>
 REAL,PARAMETER ::      H2E6=2.0E6<a name='6944'>
 REAL,PARAMETER ::      H1E6=1.0E6<a name='6945'>
 REAL,PARAMETER ::      H69766E5=6.97667E5<a name='6946'>
 REAL,PARAMETER ::      H4E5=4.E5<a name='6947'>
 REAL,PARAMETER ::      H165E5=1.65E5<a name='6948'>
 REAL,PARAMETER ::      H5725E4=57250.<a name='6949'>
 REAL,PARAMETER ::      H488E4=48800.<a name='6950'>
 REAL,PARAMETER ::      H1E4=1.E4<a name='6951'>
 REAL,PARAMETER ::      H24E3=2400.<a name='6952'>
 REAL,PARAMETER ::      H20788E3=2078.8<a name='6953'>
 REAL,PARAMETER ::      H2075E3=2075.<a name='6954'>
 REAL,PARAMETER ::      H18E3=1800.<a name='6955'>
 REAL,PARAMETER ::      H1224E3=1224.<a name='6956'>
 REAL,PARAMETER ::      H67390E2=673.9057<a name='6957'>
 REAL,PARAMETER ::      H5E2=500.<a name='6958'>
 REAL,PARAMETER ::      H3082E2=308.2<a name='6959'>
 REAL,PARAMETER ::      H3E2=300.<a name='6960'>
 REAL,PARAMETER ::      H2945E2=294.5<a name='6961'>
 REAL,PARAMETER ::      H29316E2=293.16<a name='6962'>
 REAL,PARAMETER ::      H26E2=260.0<a name='6963'>
 REAL,PARAMETER ::      H25E2=250.<a name='6964'>
 REAL,PARAMETER ::      H23E2=230.<a name='6965'>
 REAL,PARAMETER ::      H2E2=200.0<a name='6966'>
 REAL,PARAMETER ::      H15E2=150.<a name='6967'>
 REAL,PARAMETER ::      H1386E2=138.6<a name='6968'>
 REAL,PARAMETER ::      H1036E2=103.6<a name='6969'>
 REAL,PARAMETER ::      H8121E1=81.21<a name='6970'>
 REAL,PARAMETER ::      H35E1=35.<a name='6971'>
 REAL,PARAMETER ::      H3116E1=31.16<a name='6972'>
 REAL,PARAMETER ::      H28E1=28.<a name='6973'>
 REAL,PARAMETER ::      H181E1=18.1<a name='6974'>
 REAL,PARAMETER ::      H18E1=18.<a name='6975'>
 REAL,PARAMETER ::      H161E1=16.1<a name='6976'>
 REAL,PARAMETER ::      H16E1=16.<a name='6977'>
 REAL,PARAMETER ::      H1226E1=12.26<a name='6978'>
 REAL,PARAMETER ::      H9P94=9.94<a name='6979'>
 REAL,PARAMETER ::      H6P08108=6.081081081<a name='6980'>
 REAL,PARAMETER ::      H3P6=3.6<a name='6981'>
 REAL,PARAMETER ::      H3P5=3.5<a name='6982'>
 REAL,PARAMETER ::      H2P9=2.9<a name='6983'>
 REAL,PARAMETER ::      H2P8=2.8<a name='6984'>
 REAL,PARAMETER ::      H2P5=2.5<a name='6985'>
 REAL,PARAMETER ::      H1P8=1.8<a name='6986'>
 REAL,PARAMETER ::      H1P4387=1.4387<a name='6987'>
 REAL,PARAMETER ::      H1P41819=1.418191<a name='6988'>
 REAL,PARAMETER ::      H1P4=1.4<a name='6989'>
 REAL,PARAMETER ::      H1P25892=1.258925411<a name='6990'>
 REAL,PARAMETER ::      H1P082=1.082<a name='6991'>
 REAL,PARAMETER ::      HP816=0.816<a name='6992'>
 REAL,PARAMETER ::      HP805=0.805<a name='6993'>
 REAL,PARAMETER ::      HP8=0.8<a name='6994'>
 REAL,PARAMETER ::      HP60241=0.60241<a name='6995'>
 REAL,PARAMETER ::      HP602409=0.60240964<a name='6996'>
 REAL,PARAMETER ::      HP6=0.6<a name='6997'>
 REAL,PARAMETER ::      HP526315=0.52631579<a name='6998'>
 REAL,PARAMETER ::      HP518=0.518<a name='6999'>
 REAL,PARAMETER ::      HP5048=0.5048<a name='7000'>
 REAL,PARAMETER ::      HP3795=0.3795<a name='7001'>
 REAL,PARAMETER ::      HP369=0.369<a name='7002'>
 REAL,PARAMETER ::      HP26=0.26<a name='7003'>
 REAL,PARAMETER ::      HP228=0.228<a name='7004'>
 REAL,PARAMETER ::      HP219=0.219<a name='7005'>
 REAL,PARAMETER ::      HP166666=.166666<a name='7006'>
 REAL,PARAMETER ::      HP144=0.144<a name='7007'>
 REAL,PARAMETER ::      HP118666=0.118666192<a name='7008'>
 REAL,PARAMETER ::      HP1=0.1<a name='7009'>
<font color=#447700>!        (NEGATIVE EXPONENTIALS BEGIN HERE)<a name='7010'></font>
 REAL,PARAMETER ::      H658M2=0.0658<a name='7011'>
 REAL,PARAMETER ::      H625M2=0.0625<a name='7012'>
 REAL,PARAMETER ::      H44871M2=4.4871E-2<a name='7013'>
 REAL,PARAMETER ::      H44194M2=.044194<a name='7014'>
 REAL,PARAMETER ::      H42M2=0.042<a name='7015'>
 REAL,PARAMETER ::      H41666M2=0.0416666<a name='7016'>
 REAL,PARAMETER ::      H28571M2=.02857142857<a name='7017'>
 REAL,PARAMETER ::      H2118M2=0.02118<a name='7018'>
 REAL,PARAMETER ::      H129M2=0.0129<a name='7019'>
 REAL,PARAMETER ::      H1M2=.01<a name='7020'>
 REAL,PARAMETER ::      H559M3=5.59E-3<a name='7021'>
 REAL,PARAMETER ::      H3M3=0.003<a name='7022'>
 REAL,PARAMETER ::      H235M3=2.35E-3<a name='7023'>
 REAL,PARAMETER ::      H1M3=1.0E-3<a name='7024'>
 REAL,PARAMETER ::      H987M4=9.87E-4<a name='7025'>
 REAL,PARAMETER ::      H323M4=0.000323<a name='7026'>
 REAL,PARAMETER ::      H3M4=0.0003<a name='7027'>
 REAL,PARAMETER ::      H285M4=2.85E-4<a name='7028'>
 REAL,PARAMETER ::      H1M4=0.0001<a name='7029'>
 REAL,PARAMETER ::      H75826M4=7.58265E-4<a name='7030'>
 REAL,PARAMETER ::      H6938M5=6.938E-5<a name='7031'>
 REAL,PARAMETER ::      H394M5=3.94E-5<a name='7032'>
 REAL,PARAMETER ::      H37412M5=3.7412E-5<a name='7033'>
 REAL,PARAMETER ::      H15M5=1.5E-5<a name='7034'>
 REAL,PARAMETER ::      H1439M5=1.439E-5<a name='7035'>
 REAL,PARAMETER ::      H128M5=1.28E-5<a name='7036'>
 REAL,PARAMETER ::      H102M5=1.02E-5<a name='7037'>
 REAL,PARAMETER ::      H1M5=1.0E-5<a name='7038'>
 REAL,PARAMETER ::      H7M6=7.E-6<a name='7039'>
 REAL,PARAMETER ::      H4999M6=4.999E-6<a name='7040'>
 REAL,PARAMETER ::      H451M6=4.51E-6<a name='7041'>
 REAL,PARAMETER ::      H25452M6=2.5452E-6<a name='7042'>
 REAL,PARAMETER ::      H1M6=1.E-6<a name='7043'>
 REAL,PARAMETER ::      H391M7=3.91E-7<a name='7044'>
 REAL,PARAMETER ::      H1174M7=1.174E-7<a name='7045'>
 REAL,PARAMETER ::      H8725M8=8.725E-8<a name='7046'>
 REAL,PARAMETER ::      H327M8=3.27E-8<a name='7047'>
 REAL,PARAMETER ::      H257M8=2.57E-8<a name='7048'>
 REAL,PARAMETER ::      H1M8=1.0E-8<a name='7049'>
 REAL,PARAMETER ::      H23M10=2.3E-10<a name='7050'>
 REAL,PARAMETER ::      H14M10=1.4E-10<a name='7051'>
 REAL,PARAMETER ::      H11M10=1.1E-10<a name='7052'>
 REAL,PARAMETER ::      H1M10=1.E-10<a name='7053'>
 REAL,PARAMETER ::      H83M11=8.3E-11<a name='7054'>
 REAL,PARAMETER ::      H82M11=8.2E-11<a name='7055'>
 REAL,PARAMETER ::      H8M11=8.E-11<a name='7056'>
 REAL,PARAMETER ::      H77M11=7.7E-11<a name='7057'>
 REAL,PARAMETER ::      H72M11=7.2E-11<a name='7058'>
 REAL,PARAMETER ::      H53M11=5.3E-11<a name='7059'>
 REAL,PARAMETER ::      H48M11=4.8E-11<a name='7060'>
 REAL,PARAMETER ::      H44M11=4.4E-11<a name='7061'>
 REAL,PARAMETER ::      H42M11=4.2E-11<a name='7062'>
 REAL,PARAMETER ::      H37M11=3.7E-11<a name='7063'>
 REAL,PARAMETER ::      H35M11=3.5E-11<a name='7064'>
 REAL,PARAMETER ::      H32M11=3.2E-11<a name='7065'>
 REAL,PARAMETER ::      H3M11=3.0E-11<a name='7066'>
 REAL,PARAMETER ::      H28M11=2.8E-11<a name='7067'>
 REAL,PARAMETER ::      H24M11=2.4E-11<a name='7068'>
 REAL,PARAMETER ::      H23M11=2.3E-11<a name='7069'>
 REAL,PARAMETER ::      H2M11=2.E-11<a name='7070'>
 REAL,PARAMETER ::      H18M11=1.8E-11<a name='7071'>
 REAL,PARAMETER ::      H15M11=1.5E-11<a name='7072'>
 REAL,PARAMETER ::      H14M11=1.4E-11<a name='7073'>
 REAL,PARAMETER ::      H114M11=1.14E-11<a name='7074'>
 REAL,PARAMETER ::      H11M11=1.1E-11<a name='7075'>
 REAL,PARAMETER ::      H1M11=1.E-11<a name='7076'>
 REAL,PARAMETER ::      H96M12=9.6E-12<a name='7077'>
 REAL,PARAMETER ::      H93M12=9.3E-12<a name='7078'>
 REAL,PARAMETER ::      H77M12=7.7E-12<a name='7079'>
 REAL,PARAMETER ::      H74M12=7.4E-12<a name='7080'>
 REAL,PARAMETER ::      H65M12=6.5E-12<a name='7081'>
 REAL,PARAMETER ::      H62M12=6.2E-12<a name='7082'>
 REAL,PARAMETER ::      H6M12=6.E-12<a name='7083'>
 REAL,PARAMETER ::      H45M12=4.5E-12<a name='7084'>
 REAL,PARAMETER ::      H44M12=4.4E-12<a name='7085'>
 REAL,PARAMETER ::      H4M12=4.E-12<a name='7086'>
 REAL,PARAMETER ::      H38M12=3.8E-12<a name='7087'>
 REAL,PARAMETER ::      H37M12=3.7E-12<a name='7088'>
 REAL,PARAMETER ::      H3M12=3.E-12<a name='7089'>
 REAL,PARAMETER ::      H29M12=2.9E-12<a name='7090'>
 REAL,PARAMETER ::      H28M12=2.8E-12<a name='7091'>
 REAL,PARAMETER ::      H24M12=2.4E-12<a name='7092'>
 REAL,PARAMETER ::      H21M12=2.1E-12<a name='7093'>
 REAL,PARAMETER ::      H16M12=1.6E-12<a name='7094'>
 REAL,PARAMETER ::      H14M12=1.4E-12<a name='7095'>
 REAL,PARAMETER ::      H12M12=1.2E-12<a name='7096'>
 REAL,PARAMETER ::      H8M13=8.E-13<a name='7097'>
 REAL,PARAMETER ::      H46M13=4.6E-13<a name='7098'>
 REAL,PARAMETER ::      H36M13=3.6E-13<a name='7099'>
 REAL,PARAMETER ::      H135M13=1.35E-13<a name='7100'>
 REAL,PARAMETER ::      H12M13=1.2E-13<a name='7101'>
 REAL,PARAMETER ::      H1M13=1.E-13<a name='7102'>
 REAL,PARAMETER ::      H3M14=3.E-14<a name='7103'>
 REAL,PARAMETER ::      H15M14=1.5E-14<a name='7104'>
 REAL,PARAMETER ::      H14M14=1.4E-14<a name='7105'>
<font color=#447700>!<a name='7106'></font>
<font color=#447700>!******FOLLOWING ARE NEGATIVE FLOATING POINT CONSTANTS (HM'S)<a name='7107'></font>
<font color=#447700>!          ARRANGED IN DESCENDING ORDER<a name='7108'></font>
 REAL,PARAMETER ::      HM2M2=-.02<a name='7109'>
 REAL,PARAMETER ::      HM6666M2=-.066667<a name='7110'>
 REAL,PARAMETER ::      HMP5=-0.5<a name='7111'>
 REAL,PARAMETER ::      HMP575=-0.575<a name='7112'>
 REAL,PARAMETER ::      HMP66667=-.66667<a name='7113'>
 REAL,PARAMETER ::      HMP805=-0.805<a name='7114'>
 REAL,PARAMETER ::      HM1EZ=-1.<a name='7115'>
 REAL,PARAMETER ::      HM13EZ=-1.3<a name='7116'>
 REAL,PARAMETER ::      HM19EZ=-1.9<a name='7117'>
 REAL,PARAMETER ::      HM1E1=-10.<a name='7118'>
 REAL,PARAMETER ::      HM1597E1=-15.97469413<a name='7119'>
 REAL,PARAMETER ::      HM161E1=-16.1<a name='7120'>
 REAL,PARAMETER ::      HM1797E1=-17.97469413<a name='7121'>
 REAL,PARAMETER ::      HM181E1=-18.1<a name='7122'>
 REAL,PARAMETER ::      HM8E1=-80.<a name='7123'>
 REAL,PARAMETER ::      HM1E2=-100.<a name='7124'>
<font color=#447700>!<a name='7125'></font>
 REAL,PARAMETER ::      H1M16=1.0E-16<a name='7126'>
 REAL,PARAMETER ::      H1M20=1.E-20<a name='7127'>
 REAL,PARAMETER ::      HP98=0.98<a name='7128'>
 REAL,PARAMETER ::      Q19001=19.001<a name='7129'>
 REAL,PARAMETER ::      DAYSEC=1.1574E-5<a name='7130'>
 REAL,PARAMETER ::      HSIGMA=5.673E-5<a name='7131'>
 REAL,PARAMETER ::      TWENTY=20.0<a name='7132'>
 REAL,PARAMETER ::      HP537=0.537<a name='7133'>
 REAL,PARAMETER ::      HP2=0.2<a name='7134'>
 REAL,PARAMETER ::      RCO2=3.3E-4<a name='7135'>
 REAL,PARAMETER ::      Q14330=1.43306E-6<a name='7136'>
 REAL,PARAMETER ::      H3M6=3.0E-6<a name='7137'>
 REAL,PARAMETER ::      PI=3.1415927<a name='7138'>
 REAL,PARAMETER ::      DEGRAD=180.0/PI<a name='7139'>
 REAL,PARAMETER ::      H74E1=74.0<a name='7140'>
 REAL,PARAMETER ::      H15E1=15.0<a name='7141'>
<a name='7142'>
 REAL, PARAMETER:: B0 = -.51926410E-4<a name='7143'>
 REAL, PARAMETER:: B1 = -.18113332E-3<a name='7144'>
 REAL, PARAMETER:: B2 = -.10680132E-5<a name='7145'>
 REAL, PARAMETER:: B3 = -.67303519E-7<a name='7146'>
 REAL, PARAMETER:: AWIDE = 0.309801E+01<a name='7147'>
 REAL, PARAMETER:: BWIDE = 0.495357E-01<a name='7148'>
 REAL, PARAMETER:: BETAWD = 0.347839E+02<a name='7149'>
 REAL, PARAMETER:: BETINW = 0.766811E+01<a name='7150'>
<a name='7151'>
<a name='7152'>
<font color=#447700>!     REAL, INTENT(OUT) :: EM1(28,180),EM1WDE(28,180),TABLE1(28,180), &amp;<a name='7153'></font>
<font color=#447700>!                          TABLE2(28,180),TABLE3(28,180),EM3(28,180), &amp;<a name='7154'></font>
<font color=#447700>!                          SOURCE(28,NBLY), DSRCE(28,NBLY)<a name='7155'></font>
<a name='7156'>
<font color=#447700>!<a name='7157'></font>
      REAL :: ARNDM(NBLW),BRNDM(NBLW),BETAD(NBLW)<a name='7158'>
      REAL :: BANDLO(NBLW),BANDHI(NBLW)<a name='7159'>
<a name='7160'>
      INTEGER :: IBAND(40)<a name='7161'>
<a name='7162'>
      REAL :: BANDL1(64),BANDL2(64),BANDL3(35)<a name='7163'>
      REAL :: BANDH1(64),BANDH2(64),BANDH3(35) <a name='7164'>
<font color=#447700>!     REAL :: AB15WD,SKO2D,SKC1R,SKO3R<a name='7165'></font>
<a name='7166'>
<font color=#447700>!     REAL :: AWIDE,BWIDE,BETAWD,BETINW<a name='7167'></font>
<a name='7168'>
<font color=#447700>!     DATA AWIDE  / 0.309801E+01/<a name='7169'></font>
<font color=#447700>!     DATA BWIDE  / 0.495357E-01/<a name='7170'></font>
<font color=#447700>!     DATA BETAWD / 0.347839E+02/<a name='7171'></font>
<font color=#447700>!     DATA BETINW / 0.766811E+01/<a name='7172'></font>
<a name='7173'>
<font color=#447700>!<a name='7174'></font>
<font color=#447700>!% #NPADL = #PAGE*#NPAGE -  4*28*180  -  2*181 - 7*28 - 180 ;<a name='7175'></font>
<font color=#447700>!% #NPADL = #NPADL       -  11*28  - 2*180 - 2*30 ;<a name='7176'></font>
<a name='7177'>
<font color=#447700>!     PARAMETER (NPADL = #NPADL - 28*NBLX - 2*28*NBLW - 7*NBLW)<a name='7178'></font>
<a name='7179'>
      REAL ::  &amp;<a name='7180'>
               SUM(28,180),PERTSM(28,180),SUM3(28,180),       &amp;<a name='7181'>
               SUMWDE(28,180),SRCWD(28,NBLX),SRC1NB(28,NBLW), &amp;<a name='7182'>
               DBDTNB(28,NBLW)<a name='7183'>
      REAL ::  &amp;<a name='7184'>
               ZMASS(181),ZROOT(181),SC(28),DSC(28),XTEMV(28), &amp;<a name='7185'>
               TFOUR(28),FORTCU(28),X(28),X1(28),X2(180),SRCS(28), &amp;<a name='7186'>
               SUM4(28),SUM6(28),SUM7(28),SUM8(28),SUM4WD(28),     &amp;<a name='7187'>
               R1T(28),R2(28),S2(28),T3(28),R1WD(28)<a name='7188'>
      REAL ::  EXPO(180),FAC(180)<a name='7189'>
      REAL ::  CNUSB(30),DNUSB(30)<a name='7190'>
      REAL ::  ALFANB(NBLW),AROTNB(NBLW)<a name='7191'>
      REAL ::  ANB(NBLW),BNB(NBLW),CENTNB(NBLW),DELNB(NBLW), &amp;<a name='7192'>
               BETANB(NBLW)<a name='7193'>
<a name='7194'>
      REAL ::  AB15(2)<a name='7195'>
<a name='7196'>
      REAL ::   ARNDM1(64),ARNDM2(64),ARNDM3(35)<a name='7197'>
      REAL ::   BRNDM1(64),BRNDM2(64),BRNDM3(35)<a name='7198'>
      REAL ::   BETAD1(64),BETAD2(64),BETAD3(35)<a name='7199'>
<a name='7200'>
      EQUIVALENCE (ARNDM1(1),ARNDM(1)),(ARNDM2(1),ARNDM(65)), &amp;<a name='7201'>
                  (ARNDM3(1),ARNDM(129))<a name='7202'>
      EQUIVALENCE (BRNDM1(1),BRNDM(1)),(BRNDM2(1),BRNDM(65)), &amp;<a name='7203'>
                  (BRNDM3(1),BRNDM(129))<a name='7204'>
      EQUIVALENCE (BETAD1(1),BETAD(1)),(BETAD2(1),BETAD(65)), &amp;<a name='7205'>
                  (BETAD3(1),BETAD(129))<a name='7206'>
<a name='7207'>
<font color=#447700>!---------------------------------------------------------------<a name='7208'></font>
      REAL    :: CENT,DEL,BDLO,BDHI,C1,ANU,tmp<a name='7209'>
      INTEGER :: N,I,ICNT,I1,I2E,I2<a name='7210'>
      INTEGER :: J,JP,NSUBDS,NSB,IA<a name='7211'>
<a name='7212'>
<font color=#447700>!---------------------------------------------------------------<a name='7213'></font>
<a name='7214'>
      DATA IBAND  / &amp;<a name='7215'>
          2,   1,   2,   2,   1,   2,   1,   3,   2,   2, &amp;<a name='7216'>
          3,   2,   2,   4,   2,   4,   2,   3,   3,   2, &amp;<a name='7217'>
          4,   3,   4,   3,   7,   5,   6,   7,   6,   5, &amp;<a name='7218'>
          7,   6,   7,   8,   6,   6,   8,   8,   8,   8/<a name='7219'>
<a name='7220'>
      DATA BANDL1 / &amp;<a name='7221'>
         0.000000E+00,  0.100000E+02,  0.200000E+02,  0.300000E+02, &amp;<a name='7222'>
         0.400000E+02,  0.500000E+02,  0.600000E+02,  0.700000E+02, &amp;<a name='7223'>
         0.800000E+02,  0.900000E+02,  0.100000E+03,  0.110000E+03, &amp;<a name='7224'>
         0.120000E+03,  0.130000E+03,  0.140000E+03,  0.150000E+03, &amp;<a name='7225'>
         0.160000E+03,  0.170000E+03,  0.180000E+03,  0.190000E+03, &amp;<a name='7226'>
         0.200000E+03,  0.210000E+03,  0.220000E+03,  0.230000E+03, &amp;<a name='7227'>
         0.240000E+03,  0.250000E+03,  0.260000E+03,  0.270000E+03, &amp;<a name='7228'>
         0.280000E+03,  0.290000E+03,  0.300000E+03,  0.310000E+03, &amp;<a name='7229'>
         0.320000E+03,  0.330000E+03,  0.340000E+03,  0.350000E+03, &amp;<a name='7230'>
         0.360000E+03,  0.370000E+03,  0.380000E+03,  0.390000E+03, &amp;<a name='7231'>
         0.400000E+03,  0.410000E+03,  0.420000E+03,  0.430000E+03, &amp;<a name='7232'>
         0.440000E+03,  0.450000E+03,  0.460000E+03,  0.470000E+03, &amp;<a name='7233'>
         0.480000E+03,  0.490000E+03,  0.500000E+03,  0.510000E+03, &amp;<a name='7234'>
         0.520000E+03,  0.530000E+03,  0.540000E+03,  0.550000E+03, &amp;<a name='7235'>
         0.560000E+03,  0.670000E+03,  0.800000E+03,  0.900000E+03, &amp;<a name='7236'>
         0.990000E+03,  0.107000E+04,  0.120000E+04,  0.121000E+04/<a name='7237'>
      DATA BANDL2 / &amp;<a name='7238'>
         0.122000E+04,  0.123000E+04,  0.124000E+04,  0.125000E+04, &amp;<a name='7239'>
         0.126000E+04,  0.127000E+04,  0.128000E+04,  0.129000E+04, &amp;<a name='7240'>
         0.130000E+04,  0.131000E+04,  0.132000E+04,  0.133000E+04, &amp;<a name='7241'>
         0.134000E+04,  0.135000E+04,  0.136000E+04,  0.137000E+04, &amp;<a name='7242'>
         0.138000E+04,  0.139000E+04,  0.140000E+04,  0.141000E+04, &amp;<a name='7243'>
         0.142000E+04,  0.143000E+04,  0.144000E+04,  0.145000E+04, &amp;<a name='7244'>
         0.146000E+04,  0.147000E+04,  0.148000E+04,  0.149000E+04, &amp;<a name='7245'>
         0.150000E+04,  0.151000E+04,  0.152000E+04,  0.153000E+04, &amp;<a name='7246'>
         0.154000E+04,  0.155000E+04,  0.156000E+04,  0.157000E+04, &amp;<a name='7247'>
         0.158000E+04,  0.159000E+04,  0.160000E+04,  0.161000E+04, &amp;<a name='7248'>
         0.162000E+04,  0.163000E+04,  0.164000E+04,  0.165000E+04, &amp;<a name='7249'>
         0.166000E+04,  0.167000E+04,  0.168000E+04,  0.169000E+04, &amp;<a name='7250'>
         0.170000E+04,  0.171000E+04,  0.172000E+04,  0.173000E+04, &amp;<a name='7251'>
         0.174000E+04,  0.175000E+04,  0.176000E+04,  0.177000E+04, &amp;<a name='7252'>
         0.178000E+04,  0.179000E+04,  0.180000E+04,  0.181000E+04, &amp;<a name='7253'>
         0.182000E+04,  0.183000E+04,  0.184000E+04,  0.185000E+04/<a name='7254'>
      DATA BANDL3 / &amp;<a name='7255'>
         0.186000E+04,  0.187000E+04,  0.188000E+04,  0.189000E+04, &amp;<a name='7256'>
         0.190000E+04,  0.191000E+04,  0.192000E+04,  0.193000E+04, &amp;<a name='7257'>
         0.194000E+04,  0.195000E+04,  0.196000E+04,  0.197000E+04, &amp;<a name='7258'>
         0.198000E+04,  0.199000E+04,  0.200000E+04,  0.201000E+04, &amp;<a name='7259'>
         0.202000E+04,  0.203000E+04,  0.204000E+04,  0.205000E+04, &amp;<a name='7260'>
         0.206000E+04,  0.207000E+04,  0.208000E+04,  0.209000E+04, &amp;<a name='7261'>
         0.210000E+04,  0.211000E+04,  0.212000E+04,  0.213000E+04, &amp;<a name='7262'>
         0.214000E+04,  0.215000E+04,  0.216000E+04,  0.217000E+04, &amp;<a name='7263'>
         0.218000E+04,  0.219000E+04,  0.227000E+04/<a name='7264'>
<a name='7265'>
      DATA BANDH1 / &amp;<a name='7266'>
         0.100000E+02,  0.200000E+02,  0.300000E+02,  0.400000E+02, &amp;<a name='7267'>
         0.500000E+02,  0.600000E+02,  0.700000E+02,  0.800000E+02, &amp;<a name='7268'>
         0.900000E+02,  0.100000E+03,  0.110000E+03,  0.120000E+03, &amp;<a name='7269'>
         0.130000E+03,  0.140000E+03,  0.150000E+03,  0.160000E+03, &amp;<a name='7270'>
         0.170000E+03,  0.180000E+03,  0.190000E+03,  0.200000E+03, &amp;<a name='7271'>
         0.210000E+03,  0.220000E+03,  0.230000E+03,  0.240000E+03, &amp;<a name='7272'>
         0.250000E+03,  0.260000E+03,  0.270000E+03,  0.280000E+03, &amp;<a name='7273'>
         0.290000E+03,  0.300000E+03,  0.310000E+03,  0.320000E+03, &amp;<a name='7274'>
         0.330000E+03,  0.340000E+03,  0.350000E+03,  0.360000E+03, &amp;<a name='7275'>
         0.370000E+03,  0.380000E+03,  0.390000E+03,  0.400000E+03, &amp;<a name='7276'>
         0.410000E+03,  0.420000E+03,  0.430000E+03,  0.440000E+03, &amp;<a name='7277'>
         0.450000E+03,  0.460000E+03,  0.470000E+03,  0.480000E+03, &amp;<a name='7278'>
         0.490000E+03,  0.500000E+03,  0.510000E+03,  0.520000E+03, &amp;<a name='7279'>
         0.530000E+03,  0.540000E+03,  0.550000E+03,  0.560000E+03, &amp;<a name='7280'>
         0.670000E+03,  0.800000E+03,  0.900000E+03,  0.990000E+03, &amp;<a name='7281'>
         0.107000E+04,  0.120000E+04,  0.121000E+04,  0.122000E+04/<a name='7282'>
      DATA BANDH2 / &amp;<a name='7283'>
         0.123000E+04,  0.124000E+04,  0.125000E+04,  0.126000E+04, &amp;<a name='7284'>
         0.127000E+04,  0.128000E+04,  0.129000E+04,  0.130000E+04, &amp;<a name='7285'>
         0.131000E+04,  0.132000E+04,  0.133000E+04,  0.134000E+04, &amp;<a name='7286'>
         0.135000E+04,  0.136000E+04,  0.137000E+04,  0.138000E+04, &amp;<a name='7287'>
         0.139000E+04,  0.140000E+04,  0.141000E+04,  0.142000E+04, &amp;<a name='7288'>
         0.143000E+04,  0.144000E+04,  0.145000E+04,  0.146000E+04, &amp;<a name='7289'>
         0.147000E+04,  0.148000E+04,  0.149000E+04,  0.150000E+04, &amp;<a name='7290'>
         0.151000E+04,  0.152000E+04,  0.153000E+04,  0.154000E+04, &amp;<a name='7291'>
         0.155000E+04,  0.156000E+04,  0.157000E+04,  0.158000E+04, &amp;<a name='7292'>
         0.159000E+04,  0.160000E+04,  0.161000E+04,  0.162000E+04, &amp;<a name='7293'>
         0.163000E+04,  0.164000E+04,  0.165000E+04,  0.166000E+04, &amp;<a name='7294'>
         0.167000E+04,  0.168000E+04,  0.169000E+04,  0.170000E+04, &amp;<a name='7295'>
         0.171000E+04,  0.172000E+04,  0.173000E+04,  0.174000E+04, &amp;<a name='7296'>
         0.175000E+04,  0.176000E+04,  0.177000E+04,  0.178000E+04, &amp;<a name='7297'>
         0.179000E+04,  0.180000E+04,  0.181000E+04,  0.182000E+04, &amp;<a name='7298'>
         0.183000E+04,  0.184000E+04,  0.185000E+04,  0.186000E+04/<a name='7299'>
      DATA BANDH3 / &amp;<a name='7300'>
         0.187000E+04,  0.188000E+04,  0.189000E+04,  0.190000E+04, &amp;<a name='7301'>
         0.191000E+04,  0.192000E+04,  0.193000E+04,  0.194000E+04, &amp;<a name='7302'>
         0.195000E+04,  0.196000E+04,  0.197000E+04,  0.198000E+04, &amp;<a name='7303'>
         0.199000E+04,  0.200000E+04,  0.201000E+04,  0.202000E+04, &amp;<a name='7304'>
         0.203000E+04,  0.204000E+04,  0.205000E+04,  0.206000E+04, &amp;<a name='7305'>
         0.207000E+04,  0.208000E+04,  0.209000E+04,  0.210000E+04, &amp;<a name='7306'>
         0.211000E+04,  0.212000E+04,  0.213000E+04,  0.214000E+04, &amp;<a name='7307'>
         0.215000E+04,  0.216000E+04,  0.217000E+04,  0.218000E+04, &amp;<a name='7308'>
         0.219000E+04,  0.220000E+04,  0.238000E+04/<a name='7309'>
<a name='7310'>
<font color=#447700>!<a name='7311'></font>
<font color=#447700>!***THE FOLLOWING DATA STATEMENTS ARE BAND PARAMETERS OBTAINED USING<a name='7312'></font>
<font color=#447700>!   THE 1982 AFGL CATALOG ON THE SPECIFIED BANDS<a name='7313'></font>
      DATA ARNDM1  / &amp;<a name='7314'>
         0.354693E+00,  0.269857E+03,  0.167062E+03,  0.201314E+04, &amp;<a name='7315'>
         0.964533E+03,  0.547971E+04,  0.152933E+04,  0.599429E+04, &amp;<a name='7316'>
         0.699329E+04,  0.856721E+04,  0.962489E+04,  0.233348E+04, &amp;<a name='7317'>
         0.127091E+05,  0.104383E+05,  0.504249E+04,  0.181227E+05, &amp;<a name='7318'>
         0.856480E+03,  0.136354E+05,  0.288635E+04,  0.170200E+04, &amp;<a name='7319'>
         0.209761E+05,  0.126797E+04,  0.110096E+05,  0.336436E+03, &amp;<a name='7320'>
         0.491663E+04,  0.863701E+04,  0.540389E+03,  0.439786E+04, &amp;<a name='7321'>
         0.347836E+04,  0.130557E+03,  0.465332E+04,  0.253086E+03, &amp;<a name='7322'>
         0.257387E+04,  0.488041E+03,  0.892991E+03,  0.117148E+04, &amp;<a name='7323'>
         0.125880E+03,  0.458852E+03,  0.142975E+03,  0.446355E+03, &amp;<a name='7324'>
         0.302887E+02,  0.394451E+03,  0.438112E+02,  0.348811E+02, &amp;<a name='7325'>
         0.615503E+02,  0.143165E+03,  0.103958E+02,  0.725108E+02, &amp;<a name='7326'>
         0.316628E+02,  0.946456E+01,  0.542675E+02,  0.351557E+02, &amp;<a name='7327'>
         0.301797E+02,  0.381010E+01,  0.126319E+02,  0.548010E+01, &amp;<a name='7328'>
         0.600199E+01,  0.640803E+00,  0.501549E-01,  0.167961E-01, &amp;<a name='7329'>
         0.178110E-01,  0.170166E+00,  0.273514E-01,  0.983767E+00/<a name='7330'>
      DATA ARNDM2  / &amp;<a name='7331'>
         0.753946E+00,  0.941763E-01,  0.970547E+00,  0.268862E+00, &amp;<a name='7332'>
         0.564373E+01,  0.389794E+01,  0.310955E+01,  0.128235E+01, &amp;<a name='7333'>
         0.196414E+01,  0.247113E+02,  0.593435E+01,  0.377552E+02, &amp;<a name='7334'>
         0.305173E+02,  0.852479E+01,  0.116780E+03,  0.101490E+03, &amp;<a name='7335'>
         0.138939E+03,  0.324228E+03,  0.683729E+02,  0.471304E+03, &amp;<a name='7336'>
         0.159684E+03,  0.427101E+03,  0.114716E+03,  0.106190E+04, &amp;<a name='7337'>
         0.294607E+03,  0.762948E+03,  0.333199E+03,  0.830645E+03, &amp;<a name='7338'>
         0.162512E+04,  0.525676E+03,  0.137739E+04,  0.136252E+04, &amp;<a name='7339'>
         0.147164E+04,  0.187196E+04,  0.131118E+04,  0.103975E+04, &amp;<a name='7340'>
         0.621637E+01,  0.399459E+02,  0.950648E+02,  0.943161E+03, &amp;<a name='7341'>
         0.526821E+03,  0.104150E+04,  0.905610E+03,  0.228142E+04, &amp;<a name='7342'>
         0.806270E+03,  0.691845E+03,  0.155237E+04,  0.192241E+04, &amp;<a name='7343'>
         0.991871E+03,  0.123907E+04,  0.457289E+02,  0.146146E+04, &amp;<a name='7344'>
         0.319382E+03,  0.436074E+03,  0.374214E+03,  0.778217E+03, &amp;<a name='7345'>
         0.140227E+03,  0.562540E+03,  0.682685E+02,  0.820292E+02, &amp;<a name='7346'>
         0.178779E+03,  0.186150E+03,  0.383864E+03,  0.567416E+01/ <a name='7347'>
      DATA ARNDM3  / &amp;<a name='7348'>
         0.225129E+03,  0.473099E+01,  0.753149E+02,  0.233689E+02, &amp;<a name='7349'>
         0.339802E+02,  0.108855E+03,  0.380016E+02,  0.151039E+01, &amp;<a name='7350'>
         0.660346E+02,  0.370165E+01,  0.234169E+02,  0.440206E+00, &amp;<a name='7351'>
         0.615283E+01,  0.304077E+02,  0.117769E+01,  0.125248E+02, &amp;<a name='7352'>
         0.142652E+01,  0.241831E+00,  0.483721E+01,  0.226357E-01, &amp;<a name='7353'>
         0.549835E+01,  0.597067E+00,  0.404553E+00,  0.143584E+01, &amp;<a name='7354'>
         0.294291E+00,  0.466273E+00,  0.156048E+00,  0.656185E+00, &amp;<a name='7355'>
         0.172727E+00,  0.118349E+00,  0.141598E+00,  0.588581E-01, &amp;<a name='7356'>
         0.919409E-01,  0.155521E-01,  0.537083E-02/<a name='7357'>
      DATA BRNDM1  / &amp;<a name='7358'>
         0.789571E-01,  0.920256E-01,  0.696960E-01,  0.245544E+00, &amp;<a name='7359'>
         0.188503E+00,  0.266127E+00,  0.271371E+00,  0.330917E+00, &amp;<a name='7360'>
         0.190424E+00,  0.224498E+00,  0.282517E+00,  0.130675E+00, &amp;<a name='7361'>
         0.212579E+00,  0.227298E+00,  0.138585E+00,  0.187106E+00, &amp;<a name='7362'>
         0.194527E+00,  0.177034E+00,  0.115902E+00,  0.118499E+00, &amp;<a name='7363'>
         0.142848E+00,  0.216869E+00,  0.149848E+00,  0.971585E-01, &amp;<a name='7364'>
         0.151532E+00,  0.865628E-01,  0.764246E-01,  0.100035E+00, &amp;<a name='7365'>
         0.171133E+00,  0.134737E+00,  0.105173E+00,  0.860832E-01, &amp;<a name='7366'>
         0.148921E+00,  0.869234E-01,  0.106018E+00,  0.184865E+00, &amp;<a name='7367'>
         0.767454E-01,  0.108981E+00,  0.123094E+00,  0.177287E+00, &amp;<a name='7368'>
         0.848146E-01,  0.119356E+00,  0.133829E+00,  0.954505E-01, &amp;<a name='7369'>
         0.155405E+00,  0.164167E+00,  0.161390E+00,  0.113287E+00, &amp;<a name='7370'>
         0.714720E-01,  0.741598E-01,  0.719590E-01,  0.140616E+00, &amp;<a name='7371'>
         0.355356E-01,  0.832779E-01,  0.128680E+00,  0.983013E-01, &amp;<a name='7372'>
         0.629660E-01,  0.643346E-01,  0.717082E-01,  0.629730E-01, &amp;<a name='7373'>
         0.875182E-01,  0.857907E-01,  0.358808E+00,  0.178840E+00/<a name='7374'>
      DATA BRNDM2  / &amp;<a name='7375'>
         0.254265E+00,  0.297901E+00,  0.153916E+00,  0.537774E+00, &amp;<a name='7376'>
         0.267906E+00,  0.104254E+00,  0.400723E+00,  0.389670E+00, &amp;<a name='7377'>
         0.263701E+00,  0.338116E+00,  0.351528E+00,  0.267764E+00, &amp;<a name='7378'>
         0.186419E+00,  0.238237E+00,  0.210408E+00,  0.176869E+00, &amp;<a name='7379'>
         0.114715E+00,  0.173299E+00,  0.967770E-01,  0.172565E+00, &amp;<a name='7380'>
         0.162085E+00,  0.157782E+00,  0.886832E-01,  0.242999E+00, &amp;<a name='7381'>
         0.760298E-01,  0.164248E+00,  0.221428E+00,  0.166799E+00, &amp;<a name='7382'>
         0.312514E+00,  0.380600E+00,  0.353828E+00,  0.269500E+00, &amp;<a name='7383'>
         0.254759E+00,  0.285408E+00,  0.159764E+00,  0.721058E-01, &amp;<a name='7384'>
         0.170528E+00,  0.231595E+00,  0.307184E+00,  0.564136E-01, &amp;<a name='7385'>
         0.159884E+00,  0.147907E+00,  0.185666E+00,  0.183567E+00, &amp;<a name='7386'>
         0.182482E+00,  0.230650E+00,  0.175348E+00,  0.195978E+00, &amp;<a name='7387'>
         0.255323E+00,  0.198517E+00,  0.195500E+00,  0.208356E+00, &amp;<a name='7388'>
         0.309603E+00,  0.112011E+00,  0.102570E+00,  0.128276E+00, &amp;<a name='7389'>
         0.168100E+00,  0.177836E+00,  0.105533E+00,  0.903330E-01, &amp;<a name='7390'>
         0.126036E+00,  0.101430E+00,  0.124546E+00,  0.221406E+00/ <a name='7391'>
      DATA BRNDM3  / &amp;<a name='7392'>
         0.137509E+00,  0.911365E-01,  0.724508E-01,  0.795788E-01, &amp;<a name='7393'>
         0.137411E+00,  0.549175E-01,  0.787714E-01,  0.165544E+00, &amp;<a name='7394'>
         0.136484E+00,  0.146729E+00,  0.820496E-01,  0.846211E-01, &amp;<a name='7395'>
         0.785821E-01,  0.122527E+00,  0.125359E+00,  0.101589E+00, &amp;<a name='7396'>
         0.155756E+00,  0.189239E+00,  0.999086E-01,  0.480993E+00, &amp;<a name='7397'>
         0.100233E+00,  0.153754E+00,  0.130780E+00,  0.136136E+00, &amp;<a name='7398'>
         0.159353E+00,  0.156634E+00,  0.272265E+00,  0.186874E+00, &amp;<a name='7399'>
         0.192090E+00,  0.135397E+00,  0.131497E+00,  0.127463E+00, &amp;<a name='7400'>
         0.227233E+00,  0.190562E+00,  0.214005E+00/ <a name='7401'>
      DATA BETAD1  / &amp;<a name='7402'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7403'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7404'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7405'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7406'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7407'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7408'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7409'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7410'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7411'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7412'>
         0.234879E+03,  0.217419E+03,  0.201281E+03,  0.186364E+03, &amp;<a name='7413'>
         0.172576E+03,  0.159831E+03,  0.148051E+03,  0.137163E+03, &amp;<a name='7414'>
         0.127099E+03,  0.117796E+03,  0.109197E+03,  0.101249E+03, &amp;<a name='7415'>
         0.939031E+02,  0.871127E+02,  0.808363E+02,  0.750349E+02, &amp;<a name='7416'>
         0.497489E+02,  0.221212E+02,  0.113124E+02,  0.754174E+01, &amp;<a name='7417'>
         0.589554E+01,  0.495227E+01,  0.000000E+00,  0.000000E+00/ <a name='7418'>
      DATA BETAD2  / &amp;<a name='7419'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7420'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7421'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7422'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7423'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7424'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7425'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7426'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7427'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7428'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7429'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7430'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7431'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7432'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7433'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7434'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00/ <a name='7435'>
      DATA BETAD3  / &amp;<a name='7436'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7437'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7438'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7439'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7440'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7441'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7442'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7443'>
         0.000000E+00,  0.000000E+00,  0.000000E+00,  0.000000E+00, &amp;<a name='7444'>
         0.000000E+00,  0.000000E+00,  0.000000E+00/ <a name='7445'>
<font color=#447700>!---------------------------------------------------------------<a name='7446'></font>
<font color=#447700>!     EQUIVALENCE (BANDL1(1),BANDLO(1)),(BANDL2(1),BANDLO(65)), &amp;<a name='7447'></font>
<font color=#447700>!                 (BANDL3(1),BANDLO(129))<a name='7448'></font>
<a name='7449'>
<font color=#447700>!     L     = kme-1<a name='7450'></font>
<font color=#447700>!     LP1   = L+1<a name='7451'></font>
<font color=#447700>!     LP1V  = LP1*(1+2*L/2)<a name='7452'></font>
<font color=#447700>!     IMAX  = ite<a name='7453'></font>
<font color=#447700>!     LP2   = L + 2<a name='7454'></font>
 <a name='7455'>
      DO I = 1,64<a name='7456'>
         BANDLO(I)=BANDL1(I)<a name='7457'>
      ENDDO<a name='7458'>
<a name='7459'>
      DO I = 65,128<a name='7460'>
         BANDLO(I)=BANDL2(I-64)<a name='7461'>
      ENDDO<a name='7462'>
<a name='7463'>
      DO I = 129,163<a name='7464'>
         BANDLO(I)=BANDL3(I-128)<a name='7465'>
      ENDDO<a name='7466'>
<a name='7467'>
      DO I = 1,64<a name='7468'>
         BANDHI(I)=BANDH1(I)<a name='7469'>
      ENDDO<a name='7470'>
<a name='7471'>
      DO I = 65,128<a name='7472'>
         BANDHI(I)=BANDH2(I-64)<a name='7473'>
      ENDDO<a name='7474'>
<a name='7475'>
      DO I = 129,163<a name='7476'>
         BANDHI(I)=BANDH3(I-128)<a name='7477'>
      ENDDO<a name='7478'>
<a name='7479'>
<font color=#447700>!****************************************<a name='7480'></font>
<font color=#447700>!***COMPUTE LOCAL QUANTITIES AND AO3,BO3,AB15<a name='7481'></font>
<font color=#447700>!....FOR NARROW-BANDS...<a name='7482'></font>
      DO 101 N=1,NBLW<a name='7483'>
      ANB(N)=ARNDM(N)<a name='7484'>
      BNB(N)=BRNDM(N)<a name='7485'>
      CENTNB(N)=HAF*(BANDLO(N)+BANDHI(N))<a name='7486'>
      DELNB(N)=BANDHI(N)-BANDLO(N)<a name='7487'>
      BETANB(N)=BETAD(N)<a name='7488'>
101   CONTINUE<a name='7489'>
      AB15(1)=ANB(57)*BNB(57)<a name='7490'>
      AB15(2)=ANB(58)*BNB(58)<a name='7491'>
<font color=#447700>!....FOR WIDE BANDS...<a name='7492'></font>
      AB15WD=AWIDE*BWIDE<a name='7493'>
<font color=#447700>!<a name='7494'></font>
<font color=#447700>!***COMPUTE INDICES: IND,INDX2,KMAXV<a name='7495'></font>
<font color=#447700>!SH   ICNT=0<a name='7496'></font>
<font color=#447700>!SH   DO 113 I1=1,L<a name='7497'></font>
<font color=#447700>!SH     I2E=LP1-I1<a name='7498'></font>
<font color=#447700>!SH     DO 115 I2=1,I2E<a name='7499'></font>
<font color=#447700>!SH       ICNT=ICNT+1<a name='7500'></font>
<font color=#447700>!SH       INDX2(ICNT)=LP1*(I2-1)+LP2*I1<a name='7501'></font>
<font color=#447700>!SH115     CONTINUE<a name='7502'></font>
<font color=#447700>!SH113   CONTINUE<a name='7503'></font>
<font color=#447700>!SH   KMAXV(1)=1<a name='7504'></font>
<font color=#447700>!SH   DO 117 I=2,L<a name='7505'></font>
<font color=#447700>!SH   KMAXV(I)=KMAXV(I-1)+(LP2-I)<a name='7506'></font>
117   CONTINUE<a name='7507'>
<font color=#447700>!SH   KMAXVM=KMAXV(L)<a name='7508'></font>
<font color=#447700>!***COMPUTE RATIOS OF CONT. COEFFS<a name='7509'></font>
      SKC1R=BETAWD/BETINW<a name='7510'>
      SKO3R=BETAD(61)/BETINW<a name='7511'>
      SKO2D=ONE/BETINW<a name='7512'>
<font color=#447700>!<a name='7513'></font>
<font color=#447700>!****BEGIN TABLE COMPUTATIONS HERE***<a name='7514'></font>
<font color=#447700>!***COMPUTE TEMPS, MASSES FOR TABLE ENTRIES<a name='7515'></font>
<font color=#447700>!---NOTE: THE DIMENSIONING AND INITIALIZATION OF XTEMV AND OTHER ARRAYS<a name='7516'></font>
<font color=#447700>!   WITH DIMENSION OF 28 IMPLY A RESTRICTION OF MODEL TEMPERATURES FROM<a name='7517'></font>
<font color=#447700>!   100K TO 370K.<a name='7518'></font>
<font color=#447700>!---THE DIMENSIONING OF ZMASS,ZROOT AND OTHER ARRAYS WITH DIMENSION OF<a name='7519'></font>
<font color=#447700>!   180 IMPLY A RESTRICTION OF MODEL H2O AMOUNTS SUCH THAT OPTICAL PATHS<a name='7520'></font>
<font color=#447700>!   ARE BETWEEN 10**-16 AND 10**2, IN CGS UNITS.<a name='7521'></font>
      ZMASS(1)=H1M16<a name='7522'>
      DO 201 J=1,180<a name='7523'>
      JP=J+1<a name='7524'>
      ZROOT(J)=SQRT(ZMASS(J))<a name='7525'>
      ZMASS(JP)=ZMASS(J)*H1P25892<a name='7526'>
201   CONTINUE<a name='7527'>
      DO 203 I=1,28<a name='7528'>
      XTEMV(I)=HNINETY+TEN*I<a name='7529'>
      TFOUR(I)=XTEMV(I)*XTEMV(I)*XTEMV(I)*XTEMV(I)<a name='7530'>
      FORTCU(I)=FOUR*XTEMV(I)*XTEMV(I)*XTEMV(I)<a name='7531'>
203   CONTINUE<a name='7532'>
<font color=#447700>!******THE COMPUTATION OF SOURCE,DSRCE IS  NEEDED ONLY<a name='7533'></font>
<font color=#447700>!   FOR THE COMBINED WIDE-BAND CASE.TO OBTAIN THEM,THE SOURCE<a name='7534'></font>
<font color=#447700>!   MUST BE COMPUTED FOR EACH OF THE (NBLX) WIDE BANDS(=SRCWD)<a name='7535'></font>
<font color=#447700>!   THEN COMBINED (USING IBAND) INTO SOURCE.<a name='7536'></font>
      DO 205 N=1,NBLY<a name='7537'>
      DO 205 I=1,28<a name='7538'>
      SOURCE(I,N)=ZERO<a name='7539'>
205   CONTINUE<a name='7540'>
      DO 207 N=1,NBLX<a name='7541'>
      DO 207 I=1,28<a name='7542'>
      SRCWD(I,N)=ZERO<a name='7543'>
207   CONTINUE<a name='7544'>
<font color=#447700>!---BEGIN FREQ. LOOP (ON N)<a name='7545'></font>
      DO 211 N=1,NBLX<a name='7546'>
        IF (N.LE.46) THEN<a name='7547'>
<font color=#447700>!***THE 160-1200 BAND CASES<a name='7548'></font>
          CENT=CENTNB(N+16)<a name='7549'>
          DEL=DELNB(N+16)<a name='7550'>
          BDLO=BANDLO(N+16)<a name='7551'>
          BDHI=BANDHI(N+16)<a name='7552'>
        ENDIF<a name='7553'>
        IF (N.EQ.NBLX) THEN<a name='7554'>
<font color=#447700>!***THE 2270-2380 BAND CASE<a name='7555'></font>
          CENT=CENTNB(NBLW)<a name='7556'>
          DEL=DELNB(NBLW)<a name='7557'>
          BDLO=BANDLO(NBLW)<a name='7558'>
          BDHI=BANDHI(NBLW)<a name='7559'>
        ENDIF<a name='7560'>
<font color=#447700>!***FOR PURPOSES OF ACCURACY, ALL EVALUATIONS OF PLANCK FCTNS ARE MADE<a name='7561'></font>
<font color=#447700>!  ON 10 CM-1 INTERVALS, THEN SUMMED INTO THE (NBLX) WIDE BANDS.<a name='7562'></font>
      NSUBDS=(DEL-H1M3)/10+1<a name='7563'>
      DO 213 NSB=1,NSUBDS<a name='7564'>
      IF (NSB.NE.NSUBDS) THEN<a name='7565'>
        CNUSB(NSB)=TEN*(NSB-1)+BDLO+FIVE<a name='7566'>
        DNUSB(NSB)=TEN<a name='7567'>
      ELSE<a name='7568'>
        CNUSB(NSB)=HAF*(TEN*(NSB-1)+BDLO+BDHI)<a name='7569'>
        DNUSB(NSB)=BDHI-(TEN*(NSB-1)+BDLO)<a name='7570'>
      ENDIF<a name='7571'>
      C1=(H37412M5)*CNUSB(NSB)**3<a name='7572'>
<font color=#447700>!---BEGIN TEMP. LOOP (ON I)<a name='7573'></font>
      DO 215 I=1,28<a name='7574'>
      X(I)=H1P4387*CNUSB(NSB)/XTEMV(I)<a name='7575'>
      X1(I)=EXP(X(I))<a name='7576'>
      SRCS(I)=C1/(X1(I)-ONE)<a name='7577'>
      SRCWD(I,N)=SRCWD(I,N)+SRCS(I)*DNUSB(NSB)<a name='7578'>
215   CONTINUE<a name='7579'>
213   CONTINUE<a name='7580'>
211   CONTINUE<a name='7581'>
<font color=#447700>!***THE FOLLOWING LOOPS CREATE THE COMBINED WIDE BAND QUANTITIES SOURCE<a name='7582'></font>
<font color=#447700>!   AND DSRCE<a name='7583'></font>
      DO 221 N=1,40<a name='7584'>
      DO 221 I=1,28<a name='7585'>
      SOURCE(I,IBAND(N))=SOURCE(I,IBAND(N))+SRCWD(I,N)<a name='7586'>
221   CONTINUE<a name='7587'>
      DO 223 N=9,NBLY<a name='7588'>
      DO 223 I=1,28<a name='7589'>
      SOURCE(I,N)=SRCWD(I,N+32)<a name='7590'>
223   CONTINUE<a name='7591'>
      DO 225 N=1,NBLY<a name='7592'>
      DO 225 I=1,27<a name='7593'>
      DSRCE(I,N)=(SOURCE(I+1,N)-SOURCE(I,N))*HP1<a name='7594'>
225   CONTINUE<a name='7595'>
      DO 231 N=1,NBLW<a name='7596'>
      ALFANB(N)=BNB(N)*ANB(N)<a name='7597'>
      AROTNB(N)=SQRT(ALFANB(N))<a name='7598'>
231   CONTINUE<a name='7599'>
<font color=#447700>!***FIRST COMPUTE PLANCK FCTNS (SRC1NB) AND DERIVATIVES (DBDTNB) FOR<a name='7600'></font>
<font color=#447700>!   USE IN TABLE EVALUATIONS. THESE ARE DIFFERENT FROM SOURCE,DSRCE<a name='7601'></font>
<font color=#447700>!   BECAUSE DIFFERENT FREQUENCY PTS ARE USED IN EVALUATION, THE FREQ.<a name='7602'></font>
<font color=#447700>!   RANGES ARE DIFFERENT, AND THE DERIVATIVE ALGORITHM IS DIFFERENT.<a name='7603'></font>
<font color=#447700>!<a name='7604'></font>
      DO 301 N=1,NBLW<a name='7605'>
      CENT=CENTNB(N)<a name='7606'>
      DEL=DELNB(N)<a name='7607'>
<font color=#447700>!---NOTE: AT PRESENT, THE IA LOOP IS ONLY USED FOR IA=2. THE LOOP STRUCT<a name='7608'></font>
<font color=#447700>!   IS KEPT SO THAT IN THE FUTURE, WE MAY USE A QUADRATURE SCHEME FOR<a name='7609'></font>
<font color=#447700>!   THE PLANCK FCTN EVALUATION, RATHER THAN USE THE MID-BAND FREQUENCY.<a name='7610'></font>
#if 0<a name='7611'>
      DO 303 IA=1,3<a name='7612'>
#else<a name='7613'>
<font color=#447700>!jm -- getting floating point exceptions for IA=1, since 2 is only<a name='7614'></font>
<font color=#447700>!      used anyway, I disabled the looping.<a name='7615'></font>
      DO 303 IA=2,2<a name='7616'>
#endif<a name='7617'>
      ANU=CENT+HAF*(IA-2)*DEL<a name='7618'>
      C1=(H37412M5)*ANU*ANU*ANU+H1M20<a name='7619'>
<font color=#447700>!---TEMPERATURE LOOP---<a name='7620'></font>
      DO 305 I=1,28<a name='7621'>
         X(I)=H1P4387*ANU/XTEMV(I)<a name='7622'>
         X1(I)=EXP(X(I))<a name='7623'>
<font color=#447700>!#$      tmp=max((X1(I)-ONE),H1M20)<a name='7624'></font>
<font color=#447700>!#$      SC(I)=C1/tmp<a name='7625'></font>
         SC(I)=C1/((X1(I)-ONE)+H1M20)<a name='7626'>
<font color=#447700>!#$      DSC(I)=X(I)*SC(I)*SC(I)*X1(I)/(XTEMV(I)*C1)<a name='7627'></font>
         DSC(I)=SC(I)*SC(I)*X(I)*X1(I)/(XTEMV(I)*C1)<a name='7628'>
305      CONTINUE<a name='7629'>
      IF (IA.EQ.2) THEN<a name='7630'>
         DO 307 I=1,28<a name='7631'>
         SRC1NB(I,N)=DEL*SC(I)<a name='7632'>
         DBDTNB(I,N)=DEL*DSC(I)<a name='7633'>
307      CONTINUE<a name='7634'>
      ENDIF<a name='7635'>
303   CONTINUE<a name='7636'>
301   CONTINUE<a name='7637'>
<font color=#447700>!***NEXT COMPUTE R1T,R2,S2,AND T3- COEFFICIENTS USED FOR E3 FUNCTION<a name='7638'></font>
<font color=#447700>!   WHEN THE OPTICAL PATH IS LESS THAN 10-4. IN THIS CASE, WE ASSUME A<a name='7639'></font>
<font color=#447700>!   DIFFERENT DEPENDENCE ON (ZMASS).<a name='7640'></font>
<font color=#447700>!---ALSO OBTAIN R1WD, WHICH IS R1T SUMMED OVER THE 160-560 CM-1 RANGE<a name='7641'></font>
      DO 311 I=1,28<a name='7642'>
      SUM4(I)=ZERO<a name='7643'>
      SUM6(I)=ZERO<a name='7644'>
      SUM7(I)=ZERO<a name='7645'>
      SUM8(I)=ZERO<a name='7646'>
      SUM4WD(I)=ZERO<a name='7647'>
311   CONTINUE<a name='7648'>
      DO 313 N=1,NBLW<a name='7649'>
      CENT=CENTNB(N)<a name='7650'>
<font color=#447700>!***PERFORM SUMMATIONS FOR FREQ. RANGES OF 0-560,1200-2200 CM-1 FOR SUM4<a name='7651'></font>
<font color=#447700>!   SUM6,SUM7,SUM8<a name='7652'></font>
      IF (CENT.LT.560. .OR. CENT.GT.1200..AND.CENT.LE.2200.) THEN<a name='7653'>
         DO 315 I=1,28<a name='7654'>
         SUM4(I)=SUM4(I)+SRC1NB(I,N)<a name='7655'>
         SUM6(I)=SUM6(I)+DBDTNB(I,N)<a name='7656'>
         SUM7(I)=SUM7(I)+DBDTNB(I,N)*AROTNB(N)<a name='7657'>
         SUM8(I)=SUM8(I)+DBDTNB(I,N)*ALFANB(N)<a name='7658'>
315      CONTINUE<a name='7659'>
      ENDIF<a name='7660'>
<font color=#447700>!***PERFORM SUMMATIONS OVER 160-560 CM-1 FREQ RANGE FOR E1 CALCS (SUM4WD<a name='7661'></font>
      IF (CENT.GT.160. .AND. CENT.LT.560.) THEN<a name='7662'>
         DO 316 I=1,28<a name='7663'>
         SUM4WD(I)=SUM4WD(I)+SRC1NB(I,N)<a name='7664'>
316      CONTINUE<a name='7665'>
      ENDIF<a name='7666'>
313   CONTINUE<a name='7667'>
      DO 317 I=1,28<a name='7668'>
      R1T(I)=SUM4(I)/TFOUR(I)<a name='7669'>
      R2(I)=SUM6(I)/FORTCU(I)<a name='7670'>
      S2(I)=SUM7(I)/FORTCU(I)<a name='7671'>
      T3(I)=SUM8(I)/FORTCU(I)<a name='7672'>
      R1WD(I)=SUM4WD(I)/TFOUR(I)<a name='7673'>
317   CONTINUE<a name='7674'>
      DO 401 J=1,180<a name='7675'>
      DO 401 I=1,28<a name='7676'>
      SUM(I,J)=ZERO<a name='7677'>
      PERTSM(I,J)=ZERO<a name='7678'>
      SUM3(I,J)=ZERO<a name='7679'>
      SUMWDE(I,J)=ZERO<a name='7680'>
401   CONTINUE<a name='7681'>
<font color=#447700>!---FREQUENCY LOOP BEGINS---<a name='7682'></font>
      DO 411 N=1,NBLW<a name='7683'>
      CENT=CENTNB(N)<a name='7684'>
<font color=#447700>!***PERFORM CALCULATIONS FOR FREQ. RANGES OF 0-560,1200-2200 CM-1<a name='7685'></font>
      IF (CENT.LT.560. .OR. CENT.GT.1200..AND.CENT.LE.2200.) THEN<a name='7686'>
         DO 413 J=1,180<a name='7687'>
         X2(J)=AROTNB(N)*ZROOT(J)<a name='7688'>
         EXPO(J)=EXP(-X2(J))<a name='7689'>
413      CONTINUE<a name='7690'>
         DO 415 J=1,180<a name='7691'>
         IF (X2(J).GE.HUNDRED) THEN<a name='7692'>
              EXPO(J)=ZERO<a name='7693'>
         ENDIF<a name='7694'>
415      CONTINUE<a name='7695'>
         DO 417 J=121,180<a name='7696'>
         FAC(J)=ZMASS(J)*(ONE-(ONE+X2(J))*EXPO(J))/(X2(J)*X2(J))<a name='7697'>
417      CONTINUE<a name='7698'>
         DO 419 J=1,180<a name='7699'>
         DO 419 I=1,28<a name='7700'>
         SUM(I,J)=SUM(I,J)+SRC1NB(I,N)*EXPO(J)<a name='7701'>
         PERTSM(I,J)=PERTSM(I,J)+DBDTNB(I,N)*EXPO(J)<a name='7702'>
419      CONTINUE<a name='7703'>
         DO 421 J=121,180<a name='7704'>
         DO 421 I=1,28<a name='7705'>
         SUM3(I,J)=SUM3(I,J)+DBDTNB(I,N)*FAC(J)<a name='7706'>
421      CONTINUE<a name='7707'>
      ENDIF<a name='7708'>
<font color=#447700>!---COMPUTE SUM OVER 160-560 CM-1 RANGE FOR USE IN E1 CALCS (SUMWDE)<a name='7709'></font>
      IF (CENT.GT.160. .AND. CENT.LT.560.) THEN<a name='7710'>
         DO 420 J=1,180<a name='7711'>
         DO 420 I=1,28<a name='7712'>
         SUMWDE(I,J)=SUMWDE(I,J)+SRC1NB(I,N)*EXPO(J)<a name='7713'>
420      CONTINUE<a name='7714'>
      ENDIF<a name='7715'>
411   CONTINUE<a name='7716'>
      DO 431 J=1,180<a name='7717'>
      DO 431 I=1,28<a name='7718'>
      EM1(I,J)=SUM(I,J)/TFOUR(I)<a name='7719'>
      TABLE1(I,J)=PERTSM(I,J)/FORTCU(I)<a name='7720'>
431   CONTINUE<a name='7721'>
      DO 433 J=121,180<a name='7722'>
      DO 433 I=1,28<a name='7723'>
      EM3(I,J)=SUM3(I,J)/FORTCU(I)<a name='7724'>
433   CONTINUE<a name='7725'>
      DO 441 J=1,179<a name='7726'>
      DO 441 I=1,28<a name='7727'>
      TABLE2(I,J)=(TABLE1(I,J+1)-TABLE1(I,J))*TEN<a name='7728'>
441   CONTINUE<a name='7729'>
      DO 443 J=1,180<a name='7730'>
      DO 443 I=1,27<a name='7731'>
      TABLE3(I,J)=(TABLE1(I+1,J)-TABLE1(I,J))*HP1<a name='7732'>
443   CONTINUE<a name='7733'>
      DO 445 I=1,28<a name='7734'>
      TABLE2(I,180)=ZERO<a name='7735'>
445   CONTINUE<a name='7736'>
      DO 447 J=1,180<a name='7737'>
      TABLE3(28,J)=ZERO<a name='7738'>
447   CONTINUE<a name='7739'>
      DO 449 J=1,2<a name='7740'>
      DO 449 I=1,28<a name='7741'>
      EM1(I,J)=R1T(I)<a name='7742'>
449   CONTINUE<a name='7743'>
      DO 451 J=1,120<a name='7744'>
      DO 451 I=1,28<a name='7745'>
      EM3(I,J)=R2(I)/TWO-S2(I)*SQRT(ZMASS(J))/THREE+T3(I)*ZMASS(J)/EIGHT<a name='7746'>
451   CONTINUE<a name='7747'>
      DO 453 J=121,180<a name='7748'>
      DO 453 I=1,28<a name='7749'>
      EM3(I,J)=EM3(I,J)/ZMASS(J)<a name='7750'>
453   CONTINUE<a name='7751'>
<font color=#447700>!***NOW COMPUTE E1 TABLES FOR 160-560 CM-1 BANDS ONLY.<a name='7752'></font>
<font color=#447700>!   WE USE R1WD AND SUMWDE OBTAINED ABOVE.<a name='7753'></font>
      DO 501 J=1,180<a name='7754'>
      DO 501 I=1,28<a name='7755'>
      EM1WDE(I,J)=SUMWDE(I,J)/TFOUR(I)<a name='7756'>
501   CONTINUE<a name='7757'>
      DO 503 J=1,2<a name='7758'>
      DO 503 I=1,28<a name='7759'>
      EM1WDE(I,J)=R1WD(I)<a name='7760'>
503   CONTINUE<a name='7761'>
   <a name='7762'>
      END SUBROUTINE TABLE<a name='7763'>
<a name='7764'>
<font color=#447700>!---------------------------------------------------------------------<a name='7765'></font>
<A NAME='SOLARD'><A href='../../html_code/phys/module_ra_gfdleta.F.html#SOLARD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='7766'>
    <font color=#993300>SUBROUTINE </font><font color=#cc0000>SOLARD</font>(IHRST,IDAY,MONTH,JULYR) <A href='../../call_to/SOLARD.html' TARGET='index'>1</A><a name='7767'>
<font color=#447700>!---------------------------------------------------------------------<a name='7768'></font>
    IMPLICIT NONE<a name='7769'>
<font color=#447700>!---------------------------------------------------------------------<a name='7770'></font>
<font color=#447700>!$$$  SUBPROGRAM DOCUMENTATION BLOCK<a name='7771'></font>
<font color=#447700>!                .      .    .                               .<a name='7772'></font>
<font color=#447700>! SUBPROGRAM:    SOLARD      COMPUTE THE SOLAR-EARTH DISTANCE<a name='7773'></font>
<font color=#447700>!   PRGRMMR: Q.ZHAO           ORG: W/NMC2     DATE: 96-7-23       <a name='7774'></font>
<font color=#447700>!     <a name='7775'></font>
<font color=#447700>! ABSTRACT:<a name='7776'></font>
<font color=#447700>!     SOLARD CALCULATES THE SOLAR-EARTH DISTANCE ON EACH DAY<a name='7777'></font>
<font color=#447700>!     FOR USE IN SHORT-WAVE RADIATION.<a name='7778'></font>
<font color=#447700>!     <a name='7779'></font>
<font color=#447700>! PROGRAM HISTORY LOG:<a name='7780'></font>
<font color=#447700>!   96-07-23  Q.ZHAO      - ORIGINATOR<a name='7781'></font>
<font color=#447700>!   98-10-09  Q.ZHAO      - CHANGED TO USE IW3JDN IN W3LIB TO<a name='7782'></font>
<font color=#447700>!                           CALCULATE JD.<a name='7783'></font>
<font color=#447700>!     <a name='7784'></font>
<font color=#447700>! USAGE: CALL SOLARD FROM SUBROUTINE INIT<a name='7785'></font>
<font color=#447700>!<a name='7786'></font>
<font color=#447700>!   INPUT ARGUMENT LIST:<a name='7787'></font>
<font color=#447700>!       NONE<a name='7788'></font>
<font color=#447700>!  <a name='7789'></font>
<font color=#447700>!   OUTPUT ARGUMENT LIST: <a name='7790'></font>
<font color=#447700>!       R1   - THE NON-DIMENSIONAL DISTANCE BETWEEN SUN AND THE EARTH<a name='7791'></font>
<font color=#447700>!              (LESS THAN 1.0 IN SUMMER AND LARGER THAN 1.0 IN WINTER).<a name='7792'></font>
<font color=#447700>!     <a name='7793'></font>
<font color=#447700>!   INPUT FILES:<a name='7794'></font>
<font color=#447700>!     NONE<a name='7795'></font>
<font color=#447700>!        <a name='7796'></font>
<font color=#447700>!   OUTPUT FILES:<a name='7797'></font>
<font color=#447700>!     NONE<a name='7798'></font>
<font color=#447700>!     <a name='7799'></font>
<font color=#447700>!   SUBPROGRAMS CALLED:<a name='7800'></font>
<font color=#447700>!  <a name='7801'></font>
<font color=#447700>!     UNIQUE: NONE<a name='7802'></font>
<font color=#447700>!  <a name='7803'></font>
<font color=#447700>!     LIBRARY: IW3JDN<a name='7804'></font>
<font color=#447700>!  <a name='7805'></font>
<font color=#447700>!   COMMON BLOCKS: CTLBLK<a name='7806'></font>
<font color=#447700>!   <a name='7807'></font>
<font color=#447700>! ATTRIBUTES:<a name='7808'></font>
<font color=#447700>!   LANGUAGE: FORTRAN 90<a name='7809'></font>
<font color=#447700>!   MACHINE : IBM SP<a name='7810'></font>
<font color=#447700>!***********************************************************************<a name='7811'></font>
     REAL, PARAMETER :: PI=3.1415926,PI2=2.*PI<a name='7812'>
<font color=#447700>!-----------------------------------------------------------------------<a name='7813'></font>
<font color=#447700>!     INTEGER, INTENT(IN ) :: IHRST,IDAT(3)<a name='7814'></font>
      INTEGER, INTENT(IN ) :: IHRST,IDAY,MONTH,JULYR<a name='7815'>
<font color=#447700>!     REAL   , INTENT(OUT) :: R1<a name='7816'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='7817'></font>
      INTEGER :: NDM(12),JYR19,JMN<a name='7818'>
      REAL    :: CCR<a name='7819'>
<a name='7820'>
      DATA JYR19/1900/, JMN/0/, CCR/1.3E-6/<a name='7821'>
      DATA NDM/0,31,59,90,120,151,181,212,243,273,304,334/<a name='7822'>
 <a name='7823'>
<font color=#447700>!.....TPP = DAYS BETWEEN EPOCH AND PERIHELION PASSAGE OF 1900<a name='7824'></font>
<font color=#447700>!.....JDOR1 = JD OF DECEMBER 30, 1899 AT 12 HOURS UT<a name='7825'></font>
<font color=#447700>!.....JDOR2 = JD OF EPOCH WHICH IS JANUARY 0, 1990 AT 12 HOURS UT<a name='7826'></font>
<font color=#447700>!<a name='7827'></font>
      REAL    :: TPP<a name='7828'>
      DATA TPP/1.55/<a name='7829'>
<a name='7830'>
      INTEGER :: JDOR2,JDOR1<a name='7831'>
      DATA JDOR2/2415020/, JDOR1/2415019/<a name='7832'>
<a name='7833'>
      REAL    :: DAYINC,DAT,T,YEAR,DATE,EM,E,EC,EP,CR,FJD,FJD1<a name='7834'>
      INTEGER :: JYR,JMNTH,JDAY,JHRJD,JHR,JD,ITER<a name='7835'>
<font color=#447700>!<a name='7836'></font>
<font color=#447700>!     LIBRARY: IW3JDN<a name='7837'></font>
<font color=#447700>!<a name='7838'></font>
<font color=#447700>!    --------------------------------------------------------------------<a name='7839'></font>
<font color=#447700>!     COMPUTES JULIAN DAY AND FRACTION FROM YEAR, MONTH, DAY AND TIME UT<a name='7840'></font>
<font color=#447700>!     ACCURATE ONLY BETWEEN MARCH 1, 1900 AND FEBRUARY 28, 2100<a name='7841'></font>
<font color=#447700>!     BASED ON JULIAN CALENDAR CORRECTED TO CORRESPOND TO GREGORIAN<a name='7842'></font>
<font color=#447700>!     CALENDAR DURING THIS PERIOD<a name='7843'></font>
<font color=#447700>!    --------------------------------------------------------------------<a name='7844'></font>
<a name='7845'>
<font color=#447700>!     JYR=IDAT(3)<a name='7846'></font>
<font color=#447700>!     JMNTH=IDAT(1)<a name='7847'></font>
<font color=#447700>!     JDAY=IDAT(2)<a name='7848'></font>
      JHR=IHRST<a name='7849'>
<font color=#447700>!<a name='7850'></font>
      JD=IDAY-32075                                                     &amp;<a name='7851'>
             +1461*(JULYR+4800+(MONTH-14)/12)/4                         &amp;<a name='7852'>
             +367*(MONTH-2-(MONTH-14)/12*12)/12                         &amp;<a name='7853'>
             -3*((JULYR+4900+(MONTH-14)/12)/100)/4<a name='7854'>
      IF(JHR.LT.12)THEN<a name='7855'>
        JD=JD-1<a name='7856'>
        FJD=.5+.041666667*REAL(JHR)+.00069444444*REAL(JMN)<a name='7857'>
      ELSE<a name='7858'>
  7     FJD=.041666667E0*FLOAT(JHR-12)+.00069444444E0*FLOAT(JMN)<a name='7859'>
      END IF<a name='7860'>
      DAYINC=JHR/24.0<a name='7861'>
      FJD1=JD+FJD+DAYINC<a name='7862'>
      JD=FJD1<a name='7863'>
      FJD=FJD1-JD<a name='7864'>
<font color=#447700>!***<a name='7865'></font>
<font color=#447700>!*** CALCULATE THE SOLAR-EARTH DISTANCE<a name='7866'></font>
<font color=#447700>!***<a name='7867'></font>
      DAT=REAL(JD-JDOR2)-TPP+FJD<a name='7868'>
<font color=#447700>!***<a name='7869'></font>
<font color=#447700>!    COMPUTES TIME IN JULIAN CENTURIES AFTER EPOCH<a name='7870'></font>
<font color=#447700>!***<a name='7871'></font>
      T=FLOAT(JD-JDOR2)/36525.E0<a name='7872'>
<font color=#447700>!***<a name='7873'></font>
<font color=#447700>!    COMPUTES LENGTH OF ANOMALISTIC AND TROPICAL YEARS (MINUS 365 DAYS)<a name='7874'></font>
<font color=#447700>!***<a name='7875'></font>
      YEAR=.25964134E0+.304E-5*T<a name='7876'>
<font color=#447700>!***<a name='7877'></font>
<font color=#447700>!    COMPUTES ORBIT ECCENTRICITY FROM T<a name='7878'></font>
<font color=#447700>!***<a name='7879'></font>
      EC=.01675104E0-(.418E-4+.126E-6*T)*T<a name='7880'>
      YEAR=YEAR+365.E0<a name='7881'>
<font color=#447700>!***<a name='7882'></font>
<font color=#447700>!    DATE=DAYS SINCE LAST PERIHELION PASSAGE<a name='7883'></font>
<font color=#447700>!***<a name='7884'></font>
      DATE = MOD(DAT,YEAR)<a name='7885'>
<font color=#447700>!***<a name='7886'></font>
<font color=#447700>!    SOLVE ORBIT EQUATIONS BY NEWTON'S METHOD<a name='7887'></font>
<font color=#447700>!***<a name='7888'></font>
      EM=PI2*DATE/YEAR<a name='7889'>
      E=1.E0<a name='7890'>
      ITER = 0<a name='7891'>
 31   EP=E-(E-EC*SIN(E)-EM)/(1.E0-EC*COS(E))<a name='7892'>
      CR=ABS(E-EP)<a name='7893'>
      E=EP<a name='7894'>
      ITER = ITER + 1<a name='7895'>
      IF(ITER.GT.10) GOTO 1031<a name='7896'>
      IF(CR.GT.CCR) GO TO 31<a name='7897'>
 1031 CONTINUE<a name='7898'>
      R1=1.E0-EC*COS(E)<a name='7899'>
<font color=#447700>!<a name='7900'></font>
<font color=#447700>!     WRITE(6,1000)JYR,JMNTH,JDAY,JHR,R1<a name='7901'></font>
<font color=#447700>!     WRITE(6,*)JHR,R1<a name='7902'></font>
 1000 FORMAT('SUN-EARTH DISTANCE CALCULATION FINISHED IN SOLARD'/ &amp;<a name='7903'>
             'YEAR=',I5,'  MONTH=',I3,'  DAY=',I3,' HOUR=' &amp;<a name='7904'>
      ,      I3,' R1=',F9.4)<a name='7905'>
<font color=#447700>!***<a name='7906'></font>
<font color=#447700>!    RETURN TO RADTN<a name='7907'></font>
<font color=#447700>!***<a name='7908'></font>
    END SUBROUTINE SOLARD<a name='7909'>
<font color=#447700>!---------------------------------------------------------------------<a name='7910'></font>
<A NAME='CAL_MON_DAY'><A href='../../html_code/phys/module_ra_gfdleta.F.html#CAL_MON_DAY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='7911'>
    <font color=#993300>SUBROUTINE </font><font color=#cc0000>CAL_MON_DAY</font>(JULDAY,julyr,Jmonth,Jday)      <A href='../../call_to/CAL_MON_DAY.html' TARGET='index'>1</A><a name='7912'>
<font color=#447700>!---------------------------------------------------------------------<a name='7913'></font>
    IMPLICIT NONE<a name='7914'>
<font color=#447700>!-----------------------------------------------------------------------<a name='7915'></font>
    INTEGER, INTENT(IN) :: JULDAY,julyr<a name='7916'>
    INTEGER, INTENT(OUT) :: Jmonth,Jday<a name='7917'>
    LOGICAL :: LEAP,NOT_FIND_DATE<a name='7918'>
    INTEGER :: MONTH (12),itmpday,itmpmon,i<a name='7919'>
<font color=#447700>!-----------------------------------------------------------------------<a name='7920'></font>
    DATA MONTH/31,28,31,30,31,30,31,31,30,31,30,31/<a name='7921'>
<font color=#447700>!***********************************************************************<a name='7922'></font>
    NOT_FIND_DATE = .true.<a name='7923'>
<a name='7924'>
    itmpday = JULDAY<a name='7925'>
    itmpmon = 1<a name='7926'>
    LEAP=.FALSE.<a name='7927'>
    IF(MOD(julyr,4).EQ.0)THEN<a name='7928'>
      MONTH(2)=29<a name='7929'>
      LEAP=.TRUE.<a name='7930'>
    ENDIF<a name='7931'>
<a name='7932'>
    i = 1<a name='7933'>
    DO WHILE (NOT_FIND_DATE)<a name='7934'>
       IF(itmpday.GT.MONTH(i))THEN<a name='7935'>
         itmpday=itmpday-MONTH(i)<a name='7936'>
       ELSE<a name='7937'>
         Jday=itmpday<a name='7938'>
         Jmonth=i<a name='7939'>
         NOT_FIND_DATE = .false.<a name='7940'>
       ENDIF<a name='7941'>
       i = i+1<a name='7942'>
    END DO<a name='7943'>
<a name='7944'>
    END SUBROUTINE CAL_MON_DAY<a name='7945'>
<font color=#447700>!!================================================================================<a name='7946'></font>
<font color=#447700>! CO2 initialization code<a name='7947'></font>
<a name='7948'>
<A NAME='ANTEMP'><A href='../../html_code/phys/module_ra_gfdleta.F.html#ANTEMP' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='7949'>
      <font color=#993300>FUNCTION </font><font color=#cc0000>ANTEMP</font>(L,Z) <A href='../../call_to/ANTEMP.html' TARGET='index'>6</A><a name='7950'>
      REAL :: ZB(10,7),C(11,7),DELTA(10,7),TSTAR(7)<a name='7951'>
<font color=#447700>! ************** TROPICAL SOUNDING **************************<a name='7952'></font>
      DATA (ZB(N,1),N=1,10)/  2.0,   3.0,   16.5,  21.5,  45.0, &amp;<a name='7953'>
                              51.0,  70.0,  100.,  200.,  300./<a name='7954'>
      DATA (C(N,1),N=1,11)/ -6.0,  -4.0,  -6.7,   4.0,   2.2,   &amp;<a name='7955'>
                         1.0,  -2.8,  -.27,   0.0,   0.0,  0.0/<a name='7956'>
      DATA (DELTA(N,1),N=1,10)/.5,    .5,    .3,    .5,    1.0, &amp;<a name='7957'>
                              1.0,   1.0,   1.0,   1.0,    1.0/<a name='7958'>
<font color=#447700>! ************** SUB-TROPICAL SUMMER ************************<a name='7959'></font>
      DATA (ZB(N,2),N=1,10)/ 1.5,   6.5,  13.0,  18.0,  26.0, &amp;<a name='7960'>
                              36.0,  48.0,  50.0, 70.0,  100./<a name='7961'>
      DATA (C(N,2),N=1,11)/ -4.0,  -6.0,  -6.5,   0.0,   1.2, &amp;<a name='7962'>
                        2.2,   2.5,   0.0,  -3.0,  -0.25,  0.0/<a name='7963'>
      DATA (DELTA(N,2),N=1,10)/ .5,  1.0,    .5,    .5,   1.0, &amp;<a name='7964'>
                              1.0,  2.5,    .5,   1.0,   1.0/<a name='7965'>
<font color=#447700>! ************** SUB-TROPICAL WINTER ************************<a name='7966'></font>
      DATA (ZB(N,3),N=1,10)/ 3.0,  10.0,  19.0,  25.0,  32.0, &amp;<a name='7967'>
                              44.5, 50.0,  71.0,  98.0,  200.0/<a name='7968'>
      DATA (C(N,3),N=1,11)/ -3.5,  -6.0,  -0.5,  0.0,   0.4, &amp;<a name='7969'>
                              3.2,   1.6,  -1.8, -0.7,   0.0,   0.0/<a name='7970'>
      DATA (DELTA(N,3),N=1,10)/ .5,   .5,  1.0,   1.0,   1.0, &amp;<a name='7971'>
                              1.0,  1.0,  1.0,   1.0,   1.0/<a name='7972'>
<font color=#447700>! *************  SUB-ARCTIC SUMMER *************************<a name='7973'></font>
      DATA (ZB(N,4),N=1,10)/ 4.7, 10.0,  23.0,  31.8,  44.0, &amp;<a name='7974'>
                              50.2, 69.2, 100.0, 102.0, 103.0/<a name='7975'>
      DATA (C(N,4),N=1,11)/ -5.3, -7.0,   0.0,  1.4,   3.0, &amp;<a name='7976'>
                               0.7, -3.3,  -0.2,  0.0,   0.0,  0.0/<a name='7977'>
      DATA (DELTA(N,4),N=1,10)/ .5,   .3,  1.0,   1.0,   2.0, &amp;<a name='7978'>
                              1.0,  1.5,  1.0,   1.0,   1.0/<a name='7979'>
<font color=#447700>! ************ SUB-ARCTIC WINTER *****************************<a name='7980'></font>
      DATA (ZB(N,5),N=1,10)/ 1.0,   3.2,   8.5,   15.5,   25.0, &amp;<a name='7981'>
                              30.0,  35.0,  50.0,  70.0,  100.0/<a name='7982'>
      DATA (C(N,5),N=1,11)/ 3.0,  -3.2,  -6.8,  0.0,  -0.6, &amp;<a name='7983'>
                              1.0,   1.2,   2.5, -0.7,  -1.2,  0.0/<a name='7984'>
      DATA (DELTA(N,5),N=1,10)/ .4,   1.5,    .3 ,   .5,   1.0, &amp;<a name='7985'>
                              1.0,   1.0,   1.0,   1.0,   1.0/<a name='7986'>
<font color=#447700>! ************ US STANDARD 1976 ******************************<a name='7987'></font>
      DATA (ZB(N,6),N=1,10)/ 11.0,  20.0,  32.0,  47.0,  51.0, &amp; <a name='7988'>
                             71.0,  84.8520,  90.0,  91.0,  92.0/<a name='7989'>
      DATA (C(N,6),N=1,11)/ -6.5,   0.0,   1.0,   2.80,  0.0, &amp;<a name='7990'>
                             -2.80, -2.00,  0.0,   0.0,   0.0,  0.0/<a name='7991'>
      DATA (DELTA(N,6),N=1,10)/ 0.3,   1.0,   1.0,   1.0,   1.0, &amp;<a name='7992'>
                              1.0,   1.0,   1.0,   1.0,   1.0/<a name='7993'>
<font color=#447700>!<a name='7994'></font>
<font color=#447700>! ************ ENLARGED US STANDARD 1976 **********************<a name='7995'></font>
      DATA (ZB(N,7),N=1,10)/ 11.0,  20.0,  32.0,  47.0,  51.0, &amp;<a name='7996'>
                             71.0,  84.8520,  90.0,  91.0,  92.0/<a name='7997'>
      DATA (C(N,7),N=1,11)/ -6.5,   0.0,   1.0,   2.80,  0.0, &amp;<a name='7998'>
                             -2.80, -2.00,  0.0,   0.0,   0.0,  0.0/<a name='7999'>
      DATA (DELTA(N,7),N=1,10)/ 0.3,   1.0,   1.0,   1.0,   1.0, &amp;<a name='8000'>
                              1.0,   1.0,   1.0,   1.0,   1.0/<a name='8001'>
<font color=#447700>!<a name='8002'></font>
      DATA TSTAR/ 300.0,  294.0,  272.2,  287.0,  257.1, 2*288.15/<a name='8003'>
<font color=#447700>!<a name='8004'></font>
      NLAST=10<a name='8005'>
      TEMP=TSTAR(L)+C(1,L)*Z<a name='8006'>
      DO 20 N=1,NLAST<a name='8007'>
      EXPO=(Z-ZB(N,L))/DELTA(N,L)<a name='8008'>
      EXPP=ZB(N,L)/DELTA(N,L)<a name='8009'>
<font color=#447700>!JD single-precision change<a name='8010'></font>
<font color=#447700>!      FAC=EXP(EXPP)+EXP(-EXPP)<a name='8011'></font>
<font color=#447700>!mp	write(6,*) '.........................................'<a name='8012'></font>
<font color=#447700>!mp what in the hell does the next line do?<a name='8013'></font>
<font color=#447700>!mp	<a name='8014'></font>
<font color=#447700>!mp	apparently if statement &lt;0 or =0 then 23, else 24<a name='8015'></font>
<font color=#447700>!mp     IF(ABS(EXPO)-100.0) 23,23,24<a name='8016'></font>
<font color=#447700>!<a name='8017'></font>
<font color=#447700>! changed to a more reasonable value for the workstation	<a name='8018'></font>
<font color=#447700>!<a name='8019'></font>
      IF(ABS(EXPO)-50.0) 23,23,24<a name='8020'>
   23 X=EXP(EXPO)<a name='8021'>
      Y=X+1.0/X<a name='8022'>
      ZLOG=ALOG(Y)<a name='8023'>
      GO TO 25<a name='8024'>
   24 ZLOG=ABS(EXPO)<a name='8025'>
<font color=#447700>!mp   25 IF(EXPP-100.0) 27,27,28<a name='8026'></font>
   25 IF(EXPP-50.0) 27,27,28<a name='8027'>
<font color=#447700>!JD single-precision change<a name='8028'></font>
   27 FAC=EXP(EXPP)+EXP(-EXPP)<a name='8029'>
      FACLOG=ALOG(FAC)<a name='8030'>
      GO TO 29<a name='8031'>
   28 FACLOG=EXPP<a name='8032'>
<font color=#447700>!     TEMP=TEMP+(C(N+1,L)-C(N,L))*0.5*(Z+DELTA(N,L)*<a name='8033'></font>
<font color=#447700>!    1     ALOG((EXP(EXPO)+EXP(-EXPO))/FAC))<a name='8034'></font>
   29 TEMP=TEMP+(C(N+1,L)-C(N,L))*0.5*(Z+DELTA(N,L)* &amp;<a name='8035'>
           (ZLOG-FACLOG))<a name='8036'>
<font color=#447700>!mp	write(6,*) 'ANTEMP pieces (C,C,ZLOG,FACLOG)', C(N+1,L),C(N,L),<a name='8037'></font>
<font color=#447700>!mp     +	ZLOG,FACLOG<a name='8038'></font>
   20 CONTINUE<a name='8039'>
      ANTEMP=TEMP<a name='8040'>
<a name='8041'>
      END FUNCTION ANTEMP<a name='8042'>
<a name='8043'>
<font color=#447700>!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc<a name='8044'></font>
<a name='8045'>
<A NAME='COEINT'><A href='../../html_code/phys/module_ra_gfdleta.F.html#COEINT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8046'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>COEINT</font>(RAT,IR) <A href='../../call_to/COEINT.html' TARGET='index'>1</A>,<A href='../../call_from/COEINT.html' TARGET='index'>3</A><a name='8047'>
<font color=#447700>! **********************************************************************<a name='8048'></font>
<font color=#447700>!<a name='8049'></font>
<font color=#447700>!<a name='8050'></font>
<font color=#447700>!            THE TRANSMISSION FUNCTION BETWEEN P1 AND P2 IS ASSUMED TO<a name='8051'></font>
<font color=#447700>!       THE  FUNCTIONAL FORM<a name='8052'></font>
<font color=#447700>!                     TAU(P1,P2)= 1.0-SQRT(C*LOG(1.0+X*PATH)),<a name='8053'></font>
<font color=#447700>!               WHERE<a name='8054'></font>
<font color=#447700>!                     PATH(P1,P2)=((P1-P2)**2)*(P1+P2+CORE)/<a name='8055'></font>
<font color=#447700>!                                 (ETA*(P1+P2+CORE)+(P1-P2))<a name='8056'></font>
<font color=#447700>!<a name='8057'></font>
<font color=#447700>!<a name='8058'></font>
<font color=#447700>!        THE PARAMETERS C AND X ARE FUNCTIONS OF P2, AND ARE TO BE DETER<a name='8059'></font>
<font color=#447700>!        WHILE CORE IS A PRESPECIFIED NUMBER.ETA IS A FUNCTION OF THE TH<a name='8060'></font>
<font color=#447700>!        PRODUCT (CX);IT IS OBTAITED ITERATIVELY. THE DERIVATION OF ALL<a name='8061'></font>
<font color=#447700>!        VALUES WILL BE EXPLAINED IN A FORTHCOMING PAPER.<a name='8062'></font>
<font color=#447700>!            SUBROUTINE COEINT DETERMINES C(I) AND X(I) BY USING THE ACT<a name='8063'></font>
<font color=#447700>!        VALUES OF TAU(P(I-2),P(I)) AND TAU(P(I-1),P(I)) AND THE PREVIOU<a name='8064'></font>
<font color=#447700>!        ITERATION VALUE OF ETA.<a name='8065'></font>
<font color=#447700>!             DEFINE:<a name='8066'></font>
<font color=#447700>!                PATHA=PATH(P(I),P(I-2),CORE,ETA)<a name='8067'></font>
<font color=#447700>!                PATHB=PATH(P(I),P(I-1),CORE,ETA);<a name='8068'></font>
<font color=#447700>!        THEN<a name='8069'></font>
<font color=#447700>!                R=(1-TAU(P(I),P(I-2)))/(1-TAU(P(I),P(I-1)))<a name='8070'></font>
<font color=#447700>!                 = SQRT(LOG(1+X*PATHA)/LOG(1+X*PATHB)),<a name='8071'></font>
<font color=#447700>!        SO THAT<a name='8072'></font>
<font color=#447700>!                R**2= LOG(1+X*PATHA)/LOG(1+X*PATHB).<a name='8073'></font>
<font color=#447700>!        THIS EQUATION CAN BE SOLVED BY NEWTON S METHOD FOR X AND THEN T<a name='8074'></font>
<font color=#447700>!        RESULT USED TO FIND C. THIS IS REPEATED FOR EACH VALUE OF I GRE<a name='8075'></font>
<font color=#447700>!        THAN 2 TO GIVE THE ARRAYS X(I) AND C(I).<a name='8076'></font>
<font color=#447700>!             NEWTON S METHOD FOR SOLVING THE EQUATION<a name='8077'></font>
<font color=#447700>!                 F(X)=0<a name='8078'></font>
<font color=#447700>!        MAKES USE OF THE LOOP XNEW= XOLD-F(XOLD)/FPRIME(XOLD).<a name='8079'></font>
<font color=#447700>!        THIS IS ITERATED 20 TIMES, WHICH IS PROBABLY EXCESSIVE.<a name='8080'></font>
<font color=#447700>!        THE FIRST GUESS FOR ETA IS 3.2E-4*EXP(-P(I)/1000),WHICH HAS<a name='8081'></font>
<font color=#447700>!        BEEN FOUND TO BE FAIRLY REALISTIC BY EXPERIMENT; WE ITERATE 5 T<a name='8082'></font>
<font color=#447700>!        (AGAIN,PROBABLY EXCESSIVELY) TO OBTAIN THE VALUES FOR C,X,ETA T<a name='8083'></font>
<font color=#447700>!        USED FOR INTERPOLATION.<a name='8084'></font>
<font color=#447700>!           THERE ARE SEVERAL POSSIBLE PITFALLS:<a name='8085'></font>
<font color=#447700>!              1) IN THE COURSE OF ITERATION, X MAY REACH A VALUE WHICH<a name='8086'></font>
<font color=#447700>!                 1+X*PATHA NEGATIVE; IN THIS CASE THE ITERATION IS STOP<a name='8087'></font>
<font color=#447700>!                 AND AN ERROR MESSAGE IS PRINTED OUT.<a name='8088'></font>
<font color=#447700>!              2) EVEN IF (1) DOES NOT OCCUR, IT IS STILL POSSIBLE THAT<a name='8089'></font>
<font color=#447700>!                 BE NEGATIVE AND LARGE ENOUGH TO MAKE 1+X*PATH(P(I),0,C<a name='8090'></font>
<font color=#447700>!                 NEGATIVE. THIS IS CHECKED FOR IN A FINAL LOOP, AND IF<a name='8091'></font>
<font color=#447700>!                 A WARNING IS PRINTED OUT.<a name='8092'></font>
<font color=#447700>!<a name='8093'></font>
<font color=#447700>!  *********************************************************************<a name='8094'></font>
<font color=#447700>!....<a name='8095'></font>
<font color=#447700>!     IMPLICIT DOUBLE PRECISION (A-H,O-Z)<a name='8096'></font>
<font color=#447700>!     COMMON/PRESS/PA(109)<a name='8097'></font>
      REAL RAT,SINV<a name='8098'>
<font color=#447700>!     REAL PA,CORE,TRANSA,PATH,UEXP,SEXP,ETA,SEXPV<a name='8099'></font>
      REAL PA2<a name='8100'>
<font color=#447700>!     COMMON/TRAN/ TRANSA(109,109)<a name='8101'></font>
<font color=#447700>!     COMMON/COEFS/XA(109),CA(109),ETA(109),SEXPV(109),CORE,UEXP,SEXP<a name='8102'></font>
      DIMENSION PATH0(109),ETAP(109),XAP(109),CAP(109)<a name='8103'>
      DIMENSION SINV(4)<a name='8104'>
      INTEGER :: IERR<a name='8105'>
      DATA SINV/2.74992,2.12731,4.38111,0.0832926/<a name='8106'>
<font color=#447700>!NOV89   DIMENSION SINV(3)<a name='8107'></font>
<font color=#447700>!NOV89   DATA SINV/2.74992,2.12731,4.38111/<a name='8108'></font>
<font color=#447700>!O222  OLD CODE USED 2.7528 RATHER THAN 2.74992 ---K.A.C. OCTOBER 1988<a name='8109'></font>
<font color=#447700>!O222   WHEN 2.7528 WAS USED,WE EXACTLY REPRODUCED THE MRF CO2 ARRAYS<a name='8110'></font>
      CORE=5.000<a name='8111'>
      UEXP=0.90<a name='8112'>
<font color=#447700>!      P0=0.7<a name='8113'></font>
      DO 902 I=1,109<a name='8114'>
      PA2=PA(I)*PA(I)<a name='8115'>
      SEXPV(I)=.505+2.0E-5*PA(I)+.035*(PA2-.25)/(PA2+.25)<a name='8116'>
902   CONTINUE<a name='8117'>
      DO 900 I=1,109<a name='8118'>
      ETA(I)=3.2E-4*EXP(-PA(I)/500.)<a name='8119'>
      ETAP(I)=ETA(I)<a name='8120'>
900   CONTINUE<a name='8121'>
      DO 1200 NP=1,10<a name='8122'>
      DO 1000 I=3,109<a name='8123'>
      SEXP=SEXPV(I)<a name='8124'>
      R=(1.0D0-TRANSA(I,I-2))/(1.0D0-TRANSA(I,I-1))<a name='8125'>
      REXP=R**(UEXP/SEXP)<a name='8126'>
      arg1=<A href='../../html_code/phys/module_ra_gfdleta.F.html#PATH'>path</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#COEINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PATH_1">(pa(i),pa(i-2),core,eta(i))<a name='8127'>
      arg2=<A href='../../html_code/phys/module_ra_gfdleta.F.html#PATH'>path</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#COEINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PATH_2">(pa(i),pa(i-1),core,eta(i))<a name='8128'>
      PATHA=(PATH(PA(I),PA(I-2),CORE,ETA(I)))**UEXP<a name='8129'>
      PATHB=(PATH(PA(I),PA(I-1),CORE,ETA(I)))**UEXP<a name='8130'>
      XX=2.0D0*(PATHB*REXP-PATHA)/(PATHB*PATHB*REXP-PATHA*PATHA)<a name='8131'>
      DO 1010 LL=1,20<a name='8132'>
      F1=DLOG(1.0D0+XX*PATHA)<a name='8133'>
      F2=DLOG(1.0D0+XX*PATHB)<a name='8134'>
      F=F1/F2-REXP<a name='8135'>
      FPRIME=(F2*PATHA/(1.0D0+XX*PATHA)-F1*PATHB/(1.0D0+XX*PATHB))/ &amp;<a name='8136'>
          (F2*F2)<a name='8137'>
      XX=XX-F/FPRIME<a name='8138'>
      CHECK=1.0D0+XX*PATHA<a name='8139'>
<font color=#447700>!!!!  IF (CHECK) 1020,1020,1025<a name='8140'></font>
      IF(CHECK.LE.0.)THEN<a name='8141'>
        WRITE(errmess,360)I,LL,CHECK<a name='8142'>
        WRITE(errmess,*)' xx=',xx,' patha=',patha<a name='8143'>
  360   FORMAT(' ERROR,I=',I3,'LL=',I3,'CHECK=',F20.10)<a name='8144'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#COEINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_162"> ( errmess )<a name='8145'>
      ENDIF<a name='8146'>
 1010 CONTINUE<a name='8147'>
      CA(I)=(1.0D0-TRANSA(I,I-2))**(UEXP/SEXP)/ &amp;<a name='8148'>
       (DLOG(1.0D0+XX*PATHA)+1.0D-20)<a name='8149'>
      XA(I)=XX<a name='8150'>
1000  CONTINUE<a name='8151'>
      XA(2)=XA(3)<a name='8152'>
      XA(1)=XA(3)<a name='8153'>
      CA(2)=CA(3)<a name='8154'>
      CA(1)=CA(3)<a name='8155'>
      DO 1100 I=3,109<a name='8156'>
      PATH0(I)=(PATH(PA(I),0.,CORE,ETA(I)))**UEXP<a name='8157'>
      PATH0(I)=1.0D0+XA(I)*PATH0(I)<a name='8158'>
<font color=#447700>!+++  IF (PATH0(I).LT.0.) WRITE (6,361) I,PATH0(I),XA(I)<a name='8159'></font>
1100  CONTINUE<a name='8160'>
      DO 1035 I=1,109<a name='8161'>
      SEXP=SEXPV(I)<a name='8162'>
      ETAP(I)=ETA(I)<a name='8163'>
      ETA(I)=(SINV(IR)/RAT)**(1./SEXP)* &amp;<a name='8164'>
        (CA(I)*XA(I))**(1./UEXP)<a name='8165'>
1035  CONTINUE<a name='8166'>
<font color=#447700>!<a name='8167'></font>
<font color=#447700>!     THE ETA FORMULATION IS DETAILED IN SCHWARZKOPF AND FELS(1985).<a name='8168'></font>
<font color=#447700>!        THE QUANTITY SINV=(G*DELTANU)/(RCO2*D*S)<a name='8169'></font>
<font color=#447700>!      IN CGS UNITS,WITH D,THE DIFFUSICITY FACTOR=2, AND<a name='8170'></font>
<font color=#447700>!      S,THE SUM OF CO2 LINE STRENGTHS OVER THE 15UM CO2 BAND<a name='8171'></font>
<font color=#447700>!       ALSO,THE DENOMINATOR IS MULTIPLIED BY<a name='8172'></font>
<font color=#447700>!      1000 TO PERMIT USE OF MB UNITS FOR PRESSURE.<a name='8173'></font>
<font color=#447700>!        S IS ACTUALLY WEIGHTED BY B(250) AT 10 CM-1 WIDE INTERVALS,IN<a name='8174'></font>
<font color=#447700>!      ORDER TO BE CONSISTENT WITH THE METHODS USED TO OBTAIN THE LBL<a name='8175'></font>
<font color=#447700>!      1-BAND CONSOLIDATED TRANCMISSION FUNCTIONS.<a name='8176'></font>
<font color=#447700>!      FOR THE 490-850 INTERVAL (DELTANU=360,IR=1) SINV=2.74992.<a name='8177'></font>
<font color=#447700>!      (SLIGHTLY DIFFERENT FROM 2.7528 USED IN EARLIER VERSIONS)<a name='8178'></font>
<font color=#447700>!      FOR THE 490-670 INTERVAL (IR=2) SINV=2.12731<a name='8179'></font>
<font color=#447700>!      FOR THE 670-850 INTERVAL (IR=3) SINV=4.38111<a name='8180'></font>
<font color=#447700>!      FOR THE 2270-2380 INTERVAL (IR=4) SINV=0.0832926<a name='8181'></font>
<font color=#447700>!      SINV HAS BEEN OBTAINED USING THE 1982 AFGL CATALOG FOR CO2<a name='8182'></font>
<font color=#447700>!        RAT IS THE ACTUAL CO2 MIXING RATIO IN UNITS OF 330 PPMV,<a name='8183'></font>
<font color=#447700>!      LETTING USE OF THIS FORMULATION FOR ANY CO2 CONCENTRATION.<a name='8184'></font>
<font color=#447700>!<a name='8185'></font>
<font color=#447700>!     WRITE (6,366) (NP,I,CA(I),XA(I),ETA(I),SEXPV(I),I=1,109)<a name='8186'></font>
<font color=#447700>!366   FORMAT (2I4,4E20.12)<a name='8187'></font>
1200  CONTINUE<a name='8188'>
 361  FORMAT (' **WARNING:** 1+XA*PATH(PA(I),0) IS NEGATIVE,I= ',I3,/ &amp;<a name='8189'>
       20X,'PATH0(I)=',F16.6,' XA(I)=',F16.6)<a name='8190'>
      RETURN<a name='8191'>
      END SUBROUTINE COEINT<a name='8192'>
<a name='8193'>
<font color=#447700>!--------------<a name='8194'></font>
<a name='8195'>
<a name='8196'>
<font color=#447700>!CCC  PROGRAM CO2INS<a name='8197'></font>
<A NAME='CO2INS'><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8198'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>CO2INS</font>(T22,T23,T66,IQ,L,LP1,iflag) <A href='../../call_to/CO2INS.html' TARGET='index'>3</A><a name='8199'>
<font color=#447700>!     *********************************************************<a name='8200'></font>
<font color=#447700>!       SAVE DATA ON PERMANENT DATA SET DENOTED BY CO222 ******<a name='8201'></font>
<font color=#447700>!          ..... K.CAMPANA   MARCH 1988,OCTOBER 1988...<a name='8202'></font>
<font color=#447700>!          ..... K.CAMPANA   DECEMBER 1988-CLEANED UP FOR LAUNCHER<a name='8203'></font>
<font color=#447700>!          ..... K.CAMPANA   NOVEMBER 1989-ALTERED FOR NEW RADIATION<a name='8204'></font>
<font color=#447700>!     *********************************************************<a name='8205'></font>
      DIMENSION T22(LP1,LP1,3),T23(LP1,LP1,3),T66(LP1,LP1,6)<a name='8206'>
      DIMENSION DCDT8(LP1,LP1),DCDT10(LP1,LP1),CO2PO(LP1,LP1), &amp;<a name='8207'>
       CO2800(LP1,LP1),CO2PO1(LP1,LP1),CO2801(LP1,LP1),CO2PO2(LP1,LP1), &amp;<a name='8208'>
       CO2802(LP1,LP1),N(LP1),D2CT8(LP1,LP1),D2CT10(LP1,LP1)<a name='8209'>
<font color=#447700>!CC   ITIN=22<a name='8210'></font>
<font color=#447700>!CC   ITIN1=23<a name='8211'></font>
<font color=#447700>!O222  LATEST CODE HAD  IQ=1<a name='8212'></font>
<font color=#447700>!CC      IQ=4<a name='8213'></font>
1011  FORMAT (4F20.14)<a name='8214'>
<font color=#447700>!CC      READ (ITIN,1011) ((CO2PO(I,J),I=1,LP1),J=1,LP1)<a name='8215'></font>
<font color=#447700>!CC      READ (ITIN1,1011) ((CO2800(I,J),I=1,LP1),J=1,LP1)<a name='8216'></font>
<font color=#447700>!CC      READ (ITIN,1011) ((CO2PO1(I,J),I=1,LP1),J=1,LP1)<a name='8217'></font>
<font color=#447700>!CC      READ (ITIN1,1011) ((CO2801(I,J),I=1,LP1),J=1,LP1)<a name='8218'></font>
<font color=#447700>!CC      READ (ITIN,1011) ((CO2PO2(I,J),I=1,LP1),J=1,LP1)<a name='8219'></font>
<font color=#447700>!CC      READ (ITIN1,1011) ((CO2802(I,J),I=1,LP1),J=1,LP1)<a name='8220'></font>
      DO 300 J=1,LP1<a name='8221'>
        DO 300 I=1,LP1<a name='8222'>
          CO2PO(I,J) = T22(I,J,1)<a name='8223'>
<font color=#447700>!NOV89<a name='8224'></font>
          IF (IQ.EQ.5) GO TO 300<a name='8225'>
<font color=#447700>!NOV89<a name='8226'></font>
          CO2PO1(I,J) = T22(I,J,2)<a name='8227'>
          CO2PO2(I,J) = T22(I,J,3)<a name='8228'>
  300 CONTINUE<a name='8229'>
      DO 301 J=1,LP1<a name='8230'>
        DO 301 I=1,LP1<a name='8231'>
          CO2800(I,J) = T23(I,J,1)<a name='8232'>
<font color=#447700>!NOV89<a name='8233'></font>
          IF (IQ.EQ.5) GO TO 301<a name='8234'>
<font color=#447700>!NOV89<a name='8235'></font>
          CO2801(I,J) = T23(I,J,2)<a name='8236'>
          CO2802(I,J) = T23(I,J,3)<a name='8237'>
  301 CONTINUE<a name='8238'>
<font color=#447700>!***THE FOLLOWING CODE IS REWRITTEN SO THAT THE RADIATIVE BANDS<a name='8239'></font>
<font color=#447700>!   ARE:<a name='8240'></font>
<font color=#447700>!        IQ=1    560-800     (CONSOL.=490-850)<a name='8241'></font>
<font color=#447700>!        IQ=2    560-670     (CONSOL.=490-670)<a name='8242'></font>
<font color=#447700>!        IQ=3    670-800     (CONSOL.=670-850)<a name='8243'></font>
<font color=#447700>!        IQ=4    560-760 (ORIGINAL CODE)   (CONSOL.=490-850)<a name='8244'></font>
<font color=#447700>!NOV89<a name='8245'></font>
<font color=#447700>!        IQ=5   2270-2380    (CONSOL.=2270-2380)<a name='8246'></font>
<font color=#447700>!NOV89<a name='8247'></font>
<font color=#447700>!  THE FOLLOWING LOOP OBTAINS TRANSMISSION FUNCTIONS FOR BANDS<a name='8248'></font>
<font color=#447700>!  USED IN RADIATIVE MODEL CALCULATIONS,WITH THE EQUIVALENT<a name='8249'></font>
<font color=#447700>!  WIDTHS KEPT FROM THE ORIGINAL CONSOLIDATED CO2 TF S.<a name='8250'></font>
<font color=#447700>!NOV89<a name='8251'></font>
<font color=#447700>!      NOTE: ALTHOUGH THE BAND TRANSMISSION FUNCTIONS ARE<a name='8252'></font>
<font color=#447700>!  COMPUTED FOR ALL RADIATIVE BANDS, AS OF 9/28/88, THEY<a name='8253'></font>
<font color=#447700>!  ARE WRITTEN OUT IN FULL ONLY FOR THE FULL 15 UM BAND CASES<a name='8254'></font>
<font color=#447700>!  (IQ=1,4).  IN OTHER CASES, THE TRANSMISSIVITIES (1,K) ARE<a name='8255'></font>
<font color=#447700>!  WRITTEN OUT, AS THESE ARE THE ONLY ONES NEEDED FOR CTS<a name='8256'></font>
<font color=#447700>!  CALCULATIONS.  ALSO, FOR THE 4.3 UM BAND (IQ=5) THE TEMP.<a name='8257'></font>
<font color=#447700>!  DERIVATIVE TERMS ARE NOT WRITTEN OUT, AS THEY ARE UNUSED.<a name='8258'></font>
<font color=#447700>!NOV89<a name='8259'></font>
      IF (IQ.EQ.1) THEN<a name='8260'>
         C1=1.5<a name='8261'>
         C2x=0.5<a name='8262'>
      ENDIF<a name='8263'>
      IF (IQ.EQ.2) THEN<a name='8264'>
        C1=18./11.<a name='8265'>
        C2x=7./11.<a name='8266'>
      ENDIF<a name='8267'>
      IF (IQ.EQ.3) THEN<a name='8268'>
        C1=18./13.<a name='8269'>
        C2x=5./13.<a name='8270'>
      ENDIF<a name='8271'>
      IF (IQ.EQ.4) THEN<a name='8272'>
        C1=1.8<a name='8273'>
        C2x=0.8<a name='8274'>
      ENDIF<a name='8275'>
<font color=#447700>!NOV89<a name='8276'></font>
      IF (IQ.EQ.5) THEN<a name='8277'>
        C1=1.0<a name='8278'>
        C2x=0.0<a name='8279'>
      ENDIF<a name='8280'>
<font color=#447700>!NOV89<a name='8281'></font>
      DO 1021 I=1,LP1<a name='8282'>
      DO 1021 J=1,LP1<a name='8283'>
      CO2PO(J,I)=C1*CO2PO(J,I)-C2x<a name='8284'>
      CO2800(J,I)=C1*CO2800(J,I)-C2x<a name='8285'>
<font color=#447700>!NOV89<a name='8286'></font>
      IF (IQ.EQ.5) GO TO 1021<a name='8287'>
<font color=#447700>!NOV89<a name='8288'></font>
      CO2PO1(J,I)=C1*CO2PO1(J,I)-C2x<a name='8289'>
      CO2801(J,I)=C1*CO2801(J,I)-C2x<a name='8290'>
      CO2PO2(J,I)=C1*CO2PO2(J,I)-C2x<a name='8291'>
      CO2802(J,I)=C1*CO2802(J,I)-C2x<a name='8292'>
1021  CONTINUE<a name='8293'>
<font color=#447700>!NOV89<a name='8294'></font>
      IF (IQ.GE.1.AND.IQ.LE.4) THEN<a name='8295'>
<font color=#447700>!NOV89<a name='8296'></font>
      DO 1 J=1,LP1<a name='8297'>
      DO 1 I=1,LP1<a name='8298'>
      DCDT8(I,J)=.02*(CO2801(I,J)-CO2802(I,J))*100.<a name='8299'>
      DCDT10(I,J)=.02*(CO2PO1(I,J)-CO2PO2(I,J))*100.<a name='8300'>
      D2CT8(I,J)=.0016*(CO2801(I,J)+CO2802(I,J)-2.*CO2800(I,J))*1000.<a name='8301'>
      D2CT10(I,J)=.0016*(CO2PO1(I,J)+CO2PO2(I,J)-2.*CO2PO(I,J))*1000.<a name='8302'>
1     CONTINUE<a name='8303'>
<font color=#447700>!NOV89<a name='8304'></font>
      ENDIF<a name='8305'>
<font color=#447700>!NOV89<a name='8306'></font>
<font color=#447700>!O222 *********************************************************<a name='8307'></font>
<font color=#447700>!CC       REWIND 66<a name='8308'></font>
<font color=#447700>!        SAVE CDT51,CO251,C2D51,CDT58,CO258,C2D58..ON TEMPO FILE<a name='8309'></font>
<font color=#447700>!CC       WRITE (66) DCDT10<a name='8310'></font>
<font color=#447700>!CC       WRITE (66) CO2PO<a name='8311'></font>
<font color=#447700>!CC       WRITE (66) D2CT10<a name='8312'></font>
<font color=#447700>!CC       WRITE (66) DCDT8<a name='8313'></font>
<font color=#447700>!CC       WRITE (66) CO2800<a name='8314'></font>
<font color=#447700>!CC       WRITE (66) D2CT8<a name='8315'></font>
<font color=#447700>!CC       REWIND 66<a name='8316'></font>
<font color=#447700>!NOV89<a name='8317'></font>
      IF (IQ.EQ.1.OR.IQ.EQ.4) THEN<a name='8318'>
<font color=#447700>!NOV89<a name='8319'></font>
      DO 400 J=1,LP1<a name='8320'>
       DO 400 I=1,LP1<a name='8321'>
        T66(I,J,1) = DCDT10(I,J)<a name='8322'>
        T66(I,J,2) = CO2PO(I,J)<a name='8323'>
        T66(I,J,3) = D2CT10(I,J)<a name='8324'>
        T66(I,J,4) = DCDT8(I,J)<a name='8325'>
        T66(I,J,5) = CO2800(I,J)<a name='8326'>
        T66(I,J,6) = D2CT8(I,J)<a name='8327'>
  400 CONTINUE<a name='8328'>
<font color=#447700>!NOV89<a name='8329'></font>
      ELSE<a name='8330'>
      DO 409 I=1,LP1<a name='8331'>
        T66(I,1,2) = CO2PO(1,I)<a name='8332'>
        T66(I,1,5) = CO2800(1,I)<a name='8333'>
        IF (IQ.EQ.5) GO TO 409<a name='8334'>
        T66(I,1,1) = DCDT10(1,I)<a name='8335'>
        T66(I,1,3) = D2CT10(1,I)<a name='8336'>
        T66(I,1,4) = DCDT8(1,I)<a name='8337'>
        T66(I,1,6) = D2CT8(1,I)<a name='8338'>
  409 CONTINUE<a name='8339'>
      ENDIF<a name='8340'>
<font color=#447700>!NOV89<a name='8341'></font>
<font color=#447700>!O222 *********************************************************<a name='8342'></font>
      RETURN<a name='8343'>
      END SUBROUTINE CO2INS<a name='8344'>
<font color=#447700>!O222 PROGRAM CO2INT(INPUT,TAPE5=INPUT)<a name='8345'></font>
<font color=#447700>!NOV89<a name='8346'></font>
<A NAME='CO2INT'><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8347'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>CO2INT</font>(ITAPE,T15A,T15B,T22,RATIO,IR,NMETHD,NLEVLS,NLP1,NLP2) <A href='../../call_to/CO2INT.html' TARGET='index'>8</A>,<A href='../../call_from/CO2INT.html' TARGET='index'>5</A><a name='8348'>
<font color=#447700>!NOV89<a name='8349'></font>
<font color=#447700>!     *********************************************************<a name='8350'></font>
<font color=#447700>!       CHANGES TO DATA READ  AND FORMAT SEE CO222     ***<a name='8351'></font>
<font color=#447700>!          ..... K.CAMPANA   MARCH 1988,OCTOBER 1988<a name='8352'></font>
<font color=#447700>!       CHANGES TO PASS ITAPE,AND IF IR=4,READ 1 CO2 REC..KAC NOV89<a name='8353'></font>
<font color=#447700>!     *********************************************************<a name='8354'></font>
<font color=#447700>!       CO2INT INTERPOLATES CARBON DIOXIDE TRANSMISSION FUNCTIONS<a name='8355'></font>
<font color=#447700>!  FROM THE 109 LEVEL GRID,FOR WHICH THE TRANSMISSION FUNCTIONS<a name='8356'></font>
<font color=#447700>!  HAVE BEEN PRE-CALCULATED, TO THE GRID STRUCTURE SPECIFIED BY THE<a name='8357'></font>
<font color=#447700>!  USER.<a name='8358'></font>
<font color=#447700>!<a name='8359'></font>
<font color=#447700>!        METHOD:<a name='8360'></font>
<font color=#447700>!<a name='8361'></font>
<font color=#447700>!      CO2INT IS EMPLOYABLE FOR TWO PURPOSES: 1) TO OBTAIN TRANSMIS-<a name='8362'></font>
<font color=#447700>!  SIVITIES BETWEEN ANY 2 OF AN ARRAY OF USER-DEFINED PRESSURES; AND<a name='8363'></font>
<font color=#447700>!  2) TO OBTAIN LAYER-MEAN TRANSMISSIVITIES BETWEEN ANY 2 OF AN ARRAY<a name='8364'></font>
<font color=#447700>!  OF USER-DEFINED PRESSURE LAYERS.TO CLARIFY THESE TWO PURPOSES,SEE<a name='8365'></font>
<font color=#447700>!  THE DIAGRAM AND DISCUSSION BELOW.<a name='8366'></font>
<font color=#447700>!      CO2INT MAY BE USED TO EXECUTE ONLY ONE PURPOSE AT ONE TIME.<a name='8367'></font>
<font color=#447700>!<a name='8368'></font>
<font color=#447700>!     LET P BE AN ARRAY OF USER-DEFINED PRESSURES<a name='8369'></font>
<font color=#447700>!     AND PD BE USER-DEFINED PRESSURE LAYERS.<a name='8370'></font>
<font color=#447700>!<a name='8371'></font>
<font color=#447700>!       - - - - - - - - -   PD(I-1) ---<a name='8372'></font>
<font color=#447700>!                                     ^<a name='8373'></font>
<font color=#447700>!       -----------------   P(I)      ^  PRESSURE LAYER I  (PLM(I))<a name='8374'></font>
<font color=#447700>!                                     ^<a name='8375'></font>
<font color=#447700>!       - - - - - - - - -   PD(I)  ---<a name='8376'></font>
<font color=#447700>!                                     ^<a name='8377'></font>
<font color=#447700>!       -----------------   P(I+1)    ^  PRESSURE LAYER I+1 (PLM(I+1))<a name='8378'></font>
<font color=#447700>!                                     ^<a name='8379'></font>
<font color=#447700>!       - - - - - - - - -   PD(I+1)---<a name='8380'></font>
<font color=#447700>!            ...                          (THE NOTATION USED IS<a name='8381'></font>
<font color=#447700>!            ...                          CONSISTENT WITH THE CODE)<a name='8382'></font>
<font color=#447700>!            ...<a name='8383'></font>
<font color=#447700>!      - - - - - - - - -    PD(J-1)<a name='8384'></font>
<font color=#447700>!<a name='8385'></font>
<font color=#447700>!      -----------------    P(J)<a name='8386'></font>
<font color=#447700>!<a name='8387'></font>
<font color=#447700>!      - - - - - - - - -    PD(J)<a name='8388'></font>
<font color=#447700>!<a name='8389'></font>
<font color=#447700>!      PURPOSE 1:   THE TRANSMISSIVITY BETWEEN SPECIFIC PRESSURES<a name='8390'></font>
<font color=#447700>!      P(I) AND P(J) ,TAU(P(I),P(J))  IS COMPUTED BY THIS PROGRAM.<a name='8391'></font>
<font color=#447700>!      IN THIS MODE,THERE IS NO REFERENCE TO LAYER PRESSURES PD<a name='8392'></font>
<font color=#447700>!      (PD,PLM ARE NOT INPUTTED).<a name='8393'></font>
<font color=#447700>!<a name='8394'></font>
<font color=#447700>!      PURPOSE 2:   THE LAYER-MEAN TRANSMISSIVITY BETWEEN A LAYER-<a name='8395'></font>
<font color=#447700>!      MEAN PRESSURE PLM(J) AND PRESSURE LAYER I IS GIVEN BY<a name='8396'></font>
<font color=#447700>!         TAULM(PLM(I),PLM(J)). IT IS COMPUTED BY THE INTEGRAL<a name='8397'></font>
<font color=#447700>!<a name='8398'></font>
<font color=#447700>!                           PD(I)<a name='8399'></font>
<font color=#447700>!                           ----<a name='8400'></font>
<font color=#447700>!             1             ^<a name='8401'></font>
<font color=#447700>!        -------------  *   ^   TAU ( P',PLM(J) )  DP'<a name='8402'></font>
<font color=#447700>!        PD(I)-PD(I-1)      ^<a name='8403'></font>
<font color=#447700>!                        ----<a name='8404'></font>
<font color=#447700>!                        PD(I-1)<a name='8405'></font>
<font color=#447700>!<a name='8406'></font>
<font color=#447700>!           THE LAYER-MEAN PRESSURE PLM(I) IS SPECIFIED BY THE USER.<a name='8407'></font>
<font color=#447700>!        FOR MANY PURPOSES,PLM WILL BE CHOSEN TO BE THE AVERAGE<a name='8408'></font>
<font color=#447700>!        PRESSURE IN THE LAYER-IE,PLM(I)=0.5*(PD(I-1)+PD(I)).<a name='8409'></font>
<font color=#447700>!           FOR LAYER-MEAN TRANSMISSIVITIES,THE USER THUS INPUTS<a name='8410'></font>
<font color=#447700>!        A PRESSURE ARRAY (PD) DEFINING THE PRESSURE LAYERS AND AN<a name='8411'></font>
<font color=#447700>!        ARRAY (PLM) DEFINING THE LAYER-MEAN PRESSURES.THE CALCULATION<a name='8412'></font>
<font color=#447700>!        DOES NOT DEPEND ON THE P ARRAY USED FOR PURPOSE 1 (P IS NOT<a name='8413'></font>
<font color=#447700>!        INPUTTED).<a name='8414'></font>
<font color=#447700>!<a name='8415'></font>
<font color=#447700>!            THE FOLLOWING PARAGRAPHS DEPICT THE UTILIZATION OF THIS<a name='8416'></font>
<font color=#447700>!       CODE WHEN USED TO COMPUTE TRANSMISSIVITIES BETWEEN SPECIFIC<a name='8417'></font>
<font color=#447700>!       PRESSURES. LATER PARAGRAPHS DESCRIBE ADDITIONAL FEATURES NEEDED<a name='8418'></font>
<font color=#447700>!       FOR LAYER-MEAN TRANSMISSIVITIES.<a name='8419'></font>
<font color=#447700>!<a name='8420'></font>
<font color=#447700>!          FOR A GIVEN CO2 MIXING RATIO AND STANDARD TEMPERATURE<a name='8421'></font>
<font color=#447700>!      PROFILE,A TABLE OF TRANSMISSION FUNCTIONS FOR A FIXED GRID<a name='8422'></font>
<font color=#447700>!     OF ATMOSPHERIC PRESSURES HAS BEEN PRE-CALCULATED.<a name='8423'></font>
<font color=#447700>!      THE STANDARD TEMPERATURE PROFILE IS COMPUTED FROM THE US<a name='8424'></font>
<font color=#447700>!     STANDARD ATMOSPHERE (1977) TABLE.ADDITIONALLY, THE<a name='8425'></font>
<font color=#447700>!     SAME TRANSMISSION FUNCTIONS HAVE BEEN PRE-CALCULATED FOR A<a name='8426'></font>
<font color=#447700>!     TEMPERATURE PROFILE INCREASED AND DECREASED (AT ALL LEVELS)<a name='8427'></font>
<font color=#447700>!     BY 25 DEGREES.<a name='8428'></font>
<font color=#447700>!         THIS PROGRAM READS IN THE PRESPECIFIED TRANSMISSION FUNCTIONS<a name='8429'></font>
<font color=#447700>!     AND A USER-SUPPLIED PRESSURE GRID (P(I)) AND CALCULATES TRANS-<a name='8430'></font>
<font color=#447700>!     MISSION FUNCTIONS ,TAU(P(I),P(J)), FOR ALL P(I) S AND P(J) S.<a name='8431'></font>
<font color=#447700>!     A LOGARITHMIC INTERPOLATION SCHEME IS USED.<a name='8432'></font>
<font color=#447700>!         THIS METHOD IS REPEATED FOR THE THREE TEMPERATURE PROFILES<a name='8433'></font>
<font color=#447700>!     GIVEN ABOVE .THEREFORE OUTPUTS FROM THE PROGRAM ARE THREE TABLES<a name='8434'></font>
<font color=#447700>!     OF TRANSMISSION FUNCTIONS FOR THE USER-SUPPLIED PRESSURE GRID.<a name='8435'></font>
<font color=#447700>!     THE EXISTENCE OF THE THREE TABLES PERMITS SUBSEQUENT INTERPO-<a name='8436'></font>
<font color=#447700>!     LATION TO A USER-SUPPLIED TEMPERATURE PROFILE USING THE METHOD<a name='8437'></font>
<font color=#447700>!     DESCRIBED IN THE REFERENCE.SEE LIMITATIONS SECTION IF THE<a name='8438'></font>
<font color=#447700>!     USER DESIRES TO OBTAIN ONLY 1 TABLE OF TRANSMISSIVITIES.<a name='8439'></font>
<font color=#447700>!<a name='8440'></font>
<font color=#447700>!     MODIFICATIONS FOR LAYER-MEAN TRANSMISSIVITIES:<a name='8441'></font>
<font color=#447700>!          THE PRESSURES INPUTTED ARE THE LAYER-MEAN PRESSURES,PD,<a name='8442'></font>
<font color=#447700>!     AND THE LAYER-MEAN PRESSURES ,PLM. A SERIES OF TRANSMISSIVITIES<a name='8443'></font>
<font color=#447700>!     (TAU(P'',PLM(J)) ARE COMPUTED AND THE INTEGRAL GIVEN IN THE<a name='8444'></font>
<font color=#447700>!     DISCUSSION OF PURPOSE 2 IS COMPUTED.FOR PLM(I) NOT EQUAL TO<a name='8445'></font>
<font color=#447700>!     PLM(J) SIMPSON S RULE IS USED WITH 5 POINTS. IF PLM(I)=PLM(J)<a name='8446'></font>
<font color=#447700>!     (THE -NEARBY LAYER- CASE) A 49-POINT QUADRATURE IS USED FOR<a name='8447'></font>
<font color=#447700>!     GREATER ACCURACY.THE OUTPUT IS IN TAULM(PLM(I),PLM(J)).<a name='8448'></font>
<font color=#447700>!        NOTE:<a name='8449'></font>
<font color=#447700>!     TAULM IS NOT A SYMMETRICAL MATRIX. FOR THE ARRAY ELEMENT<a name='8450'></font>
<font color=#447700>!     TAULM(PLM(I),PLM(J)),THE INNER(FIRST,MOST RAPIDLY VARYING)<a name='8451'></font>
<font color=#447700>!     DIMENSION IS THE VARYING LAYER-MEAN PRESSURE,PLM(I);THE OUTER<a name='8452'></font>
<font color=#447700>!     (SECOND) DIMENSION IS THE FIXED LAYER-MEAN PRESSURE PLM(J).<a name='8453'></font>
<font color=#447700>!     THUS THE ELEMENT TAULM(2,3) IS THE TRANSMISSION FUNCTION BETWEEN<a name='8454'></font>
<font color=#447700>!     THE FIXED PRESSURE PLM(3)  AND THE PRESSURE LAYER HAVING AN AVERAG<a name='8455'></font>
<font color=#447700>!     PRESSURE OF PLM(2).<a name='8456'></font>
<font color=#447700>!         ALSO NOTE THAT NO QUADRATURE IS PERFORMED OVER THE LAYER<a name='8457'></font>
<font color=#447700>!     BETWEEN THE SMALLEST NONZERO PRESSURE AND ZERO PRESSURE;<a name='8458'></font>
<font color=#447700>!     TAULM IS TAULM(0,PLM(J)) IN THIS CASE,AND TAULM(0,0)=1.<a name='8459'></font>
<font color=#447700>!<a name='8460'></font>
<font color=#447700>!<a name='8461'></font>
<font color=#447700>!             REFERENCE:<a name='8462'></font>
<font color=#447700>!         S.B.FELS AND M.D.SCHWARZKOPF,-AN EFFICIENT ACCURATE<a name='8463'></font>
<font color=#447700>!     ALGORITHM FOR CALCULATING CO2 15 UM BAND COOLING RATES-,JOURNAL<a name='8464'></font>
<font color=#447700>!     OF GEOPHYSICAL RESEARCH,VOL.86,NO. C2, PP.1205-1232,1981.<a name='8465'></font>
<font color=#447700>!        MODIFICATIONS TO THE ALGORITHM HAVE BEEN MADE BY THE AUTHORS;<a name='8466'></font>
<font color=#447700>!     CONTACT S.B.F.OR M.D.S. FOR FURTHER DETAILS.A NOTE TO J.G.R.<a name='8467'></font>
<font color=#447700>!     IS PLANNED TO DOCUMENT THESE CHANGES.<a name='8468'></font>
<font color=#447700>!<a name='8469'></font>
<font color=#447700>!            AUTHOR:    M.DANIEL SCHWARZKOPF<a name='8470'></font>
<font color=#447700>!<a name='8471'></font>
<font color=#447700>!            DATE:      14 JULY 1983<a name='8472'></font>
<font color=#447700>!<a name='8473'></font>
<font color=#447700>!            ADDRESS:<a name='8474'></font>
<font color=#447700>!<a name='8475'></font>
<font color=#447700>!                      G.F.D.L.<a name='8476'></font>
<font color=#447700>!                      P.O.BOX 308<a name='8477'></font>
<font color=#447700>!                      PRINCETON,N.J.08540<a name='8478'></font>
<font color=#447700>!                      U.S.A.<a name='8479'></font>
<font color=#447700>!            TELEPHONE:  (609) 452-6521<a name='8480'></font>
<font color=#447700>!<a name='8481'></font>
<font color=#447700>!            INFORMATION ON TAPE: THIS SOURCE IS THE FIRST FILE<a name='8482'></font>
<font color=#447700>!        ON THIS TAPE.THE SIX FILES THAT FOLLOW ARE CO2 TRANS-<a name='8483'></font>
<font color=#447700>!        MISSIVITIES FOR THE 500-850 CM-1 INTERVAL FOR CO2<a name='8484'></font>
<font color=#447700>!        CONCENTRATIONS OF 330 PPMV (1X) ,660 PPMV (2X), AND<a name='8485'></font>
<font color=#447700>!        1320 PPMV (4X). THE FILES ARE ARRANGED AS FOLLOWS:<a name='8486'></font>
<font color=#447700>!          FILE 2   1X,CONSOLIDATED USING B(250) WEIGHTING FCTN.<a name='8487'></font>
<font color=#447700>!          FILE 3   1X,CONSOLIDATED WITH NO WEIGHTING FCTN.<a name='8488'></font>
<font color=#447700>!          FILE 4   2X,CONSOLIDATED USING B(250) WEIGHTING FCTN.<a name='8489'></font>
<font color=#447700>!          FILE 5   2X,CONSOLIDATED WITH NO WEIGHTING FCTN.<a name='8490'></font>
<font color=#447700>!          FILE 6   4X,CONSOLIDATED USING B(250) WEIGHTING FCTN.<a name='8491'></font>
<font color=#447700>!          FILE 7   4X,CONSOLIDATED WITH NO WEIGHTING FCTN.<a name='8492'></font>
<font color=#447700>!            FILES 2,4,6 ARE RECOMMENDED FOR USE IN OBTAINING<a name='8493'></font>
<font color=#447700>!        TRANSMISSION FUNCTIONS FOR USE IN HEATING RATE<a name='8494'></font>
<font color=#447700>!        COMPUTATIONS;THEY CORRESPOND TO THE TRANSMISSIVITIES<a name='8495'></font>
<font color=#447700>!        DISCUSSED IN THE 1980 PAPER.FILES 3,5,7 ARE PROVIDED<a name='8496'></font>
<font color=#447700>!        TO FACILITATE COMPARISON WITH OBSERVATION AND WITH OTHER<a name='8497'></font>
<font color=#447700>!        CALCULATIONS.<a name='8498'></font>
<font color=#447700>!<a name='8499'></font>
<font color=#447700>!            PROGRAM LANGUAGE: FORTRAN 1977,INCLUDING PARAMETER<a name='8500'></font>
<font color=#447700>!        AND PROGRAM STATEMENTS.THE PROGRAM IS WRITTEN ON A<a name='8501'></font>
<font color=#447700>!        CYBER 170-730.SEE THE SECTION ON LIMITATIONS FOR<a name='8502'></font>
<font color=#447700>!        ADAPTATIONS TO OTHER MACHINES.<a name='8503'></font>
<font color=#447700>!<a name='8504'></font>
<font color=#447700>!          INPUT UNITS,FORMATS AND FORMAT STATEMENT NOS:<a name='8505'></font>
<font color=#447700>!<a name='8506'></font>
<font color=#447700>!   UNIT NO    VARIABLES       FORMAT      STATEMENT NO.    TYPE<a name='8507'></font>
<font color=#447700>!      5        P (PURPOSE 1)  (5E16.9)        201         CARDS<a name='8508'></font>
<font color=#447700>!      5        PD (PURPOSE 2) (5E16.9)        201         CARDS<a name='8509'></font>
<font color=#447700>!      5        PLM(PURPOSE 2) (5E16.9)        201         CARDS<a name='8510'></font>
<font color=#447700>!      5        NMETHD         (I3)            202         CARDS<a name='8511'></font>
<font color=#447700>!      20       TRANSA         (4F20.14)       102          TAPE<a name='8512'></font>
<font color=#447700>!NOV89<a name='8513'></font>
<font color=#447700>!      ITAPE    TRANSA         (4F20.14)       102          TAPE<a name='8514'></font>
<font color=#447700>!NOV89<a name='8515'></font>
<font color=#447700>!<a name='8516'></font>
<font color=#447700>!         OUTPUT UNITS,FORMATS AND FORMAT STATEMENT NOS:<a name='8517'></font>
<font color=#447700>!<a name='8518'></font>
<font color=#447700>!   UNIT NO    VARIABLES       FORMAT     STATEMENT NO.<a name='8519'></font>
<font color=#447700>!      6         TRNFCT        (1X,8F15.8)     301         PRINT<a name='8520'></font>
<font color=#447700>!      22        TRNFCT        (4F20.14)       102          TAPE<a name='8521'></font>
<font color=#447700>!<a name='8522'></font>
<font color=#447700>!            PARAMETER INPUTS:<a name='8523'></font>
<font color=#447700>!     A) NLEVLS    : NLEVLS IS AN (INTEGER) PARAMETER DENOTING<a name='8524'></font>
<font color=#447700>!        THE NUMBER OF NONZERO PRESSURE LEVELS FOR PURPOSE 1<a name='8525'></font>
<font color=#447700>!        OR THE NUMBER OF NONZERO LAYER PRESSURES NEEDED TO<a name='8526'></font>
<font color=#447700>!        SPECIFY THE PRESSURE LAYERS(PURPOSE 2) IN THE OUTPUT<a name='8527'></font>
<font color=#447700>!        GRID. FOR EXAMPLE,IN PURPOSE 1,IF P=0,100,1000,NLEVLS=2.<a name='8528'></font>
<font color=#447700>!        IF,IN PURPOSE 2,PD=0,100,500,1000,THE NUMBER OF NONZERO<a name='8529'></font>
<font color=#447700>!        PRESSURE LAYERS=2,SO NLEVLS=2<a name='8530'></font>
<font color=#447700>!           IN THE CODE AS WRITTEN,NLEVLS=40; THE USER SHOULD<a name='8531'></font>
<font color=#447700>!        CHANGE THIS VALUE TO A USER-SPECIFIED VALUE.<a name='8532'></font>
<font color=#447700>!     B) NLP1,NLP2 : INTEGER PARAMETERS DEFINED AS: NLP1=NLEVLS+1;<a name='8533'></font>
<font color=#447700>!        NLP2=NLEVLS+2.<a name='8534'></font>
<font color=#447700>!           SEE LIMITATIONS FOR CODE MODIFICATIONS IF PARAMETER<a name='8535'></font>
<font color=#447700>!        STATEMENTS ARE NOT ALLOWED ON YOUR MACHINE.<a name='8536'></font>
<font color=#447700>!<a name='8537'></font>
<font color=#447700>!            INPUTS:<a name='8538'></font>
<font color=#447700>!<a name='8539'></font>
<font color=#447700>!     A) TRANSA    : THE 109X109 GRID OF TRANSMISSION FUNCTIONS<a name='8540'></font>
<font color=#447700>!            TRANSA IS A  DOUBLE PRECISION REAL ARRAY.<a name='8541'></font>
<font color=#447700>!<a name='8542'></font>
<font color=#447700>!           TRANSA  IS READ FROM FILE 20. THIS FILE CONTAINS 3<a name='8543'></font>
<font color=#447700>!     RECORDS,AS FOLLOWS:<a name='8544'></font>
<font color=#447700>!        1)   TRANSA, STANDARD TEMPERATURE PROFILE<a name='8545'></font>
<font color=#447700>!        3)   TRANSA, STANDARD TEMPERATURES + 25 DEG<a name='8546'></font>
<font color=#447700>!        5)   TRANSA, STANDARD TEMPERATURES - 25 DEG<a name='8547'></font>
<font color=#447700>!<a name='8548'></font>
<font color=#447700>!     B)   NMETHD: AN INTEGER WHOSE VALUE IS EITHER 1 (IF CO2INT IS<a name='8549'></font>
<font color=#447700>!       TO BE USED FOR PURPOSE 1) OR 2 (IF CO2INT IS TO BE USED FOR<a name='8550'></font>
<font color=#447700>!       PURPOSE 2).<a name='8551'></font>
<font color=#447700>!<a name='8552'></font>
<font color=#447700>!     C)     P,PD,PLM :<a name='8553'></font>
<font color=#447700>!          P IS A REAL ARRAY (LENGTH NLP1) SPECIFYING THE PRESSURE<a name='8554'></font>
<font color=#447700>!       GRID AT WHICH TRANSMISSION FUNCTIONS ARE TO BE COMPUTED FOR<a name='8555'></font>
<font color=#447700>!       PURPOSE 1.THE DIMENSION  OF P IS  IN MILLIBARS.THE<a name='8556'></font>
<font color=#447700>!       FOLLOWING LIMITATIONS WILL BE EXPLAINED MORE<a name='8557'></font>
<font color=#447700>!       IN THE SECTION ON LIMITATIONS: P(1) MUST BE ZERO; P(NLP1),THE<a name='8558'></font>
<font color=#447700>!       LARGEST PRESSURE, MUST NOT EXCEED 1165 MILLIBARS.<a name='8559'></font>
<font color=#447700>!         PD IS A REAL ARRAY (LENGTH NLP2) SPECIFYING THE PRESSURE<a name='8560'></font>
<font color=#447700>!       LAYERS FOR WHICH LAYER-AVERAGED TRANSMISSION FUNCTIONS ARE<a name='8561'></font>
<font color=#447700>!       TO BE COMPUTED.THE DIMENSION OF PD IS MILLIBARS.THE LIMITATIONS<a name='8562'></font>
<font color=#447700>!       FOR PD ARE THE SAME AS FOR P,AND ARE GIVEN IN THE SECTION ON<a name='8563'></font>
<font color=#447700>!       LIMITATIONS.<a name='8564'></font>
<font color=#447700>!         PLM IS A REAL ARRAY (LENGTH NLP2) SPECIFYING THE LAYER-MEAN<a name='8565'></font>
<font color=#447700>!       PRESSURES. THE DIMENSION OF PLM IS MILLIBARS. THE LIMITATIONS<a name='8566'></font>
<font color=#447700>!       FOR PLM ARE THE SAME AS FOR P,AND ARE GIVEN IN THE SECTION ON<a name='8567'></font>
<font color=#447700>!       LIMITATIONS.PD IS READ IN BEFORE PLM.<a name='8568'></font>
<font color=#447700>!<a name='8569'></font>
<font color=#447700>!          NOTE: AGAIN,WE NOTE THAT THE USER WILL INPUT EITHER P (FOR<a name='8570'></font>
<font color=#447700>!       PURPOSE 1) OR PD AND PLM(FOR PURPOSE 2) BUT NOT BOTH.<a name='8571'></font>
<font color=#447700>!<a name='8572'></font>
<font color=#447700>!<a name='8573'></font>
<font color=#447700>!<a name='8574'></font>
<font color=#447700>!<a name='8575'></font>
<font color=#447700>!           LIMITATIONS:<a name='8576'></font>
<font color=#447700>!     1)       P(1)=0.,PD(1)=0.,PLM(1)=0. THE TOP PRESSURE LEVEL<a name='8577'></font>
<font color=#447700>!       MUST BE ZERO,OR THE TOP PRESSURE LAYER MUST BE BOUNDED BY ZERO.<a name='8578'></font>
<font color=#447700>!       THE TOP LAYER-MEAN PRESSURE (PLM(1)) MUST BE ZERO; NO<a name='8579'></font>
<font color=#447700>!       QUADRATURE IS DONE ON THE TOP PRESSURE LAYER.EVEN IF ONE IS<a name='8580'></font>
<font color=#447700>!       NOT INTERESTED IN THE TRANSMISSION FUNCTION BETWEEN 0 AND P(J),<a name='8581'></font>
<font color=#447700>!       ONE MUST INCLUDE SUCH A LEVEL.<a name='8582'></font>
<font color=#447700>!     2)      PD(NLP2)=P(NLP1) IS LESS THAN OR EQUAL TO 1165 MB.<a name='8583'></font>
<font color=#447700>!       EXTRAPOLATION TO HIGHER PRESSURES IS NOT POSSIBLE.<a name='8584'></font>
<font color=#447700>!     3)      IF PROGRAM IS NOT PERMITTED ON YOUR COMPILER,<a name='8585'></font>
<font color=#447700>!       SIMPLY DELETE THE LINE.<a name='8586'></font>
<font color=#447700>!     4)      IF PARAMETER IS NOT PERMITTED,DO THE FOLLOWING:<a name='8587'></font>
<font color=#447700>!            1) DELETE ALL PARAMETER STATEMENTS IN CO2INT<a name='8588'></font>
<font color=#447700>!            2) AT THE POINT WHERE NMETHOD IS READ IN,ADD:<a name='8589'></font>
<font color=#447700>!                READ (5,202) NLEVLS<a name='8590'></font>
<font color=#447700>!                NLP1=NLEVLS+1<a name='8591'></font>
<font color=#447700>!                NLP2=NLEVLS+2<a name='8592'></font>
<font color=#447700>!            3) CHANGE DIMENSION AND/OR COMMON STATEMENTS DEFINING<a name='8593'></font>
<font color=#447700>!              ARRAYS TRNS,DELTA,P,PD,TRNFCT,PS,PDS,PLM IN CO2INT.<a name='8594'></font>
<font color=#447700>!              THE NUMERICAL VALUE OF (NLEVLS+1) SHOULD BE INSERTED<a name='8595'></font>
<font color=#447700>!              IN DIMENSION OR COMMON STATEMENTS FOR TRNS,DELTA,<a name='8596'></font>
<font color=#447700>!              P,TRNFCT,PS,PLM; THE NUMERICAL VALUE OF (NLEVLS+2)<a name='8597'></font>
<font color=#447700>!              IN DIMENSION OR COMMON STATEMENTS FOR PD,PDS.<a name='8598'></font>
<font color=#447700>!      5)    PARAMETER (NLEVLS=40) AND THE OTHER PARAMETER<a name='8599'></font>
<font color=#447700>!       STATEMENTS ARE WRITTEN IN CDC FORTRAN; ON OTHER MACHINES THE<a name='8600'></font>
<font color=#447700>!       SAME STATEMENT MAY BE WRITTEN DIFFERENTLY,FOR EXAMPLE AS<a name='8601'></font>
<font color=#447700>!       PARAMETER   NLEVLS=40<a name='8602'></font>
<font color=#447700>!      6) -DOUBLE PRECISION- IS USED INSTEAD OF -REAL*8- ,DUE TO<a name='8603'></font>
<font color=#447700>!       REQUIREMENTS OF CDC FORTAN.<a name='8604'></font>
<font color=#447700>!      7) THE STATEMENT -DO 400 KKK=1,3- CONTROLS THE NUMBER OF<a name='8605'></font>
<font color=#447700>!       TRANSMISSIVITY OUTPUT MATRICES PORDUCED BY THE PROGRAM.TO<a name='8606'></font>
<font color=#447700>!       PRODUCE 1 OUTPUT MATRIX,DELETE THIS STATEMENT.<a name='8607'></font>
<font color=#447700>!<a name='8608'></font>
<font color=#447700>!     OUTPUT:<a name='8609'></font>
<font color=#447700>!         A) TRNFCT IS AN (NLP1,NLP1) REAL ARRAY OF THE TRANSMISSION<a name='8610'></font>
<font color=#447700>!     FUNCTIONS APPROPRIATE TO YOUR ARRAY. IT IS TO BE SAVED ON FILE 22.<a name='8611'></font>
<font color=#447700>!     THE PROCEDURE FOR SAVING MAY BE MODIFIED; AS GIVEN HERE,THE<a name='8612'></font>
<font color=#447700>!     OUTPUT IS IN CARD IMAGE FORM WITH A FORMAT OF (4F20.14).<a name='8613'></font>
<font color=#447700>!<a name='8614'></font>
<font color=#447700>!         B)  PRINTED  OUTPUT IS A LISTING OF TRNFCT ON UNIT 6, IN<a name='8615'></font>
<font color=#447700>!     THE FORMAT (1X,8F15.8) (FORMAT STATEMENT 301). THE USER MAY<a name='8616'></font>
<font color=#447700>!     MODIFY OR ELIMINATE THIS AT WILL.<a name='8617'></font>
<font color=#447700>!<a name='8618'></font>
<font color=#447700>!      ************   FUNCTION INTERPOLATER ROUTINE  *****************<a name='8619'></font>
<font color=#447700>!<a name='8620'></font>
<font color=#447700>!<a name='8621'></font>
<font color=#447700>!     ******   THE FOLLOWING PARAMETER GIVES THE NUMBER OF     *******<a name='8622'></font>
<font color=#447700>!     ******           DATA LEVELS IN THE MODEL                *******<a name='8623'></font>
<font color=#447700>!     ****************************************************************<a name='8624'></font>
<font color=#447700>!     ****************************************************************<a name='8625'></font>
      COMMON/INPUT/P1,P2,TRNSLO,IA,JA,N<a name='8626'>
<font color=#447700>!     COMMON/PRESS/PA(109)<a name='8627'></font>
<font color=#447700>!     COMMON/TRAN/ TRANSA(109,109)<a name='8628'></font>
<font color=#447700>!     COMMON / OUTPUT / TRNS(NLP1,NLP1)<a name='8629'></font>
<font color=#447700>!     COMMON/INPUTP/P(NLP1),PD(NLP2)<a name='8630'></font>
      DIMENSION TRNS(NLP1,NLP1)<a name='8631'>
      DIMENSION P(NLP1),PD(NLP2)<a name='8632'>
      DIMENSION PS(NLP1),PDS(NLP2),PLM(NLP1)<a name='8633'>
      DIMENSION NRTAB(3)<a name='8634'>
      DIMENSION T15A(NLP2,2),T15B(NLP1)<a name='8635'>
      DIMENSION T22(NLP1,NLP1,3)<a name='8636'>
      LOGICAL , EXTERNAL      :: wrf_dm_on_monitor<a name='8637'>
      DATA NRTAB/1,2,4/<a name='8638'>
<font color=#447700>!***********************************<a name='8639'></font>
<font color=#447700>!   THE FOLLOWING ARE THE INPUT FORMATS<a name='8640'></font>
100   FORMAT (4F20.14)<a name='8641'>
743   FORMAT (F20.14)<a name='8642'>
201   FORMAT (5E16.9)<a name='8643'>
202   FORMAT (I3)<a name='8644'>
<font color=#447700>!O222   203   FORMAT (F12.6,I2)<a name='8645'></font>
203   FORMAT (F12.6)<a name='8646'>
<font color=#447700>!    THE FOLLOWING ARE THE OUTPUT FORMATS<a name='8647'></font>
102   FORMAT (4F20.14)<a name='8648'>
301   FORMAT (1X,8F15.8)<a name='8649'>
<font color=#447700>!<a name='8650'></font>
<font color=#447700>!CC   REWIND 15<a name='8651'></font>
<font color=#447700>!CC   REWIND 20<a name='8652'></font>
<font color=#447700>!NOV89<a name='8653'></font>
      REWIND ITAPE<a name='8654'>
<font color=#447700>!NOV89<a name='8655'></font>
<font color=#447700>!CC   REWIND 22<a name='8656'></font>
<font color=#447700>!<a name='8657'></font>
<font color=#447700>!     CALCULATION OF PA -THE -TABLE- OF 109 GRID PRESSURES<a name='8658'></font>
<font color=#447700>!     NOTE-THIS CODE MUST NOT BE CHANGED BY THE USER^^^^^^^^^<a name='8659'></font>
      PA(1)=0.<a name='8660'>
      FACT15=10.**(1./15.)<a name='8661'>
      FACT30=10.**(1./30.)<a name='8662'>
      PA(2)=1.0E-3<a name='8663'>
      DO 231 I=2,76<a name='8664'>
      PA(I+1)=PA(I)*FACT15<a name='8665'>
231   CONTINUE<a name='8666'>
      DO 232 I=77,108<a name='8667'>
      PA(I+1)=PA(I)*FACT30<a name='8668'>
232   CONTINUE<a name='8669'>
<font color=#447700>!<a name='8670'></font>
      N=25<a name='8671'>
      NLV=NLEVLS<a name='8672'>
      NLP1V=NLP1<a name='8673'>
      NLP2V=NLP2<a name='8674'>
<font color=#447700>!     READ IN THE CO2 MIXING RATIO(IN UNITS OF 330 PPMV),AND AN INDEX<a name='8675'></font>
<font color=#447700>!     GIVING THE FREQUENCY RANGE OF THE LBL DATA<a name='8676'></font>
<font color=#447700>!O222    READ (5,203) RATIO,IR<a name='8677'></font>
<font color=#447700>!CC         IR = 1<a name='8678'></font>
<font color=#447700>!CC         READ (5,203) RATIO<a name='8679'></font>
<font color=#447700>!O222   ***********************************<a name='8680'></font>
<font color=#447700>!***VALUES FOR IR*****<a name='8681'></font>
<font color=#447700>!          IR=1     CONSOL. LBL TRANS. =490-850<a name='8682'></font>
<font color=#447700>!          IR=2     CONSOL. LBL TRANS. =490-670<a name='8683'></font>
<font color=#447700>!          IR=3     CONSOL. LBL TRANS. =670-850<a name='8684'></font>
<font color=#447700>!          IR=4     CONSOL. LBL TRANS. =2270-2380<a name='8685'></font>
<font color=#447700>!*** IR MUST BE 1,2,3 OR 4 FOR THE PGM. TO WORK<a name='8686'></font>
<font color=#447700>!     ALSO READ IN THE METHOD NO.(1 OR 2)<a name='8687'></font>
<font color=#447700>!CC         READ (5,202) NMETHD<a name='8688'></font>
      IF (RATIO.EQ.1.0) GO TO 621<a name='8689'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_163">( 'SUBROUTINE CO2INT: 8746' )<a name='8690'>
<font color=#447700>!NOV89  621   ITAP1=20<a name='8691'></font>
621   ITAP1=ITAPE<a name='8692'>
<font color=#447700>!NOV89<a name='8693'></font>
      NTAP=1<a name='8694'>
      IF (NMETHD.EQ.2) GO TO 502<a name='8695'>
<font color=#447700>!   *****CARDS FOR PURPOSE 1(NMETHD=1)<a name='8696'></font>
<font color=#447700>!CC         READ (15,201) (P(I),I=1,NLP1)<a name='8697'></font>
      DO 300 I=1,NLP1<a name='8698'>
        P(I)=T15B(I)<a name='8699'>
  300 CONTINUE<a name='8700'>
      DO 801 I=1,NLP1<a name='8701'>
      PS(I)=P(I)<a name='8702'>
801   CONTINUE<a name='8703'>
      GO TO 503<a name='8704'>
502   CONTINUE<a name='8705'>
<font color=#447700>!  *****CARDS FOR PURPOSE 2(NMETHD=2)<a name='8706'></font>
<font color=#447700>!CC         READ (15,201) (PD(I),I=1,NLP2)<a name='8707'></font>
<font color=#447700>!CC         READ (15,201) (PLM(I),I=1,NLP1)<a name='8708'></font>
      DO 303 I=1,NLP2<a name='8709'>
        PD(I)=T15A(I,1)<a name='8710'>
  303 CONTINUE<a name='8711'>
      DO 302 I=1,NLP1<a name='8712'>
        PLM(I)=T15A(I,2)<a name='8713'>
  302 CONTINUE<a name='8714'>
      DO 802 I=1,NLP1<a name='8715'>
      PDS(I)=PD(I+1)<a name='8716'>
      PS(I)=PLM(I)<a name='8717'>
802   CONTINUE<a name='8718'>
<font color=#447700>!<a name='8719'></font>
503   CONTINUE<a name='8720'>
<font color=#447700>!  *****DO LOOP CONTROLLING NUMBER OF OUTPUT MATRICES<a name='8721'></font>
<font color=#447700>!NOV89<a name='8722'></font>
<font color=#447700>!NOV89    DO 400 KKK=1,3<a name='8723'></font>
      ICLOOP = 3<a name='8724'>
      IF (IR.EQ.4) ICLOOP = 1<a name='8725'>
      DO 400 KKK=1,ICLOOP<a name='8726'>
<font color=#447700>!NOV89<a name='8727'></font>
<font color=#447700>!  **********************<a name='8728'></font>
      IF (NMETHD.EQ.2) GO TO 505<a name='8729'>
<font color=#447700>!   *****CARDS FOR PURPOSE 1(NMETHD=1)<a name='8730'></font>
      DO 803 I=1,NLP1<a name='8731'>
      P(I)=PS(I)<a name='8732'>
803   CONTINUE<a name='8733'>
      GO TO 506<a name='8734'>
505   CONTINUE<a name='8735'>
<font color=#447700>!  *****CARDS FOR PURPOSE 2(NMETHD=2)<a name='8736'></font>
      DO 804 I=1,NLP1<a name='8737'>
      PD(I)=PDS(I)<a name='8738'>
      P(I)=PS(I)<a name='8739'>
804   CONTINUE<a name='8740'>
<font color=#447700>!<a name='8741'></font>
506   CONTINUE<a name='8742'>
      IA=108<a name='8743'>
      IAP=IA+1<a name='8744'>
<font color=#447700>!NOV89   IF (NTAP.EQ.1) READ (20,100) ((TRANSA(I,J),I=1,109),J=1,109)<a name='8745'></font>
<font color=#447700>!mp       IF (NTAP.EQ.1) READ (ITAPE,100) ((TRANSA(I,J),I=1,109),J=1,109)<a name='8746'></font>
        IF (NTAP.EQ.1) THEN<a name='8747'>
           IF ( wrf_dm_on_monitor() ) READ (ITAPE,743) ((TRANSA(I,J),I=1,109),J=1,109)<a name='8748'>
           CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_108"> ( TRANSA , size ( TRANSA ) * RWORDSIZE )<a name='8749'>
        ENDIF<a name='8750'>
<font color=#447700>!mp	IF (NTAP.EQ.1) READ (ITAPE,100) (tmp(I),I=1,11881<a name='8751'></font>
<font color=#447700>!mp<a name='8752'></font>
	do J=109,1,-6<a name='8753'>
<font color=#447700>!mp	write(6,697)(TRANSA(I,J),I=5,105,10)<a name='8754'></font>
	enddo<a name='8755'>
 697	format(11(f5.3,1x))<a name='8756'>
<font color=#447700>!mp<a name='8757'></font>
<font color=#447700>!NOV89<a name='8758'></font>
      DO 4 I=1,IAP<a name='8759'>
      TRANSA(I,I)=1.0<a name='8760'>
    4 CONTINUE<a name='8761'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#COEINT'>COEINT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="COEINT_1">(RATIO,IR)<a name='8762'>
      DO 805 I=1,NLP1<a name='8763'>
      DO 805 J=1,NLP1<a name='8764'>
      TRNS(J,I)=1.00<a name='8765'>
805   CONTINUE<a name='8766'>
      DO 10 I=1,NLP1<a name='8767'>
      DO 20 J=1,I<a name='8768'>
      IF (I.EQ.J) GO TO 20<a name='8769'>
      P1=P(J)<a name='8770'>
      P2=P(I)<a name='8771'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#SINTR2'>SINTR2</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SINTR2_1"><a name='8772'>
      TRNS(J,I)=TRNSLO<a name='8773'>
20    CONTINUE<a name='8774'>
10    CONTINUE<a name='8775'>
      DO 47 I=1,NLP1<a name='8776'>
      DO 47 J=I,NLP1<a name='8777'>
      TRNS(J,I)=TRNS(I,J)<a name='8778'>
47    CONTINUE<a name='8779'>
<font color=#447700>!  *****THIS IS THE END OF PURPOSE 1 CALCULATIONS<a name='8780'></font>
      IF (NMETHD.EQ.1) GO TO 2872<a name='8781'>
<font color=#447700>!<a name='8782'></font>
      DO 51 J=1,NLP1<a name='8783'>
      DO 52 I=2,NLP1<a name='8784'>
      IA=I<a name='8785'>
      JA=J<a name='8786'>
      N=25<a name='8787'>
      IF (I.NE.J) N=3<a name='8788'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#QUADSR'>QUADSR</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="QUADSR_1">(NLV,NLP1V,NLP2V,P,PD,TRNS)<a name='8789'>
52    CONTINUE<a name='8790'>
51    CONTINUE<a name='8791'>
<font color=#447700>!  *****THIS IS THE END OF PURPOSE 2 CALCULATIONS<a name='8792'></font>
2872  CONTINUE<a name='8793'>
<font color=#447700>!<a name='8794'></font>
<font color=#447700>!+++  WRITE (6,301) ((TRNS(I,J),I=1,NLP1),J=1,NLP1)<a name='8795'></font>
<font color=#447700>!CC         WRITE (22,102) ((TRNS(I,J),I=1,NLP1),J=1,NLP1)<a name='8796'></font>
      DO 304 J=1,NLP1<a name='8797'>
       DO 304 I=1,NLP1<a name='8798'>
        T22(I,J,KKK) = TRNS(I,J)<a name='8799'>
  304 CONTINUE<a name='8800'>
400   CONTINUE<a name='8801'>
      RETURN<a name='8802'>
      END SUBROUTINE CO2INT<a name='8803'>
<font color=#447700>!CCC  PROGRAM CO2IN1<a name='8804'></font>
<A NAME='CO2IN1'><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2IN1' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8805'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>CO2IN1</font>(T20,T21,T66,IQ,L,LP1) <A href='../../call_to/CO2IN1.html' TARGET='index'>1</A><a name='8806'>
<font color=#447700>!    CO2IN1=CO2INS FOR METHOD 1<a name='8807'></font>
<font color=#447700>!     *********************************************************<a name='8808'></font>
<font color=#447700>!       SAVE DATA ON PERMANENT DATA SET DENOTED BY CO222 ***<a name='8809'></font>
<font color=#447700>!          ..... K.CAMPANA   MARCH 1988,OCTOBER 1988<a name='8810'></font>
<font color=#447700>!          ..... K.CAMPANA   DECEMBER 88 CLEANED UP FOR LAUNCHER<a name='8811'></font>
<font color=#447700>!     *********************************************************<a name='8812'></font>
      DIMENSION T20(LP1,LP1,3),T21(LP1,LP1,3),T66(L,6)<a name='8813'>
      DIMENSION DCDT8(LP1,LP1),DCDT10(LP1,LP1),CO2PO(LP1,LP1), &amp;<a name='8814'>
       CO2800(LP1,LP1),CO2PO1(LP1,LP1),CO2801(LP1,LP1),CO2PO2(LP1,LP1), &amp;<a name='8815'>
       CO2802(LP1,LP1),N(LP1),D2CT8(LP1,LP1),D2CT10(LP1,LP1)<a name='8816'>
      ITIN=20<a name='8817'>
      ITIN1=21<a name='8818'>
<font color=#447700>!O222 LATEST CODE HAS IQ=1<a name='8819'></font>
<font color=#447700>!CC         IQ=4<a name='8820'></font>
1011  FORMAT (4F20.14)<a name='8821'>
<font color=#447700>!CC        READ (ITIN,1011) ((CO2PO(I,J),I=1,LP1),J=1,LP1)<a name='8822'></font>
<font color=#447700>!CC        READ (ITIN1,1011) ((CO2800(I,J),I=1,LP1),J=1,LP1)<a name='8823'></font>
<font color=#447700>!CC        READ (ITIN,1011) ((CO2PO1(I,J),I=1,LP1),J=1,LP1)<a name='8824'></font>
<font color=#447700>!CC        READ (ITIN1,1011) ((CO2801(I,J),I=1,LP1),J=1,LP1)<a name='8825'></font>
<font color=#447700>!CC        READ (ITIN,1011) ((CO2PO2(I,J),I=1,LP1),J=1,LP1)<a name='8826'></font>
<font color=#447700>!CC        READ (ITIN1,1011) ((CO2802(I,J),I=1,LP1),J=1,LP1)<a name='8827'></font>
      DO 300 J=1,LP1<a name='8828'>
        DO 300 I=1,LP1<a name='8829'>
          CO2PO(I,J) = T20(I,J,1)<a name='8830'>
<font color=#447700>!NOV89<a name='8831'></font>
          IF (IQ.EQ.5) GO TO 300<a name='8832'>
<font color=#447700>!NOV89<a name='8833'></font>
          CO2PO1(I,J) = T20(I,J,2)<a name='8834'>
          CO2PO2(I,J) = T20(I,J,3)<a name='8835'>
  300 CONTINUE<a name='8836'>
      DO 301 J=1,LP1<a name='8837'>
        DO 301 I=1,LP1<a name='8838'>
          CO2800(I,J) = T21(I,J,1)<a name='8839'>
<font color=#447700>!NOV89<a name='8840'></font>
          IF (IQ.EQ.5) GO TO 301<a name='8841'>
<font color=#447700>!NOV89<a name='8842'></font>
          CO2801(I,J) = T21(I,J,2)<a name='8843'>
          CO2802(I,J) = T21(I,J,3)<a name='8844'>
  301 CONTINUE<a name='8845'>
<font color=#447700>!***THE FOLLOWING CODE IS REWRITTEN SO THAT THE RADIATIVE BANDS<a name='8846'></font>
<font color=#447700>!   ARE:<a name='8847'></font>
<font color=#447700>!        IQ=1    560-800     (CONSOL.=490-850)<a name='8848'></font>
<font color=#447700>!        IQ=2    560-670     (CONSOL.=490-670)<a name='8849'></font>
<font color=#447700>!        IQ=3    670-800     (CONSOL.=670-850)<a name='8850'></font>
<font color=#447700>!        IQ=4    560-760 (ORIGINAL CODE)   (CONSOL.=490-850)<a name='8851'></font>
<font color=#447700>!NOV89<a name='8852'></font>
<font color=#447700>!        IQ=5   2270-2380    (CONSOL.=2270-2380)<a name='8853'></font>
<font color=#447700>!NOV89<a name='8854'></font>
<font color=#447700>!  THE FOLLOWING LOOP OBTAINS TRANSMISSION FUNCTIONS FOR BANDS<a name='8855'></font>
<font color=#447700>!  USED IN RADIATIVE MODEL CALCULATIONS,WITH THE EQUIVALENT<a name='8856'></font>
<font color=#447700>!  WIDTHS KEPT FROM THE ORIGINAL CONSOLIDATED CO2 TF S.<a name='8857'></font>
      IF (IQ.EQ.1) THEN<a name='8858'>
         C1=1.5<a name='8859'>
         C2x=0.5<a name='8860'>
      ENDIF<a name='8861'>
      IF (IQ.EQ.2) THEN<a name='8862'>
        C1=18./11.<a name='8863'>
        C2x=7./11.<a name='8864'>
      ENDIF<a name='8865'>
      IF (IQ.EQ.3) THEN<a name='8866'>
        C1=18./13.<a name='8867'>
        C2x=5./13.<a name='8868'>
      ENDIF<a name='8869'>
      IF (IQ.EQ.4) THEN<a name='8870'>
        C1=1.8<a name='8871'>
        C2x=0.8<a name='8872'>
      ENDIF<a name='8873'>
<font color=#447700>!NOV89<a name='8874'></font>
      IF (IQ.EQ.5) THEN<a name='8875'>
        C1=1.0<a name='8876'>
        C2x=0.0<a name='8877'>
      ENDIF<a name='8878'>
<font color=#447700>!NOV89<a name='8879'></font>
      DO 1021 I=1,LP1<a name='8880'>
      DO 1021 J=1,LP1<a name='8881'>
      CO2PO(J,I)=C1*CO2PO(J,I)-C2x<a name='8882'>
      CO2800(J,I)=C1*CO2800(J,I)-C2x<a name='8883'>
<font color=#447700>!NOV89<a name='8884'></font>
      IF (IQ.EQ.5) GO TO 1021<a name='8885'>
<font color=#447700>!NOV89<a name='8886'></font>
      CO2PO1(J,I)=C1*CO2PO1(J,I)-C2x<a name='8887'>
      CO2801(J,I)=C1*CO2801(J,I)-C2x<a name='8888'>
      CO2PO2(J,I)=C1*CO2PO2(J,I)-C2x<a name='8889'>
      CO2802(J,I)=C1*CO2802(J,I)-C2x<a name='8890'>
1021  CONTINUE<a name='8891'>
<font color=#447700>!NOV89<a name='8892'></font>
      IF (IQ.GE.1.AND.IQ.LE.4) THEN<a name='8893'>
<font color=#447700>!NOV89<a name='8894'></font>
      DO 1 J=1,LP1<a name='8895'>
      DO 1 I=1,LP1<a name='8896'>
      DCDT8(I,J)=.02*(CO2801(I,J)-CO2802(I,J))*100.<a name='8897'>
      DCDT10(I,J)=.02*(CO2PO1(I,J)-CO2PO2(I,J))*100.<a name='8898'>
      D2CT8(I,J)=.0016*(CO2801(I,J)+CO2802(I,J)-2.*CO2800(I,J))*1000.<a name='8899'>
      D2CT10(I,J)=.0016*(CO2PO1(I,J)+CO2PO2(I,J)-2.*CO2PO(I,J))*1000.<a name='8900'>
1     CONTINUE<a name='8901'>
<font color=#447700>!NOV89<a name='8902'></font>
      ENDIF<a name='8903'>
<font color=#447700>!NOV89<a name='8904'></font>
<font color=#447700>!O222 *********************************************************<a name='8905'></font>
<font color=#447700>!CC          REWIND 66<a name='8906'></font>
<font color=#447700>!        SAVE CDTM51,CO2M51,C2DM51,CDTM58,CO2M58,C2DM58..ON TEMPO FILE<a name='8907'></font>
<font color=#447700>!CC          WRITE (66) (DCDT10(I,I+1),I=1,L)<a name='8908'></font>
<font color=#447700>!CC          WRITE (66) (CO2PO(I,I+1),I=1,L)<a name='8909'></font>
<font color=#447700>!CC          WRITE (66) (D2CT10(I,I+1),I=1,L)<a name='8910'></font>
<font color=#447700>!CC          WRITE (66) (DCDT8(I,I+1),I=1,L)<a name='8911'></font>
<font color=#447700>!CC          WRITE (66) (CO2800(I,I+1),I=1,L)<a name='8912'></font>
<font color=#447700>!CC          WRITE (66) (D2CT8(I,I+1),I=1,L)<a name='8913'></font>
<font color=#447700>!CC          REWIND 66<a name='8914'></font>
<font color=#447700>!O222 *********************************************************<a name='8915'></font>
      DO 400 I=1,L<a name='8916'>
        T66(I,2) = CO2PO(I,I+1)<a name='8917'>
        T66(I,5) = CO2800(I,I+1)<a name='8918'>
<font color=#447700>!NOV89<a name='8919'></font>
        IF (IQ.EQ.5) GO TO 400<a name='8920'>
<font color=#447700>!NOV89<a name='8921'></font>
        T66(I,1) = DCDT10(I,I+1)<a name='8922'>
        T66(I,3) = D2CT10(I,I+1)<a name='8923'>
        T66(I,4) = DCDT8(I,I+1)<a name='8924'>
        T66(I,6) = D2CT8(I,I+1)<a name='8925'>
  400 CONTINUE<a name='8926'>
      RETURN<a name='8927'>
      END SUBROUTINE CO2IN1<a name='8928'>
<font color=#447700>!CCC  PROGRAM PTZ - COURTESY OF DAN SCHWARZKOPF,GFDL DEC 1987....<a name='8929'></font>
<A NAME='CO2PTZ'><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8930'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>CO2PTZ</font>(SGTEMP,T41,T42,T43,T44,SGLVNU,SIGLNU, &amp; <A href='../../call_to/CO2PTZ.html' TARGET='index'>1</A>,<A href='../../call_from/CO2PTZ.html' TARGET='index'>7</A><a name='8931'>
                        SFULL,SHALF,PPTOP,LREAD,NL,NLP,NLP2)<a name='8932'>
<font color=#447700>!<a name='8933'></font>
<font color=#447700>! **         THIS PROGRAM CALCULATES TEMPERATURES ,H2O MIXING RATIOS<a name='8934'></font>
<font color=#447700>! **         AND O3 MIXING RATIOS BY USING AN ANALYTICAL<a name='8935'></font>
<font color=#447700>! **         FUNCTION WHICH APPROXIMATES<a name='8936'></font>
<font color=#447700>! **         THE US STANDARD (1976).  THIS IS<a name='8937'></font>
<font color=#447700>! **         CALCULATED IN FUNCTION 'ANTEMP', WHICH IS CALLED BY THE<a name='8938'></font>
<font color=#447700>! **         MAIN PROGRAM.  THE FORM OF THE ANALYTICAL FUNCTION WAS<a name='8939'></font>
<font color=#447700>! **         SUGGESTED TO ME IN 1971 BY RICHARD S. LINDZEN.<a name='8940'></font>
<font color=#447700>! ******************************************************************<a name='8941'></font>
<font color=#447700>!         CODE TO SAVE STEMP,GTEMP ON DATA SET,BRACKETED BY CO222  **<a name='8942'></font>
<font color=#447700>!             ....K. CAMPANA MARCH 88,OCTOBER 88<a name='8943'></font>
      DIMENSION SGTEMP(NLP,2),T41(NLP2,2),T42(NLP), &amp;<a name='8944'>
                T43(NLP2,2),T44(NLP)<a name='8945'>
      DIMENSION SGLVNU(NLP),SIGLNU(NL)<a name='8946'>
      DIMENSION SFULL(NLP),SHALF(NL)<a name='8947'>
<font color=#447700>! ******************************************************************<a name='8948'></font>
<font color=#447700>!<a name='8949'></font>
<font color=#447700>!*****THIS VERSION IS ONLY USABLE FOR 1976 US STD ATM AND OBTAINS<a name='8950'></font>
<font color=#447700>!     QUANTITIES FOR CO2 INTERPOLATION AND INSERTION INTO OPERA-<a name='8951'></font>
<font color=#447700>!     TIONAL RADIATION CODES<a name='8952'></font>
<font color=#447700>!<a name='8953'></font>
      CHARACTER*20 PROFIL<a name='8954'>
      DIMENSION PRESS(NLP),TEMP(NLP),ALT(NLP),WMIX(NLP),O3MIX(NLP)<a name='8955'>
      DIMENSION WMXINT(NLP,4),WMXOUT(NLP2),OMXINT(NLP,4),OMXOUT(NLP2)<a name='8956'>
      DIMENSION PD(NLP2),GTEMP(NLP)<a name='8957'>
      DIMENSION PRS(NLP),TEMPS(NLP),PRSINT(NLP),TMPINT(NLP,4),A(NLP,4)<a name='8958'>
      DIMENSION PROUT(NLP2),TMPOUT(NLP2),TMPFLX(NLP2),TMPMID(NLP2)<a name='8959'>
<font color=#447700>!<a name='8960'></font>
<font color=#447700>!<a name='8961'></font>
      DATA PROFIL/ &amp;<a name='8962'>
         'US STANDARD 1976'/<a name='8963'>
      DATA PSMAX/1013.250/<a name='8964'>
<font color=#447700>!<a name='8965'></font>
<font color=#447700>! **         NTYPE IS AN INTEGER VARIABLE WHICH HAS THE FOLLOWING<a name='8966'></font>
<font color=#447700>! **        VALUES:    0 =SIGMA LEVELS ARE USED;   1= SKYHI L40 LEVELS<a name='8967'></font>
<font color=#447700>! **        ARE USED;   2 = SKYHI L80 LEVELS ARE USED. DEFAULT: 0<a name='8968'></font>
<font color=#447700>!<a name='8969'></font>
      NTYPE=0<a name='8970'>
<font color=#447700>!O222 READ (*,*) NTYPE<a name='8971'></font>
    5 NLEV=NL<a name='8972'>
      DELZAP=0.5<a name='8973'>
      R=8.31432<a name='8974'>
      G0=9.80665<a name='8975'>
      ZMASS=28.9644<a name='8976'>
      AA=6356.766<a name='8977'>
         ALT(1)=0.0<a name='8978'>
         TEMP(1)=<A href='../../html_code/phys/module_ra_gfdleta.F.html#ANTEMP'>ANTEMP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ANTEMP_1">(6,0.0)<a name='8979'>
<font color=#447700>!*******DETERMINE THE PRESSURES (PRESS)<a name='8980'></font>
      PSTAR=PSMAX<a name='8981'>
<font color=#447700>!<a name='8982'></font>
<font color=#447700>!***  LTOP COMPUTATION MOVED FROM MODEL INITIALIZATION<a name='8983'></font>
<font color=#447700>!<a name='8984'></font>
      LTOP(1)=0<a name='8985'>
      LTOP(2)=0<a name='8986'>
      LTOP(3)=0<a name='8987'>
      DO 30 N=1,NL<a name='8988'>
        PCLD=(PSTAR-PPTOP*10.)*SHALF(N)+PPTOP*10.<a name='8989'>
        IF(PCLD.GE.642.)LTOP(1)=N<a name='8990'>
        IF(PCLD.GE.350.)LTOP(2)=N<a name='8991'>
        IF(PCLD.GE.150.)LTOP(3)=N<a name='8992'>
<font color=#447700>!       PRINT *,N,PCLD,SHALF(N),PSTAR,PPTOP<a name='8993'></font>
   30 CONTINUE<a name='8994'>
<font color=#447700>!<a name='8995'></font>
<font color=#447700>!O222 IF (NTYPE.EQ.1) CALL SKYP(PSTAR,PD,GTEMP)<a name='8996'></font>
<font color=#447700>!O222 IF (NTYPE.EQ.2) CALL SKY80P(PSTAR,PD,GTEMP)<a name='8997'></font>
<font color=#447700>!O222 IF (NTYPE.EQ.0) CALL SIGP(PSTAR,PD,GTEMP)<a name='8998'></font>
<font color=#447700>!CC----      CALL SIGP(PSTAR,PD,GTEMP)<a name='8999'></font>
      NLM=NL-1<a name='9000'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#SIGP'>SIGP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SIGP_1">(PSTAR,PD,GTEMP,T41,T42,T43,T44,SGLVNU,SIGLNU, &amp;<a name='9001'>
                SFULL,SHALF,PPTOP,LREAD,NL,NLP,NLM,NLP2)<a name='9002'>
      PD(NLP2)=PSTAR<a name='9003'>
      DO 40 N=1,NLP<a name='9004'>
      PRSINT(N)=PD(NLP2+1-N)<a name='9005'>
 40   CONTINUE<a name='9006'>
<font color=#447700>!    *** CALCULATE TEMPS FOR SEVERAL PRESSURES TO DO QUADRATURE<a name='9007'></font>
      DO 504 NQ=1,4<a name='9008'>
      DO 505 N=2,NLP<a name='9009'>
 505  PRESS(N)=PRSINT(N)+0.25*(NQ-1)*(PRSINT(N-1)-PRSINT(N))<a name='9010'>
      PRESS(1)=PRSINT(1)<a name='9011'>
<font color=#447700>!*********************<a name='9012'></font>
      DO 100 N=1,NLEV<a name='9013'>
<font color=#447700>!<a name='9014'></font>
<font color=#447700>! **         ESTABLISH COMPUTATATIONAL LEVELS BETWEEN USER LEVELS AT<a name='9015'></font>
<font color=#447700>! **         INTERVALS OF APPROXIMATELY 'DELZAP' KM.<a name='9016'></font>
<font color=#447700>!<a name='9017'></font>
      DLOGP=7.0*ALOG(PRESS(N)/PRESS(N+1))<a name='9018'>
      NINT=DLOGP/DELZAP<a name='9019'>
      NINT=NINT+1<a name='9020'>
      ZNINT=NINT<a name='9021'>
<font color=#447700>!     G=G0<a name='9022'></font>
      DZ=R*DLOGP/(7.0*ZMASS*G0*ZNINT)<a name='9023'>
      HT=ALT(N)<a name='9024'>
<font color=#447700>!<a name='9025'></font>
<font color=#447700>! **         CALCULATE HEIGHT AT NEXT USER LEVEL BY MEANS OF<a name='9026'></font>
<font color=#447700>! **                   RUNGE-KUTTA INTEGRATION.<a name='9027'></font>
<font color=#447700>!<a name='9028'></font>
      DO 200 M=1,NINT<a name='9029'>
      RK1=<A href='../../html_code/phys/module_ra_gfdleta.F.html#ANTEMP'>ANTEMP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ANTEMP_2">(6,HT)*DZ<a name='9030'>
      RK2=<A href='../../html_code/phys/module_ra_gfdleta.F.html#ANTEMP'>ANTEMP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ANTEMP_3">(6,HT+0.5*RK1)*DZ<a name='9031'>
      RK3=<A href='../../html_code/phys/module_ra_gfdleta.F.html#ANTEMP'>ANTEMP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ANTEMP_4">(6,HT+0.5*RK2)*DZ<a name='9032'>
      RK4=<A href='../../html_code/phys/module_ra_gfdleta.F.html#ANTEMP'>ANTEMP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ANTEMP_5">(6,HT+RK3)*DZ<a name='9033'>
<font color=#447700>!mp	write(6,*) 'RK values,DZ ', RK1,RK2,RK3,RK4,DZ<a name='9034'></font>
      HT=HT+0.16666667*(RK1+RK2+RK2+RK3+RK3+RK4)<a name='9035'>
  200 CONTINUE<a name='9036'>
      ALT(N+1)=HT<a name='9037'>
      TEMP(N+1)=<A href='../../html_code/phys/module_ra_gfdleta.F.html#ANTEMP'>ANTEMP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ANTEMP_6">(6,HT)<a name='9038'>
  100 CONTINUE<a name='9039'>
      DO 506 N=1,NLP<a name='9040'>
      TMPINT(N,NQ)=TEMP(N)<a name='9041'>
      A(N,NQ)=ALT(N)<a name='9042'>
506   CONTINUE<a name='9043'>
504   CONTINUE<a name='9044'>
<font color=#447700>!O222   *****************************************************<a name='9045'></font>
<font color=#447700>!***OUTPUT TEMPERATURES<a name='9046'></font>
<font color=#447700>!O222   *****************************************************<a name='9047'></font>
      DO 901 N=1,NLP<a name='9048'>
        SGTEMP(N,1) = TMPINT(NLP2-N,1)<a name='9049'>
  901 CONTINUE<a name='9050'>
<font color=#447700>!O222   *****************************************************<a name='9051'></font>
<font color=#447700>!***OUTPUT GTEMP<a name='9052'></font>
<font color=#447700>!O222   *****************************************************<a name='9053'></font>
      DO 902 N=1,NLP<a name='9054'>
        SGTEMP(N,2) = GTEMP(N)<a name='9055'>
  902 CONTINUE<a name='9056'>
<font color=#447700>!O222   *****************************************************<a name='9057'></font>
      RETURN<a name='9058'>
      END SUBROUTINE CO2PTZ<a name='9059'>
<A NAME='PATH'><A href='../../html_code/phys/module_ra_gfdleta.F.html#PATH' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='9060'>
      <font color=#993300>FUNCTION </font><font color=#cc0000>PATH</font>(A,B,C,E) <A href='../../call_to/PATH.html' TARGET='index'>2</A><a name='9061'>
<font color=#447700>!....<a name='9062'></font>
<font color=#447700>!     DOUBLE PRECISION XA,CA<a name='9063'></font>
<font color=#447700>!     COMMON/COEFS/XA(109),CA(109),ETA(109),SEXPV(109),CORE,UEXP,SEXP<a name='9064'></font>
      PEXP=1./SEXP<a name='9065'>
      PATH=((A-B)**PEXP*(A+B+C))/(E*(A+B+C)+(A-B)**(PEXP-1.))<a name='9066'>
      RETURN<a name='9067'>
      END FUNCTION PATH<a name='9068'>
<font color=#447700>!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC<a name='9069'></font>
<A NAME='QINTRP'><A href='../../html_code/phys/module_ra_gfdleta.F.html#QINTRP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9070'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>QINTRP</font>(XM,X0,XP,FM,F0,FP,X,F) <A href='../../call_to/QINTRP.html' TARGET='index'>4</A><a name='9071'>
<font color=#447700>!....<a name='9072'></font>
<font color=#447700>!     DOUBLE PRECISION FM,F0,FP,F,D1,D2,B,A,DEL<a name='9073'></font>
      D1=(FP-F0)/(XP-X0)<a name='9074'>
      D2=(FM-F0)/(XM-X0)<a name='9075'>
      B=(D1-D2)/(XP-XM)<a name='9076'>
      A=D1-B*(XP-X0)<a name='9077'>
      DEL=(X-X0)<a name='9078'>
      F=F0+DEL*(A+DEL*B)<a name='9079'>
      RETURN<a name='9080'>
      END SUBROUTINE QINTRP<a name='9081'>
<A NAME='QUADSR'><A href='../../html_code/phys/module_ra_gfdleta.F.html#QUADSR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9082'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>QUADSR</font>(NLV,NLP1V,NLP2V,P,PD,TRNS) <A href='../../call_to/QUADSR.html' TARGET='index'>1</A>,<A href='../../call_from/QUADSR.html' TARGET='index'>1</A><a name='9083'>
      COMMON/INPUT/P1,P2,TRNSLO,IA,JA,N<a name='9084'>
      DIMENSION P(NLP1V),PD(NLP2V),TRNS(NLP1V,NLP1V)<a name='9085'>
      DIMENSION WT(101)<a name='9086'>
      N2=2*N<a name='9087'>
      N2P=2*N+1<a name='9088'>
<font color=#447700>!  *****WEIGHTS ARE CALCULATED<a name='9089'></font>
      WT(1)=1.<a name='9090'>
      DO 21 I=1,N<a name='9091'>
      WT(2*I)=4.<a name='9092'>
      WT(2*I+1)=1.<a name='9093'>
21    CONTINUE<a name='9094'>
      IF (N.EQ.1) GO TO 25<a name='9095'>
      DO 22 I=2,N<a name='9096'>
      WT(2*I-1)=2.<a name='9097'>
22    CONTINUE<a name='9098'>
25    CONTINUE<a name='9099'>
      TRNSNB=0.<a name='9100'>
      DP=(PD(IA)-PD(IA-1))/N2<a name='9101'>
      PFIX=P(JA)<a name='9102'>
      DO 1 KK=1,N2P<a name='9103'>
      PVARY=PD(IA-1)+(KK-1)*DP<a name='9104'>
      IF (PVARY.GE.PFIX) P2=PVARY<a name='9105'>
      IF (PVARY.GE.PFIX) P1=PFIX<a name='9106'>
      IF (PVARY.LT.PFIX) P1=PVARY<a name='9107'>
      IF (PVARY.LT.PFIX) P2=PFIX<a name='9108'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#SINTR2'>SINTR2</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#QUADSR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SINTR2_2"><a name='9109'>
      TRNSNB=TRNSNB+TRNSLO*WT(KK)<a name='9110'>
1     CONTINUE<a name='9111'>
      TRNS(IA,JA)=TRNSNB*DP/(3.*(PD(IA)-PD(IA-1)))<a name='9112'>
      RETURN<a name='9113'>
      END SUBROUTINE QUADSR<a name='9114'>
<font color=#447700>!---------------------------------------------------------------------<a name='9115'></font>
<A NAME='SIGP'><A href='../../html_code/phys/module_ra_gfdleta.F.html#SIGP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9116'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>SIGP</font>(PSTAR,PD,GTEMP,T41,T42,T43,T44,SGLVNU,SIGLNU, &amp; <A href='../../call_to/SIGP.html' TARGET='index'>1</A><a name='9117'>
                      SIGLV,SIGLY,PPTOP,LREAD,KD,KP,KM,KP2)<a name='9118'>
      DIMENSION Q(KD),QMH(KP),PD(KP2),PLM(KP),GTEMP(KP),PDT(KP2)<a name='9119'>
      DIMENSION SIGLY(KD),SIGLV(KP)<a name='9120'>
      DIMENSION CI(KP),SGLVNU(KP),DEL(KD),SIGLNU(KD),CL(KD),RPI(KM)<a name='9121'>
      DIMENSION IDATE(4)<a name='9122'>
      DIMENSION T41(KP2,2),T42(KP), &amp;<a name='9123'>
                T43(KP2,2),T44(KP)<a name='9124'>
<font color=#447700>!     integer :: retval<a name='9125'></font>
<font color=#447700>!     character(50) :: prsmid='prsmid'<a name='9126'></font>
<font color=#447700>!CC   18 LEVEL SIGMAS FOR NMC MRF(NEW) MODEL<a name='9127'></font>
<font color=#447700>!CC   DATA Q/.021,.074,.124,.175,.225,.275,.325,.375,.425,.497, &amp;<a name='9128'></font>
<font color=#447700>!CC          .594,.688,.777,.856,.920,.960,.981,.995/<a name='9129'></font>
<font color=#447700>!     FOR SIGMA MODELS,Q=SIGMA,QMH=0.5(Q(I)+Q(I+1),<a name='9130'></font>
<font color=#447700>!     PD=Q*PSS,PLM=QMH*PSS.PSS=SURFACE PRESSURE(SPEC.)<a name='9131'></font>
<font color=#447700>!<a name='9132'></font>
<font color=#447700>!.....   GET NMC SIGMA STRUCTURE<a name='9133'></font>
<font color=#447700>!CC   IF (LREAD.GT.0) GO TO 914<a name='9134'></font>
<font color=#447700>!---   PPTOP IS MODEL TOP PRESSURE IN CB....<a name='9135'></font>
<font color=#447700>!        SIGMA DATA IS BOTTOM OF ATMOSPHERE TO T.O.A.....<a name='9136'></font>
<font color=#447700>!cccc PPTOP=5.0<a name='9137'></font>
<font color=#447700>!     READ(11,PPTOP,END=12321)<a name='9138'></font>
12321 CONTINUE<a name='9139'>
<font color=#447700>!     WRITE(6,88221)PPTOP,KD,KP<a name='9140'></font>
<font color=#447700>!88221 FORMAT(' ENTER SIGP PPTOP=',E12.5,' KD=',I2,' KP=',I2)<a name='9141'></font>
<font color=#447700>!     open(unit=23,file='fort.23',form='unformatted' &amp;<a name='9142'></font>
<font color=#447700>!     ,    access='sequential')<a name='9143'></font>
<font color=#447700>!     REWIND 23<a name='9144'></font>
<font color=#447700>!     READ(23)SIGLY<a name='9145'></font>
<font color=#447700>!     DO KKK=1,KD<a name='9146'></font>
<font color=#447700>!      SIGLY(KKK)=1.-(FLOAT(KKK)-0.5)/KD<a name='9147'></font>
<font color=#447700>!     END DO<a name='9148'></font>
<font color=#447700>!     WRITE(6,88222)<a name='9149'></font>
<font color=#447700>!88222 FORMAT(' READ AETA')<a name='9150'></font>
<font color=#447700>!     DO 37821 LLL=1,KD<a name='9151'></font>
<font color=#447700>!     WRITE(6,37820)LLL,SIGLY(LLL)<a name='9152'></font>
<font color=#447700>!37820 FORMAT(' L=',I2,' AETA=',E12.5)<a name='9153'></font>
<font color=#447700>!37821 CONTINUE<a name='9154'></font>
<font color=#447700>!     READ(23)SIGLV<a name='9155'></font>
<font color=#447700>!     DO KKK=1,KP<a name='9156'></font>
<font color=#447700>!      SIGLV(KKK)=1.-(FLOAT(KKK-1))/KD<a name='9157'></font>
<font color=#447700>!     END DO<a name='9158'></font>
<font color=#447700>!     WRITE(6,88223)<a name='9159'></font>
<font color=#447700>!88223 FORMAT(' READ ETA')<a name='9160'></font>
<font color=#447700>!     PRINT 704,(SIGLY(K),K=1,KD)<a name='9161'></font>
<font color=#447700>!     PRINT 704,(SIGLV(K),K=1,KP)<a name='9162'></font>
<font color=#447700>!      DO 37823 LLL=1,KP<a name='9163'></font>
<font color=#447700>!      WRITE(6,37822)LLL,SIGLV(LLL)<a name='9164'></font>
<font color=#447700>!37822 FORMAT(' L=',I2,' ETA=',E12.5)<a name='9165'></font>
<font color=#447700>!37823 CONTINUE<a name='9166'></font>
  701 FORMAT(F6.2)<a name='9167'>
  702 FORMAT(7F10.6)<a name='9168'>
      IF (PPTOP.LE.0.) GO TO 708<a name='9169'>
      PSFC=100.<a name='9170'>
<font color=#447700>!--- IF PTOP NOT EQUAL TO ZERO ADJUST SIGMA SO AS TO GET PROPER STD ATM<a name='9171'></font>
<font color=#447700>!      VERTICAL LOCATION<a name='9172'></font>
      DO 706 K=1,KD<a name='9173'>
       SIGLY(K) = (SIGLY(K)*(PSFC-PPTOP)+PPTOP)/PSFC<a name='9174'>
  706 CONTINUE<a name='9175'>
      DO 707 K=1,KP<a name='9176'>
       SIGLV(K) = (SIGLV(K)*(PSFC-PPTOP)+PPTOP)/PSFC<a name='9177'>
  707 CONTINUE<a name='9178'>
  708 CONTINUE<a name='9179'>
<font color=#447700>!     PRINT 703,PPTOP<a name='9180'></font>
<font color=#447700>!     PRINT 704,(SIGLY(K),K=1,KD)<a name='9181'></font>
<font color=#447700>!     PRINT 704,(SIGLV(K),K=1,KP)<a name='9182'></font>
  703 FORMAT(1H ,'PTOP =',F6.2)<a name='9183'>
  704 FORMAT(1H ,7F10.6)<a name='9184'>
      DO 913 K=1,KP<a name='9185'>
       SGLVNU(K) = SIGLV(K)<a name='9186'>
       IF (K.LE.KD) SIGLNU(K) = SIGLY(K)<a name='9187'>
  913 CONTINUE<a name='9188'>
      DO 77 K=1,KD<a name='9189'>
         Q(K) = SIGLNU(KD+1-K)<a name='9190'>
   77 CONTINUE<a name='9191'>
      PSS=    1013250.<a name='9192'>
      QMH(1)=0.<a name='9193'>
      QMH(KP)=1.<a name='9194'>
      DO 1 K=2,KD<a name='9195'>
      QMH(K)=0.5*(Q(K-1)+Q(K))<a name='9196'>
1     CONTINUE<a name='9197'>
      PD(1)=0.<a name='9198'>
      PD(KP2)=PSS<a name='9199'>
      DO 2 K=2,KP<a name='9200'>
      PD(K)=Q(K-1)*PSS<a name='9201'>
2     CONTINUE<a name='9202'>
<font color=#447700>!       call int_get_fresh_handle(retval)<a name='9203'></font>
<font color=#447700>!       close(retval)<a name='9204'></font>
<font color=#447700>!       write(0,*)' before open in CO2O3'<a name='9205'></font>
<font color=#447700>!       open(unit=retval,file=prsmid,form='UNFORMATTED',iostat=ier)<a name='9206'></font>
<font color=#447700>!       write(0,*)' after open1'<a name='9207'></font>
<font color=#447700>!       do k=1,62<a name='9208'></font>
<font color=#447700>!         write(retval)pd(k)<a name='9209'></font>
<font color=#447700>!       enddo<a name='9210'></font>
<font color=#447700>!       close(retval)<a name='9211'></font>
      PLM(1)=0.<a name='9212'>
      DO 3 K=1,KM<a name='9213'>
      PLM(K+1)=0.5*(PD(K+1)+PD(K+2))<a name='9214'>
3     CONTINUE<a name='9215'>
      PLM(KP)=PSS<a name='9216'>
      DO 4 K=1,KD<a name='9217'>
      GTEMP(K)=PD(K+1)**0.2*(1.+PD(K+1)/30000.)**0.8/1013250.<a name='9218'>
4     CONTINUE<a name='9219'>
      GTEMP(KP)=0.<a name='9220'>
<font color=#447700>!+++  WRITE (6,100) (GTEMP(K),K=1,KD)<a name='9221'></font>
<font color=#447700>!+++  WRITE (6,100) (PD(K),K=1,KP2)<a name='9222'></font>
<font color=#447700>!+++  WRITE (6,100) (PLM(K),K=1,KP)<a name='9223'></font>
<font color=#447700>!***TAPES 41,42 ARE OUTPUT TO THE CO2 INTERPOLATION PROGRAM (PS=1013MB)<a name='9224'></font>
<font color=#447700>!  THE FOLLOWING PUTS P-DATA INTO MB<a name='9225'></font>
      DO 11 I=1,KP<a name='9226'>
      PD(I)=PD(I)*1.0E-3<a name='9227'>
      PLM(I)=PLM(I)*1.0E-3<a name='9228'>
11    CONTINUE<a name='9229'>
      PD(KP2)=PD(KP2)*1.0E-3<a name='9230'>
<font color=#447700>!CC         WRITE (41,101) (PD(K),K=1,KP2)<a name='9231'></font>
<font color=#447700>!CC         WRITE (41,101) (PLM(K),K=1,KP)<a name='9232'></font>
<font color=#447700>!CC         WRITE (42,101) (PLM(K),K=1,KP)<a name='9233'></font>
      DO 300 K=1,KP2<a name='9234'>
       T41(K,1) = PD(K)<a name='9235'>
  300 CONTINUE<a name='9236'>
      DO 301 K=1,KP<a name='9237'>
       T41(K,2) = PLM(K)<a name='9238'>
       T42(K) = PLM(K)<a name='9239'>
  301 CONTINUE<a name='9240'>
<font color=#447700>!***STORE AS PDT,SO THAT RIGHT PD IS RETURNED TO PTZ<a name='9241'></font>
      DO 12 I=1,KP2<a name='9242'>
      PDT(I)=PD(I)<a name='9243'>
12    CONTINUE<a name='9244'>
<font color=#447700>!***SECOND PASS: PSS=810MB,GTEMP NOT COMPUTED<a name='9245'></font>
      PSS=0.8*1013250.<a name='9246'>
      QMH(1)=0.<a name='9247'>
      QMH(KP)=1.<a name='9248'>
      DO 201 K=2,KD<a name='9249'>
      QMH(K)=0.5*(Q(K-1)+Q(K))<a name='9250'>
201   CONTINUE<a name='9251'>
      PD(1)=0.<a name='9252'>
      PD(KP2)=PSS<a name='9253'>
      DO 202 K=2,KP<a name='9254'>
      PD(K)=Q(K-1)*PSS<a name='9255'>
202   CONTINUE<a name='9256'>
      PLM(1)=0.<a name='9257'>
      DO 203 K=1,KM<a name='9258'>
      PLM(K+1)=0.5*(PD(K+1)+PD(K+2))<a name='9259'>
203   CONTINUE<a name='9260'>
      PLM(KP)=PSS<a name='9261'>
<font color=#447700>!+++  WRITE (6,100) (PD(K),K=1,KP2)<a name='9262'></font>
<font color=#447700>!+++  WRITE (6,100) (PLM(K),K=1,KP)<a name='9263'></font>
<font color=#447700>!***TAPES 43,44 ARE OUTPUT TO THE CO2 INTERPOLATION PROGRAM(PS=810 MB)<a name='9264'></font>
<font color=#447700>!  THE FOLLOWING PUTS P-DATA INTO MB<a name='9265'></font>
      DO 211 I=1,KP<a name='9266'>
      PD(I)=PD(I)*1.0E-3<a name='9267'>
      PLM(I)=PLM(I)*1.0E-3<a name='9268'>
211   CONTINUE<a name='9269'>
      PD(KP2)=PD(KP2)*1.0E-3<a name='9270'>
<font color=#447700>!CC       WRITE (43,101) (PD(K),K=1,KP2)<a name='9271'></font>
<font color=#447700>!CC       WRITE (43,101) (PLM(K),K=1,KP)<a name='9272'></font>
<font color=#447700>!CC       WRITE (44,101) (PLM(K),K=1,KP)<a name='9273'></font>
      DO 302 K=1,KP2<a name='9274'>
       T43(K,1) = PD(K)<a name='9275'>
  302 CONTINUE<a name='9276'>
      DO 303 K=1,KP<a name='9277'>
       T43(K,2) = PLM(K)<a name='9278'>
       T44(K) = PLM(K)<a name='9279'>
  303 CONTINUE<a name='9280'>
<font color=#447700>!***RESTORE PD<a name='9281'></font>
      DO 212 I=1,KP2<a name='9282'>
      PD(I)=PDT(I)<a name='9283'>
212   CONTINUE<a name='9284'>
100   FORMAT (1X,5E20.13)<a name='9285'>
101   FORMAT (5E16.9)<a name='9286'>
      RETURN<a name='9287'>
      END SUBROUTINE SIGP<a name='9288'>
<font color=#447700>!---------------------------------------------------------------------<a name='9289'></font>
<A NAME='SINTR2'><A href='../../html_code/phys/module_ra_gfdleta.F.html#SINTR2' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9290'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>SINTR2</font> <A href='../../call_to/SINTR2.html' TARGET='index'>2</A>,<A href='../../call_from/SINTR2.html' TARGET='index'>4</A><a name='9291'>
<font color=#447700>!....<a name='9292'></font>
<font color=#447700>!     IMPLICIT DOUBLE PRECISION (A-H,O-Z)<a name='9293'></font>
<font color=#447700>!     REAL P1,P2,PA,TRNSLO,CORE,TRANSA,PATH,UEXP,SEXP,ETA,SEXPV<a name='9294'></font>
      COMMON/INPUT/P1,P2,TRNSLO,IA,JA,N<a name='9295'>
<font color=#447700>!     COMMON/PRESS/ PA(109)<a name='9296'></font>
<font color=#447700>!     COMMON/TRAN/ TRANSA(109,109)<a name='9297'></font>
<font color=#447700>!     COMMON/COEFS/XA(109),CA(109),ETA(109),SEXPV(109),CORE,UEXP,SEXP<a name='9298'></font>
      DO 70 L=1,109<a name='9299'>
      IP1=L<a name='9300'>
      IF (P2-PA(L)) 65,65,70<a name='9301'>
   70 CONTINUE<a name='9302'>
   65 I=IP1-1<a name='9303'>
      IF (IP1.EQ.1) IP1=2<a name='9304'>
      IF (I.EQ.0) I=1<a name='9305'>
      DO 80 L=1,109<a name='9306'>
      JP1=L<a name='9307'>
      IF (P1-PA(L)) 75,75,80<a name='9308'>
   80 CONTINUE<a name='9309'>
   75 J=JP1-1<a name='9310'>
      IF (JP1.EQ.1) JP1=2<a name='9311'>
      IF (J.EQ.0) J=1<a name='9312'>
      JJJ=J<a name='9313'>
      III=I<a name='9314'>
      J=JJJ<a name='9315'>
      JP1=J+1<a name='9316'>
      I=III<a name='9317'>
      IP1=I+1<a name='9318'>
<font color=#447700>!  DETERMINE ETAP,THE VALUE OF ETA TO USE BY LINEAR INTERPOLATION<a name='9319'></font>
<font color=#447700>!    FOR PETA(=0.5*(P1+P2))<a name='9320'></font>
      PETA=P2<a name='9321'>
      DO 90 L=1,109<a name='9322'>
      IETAP1=L<a name='9323'>
      IF (PETA-PA(L)) 85,85,90<a name='9324'>
90    CONTINUE<a name='9325'>
85    IETA=IETAP1-1<a name='9326'>
      IF (IETAP1.EQ.1) IETAP1=2<a name='9327'>
      IF (IETA.EQ.0) IETA=1<a name='9328'>
      ETAP=ETA(IETA)+(PETA-PA(IETA))*(ETA(IETAP1)-ETA(IETA))/ &amp;<a name='9329'>
       (PA(IETAP1)-PA(IETA))<a name='9330'>
      SEXP=SEXPV(IETA)+(PETA-PA(IETA))*(SEXPV(IETAP1)- &amp;<a name='9331'>
       SEXPV(IETA))/ (PA(IETAP1)-PA(IETA))<a name='9332'>
      PIPMPI=PA(IP1)-PA(I)<a name='9333'>
      UP2P1=(PATH(P2,P1,CORE,ETAP))**UEXP<a name='9334'>
      IF (I-J) 126,126,127<a name='9335'>
  126 CONTINUE<a name='9336'>
      TRIP=(CA(IP1)*DLOG(1.0D0+XA(IP1)*UP2P1))**(SEXP/UEXP)<a name='9337'>
      TRI=(CA(I)*DLOG(1.0D0+XA(I)*UP2P1))**(SEXP/UEXP)<a name='9338'>
      TRNSLO=1.0D0-((PA(IP1)-P2)*TRI+(P2-PA(I))*TRIP)/PIPMPI<a name='9339'>
      GO TO 128<a name='9340'>
  127 TIJ=TRANSA(I,J)<a name='9341'>
      TIPJ=TRANSA(I+1,J)<a name='9342'>
      TIJP=TRANSA(I,J+1)<a name='9343'>
      TIPJP=TRANSA(I+1,J+1)<a name='9344'>
      UIJ=(PATH(PA(I),PA(J),CORE,ETAP))**UEXP<a name='9345'>
      UIPJ=(PATH(PA(I+1),PA(J),CORE,ETAP))**UEXP<a name='9346'>
      UIJP=(PATH(PA(I),PA(J+1),CORE,ETAP))**UEXP<a name='9347'>
      UIPJP=(PATH(PA(I+1),PA(J+1),CORE,ETAP))**UEXP<a name='9348'>
      PRODI=CA(I)*XA(I)<a name='9349'>
      PRODIP=CA(I+1)*XA(I+1)<a name='9350'>
      PROD=((PA(I+1)-P2)*PRODI+(P2-PA(I))*PRODIP)/PIPMPI<a name='9351'>
      XINT=((PA(I+1)-P2)*XA(I)+(P2-PA(I))*XA(I+1))/PIPMPI<a name='9352'>
      CINT=PROD/XINT<a name='9353'>
      AIJ=(CINT*DLOG(1.0D0+XINT*UIJ))**(SEXP/UEXP)<a name='9354'>
      AIJP=(CINT*DLOG(1.0D0+XINT*UIJP))**(SEXP/UEXP)<a name='9355'>
      AIPJ=(CINT*DLOG(1.0D0+XINT*UIPJ))**(SEXP/UEXP)<a name='9356'>
      AIPJP=(CINT*DLOG(1.0D0+XINT*UIPJP))**(SEXP/UEXP)<a name='9357'>
      EIJ=TIJ+AIJ<a name='9358'>
      EIPJ=TIPJ+AIPJ<a name='9359'>
      EIJP=TIJP+AIJP<a name='9360'>
      EIPJP=TIPJP+AIPJP<a name='9361'>
      DTDJ=(EIJP-EIJ)/(PA(J+1)-PA(J))<a name='9362'>
      DTDPJ=(EIPJP-EIPJ)/(PA(J+1)-PA(J))<a name='9363'>
      EPIP1=EIJ+DTDJ*(P1-PA(J))<a name='9364'>
      EPIPP1=EIPJ+DTDPJ*(P1-PA(J))<a name='9365'>
      EPP2P1=((PA(I+1)-P2)*EPIP1+(P2-PA(I))*EPIPP1)/PIPMPI<a name='9366'>
      TRNSLO=EPP2P1-(CINT*DLOG(1.0D0+XINT*UP2P1))**(SEXP/UEXP)<a name='9367'>
      IF (I.GE.108.OR.J.GE.108) GO TO 350<a name='9368'>
      IF (I-J-2) 350,350,355<a name='9369'>
355   CONTINUE<a name='9370'>
      TIP2J=TRANSA(I+2,J)<a name='9371'>
      TIP2JP=TRANSA(I+2,J+1)<a name='9372'>
      TI2J2=TRANSA(I+2,J+2)<a name='9373'>
      TIJP2=TRANSA(I,J+2)<a name='9374'>
      TIPJP2=TRANSA(I+1,J+2)<a name='9375'>
      UIP2J=(PATH(PA(I+2),PA(J),CORE,ETAP))**UEXP<a name='9376'>
      UIJP2=(PATH(PA(I),PA(J+2),CORE,ETAP))**UEXP<a name='9377'>
      UIPJP2=(PATH(PA(I+1),PA(J+2),CORE,ETAP))**UEXP<a name='9378'>
      UI2J2=(PATH(PA(I+2),PA(J+2),CORE,ETAP))**UEXP<a name='9379'>
      UIP2JP=(PATH(PA(I+2),PA(J+1),CORE,ETAP))**UEXP<a name='9380'>
      AIJP2=(CINT*DLOG(1.0D0+XINT*UIJP2))**(SEXP/UEXP)<a name='9381'>
      AIPJP2=(CINT*DLOG(1.0D0+XINT*UIPJP2))**(SEXP/UEXP)<a name='9382'>
      AIP2J=(CINT*DLOG(1.0D0+XINT*UIP2J))**(SEXP/UEXP)<a name='9383'>
      AIP2JP=(CINT*DLOG(1.0D0+XINT*UIP2JP))**(SEXP/UEXP)<a name='9384'>
      AI2J2=(CINT*DLOG(1.0D0+XINT*UI2J2))**(SEXP/UEXP)<a name='9385'>
      EIP2J=TIP2J+AIP2J<a name='9386'>
      EIP2JP=TIP2JP+AIP2JP<a name='9387'>
      EIJP2=TIJP2+AIJP2<a name='9388'>
      EIPJP2=TIPJP2+AIPJP2<a name='9389'>
      EI2J2=TI2J2+AI2J2<a name='9390'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#QINTRP'>QINTRP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#SINTR2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="QINTRP_1">(PA(J),PA(J+1),PA(J+2),EIJ,EIJP,EIJP2,P1,EI)<a name='9391'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#QINTRP'>QINTRP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#SINTR2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="QINTRP_2">(PA(J),PA(J+1),PA(J+2),EIPJ,EIPJP,EIPJP2,P1,EP)<a name='9392'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#QINTRP'>QINTRP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#SINTR2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="QINTRP_3">(PA(J),PA(J+1),PA(J+2),EIP2J,EIP2JP,EI2J2,P1,EP2)<a name='9393'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#QINTRP'>QINTRP</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#SINTR2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="QINTRP_4">(PA(I),PA(I+1),PA(I+2),EI,EP,EP2,P2,EPSIL)<a name='9394'>
      TRNSLO=EPSIL-(CINT*DLOG(1.0D0+XINT*UP2P1))**(SEXP/UEXP)<a name='9395'>
  350 CONTINUE<a name='9396'>
  128 CONTINUE<a name='9397'>
  205 CONTINUE<a name='9398'>
      RETURN<a name='9399'>
      END SUBROUTINE SINTR2<a name='9400'>
<A NAME='CO2O3'><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9401'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>CO2O3</font>(SFULL,SHALF,PPTOP,L,LP1,LP2) <A href='../../call_to/CO2O3.html' TARGET='index'>1</A>,<A href='../../call_from/CO2O3.html' TARGET='index'>22</A><a name='9402'>
<font color=#447700>!CCC  PROGRAM CO2O3 = CONSOLIDATION OF A NUMBER OF DAN SCHWARZKOPF,GFDL<a name='9403'></font>
<font color=#447700>!                     CODES TO PRODUCE A FILE OF CO2 HGT DATA<a name='9404'></font>
<font color=#447700>!                     FOR ANY VERTICAL COORDINATE (READ BY SUBROUTINE<a name='9405'></font>
<font color=#447700>!                     CONRAD IN THE GFDL RADIATION CODES)-K.A.C. JUN89.<a name='9406'></font>
<font color=#447700>!NOV89--UPDATED (NOV 89) FOR LATEST GFDL LW RADIATION.....K.A.C.<a name='9407'></font>
      LOGICAL                 :: opened<a name='9408'>
      LOGICAL , EXTERNAL      :: wrf_dm_on_monitor<a name='9409'>
      CHARACTER*80 errmess<a name='9410'>
<font color=#447700>!     integer :: retval,kk,ka,kb<a name='9411'></font>
<font color=#447700>!     character(50) :: co2='co2'<a name='9412'></font>
      INTEGER etarad_unit61, etarad_unit62, etarad_unit63,IERROR<a name='9413'>
      DIMENSION SGTEMP(LP1,2),CO2D1D(L,6),CO2D2D(LP1,LP1,6)<a name='9414'>
<font color=#447700>!NOV89<a name='9415'></font>
      DIMENSION CO2IQ2(LP1,LP1,6),CO2IQ3(LP1,LP1,6),CO2IQ5(LP1,LP1,6)<a name='9416'>
<font color=#447700>!NOV89<a name='9417'></font>
      DIMENSION T41(LP2,2),T42(LP1), &amp;<a name='9418'>
                T43(LP2,2),T44(LP1)<a name='9419'>
      DIMENSION T20(LP1,LP1,3),T21(LP1,LP1,3)<a name='9420'>
      DIMENSION T22(LP1,LP1,3),T23(LP1,LP1,3)<a name='9421'>
      DIMENSION SGLVNU(LP1),SIGLNU(L)<a name='9422'>
      DIMENSION SFULL(LP1),SHALF(L)<a name='9423'>
<font color=#447700>!     DIMENSION STEMP(LP1),GTEMP(LP1)<a name='9424'></font>
<font color=#447700>!     DIMENSION CDTM51(L),CO2M51(L),C2DM51(L)<a name='9425'></font>
<font color=#447700>!     DIMENSION CDTM58(L),CO2M58(L),C2DM58(L)<a name='9426'></font>
<font color=#447700>!     DIMENSION CDT51(LP1,LP1),CO251(LP1,LP1),C2D51(LP1,LP1)<a name='9427'></font>
<font color=#447700>!     DIMENSION CDT58(LP1,LP1),CO258(LP1,LP1),C2D58(LP1,LP1)<a name='9428'></font>
<font color=#447700>!NOV89<a name='9429'></font>
<font color=#447700>!     DIMENSION CDT31(LP1),CO231(LP1),C2D31(LP1)<a name='9430'></font>
<font color=#447700>!     DIMENSION CDT38(LP1),CO238(LP1),C2D38(LP1)<a name='9431'></font>
<font color=#447700>!     DIMENSION CDT71(LP1),CO271(LP1),C2D71(LP1)<a name='9432'></font>
<font color=#447700>!     DIMENSION CDT78(LP1),CO278(LP1),C2D78(LP1)<a name='9433'></font>
<font color=#447700>!     DIMENSION CO211(LP1),CO218(LP1)<a name='9434'></font>
<font color=#447700>!     EQUIVALENCE (CDT31(1),CO2IQ2(1,1,1)),(CO231(1),CO2IQ2(1,1,2))<a name='9435'></font>
<font color=#447700>!     EQUIVALENCE (C2D31(1),CO2IQ2(1,1,3)),(CDT38(1),CO2IQ2(1,1,4))<a name='9436'></font>
<font color=#447700>!     EQUIVALENCE (CO238(1),CO2IQ2(1,1,5)),(C2D38(1),CO2IQ2(1,1,6))<a name='9437'></font>
<font color=#447700>!     EQUIVALENCE (CDT71(1),CO2IQ3(1,1,1)),(CO271(1),CO2IQ3(1,1,2))<a name='9438'></font>
<font color=#447700>!     EQUIVALENCE (C2D71(1),CO2IQ3(1,1,3)),(CDT78(1),CO2IQ3(1,1,4))<a name='9439'></font>
<font color=#447700>!     EQUIVALENCE (CO278(1),CO2IQ3(1,1,5)),(C2D78(1),CO2IQ3(1,1,6))<a name='9440'></font>
<font color=#447700>!     EQUIVALENCE (CO211(1),CO2IQ5(1,1,2)),(CO218(1),CO2IQ5(1,1,5))<a name='9441'></font>
<font color=#447700>!NOV89<a name='9442'></font>
<font color=#447700>!     EQUIVALENCE (STEMP(1),SGTEMP(1,1)),(GTEMP(1),SGTEMP(1,2))<a name='9443'></font>
<font color=#447700>!     EQUIVALENCE (CDTM51(1),CO2D1D(1,1)),(CO2M51(1),CO2D1D(1,2))<a name='9444'></font>
<font color=#447700>!     EQUIVALENCE (C2DM51(1),CO2D1D(1,3)),(CDTM58(1),CO2D1D(1,4))<a name='9445'></font>
<font color=#447700>!     EQUIVALENCE (CO2M58(1),CO2D1D(1,5)),(C2DM58(1),CO2D1D(1,6))<a name='9446'></font>
<font color=#447700>!     EQUIVALENCE (CDT51(1,1),CO2D2D(1,1,1)),(CO251(1,1),CO2D2D(1,1,2))<a name='9447'></font>
<font color=#447700>!     EQUIVALENCE (C2D51(1,1),CO2D2D(1,1,3)),(CDT58(1,1),CO2D2D(1,1,4))<a name='9448'></font>
<font color=#447700>!     EQUIVALENCE (CO258(1,1),CO2D2D(1,1,5)),(C2D58(1,1),CO2D2D(1,1,6))<a name='9449'></font>
      ALLOCATE(CO251(LP1,LP1))<a name='9450'>
      ALLOCATE(CDT51(LP1,LP1))<a name='9451'>
      ALLOCATE(C2D51(LP1,LP1))<a name='9452'>
      ALLOCATE(CO258(LP1,LP1))<a name='9453'>
      ALLOCATE(CDT58(LP1,LP1))<a name='9454'>
      ALLOCATE(C2D58(LP1,LP1))<a name='9455'>
      ALLOCATE(STEMP(LP1))<a name='9456'>
      ALLOCATE(GTEMP(LP1))<a name='9457'>
      ALLOCATE(CO231(LP1))<a name='9458'>
      ALLOCATE(CDT31(LP1))<a name='9459'>
      ALLOCATE(C2D31(LP1))<a name='9460'>
      ALLOCATE(CO238(LP1))<a name='9461'>
      ALLOCATE(CDT38(LP1))<a name='9462'>
      ALLOCATE(C2D38(LP1))<a name='9463'>
      ALLOCATE(CO271(LP1))<a name='9464'>
      ALLOCATE(CDT71(LP1))<a name='9465'>
      ALLOCATE(C2D71(LP1))<a name='9466'>
      ALLOCATE(CO278(LP1))<a name='9467'>
      ALLOCATE(CDT78(LP1))<a name='9468'>
      ALLOCATE(C2D78(LP1))<a name='9469'>
      ALLOCATE(CO2M51(L))<a name='9470'>
      ALLOCATE(CDTM51(L))<a name='9471'>
      ALLOCATE(C2DM51(L))<a name='9472'>
      ALLOCATE(CO2M58(L))<a name='9473'>
      ALLOCATE(CDTM58(L))<a name='9474'>
      ALLOCATE(C2DM58(L))<a name='9475'>
      IF ( wrf_dm_on_monitor() ) THEN<a name='9476'>
        DO i = 61,99<a name='9477'>
          INQUIRE ( i , OPENED = opened )<a name='9478'>
          IF ( .NOT. opened ) THEN<a name='9479'>
            etarad_unit61 = i<a name='9480'>
            GOTO 2061<a name='9481'>
          ENDIF<a name='9482'>
        ENDDO<a name='9483'>
        etarad_unit61 = -1<a name='9484'>
 2061   CONTINUE<a name='9485'>
        DO i = 62,99<a name='9486'>
          INQUIRE ( i , OPENED = opened )<a name='9487'>
          IF ( .NOT. opened ) THEN<a name='9488'>
            etarad_unit62 = i<a name='9489'>
            GOTO 2062<a name='9490'>
          ENDIF<a name='9491'>
        ENDDO<a name='9492'>
        etarad_unit62 = -1<a name='9493'>
 2062   CONTINUE<a name='9494'>
        DO i = 63,99<a name='9495'>
          INQUIRE ( i , OPENED = opened )<a name='9496'>
          IF ( .NOT. opened ) THEN<a name='9497'>
            etarad_unit63 = i<a name='9498'>
            GOTO 2063<a name='9499'>
          ENDIF<a name='9500'>
        ENDDO<a name='9501'>
        etarad_unit63 = -1<a name='9502'>
 2063   CONTINUE<a name='9503'>
      ENDIF<a name='9504'>
      CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_109"> ( etarad_unit61 , IWORDSIZE )<a name='9505'>
      IF ( etarad_unit61 &lt; 0 ) THEN<a name='9506'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_164"> ( 'module_ra_gfdleta: co2o3: Can not find unused fortran unit to read in lookup table.' )<a name='9507'>
      ENDIF<a name='9508'>
      CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_110"> ( etarad_unit62 , IWORDSIZE )<a name='9509'>
      IF ( etarad_unit62 &lt; 0 ) THEN<a name='9510'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_165"> ( 'module_ra_gfdleta: co2o3: Can not find unused fortran unit to read in lookup table.' )<a name='9511'>
      ENDIF<a name='9512'>
      CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_111"> ( etarad_unit63 , IWORDSIZE )<a name='9513'>
      IF ( etarad_unit63 &lt; 0 ) THEN<a name='9514'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_166"> ( 'module_ra_gfdleta: co2o3: Can not find unused fortran unit to read in lookup table.' )<a name='9515'>
      ENDIF<a name='9516'>
        IF ( wrf_dm_on_monitor() ) THEN<a name='9517'>
          OPEN(etarad_unit61,FILE='tr49t85',                  &amp;<a name='9518'>
               FORM='FORMATTED',STATUS='OLD',ERR=9061,IOSTAT=IERROR)<a name='9519'>
        ENDIF<a name='9520'>
        IF ( wrf_dm_on_monitor() ) THEN<a name='9521'>
          OPEN(etarad_unit62,FILE='tr49t67',                  &amp;<a name='9522'>
               FORM='FORMATTED',STATUS='OLD',ERR=9062,IOSTAT=IERROR)<a name='9523'>
        ENDIF<a name='9524'>
        IF ( wrf_dm_on_monitor() ) THEN<a name='9525'>
          OPEN(etarad_unit63,FILE='tr67t85',                  &amp;<a name='9526'>
               FORM='FORMATTED',STATUS='OLD',ERR=9063,IOSTAT=IERROR)<a name='9527'>
        ENDIF<a name='9528'>
<a name='9529'>
<font color=#447700>!===&gt;  GET SGTEMP AND OUTPUT WHICH USED TO BE ON UNITS 41,42,43,44....<a name='9530'></font>
      LREAD = 0<a name='9531'>
<font color=#447700>!     DO KKK=1,L<a name='9532'></font>
<font color=#447700>!JD      READ(23)SIGLNU(KKK)<a name='9533'></font>
<font color=#447700>!      SIGLNU(KKK)=1.-FLOAT(KKK)/LP1<a name='9534'></font>
<font color=#447700>!     END DO<a name='9535'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2PTZ'>CO2PTZ</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2PTZ_1">(SGTEMP,T41,T42,T43,T44,SGLVNU,SIGLNU, &amp;<a name='9536'>
                  SFULL,SHALF,PPTOP,LREAD,L,LP1,LP2)<a name='9537'>
<font color=#447700>!       call int_get_fresh_handle(retval)<a name='9538'></font>
<font color=#447700>!       close(retval)<a name='9539'></font>
<font color=#447700>!       open(unit=retval,file=co2,form='UNFORMATTED',iostat=ier)<a name='9540'></font>
<font color=#447700>!       do kk=1,2<a name='9541'></font>
<font color=#447700>!         write(retval)(sgtemp(k,kk),k=1,61)<a name='9542'></font>
<font color=#447700>!       enddo<a name='9543'></font>
      DO K=1,LP1<a name='9544'>
        STEMP(K)=SGTEMP(K,1)<a name='9545'>
        GTEMP(K)=SGTEMP(K,2)<a name='9546'>
      ENDDO<a name='9547'>
<font color=#447700>!===&gt;  INTERPOLATE DESIRED CO2 DATA FROM THE DETAILED(109,109) GRID..<a name='9548'></font>
<font color=#447700>!         IR=1,IQ=1 IS FOR COMMON /CO2BD3/ IN RADIATION CODE...<a name='9549'></font>
<font color=#447700>!           FOR THE CONSOLIDATED 490-850 CM-1 BAND...<a name='9550'></font>
<font color=#447700>!NOV89<a name='9551'></font>
<font color=#447700>!     ICO2TP=61<a name='9552'></font>
      ICO2TP=etarad_unit61<a name='9553'>
<font color=#447700>!NOV89<a name='9554'></font>
      IR = 1<a name='9555'>
      RATIO = 1.0<a name='9556'>
      NMETHD = 2<a name='9557'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT'>CO2INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INT_1">(ICO2TP,T41,T42,T22,RATIO,IR,NMETHD,L,LP1,LP2)<a name='9558'>
      IR = 1<a name='9559'>
      RATIO = 1.0<a name='9560'>
      NMETHD = 1<a name='9561'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT'>CO2INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INT_2">(ICO2TP,T41,T42,T20,RATIO,IR,NMETHD,L,LP1,LP2)<a name='9562'>
      IR = 1<a name='9563'>
      RATIO = 1.0<a name='9564'>
      NMETHD = 2<a name='9565'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT'>CO2INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INT_3">(ICO2TP,T43,T44,T23,RATIO,IR,NMETHD,L,LP1,LP2)<a name='9566'>
      IR = 1<a name='9567'>
      RATIO = 1.0<a name='9568'>
      NMETHD = 1<a name='9569'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT'>CO2INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INT_4">(ICO2TP,T43,T44,T21,RATIO,IR,NMETHD,L,LP1,LP2)<a name='9570'>
<font color=#447700>!===&gt;    FILL UP THE CO2D1D ARRAY<a name='9571'></font>
<font color=#447700>!       THE FOLLOWING GETS CO2 TRANSMISSION FUNCTIONS AND<a name='9572'></font>
<font color=#447700>!         THEIR DERIVATIVES FOR TAU(I,I+1),I=1,LEVS,<a name='9573'></font>
<font color=#447700>!         WHERE THE VALUES ARE NOT OBTAINED BY QUADRATURE BUT ARE THE<a name='9574'></font>
<font color=#447700>!         ACTUAL TRANSMISSIVITIES,ETC,BETWEEN A PAIR OF PRESSURES. THESE<a name='9575'></font>
<font color=#447700>!         ARE USED ONLY FOR NEARBY LAYER CALCULATIONS INCLUDING H2O..<a name='9576'></font>
<font color=#447700>!<a name='9577'></font>
      IQ = 1<a name='9578'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2IN1'>CO2IN1</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2IN1_1">(T20,T21,CO2D1D,IQ,L,LP1)<a name='9579'>
<font color=#447700>!       do kk=1,6<a name='9580'></font>
<font color=#447700>!         write(retval)(co2d1d(k,kk),k=1,60)<a name='9581'></font>
<font color=#447700>!       enddo<a name='9582'></font>
      DO K=1,L<a name='9583'>
        CDTM51(K)=CO2D1D(K,1)<a name='9584'>
        CO2M51(K)=CO2D1D(K,2)<a name='9585'>
        C2DM51(K)=CO2D1D(K,3)<a name='9586'>
        CDTM58(K)=CO2D1D(K,4)<a name='9587'>
        CO2M58(K)=CO2D1D(K,5)<a name='9588'>
        C2DM58(K)=CO2D1D(K,6)<a name='9589'>
      ENDDO<a name='9590'>
<font color=#447700>!<a name='9591'></font>
<font color=#447700>!===&gt;    FILL UP THE CO2D2D ARRAY<a name='9592'></font>
<font color=#447700>!    THE FOLLOWING GETS CO2 TRANSMISSION FUNCTIONS AND THEIR DERIVATIVES<a name='9593'></font>
<font color=#447700>!        FROM 109-LEVEL LINE-BY-LINE CALCULATIONS MADE USING THE 1982<a name='9594'></font>
<font color=#447700>!        MCCLATCHY TAPE (12511 LINES),CONSOLIDATED,INTERPOLATED<a name='9595'></font>
<font color=#447700>!        TO THE MRF VERTICAL COORDINATE,AND RE-CONSOLIDATED TO A<a name='9596'></font>
<font color=#447700>!        200 CM-1 BANDWIDTH. THE INTERPOLATION METHOD IS DESCRIBED IN<a name='9597'></font>
<font color=#447700>!        SCHWARZKOPF AND FELS (J.G.R.,1985).<a name='9598'></font>
<font color=#447700>!<a name='9599'></font>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INS'>CO2INS</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INS_1">(T22,T23,CO2D2D,IQ,L,LP1,1)<a name='9600'>
<font color=#447700>!       do kk=1,6<a name='9601'></font>
<font color=#447700>!         write(retval)((co2d2d(ka,kb,kk),ka=1,61),kb=1,61)<a name='9602'></font>
<font color=#447700>!       enddo<a name='9603'></font>
      DO K1=1,LP1<a name='9604'>
      DO K2=1,LP1<a name='9605'>
        CDT51(K1,K2)=CO2D2D(K1,K2,1)<a name='9606'>
        CO251(K1,K2)=CO2D2D(K1,K2,2)<a name='9607'>
        C2D51(K1,K2)=CO2D2D(K1,K2,3)<a name='9608'>
        CDT58(K1,K2)=CO2D2D(K1,K2,4)<a name='9609'>
        CO258(K1,K2)=CO2D2D(K1,K2,5)<a name='9610'>
        C2D58(K1,K2)=CO2D2D(K1,K2,6)<a name='9611'>
      ENDDO<a name='9612'>
      ENDDO<a name='9613'>
<font color=#447700>!<a name='9614'></font>
<font color=#447700>!NOV89<a name='9615'></font>
<font color=#447700>!===&gt;  INTERPOLATE DESIRED CO2 DATA FROM THE DETAILED(109,109) GRID..<a name='9616'></font>
<font color=#447700>!         IR=2,IQ=2 IS FOR COMMON /CO2BD2/ IN RADIATION CODE...<a name='9617'></font>
<font color=#447700>!           FOR THE CONSOLIDATED 490-670 CM-1 BAND...<a name='9618'></font>
<font color=#447700>!     ICO2TP=62<a name='9619'></font>
      ICO2TP=etarad_unit62<a name='9620'>
      IR = 2<a name='9621'>
      RATIO = 1.0<a name='9622'>
      NMETHD = 2<a name='9623'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT'>CO2INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INT_5">(ICO2TP,T41,T42,T22,RATIO,IR,NMETHD,L,LP1,LP2)<a name='9624'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT'>CO2INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INT_6">(ICO2TP,T43,T44,T23,RATIO,IR,NMETHD,L,LP1,LP2)<a name='9625'>
      IQ = 2<a name='9626'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INS'>CO2INS</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INS_2">(T22,T23,CO2IQ2,IQ,L,LP1,2)<a name='9627'>
<font color=#447700>!       do kk=1,6<a name='9628'></font>
<font color=#447700>!         write(retval)(co2iq2(k,1,kk),k=1,61)<a name='9629'></font>
<font color=#447700>!       enddo<a name='9630'></font>
      DO K=1,LP1<a name='9631'>
        CDT31(K)=CO2IQ2(K,1,1)<a name='9632'>
        CO231(K)=CO2IQ2(K,1,2)<a name='9633'>
        C2D31(K)=CO2IQ2(K,1,3)<a name='9634'>
        CDT38(K)=CO2IQ2(K,1,4)<a name='9635'>
        CO238(K)=CO2IQ2(K,1,5)<a name='9636'>
        C2D38(K)=CO2IQ2(K,1,6)<a name='9637'>
      ENDDO<a name='9638'>
<font color=#447700>!===&gt;  INTERPOLATE DESIRED CO2 DATA FROM THE DETAILED(109,109) GRID..<a name='9639'></font>
<font color=#447700>!         IR=3,IQ=3 IS FOR COMMON /CO2BD4/ IN RADIATION CODE...<a name='9640'></font>
<font color=#447700>!           FOR THE CONSOLIDATED 670-850 CM-1 BAND...<a name='9641'></font>
<font color=#447700>!     ICO2TP=63<a name='9642'></font>
      ICO2TP=etarad_unit63<a name='9643'>
      IR = 3<a name='9644'>
      RATIO = 1.0<a name='9645'>
      NMETHD = 2<a name='9646'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT'>CO2INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INT_7">(ICO2TP,T41,T42,T22,RATIO,IR,NMETHD,L,LP1,LP2)<a name='9647'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INT'>CO2INT</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INT_8">(ICO2TP,T43,T44,T23,RATIO,IR,NMETHD,L,LP1,LP2)<a name='9648'>
      IQ = 3<a name='9649'>
      CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2INS'>CO2INS</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CO2INS_3">(T22,T23,CO2IQ3,IQ,L,LP1,3)<a name='9650'>
<font color=#447700>!       do kk=1,6<a name='9651'></font>
<font color=#447700>!         write(retval)(co2iq3(k,1,kk),k=1,61)<a name='9652'></font>
<font color=#447700>!       enddo<a name='9653'></font>
<font color=#447700>!       close(retval)<a name='9654'></font>
      DO K=1,LP1<a name='9655'>
        CDT71(K)=CO2IQ3(K,1,1)<a name='9656'>
        CO271(K)=CO2IQ3(K,1,2)<a name='9657'>
        C2D71(K)=CO2IQ3(K,1,3)<a name='9658'>
        CDT78(K)=CO2IQ3(K,1,4)<a name='9659'>
        CO278(K)=CO2IQ3(K,1,5)<a name='9660'>
        C2D78(K)=CO2IQ3(K,1,6)<a name='9661'>
      ENDDO<a name='9662'>
<font color=#447700>!---      FOLLOWING CODE NOT WORKING AND NOT NEEDED YET<a name='9663'></font>
<font color=#447700>!===&gt;  INTERPOLATE DESIRED CO2 DATA FROM THE DETAILED(109,109) GRID..<a name='9664'></font>
<font color=#447700>!         IR=4,IQ=5 IS FOR COMMON /CO2BD5/ IN RADIATION CODE...<a name='9665'></font>
<font color=#447700>!           FOR THE 4.3 MICRON BAND...<a name='9666'></font>
<font color=#447700>! NOT USED YET      ICO2TP=65<a name='9667'></font>
<font color=#447700>! NOT USED YET      IR = 4<a name='9668'></font>
<font color=#447700>! NOT USED YET      RATIO = 1.0<a name='9669'></font>
<font color=#447700>! DAN SCHWARZ --- USE 300PPMV  RATIO = 0.9091   (NOT TESTED YET).....<a name='9670'></font>
<font color=#447700>! NOT USED YET      NMETHD = 2<a name='9671'></font>
<font color=#447700>! NOT USED YET      CALL CO2INT(ICO2TP,T41,T42,T22,RATIO,IR,NMETHD)<a name='9672'></font>
<font color=#447700>! NOT USED YET      CALL CO2INT(ICO2TP,T43,T44,T23,RATIO,IR,NMETHD)<a name='9673'></font>
<font color=#447700>! NOT USED YET      IQ = 5<a name='9674'></font>
<font color=#447700>! NOT USED YET      CALL CO2INS(T22,T23,CO2IQ5,IQ)<a name='9675'></font>
<font color=#447700>!NOV89<a name='9676'></font>
<font color=#447700>!...     WRITE DATA TO DISK..<a name='9677'></font>
<font color=#447700>!            ...SINCE THESE CODES ARE COMPILED WITH AUTODBL,THE CO2 DATA<a name='9678'></font>
<font color=#447700>!               IS CONVERTED TO SINGLE PRECISION IN A LATER JOB STEP..<a name='9679'></font>
<a name='9680'>
<font color=#447700>! NOT USED YET      WRITE(66) CO211<a name='9681'></font>
<font color=#447700>! NOT USED YET      WRITE(66) CO218<a name='9682'></font>
<font color=#447700>!NOV89<a name='9683'></font>
         IF ( wrf_dm_on_monitor() ) THEN<a name='9684'>
           CLOSE (etarad_unit61)<a name='9685'>
           CLOSE (etarad_unit62)<a name='9686'>
           CLOSE (etarad_unit63)<a name='9687'>
         ENDIF<a name='9688'>
<a name='9689'>
      RETURN<a name='9690'>
9061 CONTINUE<a name='9691'>
     WRITE( errmess , '(A49,I4)' ) 'module_ra_gfdleta: error reading tr49t85 on unit ',etarad_unit61<a name='9692'>
     write(0,*)' IERROR=',IERROR<a name='9693'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_167">(errmess)<a name='9694'>
9062 CONTINUE<a name='9695'>
     WRITE( errmess , '(A49,I4)' ) 'module_ra_gfdleta: error reading tr49t67 on unit ',etarad_unit62<a name='9696'>
     write(0,*)' IERROR=',IERROR<a name='9697'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_168">(errmess)<a name='9698'>
9063 CONTINUE<a name='9699'>
     WRITE( errmess , '(A49,I4)' ) 'module_ra_gfdleta: error reading tr67t85 on unit ',etarad_unit63<a name='9700'>
     write(0,*)' IERROR=',IERROR<a name='9701'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CO2O3' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_169">(errmess)<a name='9702'>
      END SUBROUTINE CO2O3<a name='9703'>
<a name='9704'>
<a name='9705'>
<font color=#447700>!!================================================================================<a name='9706'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9707'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9708'></font>
<A NAME='CONRAD'><A href='../../html_code/phys/module_ra_gfdleta.F.html#CONRAD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9709'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>CONRAD</font>(KDS,KDE,KMS,KME,KTS,KTE) <A href='../../call_to/CONRAD.html' TARGET='index'>1</A>,<A href='../../call_from/CONRAD.html' TARGET='index'>6</A><a name='9710'>
<font color=#447700>!----------------------------------------------------------------------<a name='9711'></font>
<font color=#447700>!    *******************************************************************<a name='9712'></font>
<font color=#447700>!    *                           C O N R A D                           *<a name='9713'></font>
<font color=#447700>!    *    READ CO2 TRANSMISSION DATA FROM UNIT(NFILE)FOR NEW VERTICAL  *<a name='9714'></font>
<font color=#447700>!    *      COORDINATE TESTS      ...                                  *<a name='9715'></font>
<font color=#447700>!    *    THESE ARRAYS USED TO BE IN BLOCK DATA    ...K.CAMPANA-MAR 90 *<a name='9716'></font>
<font color=#447700>!    *******************************************************************<a name='9717'></font>
<font color=#447700>!<a name='9718'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9719'></font>
      IMPLICIT NONE<a name='9720'>
<font color=#447700>!----------------------------------------------------------------------<a name='9721'></font>
      INTEGER,INTENT(IN) :: KDS,KDE,KMS,KME,KTS,KTE<a name='9722'>
<font color=#447700>!----------------------------------------------------------------------<a name='9723'></font>
<font color=#447700>!<a name='9724'></font>
      INTEGER :: I,I1,I2,IERROR,IRTN,J,K,KK,L,LP1,N,NUNIT_CO2,RSIZE<a name='9725'>
      INTEGER,DIMENSION(3) :: RSZE<a name='9726'>
<font color=#447700>!<a name='9727'></font>
      REAL,DIMENSION(KMS:KME-1,6) :: CO21D<a name='9728'>
      REAL,DIMENSION(KMS:KME,2) :: SGTMP<a name='9729'>
      REAL,DIMENSION(KMS:KME,6) :: CO21D3,CO21D7<a name='9730'>
      REAL,DIMENSION(KMS:KME,KMS:KME,6) :: CO22D<a name='9731'>
      REAL,DIMENSION((KME-KMS+1)*(KME-KMS+1)) :: DATA2<a name='9732'>
      LOGICAL :: OPENED<a name='9733'>
      LOGICAL,EXTERNAL :: wrf_dm_on_monitor<a name='9734'>
      CHARACTER*80 errmess<a name='9735'>
<font color=#447700>!<a name='9736'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9737'></font>
<font color=#447700>!<a name='9738'></font>
<font color=#447700>!                 CO2 DATA TABLES FOR USER'S VERTICAL COORDINATE<a name='9739'></font>
<font color=#447700>!<a name='9740'></font>
<font color=#447700>!   THE FOLLOWING COMMON BLOCKS CONTAIN PRETABULATED CO2 TRANSMISSION<a name='9741'></font>
<font color=#447700>!       FUNCTIONS, EVALUATED USING THE METHODS OF FELS AND<a name='9742'></font>
<font color=#447700>!       SCHWARZKOPF (1981) AND SCHWARZKOPF AND FELS (1985),<a name='9743'></font>
<font color=#447700>!-----  THE 2-DIMENSIONAL ARRAYS ARE<a name='9744'></font>
<font color=#447700>!                    CO2 TRANSMISSION FUNCTIONS AND THEIR DERIVATIVES<a name='9745'></font>
<font color=#447700>!        FROM 109-LEVEL LINE-BY-LINE CALCULATIONS MADE USING THE 1982<a name='9746'></font>
<font color=#447700>!        MCCLATCHY TAPE (12511 LINES),CONSOLIDATED,INTERPOLATED<a name='9747'></font>
<font color=#447700>!        TO THE NMC MRF VERTICAL COORDINATTE,AND RE-CONSOLIDATED TO A<a name='9748'></font>
<font color=#447700>!        200 CM-1 BANDWIDTH. THE INTERPOLATION METHOD IS DESCRIBED IN<a name='9749'></font>
<font color=#447700>!        SCHWARZKOPF AND FELS (J.G.R.,1985).<a name='9750'></font>
<font color=#447700>!-----  THE 1-DIM ARRAYS ARE<a name='9751'></font>
<font color=#447700>!                  CO2 TRANSMISSION FUNCTIONS AND THEIR DERIVATIVES<a name='9752'></font>
<font color=#447700>!          FOR TAU(I,I+1),I=1,L,<a name='9753'></font>
<font color=#447700>!            WHERE THE VALUES ARE NOT OBTAINED BY QUADRATURE,BUT ARE THE<a name='9754'></font>
<font color=#447700>!            ACTUAL TRANSMISSIVITIES,ETC,BETWEEN A PAIR OF PRESSURES.<a name='9755'></font>
<font color=#447700>!          THESE USED ONLY FOR NEARBY LAYER CALCULATIONS INCLUDING QH2O.<a name='9756'></font>
<font color=#447700>!-----  THE WEIGHTING FUNCTION GTEMP=P(K)**0.2*(1.+P(K)/30000.)**0.8/<a name='9757'></font>
<font color=#447700>!         1013250.,WHERE P(K)=PRESSURE,NMC MRF(NEW)  L18 DATA LEVELS FOR<a name='9758'></font>
<font color=#447700>!         PSTAR=1013250.<a name='9759'></font>
<font color=#447700>!-----  STEMP IS US STANDARD ATMOSPHERES,1976,AT DATA PRESSURE LEVELS<a name='9760'></font>
<font color=#447700>!        USING NMC MRF SIGMAS,WHERE PSTAR=1013.25 MB (PTZ PROGRAM)<a name='9761'></font>
<font color=#447700>!<a name='9762'></font>
<font color=#447700>!***CO2 TRANSMISSION FUNCTIONS AND TEMPERATURE<a name='9763'></font>
<font color=#447700>!   AND PRESSURE DERIVATIVES FOR THE 560-800 CM-1 BAND. ALSO INCLUDED<a name='9764'></font>
<font color=#447700>!   ARE THE STANDARD TEMPERATURES AND THE WEIGHTING FUNCTION. THESE<a name='9765'></font>
<font color=#447700>!   DATA ARE IN BLOCK DATA BD3:<a name='9766'></font>
<font color=#447700>!         CO251    =  TRANSMISSION FCTNS FOR T0 (STD. PROFILE)<a name='9767'></font>
<font color=#447700>!                       WITH P(SFC)=1013.25 MB<a name='9768'></font>
<font color=#447700>!         CO258    =  TRANSMISSION FCTNS. FOR T0 (STD. PROFILE)<a name='9769'></font>
<font color=#447700>!                       WITH P(SFC)= 810 MB<a name='9770'></font>
<font color=#447700>!         CDT51    =  FIRST TEMPERATURE DERIVATIVE OF CO251<a name='9771'></font>
<font color=#447700>!         CDT58    =  FIRST TEMPERATURE DERIVATIVE OF CO258<a name='9772'></font>
<font color=#447700>!         C2D51    =  SECOND TEMPERATURE DERIVATIVE OF CO251<a name='9773'></font>
<font color=#447700>!         C2D58    =  SECOND TEMPERATURE DERIVATIVE OF CO251<a name='9774'></font>
<font color=#447700>!         CO2M51   =  TRANSMISSION FCTNS FOR T0 FOR ADJACENT PRESSURE<a name='9775'></font>
<font color=#447700>!                        LEVELS, WITH NO PRESSURE QUADRATURE. USED FOR<a name='9776'></font>
<font color=#447700>!                        NEARBY LAYER COMPUTATIONS. P(SFC)=1013.25 MB<a name='9777'></font>
<font color=#447700>!         CO2M58   =  SAME AS CO2M51,WITH P(SFC)= 810 MB<a name='9778'></font>
<font color=#447700>!         CDTM51   =  FIRST TEMPERATURE DERIVATIVE OF CO2M51<a name='9779'></font>
<font color=#447700>!         CDTM58   =  FIRST TEMPERATURE DERIVATIVE OF CO2M58<a name='9780'></font>
<font color=#447700>!         C2DM51   =  SECOND TEMPERATURE DERIVATIVE OF CO2M51<a name='9781'></font>
<font color=#447700>!         C2DM58   =  SECOND TEMPERATURE DERIVATIVE OF CO2M58<a name='9782'></font>
<font color=#447700>!         STEMP    =  STANDARD TEMPERATURES FOR MODEL PRESSURE LEVEL<a name='9783'></font>
<font color=#447700>!                        STRUCTURE WITH P(SFC)=1013.25 MB<a name='9784'></font>
<font color=#447700>!         GTEMP    =  WEIGHTING FUNCTION FOR MODEL PRESSURE LEVEL<a name='9785'></font>
<font color=#447700>!                        STRUCTURE WITH P(SFC)=1013.25 MB.<a name='9786'></font>
<font color=#447700>!-----       THE FOLLOWING ARE STILL IN BLOCK DATA<a name='9787'></font>
<font color=#447700>!         B0       =  TEMP. COEFFICIENT USED FOR CO2 TRANS. FCTN.<a name='9788'></font>
<font color=#447700>!                        CORRECTION FOR T(K). (SEE REF. 4 AND BD3)<a name='9789'></font>
<font color=#447700>!         B1       =  TEMP. COEFFICIENT, USED ALONG WITH B0<a name='9790'></font>
<font color=#447700>!         B2       =  TEMP. COEFFICIENT, USED ALONG WITH B0<a name='9791'></font>
<font color=#447700>!         B3       =  TEMP. COEFFICIENT, USED ALONG WITH B0<a name='9792'></font>
<font color=#447700>!<a name='9793'></font>
<font color=#447700>!***CO2 TRANSMISSION FUNCTIONS AND TEMPERATURE<a name='9794'></font>
<font color=#447700>!   AND PRESSURE DERIVATIVES FOR THE 560-670 CM-1 PART OF THE 15 UM<a name='9795'></font>
<font color=#447700>!   CO2 BAND.  THESE DATA ARE IN BLOCK DATA BD2.<a name='9796'></font>
<font color=#447700>!     FOR THE 560-670 CM-1 BAND,ONLY THE (1,I) VALUES ARE USED , SINCE<a name='9797'></font>
<font color=#447700>!     THESE ARE USED FOR CTS COMPUTATIONS.<a name='9798'></font>
<font color=#447700>!         CO231    =  TRANSMISSION FCTNS FOR T0 (STD. PROFILE)<a name='9799'></font>
<font color=#447700>!                       WITH P(SFC)=1013.25 MB<a name='9800'></font>
<font color=#447700>!         CO238    =  TRANSMISSION FCTNS. FOR T0 (STD. PROFILE)<a name='9801'></font>
<font color=#447700>!                       WITH P(SFC)= 810 MB<a name='9802'></font>
<font color=#447700>!         CDT31    =  FIRST TEMPERATURE DERIVATIVE OF CO231<a name='9803'></font>
<font color=#447700>!         CDT38    =  FIRST TEMPERATURE DERIVATIVE OF CO238<a name='9804'></font>
<font color=#447700>!         C2D31    =  SECOND TEMPERATURE DERIVATIVE OF CO231<a name='9805'></font>
<font color=#447700>!         C2D38    =  SECOND TEMPERATURE DERIVATIVE OF CO231<a name='9806'></font>
<font color=#447700>!<a name='9807'></font>
<font color=#447700>!***CO2 TRANSMISSION FUNCTIONS AND TEMPERATURE<a name='9808'></font>
<font color=#447700>!   AND PRESSURE DERIVATIVES FOR THE 670-800 CM-1 PART OF THE 15 UM<a name='9809'></font>
<font color=#447700>!   CO2 BAND.  THESE DATA ARE IN BLOCK DATA BD4.<a name='9810'></font>
<font color=#447700>!         CO271    =  TRANSMISSION FCTNS FOR T0 (STD. PROFILE)<a name='9811'></font>
<font color=#447700>!                       WITH P(SFC)=1013.25 MB<a name='9812'></font>
<font color=#447700>!         CO278    =  TRANSMISSION FCTNS. FOR T0 (STD. PROFILE)<a name='9813'></font>
<font color=#447700>!                       WITH P(SFC)= 810 MB<a name='9814'></font>
<font color=#447700>!         CDT71    =  FIRST TEMPERATURE DERIVATIVE OF CO271<a name='9815'></font>
<font color=#447700>!         CDT78    =  FIRST TEMPERATURE DERIVATIVE OF CO278<a name='9816'></font>
<font color=#447700>!         C2D71    =  SECOND TEMPERATURE DERIVATIVE OF CO271<a name='9817'></font>
<font color=#447700>!         C2D78    =  SECOND TEMPERATURE DERIVATIVE OF CO271<a name='9818'></font>
<font color=#447700>!<a name='9819'></font>
<font color=#447700>! *****THE FOLLOWING NOT USED IN CURRENT VERSION OF RADIATION *******<a name='9820'></font>
<font color=#447700>!<a name='9821'></font>
<font color=#447700>! --CO2 TRANSMISSION FUNCTIONS FOR THE 2270-<a name='9822'></font>
<font color=#447700>!       2380 PART OF THE 4.3 UM CO2 BAND.<a name='9823'></font>
<font color=#447700>!              THESE DATA ARE IN BLOCK DATA BD5.<a name='9824'></font>
<font color=#447700>!         CO211    =  TRANSMISSION FCTNS FOR T0 (STD. PROFILE)<a name='9825'></font>
<font color=#447700>!                        WITH P(SFC)=1013.25 MB<a name='9826'></font>
<font color=#447700>!         CO218    =  TRANSMISSION FCTNS. FOR T0 (STD. PROFILE)<a name='9827'></font>
<font color=#447700>!                       WITH P(SFC)= 810 MB<a name='9828'></font>
<font color=#447700>!<a name='9829'></font>
<font color=#447700>! *****THE ABOVE NOT USED IN CURRENT VERSION OF RADIATION ***********<a name='9830'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9831'></font>
<font color=#447700>!<a name='9832'></font>
      L=KME-KMS<a name='9833'>
      LP1=KME-KMS+1<a name='9834'>
<font color=#447700>!<a name='9835'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9836'></font>
      IF ( wrf_dm_on_monitor() ) THEN<a name='9837'>
        DO i = 14,99<a name='9838'>
      write(0,*)' in CONRAD i=',i,' opened=',opened<a name='9839'>
          INQUIRE ( i , OPENED = opened )<a name='9840'>
          IF ( .NOT. opened ) THEN<a name='9841'>
            nunit_co2 = i<a name='9842'>
            GOTO 2014<a name='9843'>
          ENDIF<a name='9844'>
        ENDDO<a name='9845'>
        nunit_co2 = -1<a name='9846'>
 2014   CONTINUE<a name='9847'>
      ENDIF<a name='9848'>
        IF ( wrf_dm_on_monitor() ) THEN<a name='9849'>
          OPEN(nunit_co2,FILE='co2_trans',                  &amp;<a name='9850'>
               FORM='UNFORMATTED',STATUS='OLD',ERR=9014,IOSTAT=IERROR)<a name='9851'>
        ENDIF<a name='9852'>
<a name='9853'>
      REWIND NUNIT_CO2<a name='9854'>
<font color=#447700>!----------------------------------------------------------------------<a name='9855'></font>
<font color=#447700>!<a name='9856'></font>
<font color=#447700>!***  READ IN PRE-COMPUTED CO2 TRANSMISSION DATA.<a name='9857'></font>
<font color=#447700>!<a name='9858'></font>
      RSZE(1) = LP1<a name='9859'>
      RSZE(2) = L<a name='9860'>
      RSZE(3) = LP1*LP1<a name='9861'>
<font color=#447700>!----------------------------------------------------------------------<a name='9862'></font>
<font color=#447700>!<a name='9863'></font>
      RSIZE = RSZE(1)<a name='9864'>
<font color=#447700>!<a name='9865'></font>
      DO KK=1,2<a name='9866'>
        IF( wrf_dm_on_monitor() )READ(NUNIT_CO2)(SGTMP(I,KK),I=1,RSIZE)<a name='9867'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CONRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_14">( SGTMP(1,KK), RSIZE )<a name='9868'>
      ENDDO<a name='9869'>
<font color=#447700>!<a name='9870'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9871'></font>
<font color=#447700>!<a name='9872'></font>
      RSIZE = RSZE(2)<a name='9873'>
<font color=#447700>!<a name='9874'></font>
      DO KK=1,6<a name='9875'>
        IF( wrf_dm_on_monitor() )READ(NUNIT_CO2)(CO21D(I,KK),I=1,RSIZE)<a name='9876'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CONRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_15">( CO21D(1,KK), RSIZE )<a name='9877'>
      ENDDO<a name='9878'>
<font color=#447700>!<a name='9879'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9880'></font>
<font color=#447700>!<a name='9881'></font>
      RSIZE = RSZE(3)<a name='9882'>
<font color=#447700>!<a name='9883'></font>
      DO KK=1,6<a name='9884'>
        IF( wrf_dm_on_monitor() )READ(NUNIT_CO2)(DATA2(I),I=1,RSIZE)<a name='9885'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CONRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_16">( DATA2(1), RSIZE )<a name='9886'>
        N=0<a name='9887'>
<font color=#447700>!<a name='9888'></font>
        DO I1=1,LP1<a name='9889'>
        DO I2=1,LP1<a name='9890'>
          N=N+1<a name='9891'>
          CO22D(I1,I2,KK)=DATA2(N)<a name='9892'>
        ENDDO<a name='9893'>
        ENDDO<a name='9894'>
<font color=#447700>!<a name='9895'></font>
      ENDDO<a name='9896'>
<font color=#447700>!<a name='9897'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9898'></font>
<font color=#447700>!<a name='9899'></font>
      RSIZE = RSZE(1)<a name='9900'>
<font color=#447700>!<a name='9901'></font>
      DO KK=1,6<a name='9902'>
        IF( wrf_dm_on_monitor() )READ(NUNIT_CO2)(CO21D3(I,KK),I=1,RSIZE)<a name='9903'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CONRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_17">( CO21D3(1,KK), RSIZE )<a name='9904'>
      ENDDO<a name='9905'>
<font color=#447700>!<a name='9906'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9907'></font>
<font color=#447700>!<a name='9908'></font>
      DO KK=1,6<a name='9909'>
        IF( wrf_dm_on_monitor() )READ(NUNIT_CO2)(CO21D7(I,KK),I=1,RSIZE)<a name='9910'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CONRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_18"> ( CO21D7(1,KK), RSIZE )<a name='9911'>
      ENDDO<a name='9912'>
<font color=#447700>!<a name='9913'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9914'></font>
      ALLOCATE(CO251(LP1,LP1))<a name='9915'>
      ALLOCATE(CDT51(LP1,LP1))<a name='9916'>
      ALLOCATE(C2D51(LP1,LP1))<a name='9917'>
      ALLOCATE(CO258(LP1,LP1))<a name='9918'>
      ALLOCATE(CDT58(LP1,LP1))<a name='9919'>
      ALLOCATE(C2D58(LP1,LP1))<a name='9920'>
      ALLOCATE(STEMP(LP1))<a name='9921'>
      ALLOCATE(GTEMP(LP1))<a name='9922'>
      ALLOCATE(CO231(LP1))<a name='9923'>
      ALLOCATE(CDT31(LP1))<a name='9924'>
      ALLOCATE(C2D31(LP1))<a name='9925'>
      ALLOCATE(CO238(LP1))<a name='9926'>
      ALLOCATE(CDT38(LP1))<a name='9927'>
      ALLOCATE(C2D38(LP1))<a name='9928'>
      ALLOCATE(CO271(LP1))<a name='9929'>
      ALLOCATE(CDT71(LP1))<a name='9930'>
      ALLOCATE(C2D71(LP1))<a name='9931'>
      ALLOCATE(CO278(LP1))<a name='9932'>
      ALLOCATE(CDT78(LP1))<a name='9933'>
      ALLOCATE(C2D78(LP1))<a name='9934'>
      ALLOCATE(CO2M51(L))<a name='9935'>
      ALLOCATE(CDTM51(L))<a name='9936'>
      ALLOCATE(C2DM51(L))<a name='9937'>
      ALLOCATE(CO2M58(L))<a name='9938'>
      ALLOCATE(CDTM58(L))<a name='9939'>
      ALLOCATE(C2DM58(L))<a name='9940'>
<font color=#447700>!----------------------------------------------------------------------<a name='9941'></font>
<font color=#447700>!<a name='9942'></font>
      DO K=1,LP1<a name='9943'>
        STEMP(K) = SGTMP(K,1)<a name='9944'>
        GTEMP(K) = SGTMP(K,2)<a name='9945'>
      ENDDO<a name='9946'>
<font color=#447700>!<a name='9947'></font>
      DO K=1,L<a name='9948'>
        CDTM51(K) = CO21D(K,1)<a name='9949'>
        CO2M51(K) = CO21D(K,2)<a name='9950'>
        C2DM51(K) = CO21D(K,3)<a name='9951'>
        CDTM58(K) = CO21D(K,4)<a name='9952'>
        CO2M58(K) = CO21D(K,5)<a name='9953'>
        C2DM58(K) = CO21D(K,6)<a name='9954'>
      ENDDO<a name='9955'>
<font color=#447700>!<a name='9956'></font>
      DO J=1,LP1<a name='9957'>
      DO I=1,LP1<a name='9958'>
        CDT51(I,J) = CO22D(I,J,1)<a name='9959'>
        CO251(I,J) = CO22D(I,J,2)<a name='9960'>
        C2D51(I,J) = CO22D(I,J,3)<a name='9961'>
        CDT58(I,J) = CO22D(I,J,4)<a name='9962'>
        CO258(I,J) = CO22D(I,J,5)<a name='9963'>
        C2D58(I,J) = CO22D(I,J,6)<a name='9964'>
      ENDDO<a name='9965'>
      ENDDO<a name='9966'>
<font color=#447700>!<a name='9967'></font>
      DO K=1,LP1<a name='9968'>
        CDT31(K) = CO21D3(K,1)<a name='9969'>
        CO231(K) = CO21D3(K,2)<a name='9970'>
        C2D31(K) = CO21D3(K,3)<a name='9971'>
        CDT38(K) = CO21D3(K,4)<a name='9972'>
        CO238(K) = CO21D3(K,5)<a name='9973'>
        C2D38(K) = CO21D3(K,6)<a name='9974'>
      ENDDO<a name='9975'>
<font color=#447700>!<a name='9976'></font>
      DO K=1,LP1<a name='9977'>
        CDT71(K) = CO21D7(K,1)<a name='9978'>
        CO271(K) = CO21D7(K,2)<a name='9979'>
        C2D71(K) = CO21D7(K,3)<a name='9980'>
        CDT78(K) = CO21D7(K,4)<a name='9981'>
        CO278(K) = CO21D7(K,5)<a name='9982'>
        C2D78(K) = CO21D7(K,6)<a name='9983'>
      ENDDO<a name='9984'>
<font color=#447700>!<a name='9985'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='9986'></font>
      IF(wrf_dm_on_monitor())WRITE(0,66)NUNIT_CO2<a name='9987'>
   66 FORMAT('----READ CO2 TRANSMISSION FUNCTIONS FROM UNIT ',I2)<a name='9988'>
<font color=#447700>!----------------------------------------------------------------------<a name='9989'></font>
      IF( wrf_dm_on_monitor() )THEN<a name='9990'>
        CLOSE(nunit_co2)<a name='9991'>
      ENDIF<a name='9992'>
      RETURN<a name='9993'>
<font color=#447700>!<a name='9994'></font>
9014 CONTINUE<a name='9995'>
     WRITE(errmess,'(A51,I4)')'module_ra_gfdleta: error reading co2_trans on unit ',nunit_co2<a name='9996'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_gfdleta.F.html#CONRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_170">(errmess)<a name='9997'>
<font color=#447700>!----------------------------------------------------------------------<a name='9998'></font>
      END SUBROUTINE CONRAD<a name='9999'>
<font color=#447700>!----------------------------------------------------------------------<a name='10000'></font>
<font color=#447700>!<a name='10001'></font>
      END MODULE module_RA_GFDLETA<a name='10002'>
<font color=#447700>!<a name='10003'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='10004'></font>
<a name='10005'>
</pre></body></html>